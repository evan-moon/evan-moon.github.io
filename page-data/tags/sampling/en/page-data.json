{"componentChunkName":"component---src-templates-tag-page-template-index-tsx","path":"/tags/sampling/en/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"id":"f771a19c-3cac-50f8-b8e2-4a2e090c4809","tableOfContents":"<ul>\n<li>\n<p><a href=\"#what-is-sound\">What Is Sound?</a></p>\n<ul>\n<li><a href=\"#sound-is-an-analog-signal\">Sound Is an Analog Signal</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#how-computers-hear-sound\">How Computers Hear Sound</a></p>\n<ul>\n<li><a href=\"#sampling\">Sampling</a></li>\n<li><a href=\"#lets-look-at-sample-rate-in-more-detail\">Let’s Look at Sample Rate in More Detail</a></li>\n<li><a href=\"#bit-rate\">Bit Rate</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#drawing-waveforms-with-web-audio-api\">Drawing Waveforms with Web Audio API</a></p>\n<ul>\n<li><a href=\"#setting-up-the-basic-structure\">Setting Up the Basic Structure</a></li>\n<li><a href=\"#writing-the-audioanalyzer-class\">Writing the AudioAnalyzer Class</a></li>\n<li><a href=\"#setting-up-the-svg-viewbox\">Setting Up the SVG Viewbox</a></li>\n<li><a href=\"#checking-the-uploaded-audiobuffer\">Checking the Uploaded AudioBuffer</a></li>\n<li><a href=\"#analyzing-and-refining-audio-data\">Analyzing and Refining Audio Data</a></li>\n<li><a href=\"#lets-actually-draw-now\">Let’s Actually Draw Now!</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#music-please-dj\">Music Please, DJ</a></p>\n</li>\n</ul>","excerpt":"In this post, I want to tap into my memories from my former career as a sound engineer and explain some audio theory. But since just explaining theory is boring, I’ll also draw a simple audio waveform using JavaScript’s  API based on that audio theory.","html":"<p>In this post, I want to tap into my memories from my former career as a sound engineer and explain some audio theory. But since just explaining theory is boring, I’ll also draw a simple audio waveform using JavaScript’s <code class=\"language-text\">Web Audio</code> API based on that audio theory.</p>\n<!-- more -->\n<p>I want to jump straight into coding, but you need basic knowledge about audio to understand the process of drawing waveforms. So I’ll try to explain the theory in the least boring way possible. Theory is definitely less fun than coding, but these are things you need to know at minimum to draw audio waveforms, so let’s skim through it.</p>\n<h2 id=\"what-is-sound\" style=\"position:relative;\">What Is Sound?<a href=\"#what-is-sound\" aria-label=\"what is sound permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>First, let’s understand what sound is. If I had to describe sound in one word, it would be “vibration.” Basically, hearing sound happens in this order:</p>\n<hr>\n<ol>\n<li>Some object vibrates. Let’s say the vibration frequency is about <code class=\"language-text\">440Hz</code>.</li>\n<li>The medium around that object transmits the <code class=\"language-text\">440Hz</code> vibration (usually air in normal situations).</li>\n<li>When the medium transmits the vibration, our eardrum also vibrates at <code class=\"language-text\">440Hz</code>.</li>\n<li>The cochlea converts that vibration signal into electrical signals and sends them to the auditory nerve.</li>\n<li>The brain receives and interprets the signal. <code class=\"language-text\">440Hz</code> received!</li>\n</ol>\n<hr>\n<p>Here, we use the unit Hertz (Hz) to express how many times the object vibrated in one second in step 1. <code class=\"language-text\">10Hz</code> means it vibrated 10 times in one second, and <code class=\"language-text\">1kHz</code> means it vibrated 1,000 times in one second.</p>\n<p>By the way, <code class=\"language-text\">440Hz</code> in the example is the note “A” in do-re-mi-fa-sol-la-ti-do. So when we listen to music, we’re actually feeling vibrations — the vibration of strings for string instruments, the vibration of lips or reeds for wind instruments, and the vibration of vocal cords for singing. Even the most emotional music can be broken down like this in an engineer’s hands.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/6e3222c117b2f5be65d4a041d5f0bf99/eea4a/s-oche.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAABA//EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAEW9SxqiZB//8QAGBABAQEBAQAAAAAAAAAAAAAAAQARIkH/2gAIAQEAAQUCtLxXA6b/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwFX/8QAGRAAAwADAAAAAAAAAAAAAAAAARARACJB/9oACAEBAAY/AjahrgHK/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAREhQZH/2gAIAQEAAT8h1PBElJpz6WXttU1HpBAxEr6f/9oADAMBAAIAAwAAABCTz//EABgRAQEAAwAAAAAAAAAAAAAAAAEAETFR/9oACAEDAQE/EBdWHt//xAAYEQEBAAMAAAAAAAAAAAAAAAABABEhUf/aAAgBAgEBPxAw7gcv/8QAHBABAAICAwEAAAAAAAAAAAAAAQARITFBUWGB/9oACAEBAAE/EGkFsbi9+sCRCWR5fnWtzeFiQ9YTYClkWuZiawJVwZgAaFP/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"s oche\" title=\"\" src=\"/static/6e3222c117b2f5be65d4a041d5f0bf99/c08c5/s-oche.jpg\" srcset=\"/static/6e3222c117b2f5be65d4a041d5f0bf99/0913d/s-oche.jpg 160w,\n/static/6e3222c117b2f5be65d4a041d5f0bf99/cb69c/s-oche.jpg 320w,\n/static/6e3222c117b2f5be65d4a041d5f0bf99/c08c5/s-oche.jpg 640w,\n/static/6e3222c117b2f5be65d4a041d5f0bf99/6a068/s-oche.jpg 960w,\n/static/6e3222c117b2f5be65d4a041d5f0bf99/eea4a/s-oche.jpg 1280w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>The beautiful melodies we hear are just bundles of vibration frequencies when you break them down.</small>\n</center>\n<p>These vibrations occur in nature, so they appear in analog form. Most macroscopic signals occurring in nature are analog — for example, changes in light brightness, wind intensity, or sound volume.</p>\n<h3 id=\"sound-is-an-analog-signal\" style=\"position:relative;\">Sound Is an Analog Signal<a href=\"#sound-is-an-analog-signal\" aria-label=\"sound is an analog signal permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Analog represents signals or data as continuous physical quantities. This “continuous physical quantities” sounds professional and difficult, but when you break it down, it’s really nothing special. The word we need to focus on here is not “physical quantities” but “continuous.”</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 605px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/48485ab8c211172e1d85631ac91b57ce/90cbd/analog.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVR42m1S147CQBDb//8seANxQiAhSugCUjahi5rx2Qk6jsutlOxkqseOazabyIIAOJ1QOdcrkCTA41GN7XbAdltxu3G7XTTL4xjGQqPTzMqbzWy/h6Vp+Z3n5X25wLyHZRmMtT81fNyk1So6K4Dj8T3qdnsjYEM8n5/oFL/fKyhdt17Hns38ZoPteIyUUz2fbDaDXy7hWZzO58hkK0ZkosgTfZE3GiFcr7EOQyS8XYsIMyKIlDAYIKZTdtLvI+IQ2fFqhWQ4RKi8xQKeTSI2DklTOp1iSNq+Oh1MGg2uTEexsl5a+3wuReD0MmDvtWUfDgA5/BBOFLxyXK/XY/0DuUiVKBInikrifwsh8uWXUPK9RChiEogrS0BXq9UQkJOzkOlo+n+/kNBJNAnx92gjITfDN0lsZ7dzZK7fAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"analog\" title=\"\" src=\"/static/48485ab8c211172e1d85631ac91b57ce/90cbd/analog.png\" srcset=\"/static/48485ab8c211172e1d85631ac91b57ce/69538/analog.png 160w,\n/static/48485ab8c211172e1d85631ac91b57ce/72799/analog.png 320w,\n/static/48485ab8c211172e1d85631ac91b57ce/90cbd/analog.png 605w\" sizes=\"(max-width: 605px) 100vw, 605px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>The horizontal axis is time, the vertical axis is voltage. Analog signals have continuity that never ends no matter how much you divide them</small>\n</center>\n<p>So what does continuous mean?</p>\n<p>The representative example of continuity is numbers. Let’s imagine walking from <code class=\"language-text\">1</code> to <code class=\"language-text\">2</code>. How many numbers will we encounter while walking from <code class=\"language-text\">1</code> to <code class=\"language-text\">2</code>?</p>\n<p>First, at the halfway point between <code class=\"language-text\">1</code> and <code class=\"language-text\">2</code>, there’s <code class=\"language-text\">1.5</code>. There’s also half of that, <code class=\"language-text\">1.25</code>, and half of that, <code class=\"language-text\">1.125</code>.</p>\n<p>If we keep dividing numbers like this, we eventually realize this is a pointless exercise. Even if we divide down to <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>10</mn><mrow><mo>−</mo><mn>10000</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">10^{-10000}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">10000</span></span></span></span></span></span></span></span></span></span></span></span></span> units, we can keep dividing that number infinitely. We call this property continuity.</p>\n<h2 id=\"how-computers-hear-sound\" style=\"position:relative;\">How Computers Hear Sound<a href=\"#how-computers-hear-sound\" aria-label=\"how computers hear sound permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>But as you know, computers are dumb — they only understand <code class=\"language-text\">0</code> and <code class=\"language-text\">1</code>. We call this method digital. So computers that only know <code class=\"language-text\">0</code> and <code class=\"language-text\">1</code> cannot understand continuous analog signals.</p>\n<p>Then how can we make a computer hear sound, which is an analog form occurring in nature?</p>\n<p>Simple. We convert analog to digital. Once you understand the process of converting the analog signal of sound into something the computer can understand, you’ll know what the information that the <code class=\"language-text\">Web Audio</code> API gives us means. So let’s learn about the process of converting analog to digital.</p>\n<p>To convert analog to digital, we need to go through several steps. The values used in these steps determine the resolution of the digitally converted sound — in other words, the audio quality. The terms that come up here are Sample Rate and Bit Rate.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 439px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/5c4ef295d012e89f63bcd069e92fb4b5/e3b18/encoder.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 36.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABNElEQVR42lVRSY7CQBDL//+VAxcQEmQlezobWciCYE6ecmUYzRxKlbTdLrvaMqZCHCdI01Sr73uM46jVtB3iJEXg+2jbVnH2aZoUH4ZB+bfbDff7HV3XwTJVhSTNkCS7KAES58cDddPCD0LFeF4UxT/Bh3BYxPlPccsYo0JhGCKKIi1+13WNPM9xPB4FzyRFjCzbOwX8H9fzPOv9QQQ51OKly+UC13XheR6CIFBgXVed2Mil9/sLo7iis23bsCyLCtHV9XrVO6UY4wCLMQ6HA2zbxvl8RiUr0EhSpqpRliVWEVnXTQc4jqMu+37Yncl6CuH00tUho3HK6XTS5aYSa9/NLFMrIRd4vV6Y5OzzADRBDh+BvWka7b87pGXuhTEJMApdksDJ2/OpO6Ibxv3L+XQWX/kbanYF0WWvlT4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"encoder\" title=\"\" src=\"/static/5c4ef295d012e89f63bcd069e92fb4b5/e3b18/encoder.png\" srcset=\"/static/5c4ef295d012e89f63bcd069e92fb4b5/69538/encoder.png 160w,\n/static/5c4ef295d012e89f63bcd069e92fb4b5/72799/encoder.png 320w,\n/static/5c4ef295d012e89f63bcd069e92fb4b5/e3b18/encoder.png 439w\" sizes=\"(max-width: 439px) 100vw, 439px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Difficult words that make you not know what to adjust when using encoder programs</small>\n</center>\n<p>The terms look difficult, but they’re actually simple. Sound is essentially 2-dimensional vibration frequency data drawn in a space defined by time on the horizontal axis and amplitude on the vertical axis. The sample rate represents the horizontal axis resolution, and the bit rate represents the vertical axis resolution. These values are used in sampling, the first step of converting analog to digital.</p>\n<h3 id=\"sampling\" style=\"position:relative;\">Sampling<a href=\"#sampling\" aria-label=\"sampling permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Sampling is the first step to convert analog signals to digital signals. As explained above, sound as an analog signal is continuous, so computers cannot understand this signal as-is. When we record sound using a microphone, this analog signal is ultimately converted to electrical signals and given to the computer. When sound vibrations reach the device inside the microphone, this device converts them by raising and lowering voltage.</p>\n<p>But our dumb computer still can’t understand this electrical signal even after all this.</p>\n<p>So the computer uses a trick to measure continuous electrical signals by setting specific timings: “I’ll measure voltage at these timings!” Here’s what this trick looks like in a diagram:</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f62ba441843fe9172b18fc5498bd765d/2c288/sampling.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 48.12500000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABcRAAAXEQHKJvM/AAAB2ElEQVR42mNgYGAQAGI+BghgZMAJ/sPkGP8zMIgBMSeQzQPVyw/ELHClbc6xwruN0/gZ8IDF0bl8S7yy5P8DDa53jRHzjWgVBwoLATGIFgZiJrDCK6te8qxwz3Bf5ZzmkV+/XwCbS0NX/eecG1prv8csyLEreaoeSMy+fj8L1BBmKA3Rszx1qtVNMTmlm3K6Sv1x3XZgz0El6xnqwbZOi+8x3msdpg8UF17oV+GyMKBCGFkdCrjokmIBlBAF4U0uaTa96dOlIYohYVafu5ivP67fDigvAcTiR0xC1SfGT7RAUsPEoOLBnjbzDCvYQGcpTUNtBgZ9QwYGPQdxVXN/26hwJyDbnJXVGKhL19/MP8BP3thRhYFBy4SV1dAASIcb+4W6K+ramgPVGTMwGPmLK/rqazu6AY1TgDmUJRQSFgxzfEost5kH6wFdI/KQn19palijI0P9fyak8GLIrlgnvMopwfUz0MUgl88MbbTP968XgHu7HqgYFh6LYrq55wZVu4C8t84p2awrbaYyzHv/IUkGHK4TY9sN9xp46x/Vc9UBWmqKHqZMyOHWnDlVdotthPfMwFrT/7jS5v//TEt9si3Xu6Q5A9ms6NKM6OxtHrl824CBzUAiAADz6odDaFdLSQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sampling\" title=\"\" src=\"/static/f62ba441843fe9172b18fc5498bd765d/6af66/sampling.png\" srcset=\"/static/f62ba441843fe9172b18fc5498bd765d/69538/sampling.png 160w,\n/static/f62ba441843fe9172b18fc5498bd765d/72799/sampling.png 320w,\n/static/f62ba441843fe9172b18fc5498bd765d/6af66/sampling.png 640w,\n/static/f62ba441843fe9172b18fc5498bd765d/2c288/sampling.png 684w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>The red dots in the diagram above are the timings when the computer measured voltage. The computer measures electrical signals at specific timings and stores those values. Looking at the red dot positions, this signal would have been measured as something like <code class=\"language-text\">[10, 20, 30, 27, 19, 8...]</code>.\nThe finer these red dots are — that is, the shorter the intervals at which the computer measures samples — the closer we can get to measuring the original signal.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/735b3ff4a2c2bc5e9bb423aef0d67b88/7497d/high-low-sampling.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAD2EAAA9hAHVrK90AAABSklEQVR42qWSPU8CQRCG30M+D1HxO8BBPO8OLxfgDg7QihgTY0NpaWvhn6CyNf4GS2PlX7CytLU1xmhn1Ngxzi6biFeIkUmezOztzLsztwtE7ZBm0CIddcoCHE9lFqXQJRv+g43g2UKbHFjD1HcCafJAQKBNUOPExpuH8k2eFwlZ4Fwvy28DismUKuUQfBQ4mmfiqlAbQ50qLCQD7fd1NXcSuBRdxKRAj0o/cidaOjRQPN3lqMJsMDazqbyB8vke1k48jrm7ZJV9i2kydbmPhQoypeK4YhnJgsOBybhMh+mKvqXw7M4WCmd9ntTnta/EWDTRlPkrxwfI970/3pQac58W4b+KjjPcWHYEx+bFKrbJilZpvzMYXYr/YsO8UqLQkTtagnsfyGf2LxO3HX6aqN3V4N56aDx56Aznpnur4hf0KI3Wo84+Ht3+AqxFQxyT+4MwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"high low sampling\" title=\"\" src=\"/static/735b3ff4a2c2bc5e9bb423aef0d67b88/6af66/high-low-sampling.png\" srcset=\"/static/735b3ff4a2c2bc5e9bb423aef0d67b88/69538/high-low-sampling.png 160w,\n/static/735b3ff4a2c2bc5e9bb423aef0d67b88/72799/high-low-sampling.png 320w,\n/static/735b3ff4a2c2bc5e9bb423aef0d67b88/6af66/high-low-sampling.png 640w,\n/static/735b3ff4a2c2bc5e9bb423aef0d67b88/d9199/high-low-sampling.png 960w,\n/static/735b3ff4a2c2bc5e9bb423aef0d67b88/21b4d/high-low-sampling.png 1280w,\n/static/735b3ff4a2c2bc5e9bb423aef0d67b88/7497d/high-low-sampling.png 3500w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>The rectangle inside the signal is the shape of the signal as understood by the computer.</small>\n</center>\n<p>The interval at which signals are measured is called the sample rate, and the process of measuring signals itself is called sampling. Naturally, the higher the sample rate, the better the sound resolution — the audio quality. Especially the resolution of high-frequency sounds, meaning high notes, improves noticeably.</p>\n<p>Typically, CD audio quality has a sample rate of <code class=\"language-text\">44.1kHz</code>, and TV or radio broadcasts have <code class=\"language-text\">48kHz</code>. This means about 44,100 or 48,000 samples are measured per second. What criteria determine these sample rates?</p>\n<h3 id=\"lets-look-at-sample-rate-in-more-detail\" style=\"position:relative;\">Let’s Look at Sample Rate in More Detail<a href=\"#lets-look-at-sample-rate-in-more-detail\" aria-label=\"lets look at sample rate in more detail permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>As I just explained, CDs have a sample rate of <code class=\"language-text\">44.1kHz</code>. This means the audio on CDs is the result of a computer measuring analog signals 44,100 times per second.</p>\n<p>But the range of frequencies humans can hear — the audible frequency range — is only <code class=\"language-text\">20Hz ~ 20kHz</code>. So why are sample rates set much higher at <code class=\"language-text\">44.1kHz</code> or <code class=\"language-text\">48kHz</code>?</p>\n<blockquote>\n<p>Humans can only hear sounds that vibrate up to 20,000 times per second (20kHz), so even if we record sounds vibrating 44,100 times per second (44.1kHz), we can’t hear them anyway, right?</p>\n</blockquote>\n<p>The answer to this question becomes clear when you look at what a sound vibration cycle looks like.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/54209060f49749e76b0ab4da633070e6/d9199/sine-wave.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 65.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+0lEQVR42o2SWXLEIAxEuf91p0BqbaSFk8nkx46KKkuYp31kZlXtI+ZbNWD5c/Eg460BCbVyd1HFv/BxhfUondjhFb4NhmAKz7CZEVetVMLRPNoLlkf+I23iEOPnA46EyfKntLvaauAE3P4Nbzed+nqtJUuOrLXmnK2IUGG9Q4G5xFTfByIGQAWqUzzYAJzDXl6KGS/NsmumS7qgpUe62WRV3flqh7IilGFzqEzyJMhLaI66HQp/injZ6Qjh9sLWuEjQGuiK73hujkvP74KpuLr53yW5kY6DhkmmGc0rXKddT+uUXIRlrDTYxI/5j8/dvpFgs7gO4AL8Pv4CWb0B4j12ASIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sine wave\" title=\"\" src=\"/static/54209060f49749e76b0ab4da633070e6/6af66/sine-wave.png\" srcset=\"/static/54209060f49749e76b0ab4da633070e6/69538/sine-wave.png 160w,\n/static/54209060f49749e76b0ab4da633070e6/72799/sine-wave.png 320w,\n/static/54209060f49749e76b0ab4da633070e6/6af66/sine-wave.png 640w,\n/static/54209060f49749e76b0ab4da633070e6/d9199/sine-wave.png 960w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>Audio frequencies are basically divided into individual cycles like this. The <code class=\"language-text\">+</code> part going up is where air compresses, and the <code class=\"language-text\">-</code> part going down is where air expands again.</p>\n<p>As I’ve been explaining, sound is vibration, and what we feel is the air trembling from that vibration. So we need to feel compression > expansion > compression to sense “it vibrated!” In other words, the 20,000 vibrations we can hear means this cycle repeats 20,000 times per second.</p>\n<p>You can’t feel “this is vibration” if you only continuously feel either compression or expansion alone.</p>\n<p>So to properly measure one cycle of an audio signal, you need to measure both the top peak in the + direction and the bottom peak in the - direction — at minimum 2 measurements are required. So to properly measure <code class=\"language-text\">20kHz</code>, the highest sound humans can hear at 20,000 vibrations per second, the computer must measure at least <code class=\"language-text\">20,000 * 2 = 40,000</code> times per second.</p>\n<p>This is exactly why CDs have a sample rate of <code class=\"language-text\">44.1kHz</code>. This is called the Nyquist Theorem. In short, the Nyquist theorem can be summarized as:</p>\n<blockquote>\n<p>You have an audio frequency you want to measure? If you want to capture the audio signal properly, you need to measure at least twice as fast as that frequency.</p>\n<p>So prepare a sample rate at least double the audio frequency you want to measure.</p>\n</blockquote>\n<p>But here another question arises. According to that theory, since the human audible frequency is <code class=\"language-text\">20,000Hz</code>, we should be able to record all sounds humans can hear with just 40,000 measurements. So why measure 44,100 or 48,000 times?</p>\n<p>Because nature doesn’t only have humans — there are friends like these too:</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f9e7d3854217d95b93299ec30c34597c/eea4a/dolphin.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDAv/EABYBAQEBAAAAAAAAAAAAAAAAAAIBA//aAAwDAQACEAMQAAABspui5kWX/8QAGBAAAgMAAAAAAAAAAAAAAAAAAhAAESL/2gAIAQEAAQUCIqmma//EABYRAAMAAAAAAAAAAAAAAAAAABARIf/aAAgBAwEBPwFQf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABwQAAICAgMAAAAAAAAAAAAAAAABETFBUWFxkf/aAAgBAQABPyHA9JSNdF8F2M1DRg//2gAMAwEAAgADAAAAEGvP/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAwEBPxABwW3/xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QV2f/xAAdEAEAAgICAwAAAAAAAAAAAAABABEhMUFRYYHR/9oACAEBAAE/EKacN9PUGWE4OS+CJgtqtXqUMck+xVFIwyF6n//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"dolphin\" title=\"\" src=\"/static/f9e7d3854217d95b93299ec30c34597c/c08c5/dolphin.jpg\" srcset=\"/static/f9e7d3854217d95b93299ec30c34597c/0913d/dolphin.jpg 160w,\n/static/f9e7d3854217d95b93299ec30c34597c/cb69c/dolphin.jpg 320w,\n/static/f9e7d3854217d95b93299ec30c34597c/c08c5/dolphin.jpg 640w,\n/static/f9e7d3854217d95b93299ec30c34597c/6a068/dolphin.jpg 960w,\n/static/f9e7d3854217d95b93299ec30c34597c/eea4a/dolphin.jpg 1280w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Hello. I can emit sounds up to 150kHz.</small>\n</center>\n<p>There are actually much higher sounds in nature that we can’t hear. It’s just that we can only hear up to <code class=\"language-text\">20kHz</code>. Bats and dolphins make sounds in much higher frequency ranges, don’t they?</p>\n<p>So what happens if these sounds enter a container prepared with a <code class=\"language-text\">40kHz</code> sample rate? The computer was trying to measure voltage 40,000 times per second to properly measure sounds cycling 20,000 times per second. But what if a much higher frequency sound cycling 30,000 times per second comes in?</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 572px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1c9dd2b354904b4b414af5ba807e5204/a805e/nyquist-error.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABo0lEQVR42mVTW46jMBDk/odb7QHmY5REIcEYx28bMDXdDWwy2pZsisL9qjbd5XKBMQbjOEIphWlU0FoR1hgGXsRpDa3275oxrROrYRBfjnG73dBN0wS2jbdlQQsRNTeUClRa8wI03lIk0PDL+ECM2A7eWvsO2DYKWQImVXG/lj0JccynKWGJ5FyyJGaeg2wcrBS0nN8Buezdu2ENiRI2qUacJFNDi8QnevfhXd2ySnXgc2HnX68XOu5d4s0zks6Q4uNHe8SDqmD/MoVTHOGkZWZIJjbnHLp+6rFghvEWLjgUVORikatDPnAiPNOX71vA0yTBKdOZeT+TkkHdEganqOVHLznDGKjrdddorqTNoVcknuRgPKcCb4rg9sG3nIB1gbFUob5epfo17Hrg0I3S7jh+8isWG8H+MvXTVtajon/QUP7+eSJ5Jo4ApzMLzZmOCf4zCpR9RXHlI96G7y+SbaKhDPcBnHKjO/jL+J2r4+z/3b2AWprk4mPczFZWWJKve9AWvZMJ8fLey33ip6drYA9O+BMT78jHGE9/zO6XqPJn3+MHKHJYsi4mGRwAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"nyquist error\" title=\"\" src=\"/static/1c9dd2b354904b4b414af5ba807e5204/a805e/nyquist-error.png\" srcset=\"/static/1c9dd2b354904b4b414af5ba807e5204/69538/nyquist-error.png 160w,\n/static/1c9dd2b354904b4b414af5ba807e5204/72799/nyquist-error.png 320w,\n/static/1c9dd2b354904b4b414af5ba807e5204/a805e/nyquist-error.png 572w\" sizes=\"(max-width: 572px) 100vw, 572px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<blockquote>\n<p>Answer: It starts plotting points in weird places.</p>\n</blockquote>\n<p>Looking at the diagram, the cycle of the incoming signal is shorter than the interval at which the computer plots points — the interval at which it measures voltage. So looking at the points the computer plotted, you can see they’re plotted at awkward places, not at the signal’s peaks. This is the trap that the Nyquist theorem has. And if you connect those awkwardly plotted points (the blue line), you can see it becomes a low frequency. What happens then?</p>\n<p>It becomes very audible to our ears. A truly spine-chilling moment! Nothing was audible when recording, but when listening to the recording, there’s a strange sound recorded. So this phenomenon is called “Ghost Frequency.”</p>\n<blockquote>\n<p>Then just crank up the sample rate! Wouldn’t properly recording high sounds solve the problem?</p>\n</blockquote>\n<p>But since this digital audio technology first started being used in the 1970s, hardware capacity couldn’t keep up with arbitrarily raising sample rates.</p>\n<p>So the method used to solve this problem was LPF (Low Pass Filter). This filter should be very familiar to those who’ve studied electronics — it literally only passes low frequencies through. If you use an LPF when recording audio to cut off all sounds higher than the human audible frequency and only let sounds in the human audible range pass through, the ghost frequency problem I just mentioned won’t occur.</p>\n<p>But analog signals don’t get cut cleanly like cutting radishes.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/bcb489965646eb5446167bbddb504813/c1b63/cut-off.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQklEQVR42o1STY8hYRDuHQYzPnr1rm0d7aNFxmDGmPVtkT0gEb9BIiGcCIk4uDiKiIOjxMWJiASJCAdxc/ILHOeP2CrRSU/PJLNv8qSrq+p53qp6i1itVublcskJsdvtzKPR6CGZTHoIgrAyDPOIQDuVSr1gDHPEPNQi9vu9QojT6SQfDAb3JpPJazab9SAirVQqdD6fp8C+5TiOxli321VirphPiM6365cF0LxzvV5rDofDnSDvF8Ao4nx6+KANoOSdcLNKdLvymsNzEBKAjKjX6/pqtcoI4XA4gtls1oQxaJXudDr2drttxdYxXigUWLfbHSyVSoZms8nAXHEcPwAeotVqyXhAFVKv10tC8uv5fJaWy2U5+KXT6ZTq9/satNEHsRuXy/USjUa1yIG45FrlzYeeaZpWhsPhV+EIRDO8kCKRiMdut6uJr45Op1NBsk9IXiwW6l6v904wHo/7A4GA5r8Eg8GgV1ghtESKKwyFQr9tNpvmyxcmSfK7z+eLwCxv4ZcBuKE1n16v94ONo9Dhbvr9/jAI6j5bHeGzE1qt1ggCf0HYIpfLLeB6hhNiWRYFnxUKhQm+JtiEOMybu2pIBDrvK5TJZA+1Ws0gDIj28JLXaDRYiqIcHyqEKvAWK6zKUyaTSeRyuQi8qhPmxs1mM/N8PjdOJpMn+Lejjb7xeGzZbDaPsKN/0ul0ErmocdFyOp0qRCKRIKEy6ng83sOjWIbDoXq73Srf3t7u4CJDsVj8iTb6MBaLxTjMRQ5yeZ1/c43gleg9ctcAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"cut off\" title=\"\" src=\"/static/bcb489965646eb5446167bbddb504813/6af66/cut-off.png\" srcset=\"/static/bcb489965646eb5446167bbddb504813/69538/cut-off.png 160w,\n/static/bcb489965646eb5446167bbddb504813/72799/cut-off.png 320w,\n/static/bcb489965646eb5446167bbddb504813/6af66/cut-off.png 640w,\n/static/bcb489965646eb5446167bbddb504813/d9199/cut-off.png 960w,\n/static/bcb489965646eb5446167bbddb504813/c1b63/cut-off.png 1200w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>Even with an LPF, the cut portion slopes down diagonally, leaving some less-than-ideal parts. The point where it starts dropping below the allowable range of <code class=\"language-text\">-3dB</code> shown in the diagram is called the Cut Off. We’re saying we’ll consider the signal cut from there.</p>\n<p>You might think, “What if we lower the Cut Off point a bit below <code class=\"language-text\">20kHz</code> to make signals disappear around <code class=\"language-text\">20kHz</code>?” But apparently they decided it was too wasteful not to utilize the full <code class=\"language-text\">20kHz</code> frequency range because of that problem.</p>\n<p>So they agreed to set the Cut Off exactly at <code class=\"language-text\">20kHz</code> and just accept the remaining portion. With the technology at the time, they reduced and reduced that remaining portion until it was exactly <code class=\"language-text\">2,050Hz</code>.</p>\n<p>Now if we add the remaining portion and audible frequency, we get <code class=\"language-text\">22,050Hz</code>. According to the Nyquist theorem, we need to prepare at least double the sample rate to properly measure this signal, so the standard sample rate for CDs became <code class=\"language-text\">44,100Hz = 44.1kHz</code>.\nThere were various other issues that always arise when setting international standards — technical limitations at the time, companies fighting each other, adult matters, etc. — but this was the representative technical reason.</p>\n<p>After that, higher sample rates like <code class=\"language-text\">48kHz</code>, <code class=\"language-text\">96kHz</code>, <code class=\"language-text\">192kHz</code> just increased as devices advanced and technical limitations disappeared. “Higher sample rate is better! Let’s pump it up!”</p>\n<h3 id=\"bit-rate\" style=\"position:relative;\">Bit Rate<a href=\"#bit-rate\" aria-label=\"bit rate permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Bit rate is super simple compared to sampling. Especially since it has “Bit” in the name, which we developers are familiar with, right? If sample rate is the horizontal resolution of sound, bit rate is the vertical resolution.</p>\n<p>Like sample rate, bit rate is also commonly explained based on CDs, so I’ll explain based on CDs again.</p>\n<p>CD bit rate is <code class=\"language-text\">16bit</code>, which literally means it can express values corresponding to <code class=\"language-text\">16 bits</code> vertically. When we did sampling earlier as explained above, we measured voltage. The bit rate determines how finely the computer can express these measured voltage values. <code class=\"language-text\">16bit</code> means we can use 16-digit binary, and since <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup><mo>=</mo><mn>65536</mn></mrow><annotation encoding=\"application/x-tex\">2^{16} = 65536</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">16</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">65536</span></span></span></span></span>, we can use a total of 65,537 values from 0 to 65,536.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/b1bb1c1aa17f6cf158141942536a758f/f2239/bitrate.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 46.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAD2EAAA9hAHVrK90AAABdUlEQVR42o2S20oCURSGf8dDaTNqGo4zlqZJgXfVRVcWSRCkIlSSZUJhWCoeShANKQIpCrrqEXqHeoAezP45BBFFLvhYh2HW3v9aGwAmiVv3sY8wlLscvPtFhO53sPQ+z7qdzBAvDLPgH/PohF8TmD6sQrBdMD9nnxJ8+RbibwvMgySA25GA5VEc4oZ2gPRXQxHhoQL/WZ3xMSkDQpU+T9+A2i/AW4swl4GRBbPPTiDhYG4jArF+Q8v5QX3MwKZeMd4lp0ZT6x59BfZQBcpTDoj8lGz5Xb5NScK50mLU5gEV+gbpG7IFrV6DlGrDk+4wLrB2YiqpmxT13B6oYCKyaUg2FuM0cRny9PpXTYK/XIVjrseYCF16bSwDxk36DqT0EGIqgTHNBU82CvXmgJKa5pxLpoIjTK1eIviwbl5iHPNpzyqE6Msi3NlrYxza0jgOR6wFmYuDom3eP+4NtYZx/Qe5s6Y/L3GrB3G7C3WQgSup6AcC8id2pjciNdJZ2gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"bitrate\" title=\"\" src=\"/static/b1bb1c1aa17f6cf158141942536a758f/6af66/bitrate.png\" srcset=\"/static/b1bb1c1aa17f6cf158141942536a758f/69538/bitrate.png 160w,\n/static/b1bb1c1aa17f6cf158141942536a758f/72799/bitrate.png 320w,\n/static/b1bb1c1aa17f6cf158141942536a758f/6af66/bitrate.png 640w,\n/static/b1bb1c1aa17f6cf158141942536a758f/d9199/bitrate.png 960w,\n/static/b1bb1c1aa17f6cf158141942536a758f/21b4d/bitrate.png 1280w,\n/static/b1bb1c1aa17f6cf158141942536a758f/f2239/bitrate.png 3116w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>\n    You can see that as bit rate increases, the bars inside the analog signal are filled in more meticulously.<br>\n    Since it's signed counting bits for both + and -, only 50% each is shown in the diagram.\n  </small>\n</center>\n<p>Of course, the voltage values converted from analog sound signals won’t be nice round integers like <code class=\"language-text\">123</code>, so we find an approximate value among our available <code class=\"language-text\">0-65536</code> range and convert to it. This process is called quantization. <small>(Yes, it’s the same “quantum” as in quantum mechanics.)</small></p>\n<p>The process of then converting the voltage values changed to <code class=\"language-text\">0-65536</code> into binary that computers can understand is called coding.</p>\n<p>Since these are familiar problems for us developers, I’ll just explain this much and move on.</p>\n<h2 id=\"drawing-waveforms-with-web-audio-api\" style=\"position:relative;\">Drawing Waveforms with Web Audio API<a href=\"#drawing-waveforms-with-web-audio-api\" aria-label=\"drawing waveforms with web audio api permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Finally, the long audio theory is over. Since my goal is to draw waveforms using digitally converted audio, I only covered the analog to digital conversion process. I won’t cover the reverse process of digital to analog conversion in this post. But that’s also quite interesting, so I highly recommend looking it up separately. I’ll upload an audio file, analyze it with the <code class=\"language-text\">Web Audio</code> API to extract the needed data, and draw the waveform using <code class=\"language-text\">svg</code> elements.</p>\n<p>For reference, the project was set up super simply using <code class=\"language-text\">webpack4</code> and <code class=\"language-text\">babel7</code>. You can check the detailed code in the <a href=\"https://github.com/evan-moon/simple-waveform-visualizer\" target=\"_blank\" rel=\"nofollow\">GitHub repository</a>.</p>\n<h3 id=\"setting-up-the-basic-structure\" style=\"position:relative;\">Setting Up the Basic Structure<a href=\"#setting-up-the-basic-structure\" aria-label=\"setting up the basic structure permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Let’s start by writing simple HTML.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audio-uploader<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>waveform<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">preserveAspectRatio</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>none<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>waveform-path-group<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>That’s it for HTML. We just need one <code class=\"language-text\">input</code> element to upload audio files and one <code class=\"language-text\">svg</code> element to draw the waveform. Since this is for testing purposes and UI isn’t important, I focused on functionality. <small>(That’s how I’ll spin it.)</small></p>\n<p>Now let’s write an event handler that will execute when a file is uploaded.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// index.js</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> inputDOM <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio-uploader'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  inputDOM<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onchange</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>currentTarget<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      reader<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      reader<span class=\"token punctuation\">.</span><span class=\"token function\">readAsArrayBuffer</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The <code class=\"language-text\">FileReader.prototype.readAsArrayBuffer</code> method doesn’t return binary files all at once but returns them in chunk units. It’s commonly used when uploading files to servers and such.</p>\n<p>Normally we’d need to write separate logic to handle this <code class=\"language-text\">ArrayBuffer</code>, but since the <code class=\"language-text\">Web Audio</code> API we’ll use internally handles <code class=\"language-text\">ArrayBuffer</code> for us, we don’t need to worry.</p>\n<h3 id=\"writing-the-audioanalyzer-class\" style=\"position:relative;\">Writing the AudioAnalyzer Class<a href=\"#writing-the-audioanalyzer-class\" aria-label=\"writing the audioanalyzer class permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Now it’s time to actually use the <code class=\"language-text\">Web Audio</code> API. I created a separate singleton class called <code class=\"language-text\">AudioAnalyzer</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// lib/AudioAnalyzer.js</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AudioAnalyzer</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>window<span class=\"token punctuation\">.</span>AudioContext<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> errorMsg <span class=\"token operator\">=</span> <span class=\"token string\">'Web Audio API not supported'</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>errorMsg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>errorMsg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token punctuation\">(</span>AudioContext <span class=\"token operator\">||</span> webkitAudioContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>peaks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>waveFormBox <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'waveform'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>waveFormPathGroup <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'waveform-path-group'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">reset</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token punctuation\">(</span>AudioContext <span class=\"token operator\">||</span> webkitAudioContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>peaks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AudioAnalyzer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"setting-up-the-svg-viewbox\" style=\"position:relative;\">Setting Up the SVG Viewbox<a href=\"#setting-up-the-svg-viewbox\" aria-label=\"setting up the svg viewbox permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>After setting up this basic structure, I’ll declare a method to set the viewbox of the <code class=\"language-text\">svg</code> element where audio waveforms will be drawn. Since the length of incoming data varies greatly depending on sample rate, we need to dynamically change the viewbox <code class=\"language-text\">width</code> to match the audio data size so we can draw all signals to fit exactly in the viewbox.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">updateViewboxSize</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>waveFormBox<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'viewBox'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">0 -1 </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> 2</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>The <code class=\"language-text\">viewBox</code> attribute of <code class=\"language-text\">svg</code> elements means <code class=\"language-text\">min-x</code>, <code class=\"language-text\">min-y</code>, <code class=\"language-text\">width</code>, <code class=\"language-text\">height</code> from the front. As I mentioned when explaining bit rate, audio signals are signed, so we need to set the viewbox starting at <code class=\"language-text\">0, -1</code> instead of <code class=\"language-text\">0, 0</code>. The <code class=\"language-text\">width</code> is set to the audio’s sample rate so the audio signal fills from start to end of the viewbox, and <code class=\"language-text\">height</code> is set to <code class=\"language-text\">2</code> since we need to cover <code class=\"language-text\">-1 ~ 1</code>.</p>\n<p>I appropriately added this <code class=\"language-text\">updateViewboxSize</code> method to the <code class=\"language-text\">constructor</code> and <code class=\"language-text\">reset</code> methods so the viewbox size is also initialized when the application initializes.</p>\n<h3 id=\"checking-the-uploaded-audiobuffer\" style=\"position:relative;\">Checking the Uploaded AudioBuffer<a href=\"#checking-the-uploaded-audiobuffer\" aria-label=\"checking the uploaded audiobuffer permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Now we just need to declare a cute setter that decodes audio files uploaded through the <code class=\"language-text\">input</code> element.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">setAudio</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">audioFile</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">decodeAudioData</span><span class=\"token punctuation\">(</span>audioFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">buffer</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The <code class=\"language-text\">AudioContext.prototype.decodeAudioData</code> method receives an <code class=\"language-text\">ArrayBuffer</code> and converts it to an <code class=\"language-text\">AudioBuffer</code>. As I explained above, since the <code class=\"language-text\">ArrayBuffer</code> returned by the <code class=\"language-text\">readAsArrayBuffer</code> method doesn’t load all binary data at once but loads in chunk units, <code class=\"language-text\">decodeAudioData</code> also doesn’t do the conversion synchronously. So when using this method, you need to use callback functions or <code class=\"language-text\">Promise</code>.</p>\n<p>Now let’s change it so that when a file is uploaded, it passes the audio file to <code class=\"language-text\">AudioAnalyzer</code> so we can see how audio files are actually converted.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// index.js</span>\n<span class=\"token keyword\">import</span> AudioAnalyzer <span class=\"token keyword\">from</span> <span class=\"token string\">'./lib/AudioAnalyzer'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> inputDOM <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio-uploader'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  inputDOM<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onchange</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>currentTarget<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Initialize AudioAnalyzer</span>\n      AudioAnalyzer<span class=\"token punctuation\">.</span><span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// Pass the file data to AudioAnalyzer</span>\n      reader<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> AudioAnalyzer<span class=\"token punctuation\">.</span><span class=\"token function\">setAudio</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      reader<span class=\"token punctuation\">.</span><span class=\"token function\">readAsArrayBuffer</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>At this point, I think we don’t need to write anything more in the main function. Now we just play with <code class=\"language-text\">AudioAnalyzer</code>. To check what data comes out, I uploaded an mp3 file of a song I like.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">AudioBuffer <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">length</span><span class=\"token operator\">:</span> <span class=\"token number\">12225071</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">duration</span><span class=\"token operator\">:</span> <span class=\"token number\">277.2124943310658</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">sampleRate</span><span class=\"token operator\">:</span> <span class=\"token number\">44100</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">numberOfChannels</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Then <code class=\"language-text\">decodeAudioData</code> executed inside <code class=\"language-text\">AudioAnalyzer</code>’s <code class=\"language-text\">setAudio</code> method receives the <code class=\"language-text\">ArrayBuffer</code>, converts it to <code class=\"language-text\">AudioBuffer</code>, and returns it. Breaking this down reveals useful information.</p>\n<hr>\n<ul>\n<li><code class=\"language-text\">sampleRate</code>: Obviously means sample rate — this song’s sample rate is <code class=\"language-text\">44,100Hz</code>.</li>\n<li><code class=\"language-text\">numberOfChannels</code>: Indicates how many channels this audio has — this file is a stereo channel audio file with two channels.</li>\n<li><code class=\"language-text\">length</code>: Means the number of peaks. Peaks are the voltage values the computer measured during sampling.</li>\n<li><code class=\"language-text\">duration</code>: Shows this audio file’s playback length in seconds. This song is about 277 seconds long.</li>\n</ul>\n<hr>\n<p>Hmm, something to decide here. When audio data with <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span> channels comes in, we need to either express the waveforms of all <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span> channels or merge channels into one and express the waveform. I plan to merge all channels into one even when audio data with <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span> channels comes in.</p>\n<p>But explaining channel merging in this post would make things too complicated, so I’ll just proceed using one channel.</p>\n<h3 id=\"analyzing-and-refining-audio-data\" style=\"position:relative;\">Analyzing and Refining Audio Data<a href=\"#analyzing-and-refining-audio-data\" aria-label=\"analyzing and refining audio data permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Now I’ve obtained the basic audio data, <code class=\"language-text\">AudioBuffer</code>. With just this data, I can draw audio waveforms.\nLet’s extract only the needed data from <code class=\"language-text\">AudioBuffer</code> and assign them to class member variables.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">setAudio</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">audioFile</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">decodeAudioData</span><span class=\"token punctuation\">(</span>audioFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">buffer</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Assign AudioBuffer object to member variable</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Assign uploaded audio's sample rate to member variable</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">.</span>sampleRate<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Adjust svg element size according to sample rate</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">updateViewboxSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Phew, if we’ve come this far, we’re all ready to draw waveforms. First, let’s extract audio signals one by one from <code class=\"language-text\">AudioBuffer</code>.</p>\n<p>Let’s first look at the array containing audio signals. When I briefly looked at the <code class=\"language-text\">AudioBuffer</code> data earlier, there was a property called <code class=\"language-text\">numberOfChannels</code> with value <code class=\"language-text\">2</code> for <code class=\"language-text\">stereo</code> channels. This channel data can be obtained through the <code class=\"language-text\">AudioBuffer.getChannelData</code> method.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer<span class=\"token punctuation\">.</span>numberOfChannels<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">getChannelData</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Float32Array(12225071) [0, 0, 0, …]</span>\n<span class=\"token comment\">// Float32Array(12225071) [0, 0, 0, …]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Wow, a massive <code class=\"language-text\">Float32Array</code> appeared. All the values I see now are <code class=\"language-text\">0</code>, but that’s because music usually doesn’t start with a BANG! — the elements at later indices have proper values. But we can’t use these values as-is; we need to refine them a bit.</p>\n<p>First, let’s think about what those elements in the array actually are. Using the array length <code class=\"language-text\">12225071</code>, we can figure out what this friend is. When we looked at this song’s playback duration through <code class=\"language-text\">AudioBuffer</code> earlier, it was about 277 seconds. Multiplying this song’s sample rate by playback duration gives <code class=\"language-text\">12225071</code>. In other words, those elements are the peaks — the voltages the computer measured according to the sample rate.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f62ba441843fe9172b18fc5498bd765d/2c288/sampling.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 48.12500000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABcRAAAXEQHKJvM/AAAB2ElEQVR42mNgYGAQAGI+BghgZMAJ/sPkGP8zMIgBMSeQzQPVyw/ELHClbc6xwruN0/gZ8IDF0bl8S7yy5P8DDa53jRHzjWgVBwoLATGIFgZiJrDCK6te8qxwz3Bf5ZzmkV+/XwCbS0NX/eecG1prv8csyLEreaoeSMy+fj8L1BBmKA3Rszx1qtVNMTmlm3K6Sv1x3XZgz0El6xnqwbZOi+8x3msdpg8UF17oV+GyMKBCGFkdCrjokmIBlBAF4U0uaTa96dOlIYohYVafu5ivP67fDigvAcTiR0xC1SfGT7RAUsPEoOLBnjbzDCvYQGcpTUNtBgZ9QwYGPQdxVXN/26hwJyDbnJXVGKhL19/MP8BP3thRhYFBy4SV1dAASIcb+4W6K+ramgPVGTMwGPmLK/rqazu6AY1TgDmUJRQSFgxzfEost5kH6wFdI/KQn19palijI0P9fyak8GLIrlgnvMopwfUz0MUgl88MbbTP968XgHu7HqgYFh6LYrq55wZVu4C8t84p2awrbaYyzHv/IUkGHK4TY9sN9xp46x/Vc9UBWmqKHqZMyOHWnDlVdotthPfMwFrT/7jS5v//TEt9si3Xu6Q5A9ms6NKM6OxtHrl824CBzUAiAADz6odDaFdLSQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sampling\" title=\"\" src=\"/static/f62ba441843fe9172b18fc5498bd765d/6af66/sampling.png\" srcset=\"/static/f62ba441843fe9172b18fc5498bd765d/69538/sampling.png 160w,\n/static/f62ba441843fe9172b18fc5498bd765d/72799/sampling.png 320w,\n/static/f62ba441843fe9172b18fc5498bd765d/6af66/sampling.png 640w,\n/static/f62ba441843fe9172b18fc5498bd765d/2c288/sampling.png 684w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Each of those peaks is stored as an element in the Float32Array.</small>\n</center>\n<p>Now that we know those elements are peaks, let’s refine these friends a bit. Why refine?</p>\n<blockquote>\n<p>Is rendering all 12,225,071 peaks really efficient visualization…?</p>\n</blockquote>\n<p>A reasonable suspicion. Whether ten million or five million peaks are plotted, we’re going to view it on a small monitor anyway, so expressing every single one doesn’t really have much meaning.</p>\n<p>So I’ll compress the peaks appropriately. Instead of collecting all peaks, I’ll create samples of appropriate length and collect only the maximum and minimum values within each sample.</p>\n<p>As explained above, according to the Nyquist theorem, we only need one maximum and one minimum to express one cycle, so there’s no problem.</p>\n<p>If my application had a waveform zoom feature, I’d need to dynamically select peaks according to how many are needed for rendering when zoom in/out events occur. But this application isn’t that sophisticated, so logic that refines only a fixed number of peaks is sufficient.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> sampleSize <span class=\"token operator\">=</span> peaks<span class=\"token punctuation\">.</span>length <span class=\"token operator\">/</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> sampleStep <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>sampleSize <span class=\"token operator\">/</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Getting only channel 0 as an example</span>\n<span class=\"token keyword\">const</span> peaks <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">getChannelData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> resultsPeaks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// We'll collect exactly 44,100 peaks, the sample rate length</span>\n<span class=\"token function\">Array</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v<span class=\"token punctuation\">,</span> newPeakIndex</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> start <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>newPeakIndex <span class=\"token operator\">*</span> sampleSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> end <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>newPeakIndex <span class=\"token operator\">+</span> sampleSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> min <span class=\"token operator\">=</span> peaks<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> max <span class=\"token operator\">=</span> peaks<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> sampleIndex <span class=\"token operator\">=</span> start<span class=\"token punctuation\">;</span> sampleIndex <span class=\"token operator\">&lt;</span> end<span class=\"token punctuation\">;</span> sampleIndex <span class=\"token operator\">+=</span> sampleStep<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> v <span class=\"token operator\">=</span> peaks<span class=\"token punctuation\">[</span>sampleIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>v <span class=\"token operator\">></span> max<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      max <span class=\"token operator\">=</span> v<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>v <span class=\"token operator\">&lt;</span> min<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      min <span class=\"token operator\">=</span> v<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  resultPeaks<span class=\"token punctuation\">[</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> newPeakIndex<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> max<span class=\"token punctuation\">;</span>\n  resultPeaks<span class=\"token punctuation\">[</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> newPeakIndex <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> min<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>It looks complicated, but in one sentence:</p>\n<blockquote>\n<ol>\n<li>Iterate for the sample rate count.</li>\n<li>Define a secondary sample section of appropriate length and find max and min within that section.</li>\n<li>Insert max at even indices and min at odd indices in the resultPeaks array.</li>\n</ol>\n</blockquote>\n<p>The reason we double the array size with <code class=\"language-text\">2 * newPeakIndex</code> when storing values in <code class=\"language-text\">resultsPeaks</code> is because we need to store up to 2 values, <code class=\"language-text\">max</code> and <code class=\"language-text\">min</code>, in each iteration.</p>\n<p>This way, I got one appropriately compressed peak array of length <code class=\"language-text\">88,200</code>.</p>\n<h3 id=\"lets-actually-draw-now\" style=\"position:relative;\">Let’s Actually Draw Now!<a href=\"#lets-actually-draw-now\" aria-label=\"lets actually draw now permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>The drawing method is simpler than you’d think. We just iterate through the peak array we extracted and draw.</p>\n<p>SVG’s <code class=\"language-text\">path</code> element analyzes the string in the <code class=\"language-text\">d</code> attribute to draw lines. Here, <code class=\"language-text\">M</code> is Move, a command to move the pointer that draws; and <code class=\"language-text\">L</code> is Line, a command to draw a line to the specified location.</p>\n<p>So we just need to repeat moving the pointer and drawing lines. This is exactly why I stored max values at even indices and min values at odd indices earlier. I intended to use the <code class=\"language-text\">M</code> command to move the pointer at even indices and the <code class=\"language-text\">L</code> command to draw lines at odd indices while iterating.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">draw</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> peaks <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>peaks<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> totalPeaks <span class=\"token operator\">=</span> peaks<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> d <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> peakIndex <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> peakIndex <span class=\"token operator\">&lt;</span> totalPeaks<span class=\"token punctuation\">;</span> peakIndex<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>peakNumber <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        d <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> M</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>peakNumber <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>peaks<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        d <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> L</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>peakNumber <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>peaks<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElementNS</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://www.w3.org/2000/svg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    path<span class=\"token punctuation\">.</span><span class=\"token function\">setAttributeNS</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'d'</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>waveFormPathGroup<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">Math.floor(peakNumber / 2)</code> is the <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span> axis, <code class=\"language-text\">peaks.shift()</code> is the <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span> axis. This code will work roughly like this. Think of the numbers in front as peak indices.</p>\n<blockquote>\n<ol>\n<li>Move pointer to (0, 100)</li>\n<li>Draw line to (0, -25)</li>\n<li>Move pointer to (1, 300)</li>\n<li>Draw line to (1, -450)</li>\n<li>Keep repeating</li>\n</ol>\n</blockquote>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1118d0dac6e09f7762f18b1e9a75eae3/2bef9/svg-graph.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIklEQVR42q1Ui3KDMAzj/792KwTIy56kBFq6lrG7cpdzcCxZdgyDf/gZrgTZ4cWuEdZatQwA7WHNus3Za0oifo7b7HtC7kFgJGAwFcXotq7tDPZ/hFS0zG4RBPRhL8LYCadRpH8TkgiqPAEMkNGCrIap+aQQ4GnywnNimASY+tDXndBKFUhqALoTBvecepKkBGUOra84Uxz2O2FCUAgAIqgweFk83769rLB4z+OI/Qrfl2eejTdP8GUkS4yjryt+UljaRVBN2BQuLxQycVNWw72Slz1UH0ncwSpZ5SVdxqHk2AlZOjDnt4xylZm+uStEqSLEYmva2fz+Ug5zSLuNBMmhgOMjNfDtt6wW5XNCf5ivbf36iuKFOTz/mO2yf/j03+YHjbqjJKikfkgAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"svg graph\" title=\"\" src=\"/static/1118d0dac6e09f7762f18b1e9a75eae3/6af66/svg-graph.png\" srcset=\"/static/1118d0dac6e09f7762f18b1e9a75eae3/69538/svg-graph.png 160w,\n/static/1118d0dac6e09f7762f18b1e9a75eae3/72799/svg-graph.png 320w,\n/static/1118d0dac6e09f7762f18b1e9a75eae3/6af66/svg-graph.png 640w,\n/static/1118d0dac6e09f7762f18b1e9a75eae3/d9199/svg-graph.png 960w,\n/static/1118d0dac6e09f7762f18b1e9a75eae3/2bef9/svg-graph.png 1024w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Repeating that process draws bars roughly like this</small>\n</center>\n<p>The audio waveform we’re trying to draw represents digital signals, so it cannot be expressed as continuous analog like the audio signal examples we saw above. So we have to express it by drawing bars like this. It might look like a pretty shabby drawing, but when 88,200 of those lines overlap, it looks pretty convincing.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/4fc99e0799e666c130dfd81d1d0d3bae/3c1e5/two-dimension.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA3klEQVR42k2Pu0pDYRCEzxv6CPoAFmITFEQtUhhELSyCoHiBFFGCl0RiMELUKMGgNtqoiI9g4eWQnf38f3LkZGDYYXdY+BKC3MnluePelWeFLBt6kEL6BZaO9IKS955zvy9eL53nM+ehJvoV0d0UrSXRXhG9PdFZF6eLxsmccTRjVCeNnXGjVRJ3od9eFR99J3npiNtt8dR0HmvD482WuFgTx7NGY8G4KovzZXFYMA6mg6eM3QmjPGbU543rDdEsirdueOgZzigmGUJ0xPxH8og7yJB/4PszzN+8G5H/AOW3I13BHvjUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"two dimension\" title=\"\" src=\"/static/4fc99e0799e666c130dfd81d1d0d3bae/6af66/two-dimension.png\" srcset=\"/static/4fc99e0799e666c130dfd81d1d0d3bae/69538/two-dimension.png 160w,\n/static/4fc99e0799e666c130dfd81d1d0d3bae/72799/two-dimension.png 320w,\n/static/4fc99e0799e666c130dfd81d1d0d3bae/6af66/two-dimension.png 640w,\n/static/4fc99e0799e666c130dfd81d1d0d3bae/d9199/two-dimension.png 960w,\n/static/4fc99e0799e666c130dfd81d1d0d3bae/21b4d/two-dimension.png 1280w,\n/static/4fc99e0799e666c130dfd81d1d0d3bae/3c1e5/two-dimension.png 2854w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Even bars become art when drawn well</small>\n</center>\n<p>So, we’ve simply drawn an audio waveform. Now that we’ve done all this… actually there’s a library called <a href=\"https://github.com/katspaugh/wavesurfer.js\" target=\"_blank\" rel=\"nofollow\">WaveSurfer</a> that does this. It has more features too.</p>\n<p>I just wanted to try drawing it myself with my own hands.</p>\n<h2 id=\"music-please-dj\" style=\"position:relative;\">Music Please, DJ<a href=\"#music-please-dj\" aria-label=\"music please dj permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Just drawing waveforms feels a bit lacking, so let’s make one more method as an interlude. It’s the feature to play this music.\nOriginally my intention when making this method was “let’s at least listen to some music while making this,” but I listened to the same song so many times while making it that I got a bit tired of it.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">play</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">buffer</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> sourceBuffer <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createBufferSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  sourceBuffer<span class=\"token punctuation\">.</span>buffer <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">;</span>\n  sourceBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  sourceBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The <code class=\"language-text\">AudioContext.prototype.createBufferSource</code> method creates one of the <code class=\"language-text\">AudioNode</code>s called <code class=\"language-text\">AudioBufferSourceNode</code>. When we pass the <code class=\"language-text\">AudioBuffer</code> we’ve been playing with to this <code class=\"language-text\">AudioNode</code>, it helps us do real audio control… it’s kind of like a shell.</p>\n<p>The <code class=\"language-text\">Web Audio</code> API provides functionality to modulate sounds by connecting these <code class=\"language-text\">AudioNode</code>s together, so you can use this to make audio effectors like compressors or reverbs. Next time, I should aim to make an audio effector.</p>\n<p>You can check the completed sample source in my <a href=\"https://github.com/evan-moon/simple-waveform-visualizer\" target=\"_blank\" rel=\"nofollow\">GitHub repository</a>, and the live demo <a href=\"https://simple-audio-waveform.herokuapp.com/\" target=\"_blank\" rel=\"nofollow\">here</a>.</p>\n<p>That wraps up this post on how computers hear sound.</p>","fields":{"slug":"20190710-javascript-audio-waveform-en","path":"/2019/07/10/javascript-audio-waveform/en/","lang":"en"},"frontmatter":{"title":"How Do Computers Hear Sound?","subTitle":"Understanding digital audio conversion through sampling, bit rate, and Web Audio API","date":"Jul 10, 2019","categories":["Programming","Audio"],"tags":["Sound Engineering","Nyquist","Logic Pro X","Cubase","Analog to Digital","AD Convert","Digital to Analog","DA Convert","Sampling","Sample Rate","AudioContext","Bit Rate","JavaScript Audio API"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/6cd3149c200b28430bab8288d044aa4c/3a812/thumbnail.jpg","srcSet":"/static/6cd3149c200b28430bab8288d044aa4c/3a812/thumbnail.jpg 320w,\n/static/6cd3149c200b28430bab8288d044aa4c/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/6cd3149c200b28430bab8288d044aa4c/fc5c5/thumbnail.webp 320w,\n/static/6cd3149c200b28430bab8288d044aa4c/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/6cd3149c200b28430bab8288d044aa4c/2d839/thumbnail.jpg","srcSet":"/static/6cd3149c200b28430bab8288d044aa4c/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/6cd3149c200b28430bab8288d044aa4c/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}}]}},"pageContext":{"tag":"Sampling","lang":"en"}},"staticQueryHashes":["3523904809","650499039"],"slicesMap":{}}