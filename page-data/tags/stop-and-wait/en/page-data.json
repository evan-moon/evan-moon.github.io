{"componentChunkName":"component---src-templates-tag-page-template-index-tsx","path":"/tags/stop-and-wait/en/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"id":"9dad4008-64b7-56a7-b07c-f8346a92a048","tableOfContents":"<ul>\n<li>\n<p><a href=\"#tcps-flow-control\">TCP’s Flow Control</a></p>\n<ul>\n<li><a href=\"#stop-and-wait\">Stop and Wait</a></li>\n<li><a href=\"#sliding-window\">Sliding Window</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#tcps-error-control\">TCP’s Error Control</a></p>\n<ul>\n<li><a href=\"#how-do-we-know-an-error-occurred\">How Do We Know an Error Occurred?</a></li>\n<li><a href=\"#stop-and-wait-1\">Stop and Wait</a></li>\n<li><a href=\"#go-back-n\">Go Back N</a></li>\n<li><a href=\"#selective-repeat\">Selective Repeat</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#wrapping-up\">Wrapping Up</a></p>\n</li>\n</ul>","excerpt":"TCP (Transmission Control Protocol) has built-in features for controlling the flow of transmitted data and detecting and responding to network congestion. If TCP didn’t provide these features, developers would have to manually define what units to send data in, and handle exceptions when packets are lost. Thanks to TCP handling all of this, we can focus entirely on application-layer behavior.","html":"<p>TCP (Transmission Control Protocol) has built-in features for controlling the flow of transmitted data and detecting and responding to network congestion.</p>\n<p>If TCP didn’t provide these features, developers would have to manually define what units to send data in, and handle exceptions when packets are lost. Thanks to TCP handling all of this, we can focus entirely on application-layer behavior.</p>\n<!-- more -->\n<p>TCP’s transmission control methods are generally divided into three categories: flow control (regulating the amount of data being transmitted), error control (handling lost or corrupted data during communication), and congestion control (responding to network congestion).</p>\n<p>Of course, application-layer developers rarely need to touch transport-layer protocols like TCP directly. But if something goes wrong at this level, not understanding how TCP works means you won’t even be able to identify the cause, let alone fix it. (And overtime will inevitably follow.)</p>\n<p>With that in mind, this post covers TCP’s flow control and error control techniques.</p>\n<h2 id=\"tcps-flow-control\" style=\"position:relative;\">TCP’s Flow Control<a href=\"#tcps-flow-control\" aria-label=\"tcps flow control permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>When a sender and receiver exchange data, various factors can cause their processing speeds to differ. If the receiver processes data faster than the sender transmits it, there’s really no problem.</p>\n<p>It handles everything as fast as it comes in. The issue arises when the sender is faster than the receiver.</p>\n<p>Both the sender and receiver have buffers for storing data. If the sender transmits data faster than the receiver can process what’s in its buffer, the receiver’s buffer will eventually fill up.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/ffb20ecdb68523bcd2bca1b47ccabf1c/79384/overflow.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 98.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAEDBAUC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAe9PPk3qhnsK9iP/xAAcEAEAAgEFAAAAAAAAAAAAAAABAgMAEBESITP/2gAIAQEAAQUCdUk2cJuV7kHq5XKvP//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABkQAAMAAwAAAAAAAAAAAAAAAAABEBEhIv/aAAgBAQAGPwKvc6eWOI//xAAeEAEAAwAABwAAAAAAAAAAAAABABEhEDFBUWFxsf/aAAgBAQABPyHZLO/Dne3C6qJsz2wkKDrNkzCCI7R8/Z//2gAMAwEAAgADAAAAECvPPP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABcRAAMBAAAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8Qys//xAAeEAEAAgIBBQAAAAAAAAAAAAABABEhYRAxQZGh0f/aAAgBAQABPxAAi0WQToPPGZREFg7HH2ICj7UYl4WIg3Bb1NlOiXgcxHFqr2n/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"overflow\" title=\"\" src=\"/static/ffb20ecdb68523bcd2bca1b47ccabf1c/c08c5/overflow.jpg\" srcset=\"/static/ffb20ecdb68523bcd2bca1b47ccabf1c/0913d/overflow.jpg 160w,\n/static/ffb20ecdb68523bcd2bca1b47ccabf1c/cb69c/overflow.jpg 320w,\n/static/ffb20ecdb68523bcd2bca1b47ccabf1c/c08c5/overflow.jpg 640w,\n/static/ffb20ecdb68523bcd2bca1b47ccabf1c/6a068/overflow.jpg 960w,\n/static/ffb20ecdb68523bcd2bca1b47ccabf1c/eea4a/overflow.jpg 1280w,\n/static/ffb20ecdb68523bcd2bca1b47ccabf1c/79384/overflow.jpg 3488w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>It's like pouring water into an already full glass</small>\n</center>\n<p>Data that arrives when the receiver’s buffer is full gets discarded — there’s simply no room left. The sender would of course resend the data, but since data transmission is highly variable depending on network conditions, it’s best to minimize this kind of retransmission whenever possible.</p>\n<p>So the sender needs to gauge the receiver’s processing speed and decide how fast and how much data to transmit. This is TCP’s flow control.</p>\n<p>The receiver includes its window size — representing how much data it can handle — in its response header and sends it to the sender. The sender then references this window size and current network conditions to send an appropriate amount of data, thereby controlling the overall flow.</p>\n<h3 id=\"stop-and-wait\" style=\"position:relative;\">Stop and Wait<a href=\"#stop-and-wait\" aria-label=\"stop and wait permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Stop and Wait is a general term for any approach where, after sending data, you wait for a confirmation response before sending more. The receiver can reply with things like “got it!” or “didn’t get it…” — and the type of response determines which error control methods can be used.</p>\n<center>\n  <div style=\"width: 300px;\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/65ff8e861f0894835574fb210cb11888/e9d87/stop-and-wait.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC1klEQVR42pVVz2saYRDdXdfEqGuSJhtsaWpNraCFQistQewP2ksPpZS0QkqhQkshl+Cf4D3kkmNyzCnouSKJv6KgxhSxaKtUq1L0JuToTTtjZ2Gz0Y1ZeHzL7rfzzZt585ZhGOYV4AngJWCW+X+xjPolvdcDXgCeAp4DXPhwGWAH3AZMKT4aYjAYjDtAA1gCOABWgFl6sQgQADxgmla17FgFC8zUIN80Tw+Q8hxhXhCEBVhnwuHwo729vZu4cUy2FwLOKbNyuVzazc1NzJYJBoMft7e3sT56u92ObK4BTFQirSyhcwG1CkqXUZ4iRhjogayh5zOUKDWbTUe73d6oVCqf4/H4F1xPTk6+FovFdb/fP0cBp2UZCvKAFuq2xul0GvHB6enph1ar9aNer2eSyWQuk8lkDw8Pv0ej0W+BQABpM16vV0PfG5WUl2QncAgVqTCTNAVTngHoSFtD6hKoMRrIjEeMkI5BGVCkzgmSZBCiKCIVPhKJ2I6OjtSmyKgmG1ai7Xa78QBtKBTa2NnZceNHZrNZpAA6YjWWsnbCOWYokECBcX08VjZXuDgCT+Uyyl8uSLO8uro6pFEul980Go1mrVb7eXx8XMnn879Aj79TqVQepgbNhLNYLDpiNqukfIvchrHZbChWDoJYu93u+06n8xaa8i6dTq/FYrG1RCLxen9/3zDCxi50WaBC6yaso6ps5mVpGyWn8Xg8IrnNs93d3Tu4ETLkRxx4qduwIGAOgPPKHxwceLe2tu4jCyiJSPulINOjanhV2bAkHT2V6KGabFgaPaHX662Au1ihIStnZ2dWMAsrONCyz+fT0X6eRtWklM0Nkg4HDjKUTaFQ+ASy+Qu2hXKp5nK5CrjNH7hPQynw38GSIjSU3bmAaF3XZZu4arW6CFne6/f7jlKp5Mhmsw44xAm4SwahKpurTgqrWC/IxjSihmhdGgRaF0K6HzPbQ6P4B8hy+YLbIMmSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"stop and wait\" title=\"\" src=\"/static/65ff8e861f0894835574fb210cb11888/6af66/stop-and-wait.png\" srcset=\"/static/65ff8e861f0894835574fb210cb11888/69538/stop-and-wait.png 160w,\n/static/65ff8e861f0894835574fb210cb11888/72799/stop-and-wait.png 320w,\n/static/65ff8e861f0894835574fb210cb11888/6af66/stop-and-wait.png 640w,\n/static/65ff8e861f0894835574fb210cb11888/d9199/stop-and-wait.png 960w,\n/static/65ff8e861f0894835574fb210cb11888/e9d87/stop-and-wait.png 1176w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  </div>\n  <br>\n</center>\n<p>The core principle of Stop and Wait flow control is simply “send data when the other party responds,” making it straightforward to implement and easy for developers to understand.</p>\n<p>If you think about implementing basic ARQ (Automatic Repeat Request), you could set the receiver’s window size to 1 byte and use something like <code class=\"language-text\">can process = 1</code>, <code class=\"language-text\">cannot process = 0</code> — a rough implementation that would still work.</p>\n<p>But an approach that only exchanges “can process” or “cannot process” signals is as inefficient as it is simple. The sender can only find out whether the receiver can handle data by actually sending it. In other words, this basic Stop and Wait approach essentially amounts to just keep sending until it works.</p>\n<p>For this reason, when using Stop and Wait for flow control, various error control methods are introduced alongside it to compensate for this inefficiency.</p>\n<h3 id=\"sliding-window\" style=\"position:relative;\">Sliding Window<a href=\"#sliding-window\" aria-label=\"sliding window permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>As we just saw, Stop and Wait has efficiency issues, so modern TCP uses the sliding window approach in almost all cases unless there are special circumstances.</p>\n<p>Sliding window works by having the receiver define how much data it can process at once, and continuously informing the sender of its current processing status to control the data flow.</p>\n<p>While there are many differences from Stop and Wait, the biggest one is that the sender knows how much data the receiver can handle. With this information, the sender can roughly predict whether data will be processed without the receiver having to explicitly respond “can process” to each piece.</p>\n<p>Both the sender and receiver have buffers for storing data, plus a separate masking tool called a window. The sender can continuously transmit data within this window without waiting for the receiver’s response.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1b3989f922769714854cd9b45b5bd9ca/11f9c/window.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 18.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQklEQVR42hXM2UoCYQCGYe8qiIpKCbyacBmXGBV3Z0YdQ/GgTgrSNLcRKXGBkBxs1Nx+JZfUEekg6Rb0yw5eeI5eBZ2YFp3P35leNF1aUI7mF81KawsrjSm3NDN7pLWVk6ZmRpJN7sZLslEwZVc5Z2YuxMVfwZqeC7b0vzeCMydnLal5UXEaGEAdHu4K3hhaWjfeDRyIPYy2I4q2LYw+zUOkOHT1XgRCFRzzBGq+B0N6BWWgi4u9tckl1Nf97Tk/guKQ6UHJD3Z5TwxNjQsNigVxRPDhu0XXe4OBJYS6jkFX5wEbLOOAG0Dl7+wnMk7YDs64Di4fF1AFe9sjP4FC/zB5o4V1qRVJilPKPpzQDFlaGDKinGRs9BDZypLPKx9ZmFz9fEx81TwtK3RyVr2vbarGxKxq2ndX+6nSqUXZEJ/W/wAfQdwulAraEgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"window\" title=\"\" src=\"/static/1b3989f922769714854cd9b45b5bd9ca/6af66/window.png\" srcset=\"/static/1b3989f922769714854cd9b45b5bd9ca/69538/window.png 160w,\n/static/1b3989f922769714854cd9b45b5bd9ca/72799/window.png 320w,\n/static/1b3989f922769714854cd9b45b5bd9ca/6af66/window.png 640w,\n/static/1b3989f922769714854cd9b45b5bd9ca/d9199/window.png 960w,\n/static/1b3989f922769714854cd9b45b5bd9ca/21b4d/window.png 1280w,\n/static/1b3989f922769714854cd9b45b5bd9ca/11f9c/window.png 1707w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Frames within the window can be sent continuously without waiting for the receiver's response</small>\n</center>\n<p>The sender’s window size is determined during the 3-way handshake when the TCP connection is first established. During this process, both sides inform each other of their current buffer sizes, and the sender uses the receiver’s buffer size to determine its own window size through a process of “hmm, they can probably handle about this much.”</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">localhost.initiator <span class=\"token operator\">></span> localhost.receiver: Flags <span class=\"token punctuation\">[</span>S<span class=\"token punctuation\">]</span>, <span class=\"token function\">seq</span> <span class=\"token number\">1487079775</span>, win <span class=\"token number\">65535</span>\nlocalhost.receiver <span class=\"token operator\">></span> localhost.initiator: Flags <span class=\"token punctuation\">[</span>S.<span class=\"token punctuation\">]</span>, <span class=\"token function\">seq</span> <span class=\"token number\">3886578796</span>, ack <span class=\"token number\">1487079776</span>, win <span class=\"token number\">65535</span>\nlocalhost.initiator <span class=\"token operator\">></span> localhost.receiver: Flags <span class=\"token punctuation\">[</span>.<span class=\"token punctuation\">]</span>, ack <span class=\"token number\">1</span>, win <span class=\"token number\">6379</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Observing the 3-way handshake via <code class=\"language-text\">tcpdump</code>, you can see that the initial <code class=\"language-text\">SYN</code> and <code class=\"language-text\">SYN+ACK</code> packets each report their own buffer sizes, and in the final <code class=\"language-text\">ACK</code> packet the sender announces its chosen window size.</p>\n<p>Both sides reported their buffer size as <code class=\"language-text\">65535</code>, but the sender’s final window size is <code class=\"language-text\">6379</code>. Why did the sender set its window to one-tenth of the receiver’s buffer?</p>\n<p>The sender’s window size isn’t determined by the receiver’s buffer size alone — it considers various other factors as well. The network is too unpredictable to simply trust the buffer size the other party reported. A key value used here is RTT (Round Trip Time), representing the round-trip time of packets.</p>\n<p>The sender measures the time between sending its initial <code class=\"language-text\">SYN</code> packet and receiving the <code class=\"language-text\">SYN+ACK</code> response, using this to infer the current network conditions. If this value is too large, it means the round trip is slow, suggesting poor network conditions, so the sender reduces its window size.</p>\n<p>This window size isn’t fixed — it can change dynamically throughout the communication based on network congestion and the window sizes the receiver reports. By adjusting the window size (the amount of data sent continuously), TCP can flexibly control the flow.</p>\n<p>Now that you have a general understanding of windows, let’s see why this technique is called <strong>sliding</strong> window.</p>\n<p>Imagine the sender wants to transmit data with sequence numbers <code class=\"language-text\">0 through 6</code>. The sender’s buffer would contain the data to be transmitted like this:</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/232f15946f1a7d8a42025e582ef6400f/8d9a9/sw-0.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 14.375000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdUlEQVR42n2OOwpEIRAE3/2vZeodRDAwUFHxi2gvMyC83WCzoqfpqaeUgpwzvPf45ZTSF4cQUGtFjJGZcmLnHM45EELgUUqh9445J5fGGGitQWvNTLc3G2O4S2OUr7X4mbUWUko8bysa+md4+RpeWzLce7PhB0qX47bPh+fNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sw 0\" title=\"\" src=\"/static/232f15946f1a7d8a42025e582ef6400f/6af66/sw-0.png\" srcset=\"/static/232f15946f1a7d8a42025e582ef6400f/69538/sw-0.png 160w,\n/static/232f15946f1a7d8a42025e582ef6400f/72799/sw-0.png 320w,\n/static/232f15946f1a7d8a42025e582ef6400f/6af66/sw-0.png 640w,\n/static/232f15946f1a7d8a42025e582ef6400f/d9199/sw-0.png 960w,\n/static/232f15946f1a7d8a42025e582ef6400f/21b4d/sw-0.png 1280w,\n/static/232f15946f1a7d8a42025e582ef6400f/8d9a9/sw-0.png 2244w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>The sender considers the receiver’s window size and current network conditions, sets its window size to 3, and starts transmitting the data within the window.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/16d1ae2726a8f3f4e63bad71de5db069/8d9a9/sw-1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 30.624999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABA0lEQVR42q2OzUrDQBDHt2A9qBXfoAiFQl/CqydveYW8hg/mB7T5aLJBSrHVqyTEEMk2m91kUyGZcRssKHhQcODH/ze7MDOEfK9jzTn5h+p95oHm6Mtb78+TjMnk5HI0Ot3nxXB4djUeD3bs/NowDk3T7P8WImbTYEt9Xzm2r7y5r93bu3KtgK1WVCpFpRA0yzJa1zUVP3jTNDSKIkq2iwd8ubvB9nGJ78sFbjwX8XmNIqAY398iJK/IOMe3NMW2bTHVWZYl6gEYxzFWVYVKKUySpPsjwp4Bd22QjgXl3AHpuVDqXmgX1hQ2T2vgUkKe5x36IuCcd14URQdjDPQSCMMQPgC0vexT2sGI+AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sw 1\" title=\"\" src=\"/static/16d1ae2726a8f3f4e63bad71de5db069/6af66/sw-1.png\" srcset=\"/static/16d1ae2726a8f3f4e63bad71de5db069/69538/sw-1.png 160w,\n/static/16d1ae2726a8f3f4e63bad71de5db069/72799/sw-1.png 320w,\n/static/16d1ae2726a8f3f4e63bad71de5db069/6af66/sw-1.png 640w,\n/static/16d1ae2726a8f3f4e63bad71de5db069/d9199/sw-1.png 960w,\n/static/16d1ae2726a8f3f4e63bad71de5db069/21b4d/sw-1.png 1280w,\n/static/16d1ae2726a8f3f4e63bad71de5db069/8d9a9/sw-1.png 2244w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>What state is the data in the window? It’s been sent, but the sender hasn’t yet received confirmation from the receiver.</p>\n<p>In other words, data in the window is always in a state of “sent, but don’t know if the other party has processed it.” There could also be situations where data is placed in the window but blocked and can’t be processed, but let’s keep things simple and not worry about those cases.</p>\n<p>The receiver then processes data at its own speed and responds with the amount of remaining space in its buffer. If the receiver sends back <code class=\"language-text\">Window Size: 1</code>, it means “I have 1 byte of buffer space left, so only send that much more.”</p>\n<p>Now the sender knows it can send one more piece of data, so it slides its window one position over and transmits the newly included data (number 3) to the receiver.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/ad1acdaf42325f81a805f9972417f525/8d9a9/sw-2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 33.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABY0lEQVR42q2OP0vDQBiHA+pmwUmjDo6VgoObk5MO9SP0E4iL36MiCkIdHALiFChtIZN/6FC99pq01GKtOFQNgSO0plySS5NGeb0Uqh07+MLDPdy9v+MntNvtWMRBKrW2sxlfuTg73VURunxttaTHWu0qc3KU3EskxOT21kYul1swTXN+nJmk2+3G8vl8TGCMEce2iadVjUG1YvhqRffQQ8fFqMPKqDOoIN1XscHqmm71esTzPNLv94llWb/e4/cAQEqlEhF0XYfA9wFenuET3cOw2YBvzvvdDYT8/OJ83F5D8NSEAWNACIEgCIAXAcMwIAxDoJQCbwiapoHAHyn/kHp1jXoqHsEwom71zx1ctp2aSh2eDIZDyptR13VplI3ctm3KG1KMMRUURRFlWRbfJEl0ZUk0IyJX5JFDNruYOdyPo/Pj1UKhsDTej5j0YrEoptNpUZhyljmzwj/NDGedMzfN9g/YBTGIBWRq1AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sw 2\" title=\"\" src=\"/static/ad1acdaf42325f81a805f9972417f525/6af66/sw-2.png\" srcset=\"/static/ad1acdaf42325f81a805f9972417f525/69538/sw-2.png 160w,\n/static/ad1acdaf42325f81a805f9972417f525/72799/sw-2.png 320w,\n/static/ad1acdaf42325f81a805f9972417f525/6af66/sw-2.png 640w,\n/static/ad1acdaf42325f81a805f9972417f525/d9199/sw-2.png 960w,\n/static/ad1acdaf42325f81a805f9972417f525/21b4d/sw-2.png 1280w,\n/static/ad1acdaf42325f81a805f9972417f525/8d9a9/sw-2.png 2244w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>Because the window moves sideways to include new data for transmission, it’s called a <strong>sliding</strong> window. If the receiver had sent a window size larger than 1, the sender would slide its window further and send more data continuously.</p>\n<p>However, since the sender’s window size is 3, even if the receiver reports 4, it won’t slide 4 positions — only up to its own window size of 3. But in this case, the sender would recognize that the receiver’s performance has improved and could respond by increasing its own window size.</p>\n<p>The sender’s buffer can be roughly divided into three states:</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/a04bfa93161e2a1c8ef37a6f19e1b0dc/db7ce/sw-3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 31.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaUlEQVR42oWOz0vCYBzG56VuXfph/0AheZDqP+jQOf+A/hPFk9fasUsQSBdh+OMgghNzc7nZnFIyECEp0BGibu/GtndTvr2Oea0HPjwPvC/P96GorQAiG8tms1GGZZNcr3dTFUSCEJArFpOZTOYo/B2h/hKeNW7B6jys58Kd/lK/B0lK23wjBVI7wOWbKVDk9KLF3f9oGm3bNj2dTmmEEK3repDX6zU9Ho/pcNzweYVV8GzV90cqWOoA4OsTrMEH4R3gewxLpQt4NAQTGWAgBL7vAykE0zTB8zwwDAM0TYOg0F8KuZUuAZ61bSS2PEN8xXZHxPMWR+Cx8ybhGdfEiDgpdDHGDsEkSyeO40xItlzXdUihGy6UjvGingAkxKDfPwVZjmmlUhzX6wGbDDwfRyx7VigULqvVaqJcLl93u90nWZYfGYa5qtVq58QvNn1RwgHhMGSfsEf9o0qlstsnxxVFOcnn8zvbh1+TxRfeE68QWgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sw 3\" title=\"\" src=\"/static/a04bfa93161e2a1c8ef37a6f19e1b0dc/6af66/sw-3.png\" srcset=\"/static/a04bfa93161e2a1c8ef37a6f19e1b0dc/69538/sw-3.png 160w,\n/static/a04bfa93161e2a1c8ef37a6f19e1b0dc/72799/sw-3.png 320w,\n/static/a04bfa93161e2a1c8ef37a6f19e1b0dc/6af66/sw-3.png 640w,\n/static/a04bfa93161e2a1c8ef37a6f19e1b0dc/d9199/sw-3.png 960w,\n/static/a04bfa93161e2a1c8ef37a6f19e1b0dc/21b4d/sw-3.png 1280w,\n/static/a04bfa93161e2a1c8ef37a6f19e1b0dc/db7ce/sw-3.png 2404w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>In short, the sliding window approach repeats the cycle of “send → receive response → slide window,” continuously transmitting as much data as currently possible.</p>\n<p>This simplified diagram with only numbers <code class=\"language-text\">0 through 6</code> might not seem impressive, but TCP’s maximum window size without any options is 65,535 bytes, and with the WSCALE option maxed out, it can be set to 1 GB.</p>\n<p>Plus, the data sent continuously in one batch isn’t just one or two pieces — it’s often hundreds of bytes at a time. In real-world environments, this delivers significantly better efficiency compared to Stop and Wait flow control. Theoretically, up to 1 GB can be transmitted continuously without a single ACK response from the receiver.</p>\n<p>Because the sliding window approach is clearly faster in terms of transmission speed compared to Stop and Wait’s one-at-a-time send-and-wait cycle, and because the window size can be flexibly adjusted through ongoing communication between sender and receiver, modern TCP uses sliding window for flow control by default.</p>\n<h2 id=\"tcps-error-control\" style=\"position:relative;\">TCP’s Error Control<a href=\"#tcps-error-control\" aria-label=\"tcps error control permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>TCP fundamentally uses ARQ (Automatic Repeat Request) — retransmission-based error control. In plain terms, if something goes wrong during communication, the sender must retransmit the affected data to the receiver.</p>\n<p>But since retransmission means redoing work that’s already been done, various methods are used to minimize this retransmission overhead.</p>\n<h3 id=\"how-do-we-know-an-error-occurred\" style=\"position:relative;\">How Do We Know an Error Occurred?<a href=\"#how-do-we-know-an-error-occurred\" aria-label=\"how do we know an error occurred permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>There are broadly two ways for TCP endpoints to detect errors.</p>\n<p>The first is the receiver explicitly sending a <code class=\"language-text\">NACK (negative acknowledgment)</code> to the sender. The second is inferring an error when the sender doesn’t receive an <code class=\"language-text\">ACK (positive acknowledgment)</code>, or keeps receiving duplicate ACKs.</p>\n<p>At first glance, NACK might seem more straightforward, but using NACK requires additional logic on the receiver’s side to decide whether to send an ACK or NACK. So in practice, inferring errors using only ACKs is the more common approach.</p>\n<p>A timeout occurs when data sent by the sender is lost in transit (so the receiver never received it and therefore never sent an ACK), or when the receiver responded correctly but the ACK packet itself was lost.</p>\n<p>In both cases, from the sender’s perspective, it sent data and the receiver didn’t respond within a certain time period.</p>\n<p>The second method — detecting errors through duplicate ACKs — works roughly like this:</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/02ea09db0f12e0cdfcf4b209c00ccf68/9ac09/duplicated-ack.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 47.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1UlEQVR42o2SSQrCQBBFv2ZOHHBC4wQO4M6NIF7E87h24U29g/42P9BmICl4dFJJ/ZoaADrIbEKuOmH5UfjnQvZoaWMSE5d0C6K5xfrWWjAhoXWGVgJjUU2isr0o+KDAnUFHIFA1kcT7yHwbMmsleqPgk4EfCryBgSoLLEHj25ElcdoUuVZQbwuMrJY9iTtazKBpjnn5K1Vkgn38t50va6gkUQWlMSQ1rTgSD9WySZyShdqf6/0XawY8lSNVFa7Vple4QnHTQg7kRM569isutm2RlaAIvrJoCfc06g3RAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"duplicated ack\" title=\"\" src=\"/static/02ea09db0f12e0cdfcf4b209c00ccf68/6af66/duplicated-ack.png\" srcset=\"/static/02ea09db0f12e0cdfcf4b209c00ccf68/69538/duplicated-ack.png 160w,\n/static/02ea09db0f12e0cdfcf4b209c00ccf68/72799/duplicated-ack.png 320w,\n/static/02ea09db0f12e0cdfcf4b209c00ccf68/6af66/duplicated-ack.png 640w,\n/static/02ea09db0f12e0cdfcf4b209c00ccf68/d9199/duplicated-ack.png 960w,\n/static/02ea09db0f12e0cdfcf4b209c00ccf68/21b4d/duplicated-ack.png 1280w,\n/static/02ea09db0f12e0cdfcf4b209c00ccf68/9ac09/duplicated-ack.png 2204w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>To put this more simply: the sender has already sent <code class=\"language-text\">SEQ 2</code>, but the receiver keeps saying “hey, it’s time to send me number 2.” The sender can then infer that something went wrong with its data number 2.</p>\n<p>However, since TCP uses packet-based transmission where arrival order isn’t guaranteed, receiving one or two duplicate ACKs doesn’t immediately trigger an error determination. Typically, it takes three duplicate ACKs before an error is declared.</p>\n<h3 id=\"stop-and-wait-1\" style=\"position:relative;\">Stop and Wait<a href=\"#stop-and-wait-1\" aria-label=\"stop and wait 1 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Stop and Wait is the same approach we looked at in flow control — send data, wait for a positive response, then send the next piece.</p>\n<p>It appears again in error control because it inherently provides basic error control. Two birds with one stone, if you will. Since data keeps being retransmitted until a positive response arrives, it handles both flow control and error control.</p>\n<center>\n  <div style=\"width: 300px;\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/8beaea3d1aff1e971396525f6b9fbd36/eb2ef/stop-and-wait-error.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 120%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsTAAALEwEAmpwYAAACsElEQVR42pWUPWxSURTH3ydfbYEHWIVGnxqsg8FEqYbEuJgY2ZyYuzUm2r1TWRrTicSFgXTo4lIYWBz4SGiHpkBIKg0BUvkKJjAwsLhfz8Hz4pPywvMmv/Aeue/cc+7/fw7H/V0R4C3wBrBwyxdPv0+BKPAaeKnfsAKowC3dZjPLCviBDcA9f5oCOIE1QgYkhDHGIwZBZdp/YznpRFHb5HK58FQ5lUq9SyQSr/A6gsGgVTvITEBp0V01Gg1PuVx20n822ovYgYfAnaUBscTRaKTW6/XH/X7//ng8ftBsNjcvLy83aItEAdcBzyLF8JT1cDiMJci7u7vOwWDwrdfrtSC7erVa/X56evojn88fU5kyfWuZL1kLiAq76FlAhsOhHTJ15HK5lVqt5sD36+tr6zJR5lXWRBFNetFQFMzOAaxq1lEUBf+zHR0dbWUymUe4ia7EtG30KvPb29uoKJfNZrcg6DM8MBQKaZVoCSiEKdsYLZEQzNpG2NnZkbvd7kewzOH5+fnB1dXVQalUOgQ+kbmtpLCdvr1xudiTdzVRotGotdPpxH8Oh8dgmxQCtjkuFov78XhcoOx4CnxT5Rcc5/0MMOxdCMbAKibL/0eUAPnvNqbNVNUGAe1sb2+TZbMfZs+RiOeXz+dvxGKWOGMC+5OdYcB7wHPgCbWPqLUdK5UkCCgAPOBhxoIZGttNQTVLrJBI4hfojhpjskFAi14Uni5Xr7KgCaOqKh4ipdPp98lkcjbNyeyyrpv+a3zNFlhFOjk5EXUeXNONr6Dp8TWdTt3tdtsHHlTgXalUKl4YDk6qTD8DFo4vH95dLBbDDCw4vsDUBTB3/+Liog3BWpDpsFAofKUyNWPbjEQJkH1m94rmBWOvTyaTAAxW/9nZmb/VagUgoNfscFg1MbKMbDNrgt+w9OsqEzQqSAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"stop and wait error\" title=\"\" src=\"/static/8beaea3d1aff1e971396525f6b9fbd36/6af66/stop-and-wait-error.png\" srcset=\"/static/8beaea3d1aff1e971396525f6b9fbd36/69538/stop-and-wait-error.png 160w,\n/static/8beaea3d1aff1e971396525f6b9fbd36/72799/stop-and-wait-error.png 320w,\n/static/8beaea3d1aff1e971396525f6b9fbd36/6af66/stop-and-wait-error.png 640w,\n/static/8beaea3d1aff1e971396525f6b9fbd36/d9199/stop-and-wait-error.png 960w,\n/static/8beaea3d1aff1e971396525f6b9fbd36/21b4d/stop-and-wait-error.png 1280w,\n/static/8beaea3d1aff1e971396525f6b9fbd36/eb2ef/stop-and-wait-error.png 1324w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n    <br>\n  </div>\n</center>\n<p>However, when using sliding window for flow control, data within the window needs to be sent continuously. Using Stop and Wait for error control would negate the benefits of sliding window.</p>\n<p>For this reason, more efficient and smarter ARQ methods are generally used instead.</p>\n<h3 id=\"go-back-n\" style=\"position:relative;\">Go Back N<a href=\"#go-back-n\" aria-label=\"go back n permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Go Back N sends data continuously and then checks which piece of data first caused an error.</p>\n<p>As mentioned above, detecting errors through ACK anomalies is more commonly used in practice, but assuming the receiver uses NACK makes the diagrams easier to follow. So for explaining error control techniques, I’ll assume the receiver uses NACK.</p>\n<p>Since this section focuses on explaining error control techniques, let’s concentrate on how errors are controlled rather than how they’re detected.</p>\n<p>With Go Back N, after sending data continuously, a single ACK or NACK is enough to understand the receiver’s processing status, which makes it a great fit with sliding window flow control.</p>\n<center>\n  <div style=\"width: 300px;\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1bc040f7f4090114bb5b65db8e769d5b/e9d87/go-back-n.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 133.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD10lEQVR42o1VSUtbURR+0ZjEmLyYxLk1FomhjVpL01hX2i5aui3FTaEoLVRLV/0FQldC3QhWiFAiVLAVjG4c4ggOcUAjOIBWs2iwFDW6EGoWpr5+JzmhLxrFCx/33dx7vzPc75wIgiA8BaqBx0CGEBsK4XpDzfdqgEdAJf14C7jNc5rssCIOSZIuM5AC5AB2oAQoiG9kAxogla0qr/BKIUN80F29/BARZgJGQGQYMGitHh4ernC5XPlXGLlAmMMklEMdkdHa4XBoyevu7u63ra2tDnyrYCSTjes4RUo+n0CYy94ZeYMsihaLhdYpCwsL9UtLS/fJW6PRSJfT+ZwJIKNlgFlOaJblUMceiEVFRTQrh4aGGjs7O8lDgQkNsmiIvBTIkhMa+cUSRm1trYrm/v7+6paWFhuRkBEmFdkRIrayt0kJr6vBVM6fOlnICR5ub29bp6enq3Z2dh4EAgHn+vp6pd/vd25ubjqDwaBza2urcnR0lAjSrFarmkMX5YQ3KQc1NTWUR2FiYuLL4ODg8erq6s+1tbXd2dnZXa/Xuzs/P787MzMTHBkZCQ0MDDyhs01NTcoLhDBRzF5GQz47O1OjOjIA7d7enk6OyclJHTzWMdGlOsyKi5mtpTAU16iYi4TPBSG/B6/UhI3X2LDHXkxkEau/9fW9+NjcTNIQniFnjsSav0iImspyQ3sSPAQyGDoJwp7ES657vfUT7e2kQ61MMgbWKwk7j78TKiWTrYh4IVMtLnzKzSWNpUl9fa+krq5yGFFKZrOeDC8BiEjrAtBi7iWVDUhSEa6K9ZXBpZf63eNp/OxyOcmbl2gYH1AdX2FYikWlAWxvzgnbxEJNOn74/dlBny+dlyoOU8NzOkKr0MU6VgKhgqVSCNncPDk5KVxcXCyEgC1utztvf38/H4K+cXBwUIAzUfwKBCzuujoNN9b/ObTZbNHCjkQiDSDDWenP8fFx2OfzhdFlwuPj4+GNjY0wDIRBGsb+ySkGzv+GNqmOVdxI2D2TiVq4HlXxDuUm4fIpBPx3ZWUlAhFHUHKR5eXlyNjYWHRGtZxOTU1Jc3NzIVRREUXHrx8bWq2WurG+t7c3/+joqOLw8LAUNVuG73JCKBS6g3U5vKsggOwuzTBYCsPxBiGe79gGWU9Uyh8JoafzxcuGNlnHzqTK0Ov15lzoD2kQi4uLyZASjeF9R0dHFb0o5cput1PONNxpktaySfZvp2FvDSCkWdnT09PQ1tb2kHJFhvi8KOvc5Vf2w/hAR4n+5vF4KtGxC+kyJ1/PhPHqKjnfsQ3nCBXX6DRpMtjj7e8fXQh0aZiMba4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"go back n\" title=\"\" src=\"/static/1bc040f7f4090114bb5b65db8e769d5b/6af66/go-back-n.png\" srcset=\"/static/1bc040f7f4090114bb5b65db8e769d5b/69538/go-back-n.png 160w,\n/static/1bc040f7f4090114bb5b65db8e769d5b/72799/go-back-n.png 320w,\n/static/1bc040f7f4090114bb5b65db8e769d5b/6af66/go-back-n.png 640w,\n/static/1bc040f7f4090114bb5b65db8e769d5b/d9199/go-back-n.png 960w,\n/static/1bc040f7f4090114bb5b65db8e769d5b/e9d87/go-back-n.png 1176w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n    <br>\n  </div>\n</center>\n<p>In the diagram above, the receiver detects an error starting from data number 4 and tells the sender “resend everything from number 4.”</p>\n<p>In Go Back N, when the receiver detects an error in data number 4, it discards all data it received after number 4 and sends a NACK to the sender.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/393dda4bf3efb487525f9567f2d08f12/b88bf/go-back-n-example.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 35.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABk0lEQVR42p2KSShEcRzHnywlOWiuzhwcmTJlSZpQ8zRIWU5qsmTLkiVN2ZeQJWGs72BpJs00svaII8+8mf/M65kZxgENN7yiJHw9cVAc8KtP38/v9/tS1B9GrVaHpSSqklKVSsXnKeBbCUCgTPAvCJEJSNA1ReV+eNAPnUBqYO3SrJsRRP2Kz9FqPiO6aRfpWzsndYseUjYvkn7ZyxmRVC35yCHrJGfLZuFkhyNt635SOOcm3Rt+0mI5txcxXu/g1jVDlS6cXMV12aAZcb5qxwTEdhwg3yAipZ+HqptDnuEYyb0cEoZF8OPLQKced6PjqOrZAV1hQrWcxe3bL9rGTeinbQ6q0ei7yBh2QDcrvpYwbqQNHqFm6RR5E05kjthRK3v2qB05Bjc40y4kwyT8RivqGQEFzdaXZsaFyin7c+6QDe1GD0+xLkllsd1qWeFes00k2sLd0PvCA73BS/Qq/+4fuSrvnFuieeFazptM9gLprq65kr3jR41VxuR4yGI9T0rqv6OIVoQ3RITFxEdGhn59vAEdrBxc2iz0dAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"go back n example\" title=\"\" src=\"/static/393dda4bf3efb487525f9567f2d08f12/6af66/go-back-n-example.png\" srcset=\"/static/393dda4bf3efb487525f9567f2d08f12/69538/go-back-n-example.png 160w,\n/static/393dda4bf3efb487525f9567f2d08f12/72799/go-back-n-example.png 320w,\n/static/393dda4bf3efb487525f9567f2d08f12/6af66/go-back-n-example.png 640w,\n/static/393dda4bf3efb487525f9567f2d08f12/d9199/go-back-n-example.png 960w,\n/static/393dda4bf3efb487525f9567f2d08f12/21b4d/go-back-n-example.png 1280w,\n/static/393dda4bf3efb487525f9567f2d08f12/b88bf/go-back-n-example.png 1702w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>A ruthlessly cool approach — when an error occurs, perfectly good data after it gets tossed too</small>\n</center>\n<p>This means the sender, upon receiving the NACK, must retransmit the errored data number 4 and everything it sent after it. Even though the sender had transmitted up to number 5, it has to go back to number 4 and retransmit from there — hence the name Go Back N.</p>\n<h3 id=\"selective-repeat\" style=\"position:relative;\">Selective Repeat<a href=\"#selective-repeat\" aria-label=\"selective repeat permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Selective Repeat means exactly what it sounds like — selective retransmission. While Go Back N is much more efficient than Stop and Wait, it still has the inefficiency of discarding and retransmitting data that was successfully delivered after the error point.</p>\n<p>So the approach of “just retransmit the errored data” was born.</p>\n<center>\n  <div style=\"width: 300px;\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/a16fa4ea93d682445ee5ce78e4673ab5/e9d87/selective-repeat.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 153.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAfCAYAAADnTu3OAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEaElEQVR42p1WTUxjZRR9pYWWtvT1h06nRqnDMAOCKQqBQKJ0ZjayYFsTN6MbG01kYeJCk6ksjInMwmBgFoQIU0mGyIRpIuU/gK/8g/yEv0AxSHAoC5WN45REST23vWUehRJmvuTkvdLvO/d+955ziyAIwjtAFXALyBLiSyFcbGmAm4ALuAGU0R9fAfIBB5Au26xIIBqNpgqQBliBAiAXuJz4gv6oBZSAGlCdk5VChsTKBPTyTdmAiWFgiFj0Wd3d3V3c3NxsPyfIKcJLRMBZ6vlddDqdOipDR0eHp7GxsYTeEcSIp5H3ZfBtTGcRyjOkiIacnBz6nDY3N3d7dXX1DcrWZDKJie8BCyfxOp89XhbuGNVQxxkYcnNz6bCqr6/vo9bWVuqggjMUeZ+eyYsAs5zQxGQnlsfjiXW9s7Pzrfr6+mtE4HA4jJxlIkMdq8SYivCiGlTKVFF4HqGwsbFRIEnSrc3NzbeBqsXFxRuzs7OutbW1qu3t7ar19XVXb28vSU2Vl5enZkNkyQlfBmwul4vqKIyMjDTjwD/Ly8u/oxnhycnJ8ODgYHh6ejo8Pj7+eGho6K9AIHCTy6HkWj4jRIgrsqKmySORSxJ4Hh1auHNGjqRiKC/gmNOEbnhwEhmOQjrfoXsV8WyzuJuaBw8fvvf13btO2utyODSFcUGnzhBv2Z+jMVFkCegAPZAVhbDxVP0aCHww0dBAOtSazeaENY3cTB33QEx2SuK6Inaby3HIY7eTCzL+6+q6Hb1/30nkURBS4D/xfScy+wlBrgpCSbJTYrLBRoU7XjdqjJatp3zw6NGHDffuxTJ0wSkoSeY38dsYAQ1w/f0zdKiSdVYJpCU6Gw6FrJCRgZxTXl5ueKmgwCLCMXx1LezkNJxhPZXwnKsON+Eb2Zn8GSFEHSPE3Mvu6en5Hk75AWL2Qdg+iNkHsftGR0d98/PzbXj+iO8+odKwU/TJTslXq9U0woX29vZ8WK1rZWXFPzU15afnzMyMHwFiT7ima2Jiog/Ed2TnTxGaamtr1Vy/j4+Ojv7G4cfw7z5I92HBfdhtH+T0Ht7d3f0D+zaQ6auUJY+0E1e+ZrPZyH7CwMDAp9gYxeEnQAQDIYJsDoeHh59i0D5Fpk+Af1GG35qammI/Sva4vE5Yz8Y6VCC6eWxsrIgmzuHhYQyRSCQPU+e1nZ2dQgyIwq2trSJMnOt1dXWJRp4itDKhyLXQyLsOEgOuqErh5zMJj+eh2+1W0kiqqKjILCsro6GR4ff7P2tpaSmlOhUXFxtLS0u1/AOmSjVtTNiUHgqF1ASIWA25ZCCrdMrs4OBARF31bW1tGgQUKysrL1VXV1shtcsc9M1zJ/YLLGtyl3W45hVkJaEZEjKU0BgJ4pWCwaAEqUhogrSwsIAGS0FIKLi0tPQzxP5Lf3//t1QWHnXH62pNTU3J3t7eF+jklzjkhQ5jAJEXZYgBJF7o0gtheyGhOwj2FQK/S7W0WCwnhC2+iJeT/gujTgv/Ayrd38q3b/JAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"selective repeat\" title=\"\" src=\"/static/a16fa4ea93d682445ee5ce78e4673ab5/6af66/selective-repeat.png\" srcset=\"/static/a16fa4ea93d682445ee5ce78e4673ab5/69538/selective-repeat.png 160w,\n/static/a16fa4ea93d682445ee5ce78e4673ab5/72799/selective-repeat.png 320w,\n/static/a16fa4ea93d682445ee5ce78e4673ab5/6af66/selective-repeat.png 640w,\n/static/a16fa4ea93d682445ee5ce78e4673ab5/d9199/selective-repeat.png 960w,\n/static/a16fa4ea93d682445ee5ce78e4673ab5/e9d87/selective-repeat.png 1176w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n    <br>\n  </div>\n</center>\n<p>At first glance this seems nothing but efficient and wonderful, but unlike Stop and Wait and Go Back N, there’s a drawback: the data in the receiver’s buffer is no longer sequential.</p>\n<p>Looking at the example above, the receiver’s buffer wouldn’t contain <code class=\"language-text\">0, 1, 2, 3, 4, 5</code> in order — it would have <code class=\"language-text\">0, 1, 2, 3, 5</code> with the discarded 4 missing. When the sender retransmits 4, the receiver needs to insert it somewhere in the middle of the buffer and sort the data.</p>\n<p>Since you can’t sort data in place within the same buffer, a separate buffer is needed.</p>\n<p>In the end, the retransmission step was eliminated but a reordering step was added. When retransmission is more advantageous, use Go Back N; when reordering is more advantageous, use Selective Repeat.</p>\n<p>If you want to use Selective Repeat in TCP communication, set the <code class=\"language-text\">SACK</code> option to 1 — though in practice it’s usually enabled by default.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">sysctl</span> net.inet.tcp <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> sack:\nnet.inet.tcp.sack: <span class=\"token number\">1</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>On macOS, using the <code class=\"language-text\">sysctl</code> command to check TCP-related kernel variables shows <code class=\"language-text\">net.inet.tcp.sack</code> set to 1.</p>\n<p>Given that in most cases it’s more beneficial for the receiver to handle reordering than to traverse the jungle of the network again, it makes sense that Selective Repeat is the default.</p>\n<h2 id=\"wrapping-up\" style=\"position:relative;\">Wrapping Up<a href=\"#wrapping-up\" aria-label=\"wrapping up permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>The hardest part about studying TCP recently has been how many different concepts are intertwined within this single topic.</p>\n<p>Being a nearly 50-year-old protocol, TCP has accumulated a massive number of improvements and options compared to its early versions. So whenever you try to dig into any single TCP behavior, everything else comes along for the ride like a chain of sausages.</p>\n<p>For example, the window size discussed in the sliding window section isn’t simply set to whatever the receiver reported. It’s determined by comprehensively considering various network-related variables like RTT, MTU, and MSS. To be precise, the sender’s final window size is the smaller of two values: the window size reported by the receiver and the window size the sender determined based on network congestion.</p>\n<p>Additionally, the error detection techniques discussed in the error control section are also an important part of congestion control. They feed into the logic that resets the sender’s window size, followed by retransmission using whichever error control technique both sides agreed upon.</p>\n<p>In other words, even though this post didn’t cover it, congestion control content is mixed into the topic of flow control.</p>\n<p>Personally, I feel like splitting things into topics like flow, congestion, and error sometimes makes it more confusing. I considered writing a post that ignored these distinctions, but since everyone is used to this categorization, I decided to go along with it.</p>\n<p>I actually intended to include congestion control in this post, but when the line count exceeded 500, I decided to split it out. Long posts are exhausting for readers.</p>\n<p>In the next post, I’ll cover TCP’s congestion control.</p>\n<p>That concludes this post on TCP’s flow control and error control.</p>","fields":{"slug":"20191122-tcp-flow-control-error-control-en","path":"/2019/11/22/tcp-flow-control-error-control/en/","lang":"en"},"frontmatter":{"title":"TCP's Flow Control and Error Control","subTitle":"How TCP delivers packets safely — a guide to flow control and error control","date":"Nov 22, 2019","categories":["Programming","Network"],"tags":["TCP","Flow Control","Error Control","Stop and Wait","Go Back N","Selective Repeat","Sliding Window"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/2ebbc07e03d747e529b6345b51c1196d/d803c/thumbnail.png","srcSet":"/static/2ebbc07e03d747e529b6345b51c1196d/d803c/thumbnail.png 320w,\n/static/2ebbc07e03d747e529b6345b51c1196d/2a1fd/thumbnail.png 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/2ebbc07e03d747e529b6345b51c1196d/fc5c5/thumbnail.webp 320w,\n/static/2ebbc07e03d747e529b6345b51c1196d/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/2ebbc07e03d747e529b6345b51c1196d/01fb2/thumbnail.png","srcSet":"/static/2ebbc07e03d747e529b6345b51c1196d/01fb2/thumbnail.png 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/2ebbc07e03d747e529b6345b51c1196d/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}}]}},"pageContext":{"tag":"Stop and Wait","lang":"en"}},"staticQueryHashes":["3523904809","650499039"],"slicesMap":{}}