{"version":3,"sources":["webpack:///./node_modules/amplitude-js/amplitude.umd.js"],"names":["factory","_typeof","obj","Symbol","iterator","constructor","prototype","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_defineProperty","value","_objectSpread","arguments","source","ownKeys","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","forEach","Constants","UTF8","s","utftext","n","c","charCodeAt","String","fromCharCode","c1","c2","Base64","_keyStr","encode","input","window","btoa","atob","unescape","encodeURIComponent","e","_encode","chr1","chr2","chr3","enc1","enc2","enc3","enc4","output","isNaN","charAt","decode","decodeURIComponent","escape","_decode","replace","indexOf","toString","type","val","call","undefined","nodeType","Buffer","isBuffer","valueOf","apply","localStorage","logLevels","DISABLE","ERROR","WARN","INFO","logLevel","log","error","_log","warn","info","console","_truncateValue","substring","validateProperties","properties","propsType","copy","property","hasOwnProperty","keyType","validatePropertyValue","invalidValueTypes","valueType","arrayCopy","element","elemType","push","validateGroupName","groupName","groupNameType","utils","logLevelName","str","name","query","results","RegExp","exec","truncate","groups","groupsType","group","expectedType","getLocation","location","base64Id","Math","floor","random","get","ca","document","cookie","split","set","opts","expires","expirationDays","date","Date","setTime","getTime","toUTCString","domain","secure","sameSite","baseCookie","uid","cookieName","_areCookiesEnabled","getHost","url","a","createElement","href","hostname","topDomain","parts","levels","cname","slice","join","_i","_options","_domainSpecific","suffix","get$1","nameEq","JSON","parse","set$1","stringify","remove","Cookie","reset","options","token","stored","setRaw","getRaw","result","setItem","getItem","removeItem","windowLocalStorageAvailable","globalStorage","div","attrKey","style","display","getElementsByTagName","appendChild","addBehavior","k","v","load","getAttribute","this","setAttribute","save","removeAttribute","clear","attr","XMLDocument","documentElement","attributes","localStorage$1","cookieStorage","storage","getStorage","MetadataStorage","_ref","storageKey","disableCookies","instance","Constructor","TypeError","_classCallCheck","disableCookieStorage","cookieDomain","writableTopDomain","protoProps","staticProps","_ref2","deviceId","userId","optOut","sessionId","lastEventTime","eventId","identifyId","sequenceNumber","getCookieStorageKey","values","parseInt","Identify","userPropertiesOperations","add","_addOperation","append","clearAll","prepend","setOnce","unset","operation","commonjsGlobal","global","self","createCommonjsModule","fn","module","exports","md5","$","safeAdd","x","y","lsw","md5cmn","q","b","t","num","cnt","md5ff","d","md5gg","md5hh","md5ii","binlMD5","len","olda","oldb","oldc","oldd","binl2rstr","length32","rstr2binl","length8","rstr2hex","str2rstrUTF8","rawMD5","rstrMD5","rawHMACMD5","data","hash","bkey","ipad","opad","rstrHMACMD5","string","raw","propIsEnumerable","propertyIsEnumerable","toObject","objectAssign","assign","test1","getOwnPropertyNames","test2","map","test3","letter","err","shouldUseNative","from","symbols","to","strict","toUpperCase","queryString","arrayFormat","sort","formatter","index","encoderForArrayFormat","Array","isArray","val2","Request","send","callback","XDomainRequest","xdr","open","onload","responseText","onerror","ontimeout","onprogress","xhr","XMLHttpRequest","onreadystatechange","readyState","status","setRequestHeader","Revenue","_price","_productId","_quantity","_revenueType","_properties","setProductId","productId","setQuantity","quantity","setPrice","price","setRevenueType","revenueType","setEventProperties","eventProperties","_isValidRevenue","_toJSONObject","uaParser","undefined$1","MODEL","NAME","TYPE","VENDOR","VERSION","MOBILE","TABLET","SMARTTV","util","extend","regexes","extensions","mergedRegexes","has","str1","str2","toLowerCase","lowerize","major","version","trim","mapper","rgx","ua","arrays","j","p","matches","match","regex","test","_str","maps","browser","oldsafari","device","amazon","model","sprint","vendor","os","windows","cpu","engine","UAParser","uastring","getResult","navigator","userAgent","rgxmap","getBrowser","getCPU","architecture","getDevice","getEngine","getOS","getUA","setUA","BROWSER","MAJOR","CPU","ARCHITECTURE","DEVICE","CONSOLE","WEARABLE","EMBEDDED","ENGINE","OS","jQuery","Zepto","parser","prop","DEFAULT_OPTIONS","apiEndpoint","batchEvents","cookieExpiration","sameSiteCookie","cookieForceUpgrade","deferInitialization","deviceIdFromUrlParam","eventUploadPeriodMillis","eventUploadThreshold","forceHttps","includeGclid","includeReferrer","includeUtm","language","languages","userLanguage","onError","platform","savedMaxCount","saveEvents","saveParamsReferrerOncePerSession","secureCookie","sessionTimeout","trackingOptions","city","country","carrier","device_manufacturer","device_model","dma","ip_address","os_name","os_version","region","version_name","unsetParamsReferrerOnNewSession","unsentKey","unsentIdentifyKey","uploadBatchSize","AmplitudeClient","instanceName","_instanceName","_unsentEvents","_unsentIdentifys","_ua","_q","_sending","_updateScheduled","_onInit","_eventId","_identifyId","_lastEventTime","_newSession","_sequenceNumber","_sessionId","_isInitialized","_userAgent","init","apiKey","opt_userId","opt_config","opt_callback","_this","_parseConfig","_storageSuffix","_storageSuffixV5","_oldCookiename","_unsentKey","_unsentIdentifyKey","_cookieName","_metadataStorage","hasOldCookie","hasNewCookie","_useOldCookie","hasCookie","_deferInitialization","_generateApiPropertiesTrackingConfig","_apiPropertiesTrackingOptions","tracking_options","_upgradeCookieData","_loadCookieData","_pendingReadStorage","initFromStorage","storedDeviceId","_getInitialDeviceId","now","_unsetUTMParams","_trackParamsAndReferrer","_validateUnsentEventQueue","_saveCookieData","_sendEventsIfReady","_loadSavedUnsentEvents","event","runQueuedFunctions","deleteLowerLevelDomainCookies","host","cookieHost","hostParts","cookieHostParts","deleteDomain","configDeviceId","_getDeviceIdFromUrlParam","_getUrlParams","queue","userProperties","user_properties","event_properties","_migrateUnsentEvents","cb","_this2","Promise","all","AsyncStorage","then","unsentEventsString","itemsToSet","itemsToRemove","_initUtmData","_saveReferrer","_getReferrer","_saveGclid","config","parseValidateAndLoad","inputValue","_apiKeySet","methodName","savedUnsentEventsString","_getFromStorage","unsentEvents","_parseSavedUnsentEventsString","_setInStorage","events","isNewSession","onInit","getSessionId","nextEventId","nextIdentifyId","nextSequenceNumber","_unsentCount","sendEvents","setTimeout","bind","scope","cookieData","_loadCookieDataProps","queryParams","cookieParams","rawCookie","fetchParam","utmSource","utmMedium","utmCampaign","utmTerm","utmContent","utmData","addIfNotNull","utmProperties","queryName","_sendParamsReferrerUserProperties","identify","referrer","search","urlParams","gclid","_getReferringDomain","referrerInfo","serializedUnsentEvents","serializedIdentifys","unsentIdentify","setDomain","_shouldDeferCall","setUserId","setGroup","groupType","_logEvent","setOptOut","enable","setSessionId","resetSessionId","regenerateDeviceId","setDeviceId","setUserProperties","sanitized","clearUserProperties","_convertProxyObjectToRealObject","proxy","identify_obj","reason","groupIdentify","group_type","group_name","setVersionName","versionName","eventType","apiProperties","groupProperties","timestamp","eventTime","osName","osVersion","deviceModel","device_id","user_id","event_id","session_id","event_type","_shouldTrackField","api_properties","uuid","library","sequence_number","group_properties","user_agent","_limitEventsQueued","field","fields","splice","logEvent","logEventWithTimestamp","logEventWithGroups","_isNumber","parseFloat","isFinite","logRevenueV2","revenue_obj","logRevenue","product","special","removeEvents","maxEventId","maxIdentifyId","response","_removeEvents","eventQueue","maxId","filteredEvents","unsentEvent","Infinity","protocol","numEvents","min","mergedEvents","_mergeEventsAndIdentifys","eventsToSend","uploadTime","client","upload_time","checksum","ceil","eventIndex","identifyIndex","noIdentifys","noEvents","setGlobalUserProperties","__VERSION__","_initializationDeferred","enableTracking","Amplitude","_instances","getInstance","old","amplitude","newInstance","_iq"],"mappings":"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","file":"5f9fef99-d03cb4435714e25f63b8.js","sourcesContent":["require(\"core-js/modules/es6.regexp.search\");\n\nrequire(\"core-js/modules/es6.function.bind\");\n\nrequire(\"core-js/modules/es6.promise\");\n\nrequire(\"core-js/modules/es6.string.iterator\");\n\nrequire(\"core-js/modules/es6.array.reduce\");\n\nrequire(\"core-js/modules/es6.string.trim\");\n\nrequire(\"core-js/modules/es6.object.create\");\n\nrequire(\"core-js/modules/es6.number.constructor\");\n\nrequire(\"core-js/modules/es6.array.sort\");\n\nrequire(\"core-js/modules/es6.array.is-array\");\n\nrequire(\"core-js/modules/es6.regexp.match\");\n\nrequire(\"core-js/modules/es6.array.map\");\n\nrequire(\"core-js/modules/es6.object.assign\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"core-js/modules/es6.regexp.constructor\");\n\nrequire(\"core-js/modules/es6.regexp.to-string\");\n\nrequire(\"core-js/modules/es6.date.to-string\");\n\nrequire(\"core-js/modules/es6.array.index-of\");\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nrequire(\"core-js/modules/es6.array.for-each\");\n\nrequire(\"core-js/modules/es6.array.filter\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es6.object.define-property\");\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define('amplitude', factory) : (global = global || self, global.amplitude = factory());\n})(this, function () {\n  'use strict';\n\n  function _typeof(obj) {\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n          return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n        }));\n      }\n\n      ownKeys.forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n\n    return target;\n  }\n\n  var Constants = {\n    DEFAULT_INSTANCE: '$default_instance',\n    API_VERSION: 2,\n    MAX_STRING_LENGTH: 4096,\n    MAX_PROPERTY_KEYS: 1000,\n    IDENTIFY_EVENT: '$identify',\n    GROUP_IDENTIFY_EVENT: '$groupidentify',\n    // localStorageKeys\n    LAST_EVENT_ID: 'amplitude_lastEventId',\n    LAST_EVENT_TIME: 'amplitude_lastEventTime',\n    LAST_IDENTIFY_ID: 'amplitude_lastIdentifyId',\n    LAST_SEQUENCE_NUMBER: 'amplitude_lastSequenceNumber',\n    SESSION_ID: 'amplitude_sessionId',\n    // Used in cookie as well\n    DEVICE_ID: 'amplitude_deviceId',\n    OPT_OUT: 'amplitude_optOut',\n    USER_ID: 'amplitude_userId',\n    COOKIE_TEST_PREFIX: 'amp_cookie_test',\n    COOKIE_PREFIX: \"amp\",\n    // revenue keys\n    REVENUE_EVENT: 'revenue_amount',\n    REVENUE_PRODUCT_ID: '$productId',\n    REVENUE_QUANTITY: '$quantity',\n    REVENUE_PRICE: '$price',\n    REVENUE_REVENUE_TYPE: '$revenueType',\n    AMP_DEVICE_ID_PARAM: 'amp_device_id',\n    // url param\n    REFERRER: 'referrer',\n    // UTM Params\n    UTM_SOURCE: 'utm_source',\n    UTM_MEDIUM: 'utm_medium',\n    UTM_CAMPAIGN: 'utm_campaign',\n    UTM_TERM: 'utm_term',\n    UTM_CONTENT: 'utm_content'\n  };\n  /* jshint bitwise: false */\n\n  /*\n   * UTF-8 encoder/decoder\n   * http://www.webtoolkit.info/\n   */\n\n  var UTF8 = {\n    encode: function encode(s) {\n      var utftext = '';\n\n      for (var n = 0; n < s.length; n++) {\n        var c = s.charCodeAt(n);\n\n        if (c < 128) {\n          utftext += String.fromCharCode(c);\n        } else if (c > 127 && c < 2048) {\n          utftext += String.fromCharCode(c >> 6 | 192);\n          utftext += String.fromCharCode(c & 63 | 128);\n        } else {\n          utftext += String.fromCharCode(c >> 12 | 224);\n          utftext += String.fromCharCode(c >> 6 & 63 | 128);\n          utftext += String.fromCharCode(c & 63 | 128);\n        }\n      }\n\n      return utftext;\n    },\n    decode: function decode(utftext) {\n      var s = '';\n      var i = 0;\n      var c = 0,\n          c1 = 0,\n          c2 = 0;\n\n      while (i < utftext.length) {\n        c = utftext.charCodeAt(i);\n\n        if (c < 128) {\n          s += String.fromCharCode(c);\n          i++;\n        } else if (c > 191 && c < 224) {\n          c1 = utftext.charCodeAt(i + 1);\n          s += String.fromCharCode((c & 31) << 6 | c1 & 63);\n          i += 2;\n        } else {\n          c1 = utftext.charCodeAt(i + 1);\n          c2 = utftext.charCodeAt(i + 2);\n          s += String.fromCharCode((c & 15) << 12 | (c1 & 63) << 6 | c2 & 63);\n          i += 3;\n        }\n      }\n\n      return s;\n    }\n  };\n  /* jshint bitwise: false */\n\n  /*\n   * Base64 encoder/decoder\n   * http://www.webtoolkit.info/\n   */\n\n  var Base64 = {\n    _keyStr: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n    encode: function encode(input) {\n      try {\n        if (window.btoa && window.atob) {\n          return window.btoa(unescape(encodeURIComponent(input)));\n        }\n      } catch (e) {//log(e);\n      }\n\n      return Base64._encode(input);\n    },\n    _encode: function _encode(input) {\n      var output = '';\n      var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n      var i = 0;\n      input = UTF8.encode(input);\n\n      while (i < input.length) {\n        chr1 = input.charCodeAt(i++);\n        chr2 = input.charCodeAt(i++);\n        chr3 = input.charCodeAt(i++);\n        enc1 = chr1 >> 2;\n        enc2 = (chr1 & 3) << 4 | chr2 >> 4;\n        enc3 = (chr2 & 15) << 2 | chr3 >> 6;\n        enc4 = chr3 & 63;\n\n        if (isNaN(chr2)) {\n          enc3 = enc4 = 64;\n        } else if (isNaN(chr3)) {\n          enc4 = 64;\n        }\n\n        output = output + Base64._keyStr.charAt(enc1) + Base64._keyStr.charAt(enc2) + Base64._keyStr.charAt(enc3) + Base64._keyStr.charAt(enc4);\n      }\n\n      return output;\n    },\n    decode: function decode(input) {\n      try {\n        if (window.btoa && window.atob) {\n          return decodeURIComponent(escape(window.atob(input)));\n        }\n      } catch (e) {//log(e);\n      }\n\n      return Base64._decode(input);\n    },\n    _decode: function _decode(input) {\n      var output = '';\n      var chr1, chr2, chr3;\n      var enc1, enc2, enc3, enc4;\n      var i = 0;\n      input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, '');\n\n      while (i < input.length) {\n        enc1 = Base64._keyStr.indexOf(input.charAt(i++));\n        enc2 = Base64._keyStr.indexOf(input.charAt(i++));\n        enc3 = Base64._keyStr.indexOf(input.charAt(i++));\n        enc4 = Base64._keyStr.indexOf(input.charAt(i++));\n        chr1 = enc1 << 2 | enc2 >> 4;\n        chr2 = (enc2 & 15) << 4 | enc3 >> 2;\n        chr3 = (enc3 & 3) << 6 | enc4;\n        output = output + String.fromCharCode(chr1);\n\n        if (enc3 !== 64) {\n          output = output + String.fromCharCode(chr2);\n        }\n\n        if (enc4 !== 64) {\n          output = output + String.fromCharCode(chr3);\n        }\n      }\n\n      output = UTF8.decode(output);\n      return output;\n    }\n  };\n  /**\n   * toString ref.\n   * @private\n   */\n\n  var toString = Object.prototype.toString;\n  /**\n   * Return the type of `val`.\n   * @private\n   * @param {Mixed} val\n   * @return {String}\n   * @api public\n   */\n\n  function type(val) {\n    switch (toString.call(val)) {\n      case '[object Date]':\n        return 'date';\n\n      case '[object RegExp]':\n        return 'regexp';\n\n      case '[object Arguments]':\n        return 'arguments';\n\n      case '[object Array]':\n        return 'array';\n\n      case '[object Error]':\n        return 'error';\n    }\n\n    if (val === null) {\n      return 'null';\n    }\n\n    if (val === undefined) {\n      return 'undefined';\n    }\n\n    if (val !== val) {\n      return 'nan';\n    }\n\n    if (val && val.nodeType === 1) {\n      return 'element';\n    }\n\n    if (typeof Buffer !== 'undefined' && typeof Buffer.isBuffer === 'function' && Buffer.isBuffer(val)) {\n      return 'buffer';\n    }\n\n    val = val.valueOf ? val.valueOf() : Object.prototype.valueOf.apply(val);\n    return _typeof(val);\n  }\n\n  var logLevels = {\n    DISABLE: 0,\n    ERROR: 1,\n    WARN: 2,\n    INFO: 3\n  };\n  var logLevel = logLevels.WARN;\n\n  var setLogLevel = function setLogLevel(logLevelName) {\n    if (logLevels.hasOwnProperty(logLevelName)) {\n      logLevel = logLevels[logLevelName];\n    }\n  };\n\n  var getLogLevel = function getLogLevel() {\n    return logLevel;\n  };\n\n  var log = {\n    error: function error(s) {\n      if (logLevel >= logLevels.ERROR) {\n        _log(s);\n      }\n    },\n    warn: function warn(s) {\n      if (logLevel >= logLevels.WARN) {\n        _log(s);\n      }\n    },\n    info: function info(s) {\n      if (logLevel >= logLevels.INFO) {\n        _log(s);\n      }\n    }\n  };\n\n  var _log = function _log(s) {\n    try {\n      console.log('[Amplitude] ' + s);\n    } catch (e) {// console logging not available\n    }\n  };\n\n  var isEmptyString = function isEmptyString(str) {\n    return !str || str.length === 0;\n  };\n\n  var sessionStorageEnabled = function sessionStorageEnabled() {\n    try {\n      if (window.sessionStorage) {\n        return true;\n      }\n    } catch (e) {} // sessionStorage disabled\n\n\n    return false;\n  }; // truncate string values in event and user properties so that request size does not get too large\n\n\n  var truncate = function truncate(value) {\n    if (type(value) === 'array') {\n      for (var i = 0; i < value.length; i++) {\n        value[i] = truncate(value[i]);\n      }\n    } else if (type(value) === 'object') {\n      for (var key in value) {\n        if (value.hasOwnProperty(key)) {\n          value[key] = truncate(value[key]);\n        }\n      }\n    } else {\n      value = _truncateValue(value);\n    }\n\n    return value;\n  };\n\n  var _truncateValue = function _truncateValue(value) {\n    if (type(value) === 'string') {\n      return value.length > Constants.MAX_STRING_LENGTH ? value.substring(0, Constants.MAX_STRING_LENGTH) : value;\n    }\n\n    return value;\n  };\n\n  var validateInput = function validateInput(input, name, expectedType) {\n    if (type(input) !== expectedType) {\n      log.error('Invalid ' + name + ' input type. Expected ' + expectedType + ' but received ' + type(input));\n      return false;\n    }\n\n    return true;\n  }; // do some basic sanitization and type checking, also catch property dicts with more than 1000 key/value pairs\n\n\n  var validateProperties = function validateProperties(properties) {\n    var propsType = type(properties);\n\n    if (propsType !== 'object') {\n      log.error('Error: invalid properties format. Expecting Javascript object, received ' + propsType + ', ignoring');\n      return {};\n    }\n\n    if (Object.keys(properties).length > Constants.MAX_PROPERTY_KEYS) {\n      log.error('Error: too many properties (more than 1000), ignoring');\n      return {};\n    }\n\n    var copy = {}; // create a copy with all of the valid properties\n\n    for (var property in properties) {\n      if (!properties.hasOwnProperty(property)) {\n        continue;\n      } // validate key\n\n\n      var key = property;\n      var keyType = type(key);\n\n      if (keyType !== 'string') {\n        key = String(key);\n        log.warn('WARNING: Non-string property key, received type ' + keyType + ', coercing to string \"' + key + '\"');\n      } // validate value\n\n\n      var value = validatePropertyValue(key, properties[property]);\n\n      if (value === null) {\n        continue;\n      }\n\n      copy[key] = value;\n    }\n\n    return copy;\n  };\n\n  var invalidValueTypes = ['nan', 'function', 'arguments', 'regexp', 'element'];\n\n  var validatePropertyValue = function validatePropertyValue(key, value) {\n    var valueType = type(value);\n\n    if (invalidValueTypes.indexOf(valueType) !== -1) {\n      log.warn('WARNING: Property key \"' + key + '\" with invalid value type ' + valueType + ', ignoring');\n      value = null;\n    } else if (valueType === 'undefined') {\n      value = null;\n    } else if (valueType === 'error') {\n      value = String(value);\n      log.warn('WARNING: Property key \"' + key + '\" with value type error, coercing to ' + value);\n    } else if (valueType === 'array') {\n      // check for nested arrays or objects\n      var arrayCopy = [];\n\n      for (var i = 0; i < value.length; i++) {\n        var element = value[i];\n        var elemType = type(element);\n\n        if (elemType === 'array') {\n          log.warn('WARNING: Cannot have ' + elemType + ' nested in an array property value, skipping');\n          continue;\n        } else if (elemType === 'object') {\n          arrayCopy.push(validateProperties(element));\n        } else {\n          arrayCopy.push(validatePropertyValue(key, element));\n        }\n      }\n\n      value = arrayCopy;\n    } else if (valueType === 'object') {\n      value = validateProperties(value);\n    }\n\n    return value;\n  };\n\n  var validateGroups = function validateGroups(groups) {\n    var groupsType = type(groups);\n\n    if (groupsType !== 'object') {\n      log.error('Error: invalid groups format. Expecting Javascript object, received ' + groupsType + ', ignoring');\n      return {};\n    }\n\n    var copy = {}; // create a copy with all of the valid properties\n\n    for (var group in groups) {\n      if (!groups.hasOwnProperty(group)) {\n        continue;\n      } // validate key\n\n\n      var key = group;\n      var keyType = type(key);\n\n      if (keyType !== 'string') {\n        key = String(key);\n        log.warn('WARNING: Non-string groupType, received type ' + keyType + ', coercing to string \"' + key + '\"');\n      } // validate value\n\n\n      var value = validateGroupName(key, groups[group]);\n\n      if (value === null) {\n        continue;\n      }\n\n      copy[key] = value;\n    }\n\n    return copy;\n  };\n\n  var validateGroupName = function validateGroupName(key, groupName) {\n    var groupNameType = type(groupName);\n\n    if (groupNameType === 'string') {\n      return groupName;\n    }\n\n    if (groupNameType === 'date' || groupNameType === 'number' || groupNameType === 'boolean') {\n      groupName = String(groupName);\n      log.warn('WARNING: Non-string groupName, received type ' + groupNameType + ', coercing to string \"' + groupName + '\"');\n      return groupName;\n    }\n\n    if (groupNameType === 'array') {\n      // check for nested arrays or objects\n      var arrayCopy = [];\n\n      for (var i = 0; i < groupName.length; i++) {\n        var element = groupName[i];\n        var elemType = type(element);\n\n        if (elemType === 'array' || elemType === 'object') {\n          log.warn('WARNING: Skipping nested ' + elemType + ' in array groupName');\n          continue;\n        } else if (elemType === 'string') {\n          arrayCopy.push(element);\n        } else if (elemType === 'date' || elemType === 'number' || elemType === 'boolean') {\n          element = String(element);\n          log.warn('WARNING: Non-string groupName, received type ' + elemType + ', coercing to string \"' + element + '\"');\n          arrayCopy.push(element);\n        }\n      }\n\n      return arrayCopy;\n    }\n\n    log.warn('WARNING: Non-string groupName, received type ' + groupNameType + '. Please use strings or array of strings for groupName');\n  }; // parses the value of a url param (for example ?gclid=1234&...)\n\n\n  var getQueryParam = function getQueryParam(name, query) {\n    name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n    var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\n    var results = regex.exec(query);\n    return results === null ? undefined : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\n  };\n\n  var utils = {\n    setLogLevel: setLogLevel,\n    getLogLevel: getLogLevel,\n    logLevels: logLevels,\n    log: log,\n    isEmptyString: isEmptyString,\n    getQueryParam: getQueryParam,\n    sessionStorageEnabled: sessionStorageEnabled,\n    truncate: truncate,\n    validateGroups: validateGroups,\n    validateInput: validateInput,\n    validateProperties: validateProperties\n  };\n\n  var getLocation = function getLocation() {\n    return window.location;\n  }; // A URL safe variation on the the list of Base64 characters \n\n\n  var base64Chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_';\n\n  var base64Id = function base64Id() {\n    var str = '';\n\n    for (var i = 0; i < 22; ++i) {\n      str += base64Chars.charAt(Math.floor(Math.random() * 64));\n    }\n\n    return str;\n  };\n\n  var get = function get(name) {\n    try {\n      var ca = document.cookie.split(';');\n      var value = null;\n\n      for (var i = 0; i < ca.length; i++) {\n        var c = ca[i];\n\n        while (c.charAt(0) === ' ') {\n          c = c.substring(1, c.length);\n        }\n\n        if (c.indexOf(name) === 0) {\n          value = c.substring(name.length, c.length);\n          break;\n        }\n      }\n\n      return value;\n    } catch (e) {\n      return null;\n    }\n  };\n\n  var set = function set(name, value, opts) {\n    var expires = value !== null ? opts.expirationDays : -1;\n\n    if (expires) {\n      var date = new Date();\n      date.setTime(date.getTime() + expires * 24 * 60 * 60 * 1000);\n      expires = date;\n    }\n\n    var str = name + '=' + value;\n\n    if (expires) {\n      str += '; expires=' + expires.toUTCString();\n    }\n\n    str += '; path=/';\n\n    if (opts.domain) {\n      str += '; domain=' + opts.domain;\n    }\n\n    if (opts.secure) {\n      str += '; Secure';\n    }\n\n    if (opts.sameSite) {\n      str += '; SameSite=' + opts.sameSite;\n    }\n\n    document.cookie = str;\n  }; // test that cookies are enabled - navigator.cookiesEnabled yields false positives in IE, need to test directly\n\n\n  var areCookiesEnabled = function areCookiesEnabled() {\n    var uid = String(new Date());\n\n    try {\n      var cookieName = Constants.COOKIE_TEST_PREFIX + base64Id();\n      set(cookieName, uid, {});\n\n      var _areCookiesEnabled = get(cookieName + '=') === uid;\n\n      set(cookieName, null, {});\n      return _areCookiesEnabled;\n    } catch (e) {}\n\n    return false;\n  };\n\n  var baseCookie = {\n    set: set,\n    get: get,\n    areCookiesEnabled: areCookiesEnabled\n  };\n\n  var getHost = function getHost(url) {\n    var a = document.createElement('a');\n    a.href = url;\n    return a.hostname || location.hostname;\n  };\n\n  var topDomain = function topDomain(url) {\n    var host = getHost(url);\n    var parts = host.split('.');\n    var levels = [];\n    var cname = '_tldtest_' + base64Id();\n\n    for (var i = parts.length - 2; i >= 0; --i) {\n      levels.push(parts.slice(i).join('.'));\n    }\n\n    for (var _i = 0; _i < levels.length; ++_i) {\n      var domain = levels[_i];\n      var opts = {\n        domain: '.' + domain\n      };\n      baseCookie.set(cname, 1, opts);\n\n      if (baseCookie.get(cname)) {\n        baseCookie.set(cname, null, opts);\n        return domain;\n      }\n    }\n\n    return '';\n  };\n  /*\n   * Cookie data\n   */\n\n\n  var _options = {\n    expirationDays: undefined,\n    domain: undefined\n  };\n\n  var reset = function reset() {\n    _options = {\n      expirationDays: undefined,\n      domain: undefined\n    };\n  };\n\n  var options = function options(opts) {\n    if (arguments.length === 0) {\n      return _options;\n    }\n\n    opts = opts || {};\n    _options.expirationDays = opts.expirationDays;\n    _options.secure = opts.secure;\n    _options.sameSite = opts.sameSite;\n    var domain = !utils.isEmptyString(opts.domain) ? opts.domain : '.' + topDomain(getLocation().href);\n    var token = Math.random();\n    _options.domain = domain;\n    set$1('amplitude_test', token);\n    var stored = get$1('amplitude_test');\n\n    if (!stored || stored !== token) {\n      domain = null;\n    }\n\n    remove('amplitude_test');\n    _options.domain = domain;\n    return _options;\n  };\n\n  var _domainSpecific = function _domainSpecific(name) {\n    // differentiate between cookies on different domains\n    var suffix = '';\n\n    if (_options.domain) {\n      suffix = _options.domain.charAt(0) === '.' ? _options.domain.substring(1) : _options.domain;\n    }\n\n    return name + suffix;\n  };\n\n  var get$1 = function get(name) {\n    var nameEq = _domainSpecific(name) + '=';\n    var value = baseCookie.get(nameEq);\n\n    try {\n      if (value) {\n        return JSON.parse(Base64.decode(value));\n      }\n    } catch (e) {\n      return null;\n    }\n\n    return null;\n  };\n\n  var set$1 = function set(name, value) {\n    try {\n      baseCookie.set(_domainSpecific(name), Base64.encode(JSON.stringify(value)), _options);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  };\n\n  var setRaw = function setRaw(name, value) {\n    try {\n      baseCookie.set(_domainSpecific(name), value, _options);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  };\n\n  var getRaw = function getRaw(name) {\n    var nameEq = _domainSpecific(name) + '=';\n    return baseCookie.get(nameEq);\n  };\n\n  var remove = function remove(name) {\n    try {\n      baseCookie.set(_domainSpecific(name), null, _options);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  };\n\n  var Cookie = {\n    reset: reset,\n    options: options,\n    get: get$1,\n    set: set$1,\n    remove: remove,\n    setRaw: setRaw,\n    getRaw: getRaw\n  };\n  /* jshint -W020, unused: false, noempty: false, boss: true */\n\n  /*\n   * Implement localStorage to support Firefox 2-3 and IE 5-7\n   */\n\n  var localStorage; // jshint ignore:line\n\n  {\n    // test that Window.localStorage is available and works\n    var windowLocalStorageAvailable = function windowLocalStorageAvailable() {\n      var uid = new Date();\n      var result;\n\n      try {\n        window.localStorage.setItem(uid, uid);\n        result = window.localStorage.getItem(uid) === String(uid);\n        window.localStorage.removeItem(uid);\n        return result;\n      } catch (e) {// localStorage not available\n      }\n\n      return false;\n    };\n\n    if (windowLocalStorageAvailable()) {\n      localStorage = window.localStorage;\n    } else if (window.globalStorage) {\n      // Firefox 2-3 use globalStorage\n      // See https://developer.mozilla.org/en/dom/storage#globalStorage\n      try {\n        localStorage = window.globalStorage[window.location.hostname];\n      } catch (e) {// Something bad happened...\n      }\n    } else if (typeof document !== 'undefined') {\n      // IE 5-7 use userData\n      // See http://msdn.microsoft.com/en-us/library/ms531424(v=vs.85).aspx\n      var div = document.createElement('div'),\n          attrKey = 'localStorage';\n      div.style.display = 'none';\n      document.getElementsByTagName('head')[0].appendChild(div);\n\n      if (div.addBehavior) {\n        div.addBehavior('#default#userdata');\n        localStorage = {\n          length: 0,\n          setItem: function setItem(k, v) {\n            div.load(attrKey);\n\n            if (!div.getAttribute(k)) {\n              this.length++;\n            }\n\n            div.setAttribute(k, v);\n            div.save(attrKey);\n          },\n          getItem: function getItem(k) {\n            div.load(attrKey);\n            return div.getAttribute(k);\n          },\n          removeItem: function removeItem(k) {\n            div.load(attrKey);\n\n            if (div.getAttribute(k)) {\n              this.length--;\n            }\n\n            div.removeAttribute(k);\n            div.save(attrKey);\n          },\n          clear: function clear() {\n            div.load(attrKey);\n            var i = 0;\n            var attr;\n\n            while (attr = div.XMLDocument.documentElement.attributes[i++]) {\n              div.removeAttribute(attr.name);\n            }\n\n            div.save(attrKey);\n            this.length = 0;\n          },\n          key: function key(k) {\n            div.load(attrKey);\n            return div.XMLDocument.documentElement.attributes[k];\n          }\n        };\n        div.load(attrKey);\n        localStorage.length = div.XMLDocument.documentElement.attributes.length;\n      }\n    }\n\n    if (!localStorage) {\n      localStorage = {\n        length: 0,\n        setItem: function setItem(k, v) {},\n        getItem: function getItem(k) {},\n        removeItem: function removeItem(k) {},\n        clear: function clear() {},\n        key: function key(k) {}\n      };\n    }\n  }\n  var localStorage$1 = localStorage;\n  /* jshint -W020, unused: false, noempty: false, boss: true */\n\n  var cookieStorage = function cookieStorage() {\n    this.storage = null;\n  };\n\n  cookieStorage.prototype.getStorage = function () {\n    if (this.storage !== null) {\n      return this.storage;\n    }\n\n    if (baseCookie.areCookiesEnabled()) {\n      this.storage = Cookie;\n    } else {\n      // if cookies disabled, fallback to localstorage\n      // note: localstorage does not persist across subdomains\n      var keyPrefix = 'amp_cookiestore_';\n      this.storage = {\n        _options: {\n          expirationDays: undefined,\n          domain: undefined,\n          secure: false\n        },\n        reset: function reset() {\n          this._options = {\n            expirationDays: undefined,\n            domain: undefined,\n            secure: false\n          };\n        },\n        options: function options(opts) {\n          if (arguments.length === 0) {\n            return this._options;\n          }\n\n          opts = opts || {};\n          this._options.expirationDays = opts.expirationDays || this._options.expirationDays; // localStorage is specific to subdomains\n\n          this._options.domain = opts.domain || this._options.domain || window && window.location && window.location.hostname;\n          return this._options.secure = opts.secure || false;\n        },\n        get: function get(name) {\n          try {\n            return JSON.parse(localStorage$1.getItem(keyPrefix + name));\n          } catch (e) {}\n\n          return null;\n        },\n        set: function set(name, value) {\n          try {\n            localStorage$1.setItem(keyPrefix + name, JSON.stringify(value));\n            return true;\n          } catch (e) {}\n\n          return false;\n        },\n        remove: function remove(name) {\n          try {\n            localStorage$1.removeItem(keyPrefix + name);\n          } catch (e) {\n            return false;\n          }\n        }\n      };\n    }\n\n    return this.storage;\n  };\n  /**\n  * MetadataStorage involves SDK data persistance\n  * storage priority: cookies -> localStorage -> in memory \n  * if in localStorage, unable track users between subdomains\n  * if in memory, then memory can't be shared between different tabs\n  */\n\n\n  var MetadataStorage = /*#__PURE__*/function () {\n    function MetadataStorage(_ref) {\n      var storageKey = _ref.storageKey,\n          disableCookies = _ref.disableCookies,\n          domain = _ref.domain,\n          secure = _ref.secure,\n          sameSite = _ref.sameSite,\n          expirationDays = _ref.expirationDays;\n\n      _classCallCheck(this, MetadataStorage);\n\n      this.storageKey = storageKey;\n      this.disableCookieStorage = !baseCookie.areCookiesEnabled() || disableCookies;\n      this.domain = domain;\n      this.secure = secure;\n      this.sameSite = sameSite;\n      this.expirationDays = expirationDays;\n      this.cookieDomain = '';\n      {\n        var writableTopDomain = topDomain(getLocation().href);\n        this.cookieDomain = domain || (writableTopDomain ? '.' + writableTopDomain : null);\n      }\n    }\n\n    _createClass(MetadataStorage, [{\n      key: \"getCookieStorageKey\",\n      value: function getCookieStorageKey() {\n        if (!this.domain) {\n          return this.storageKey;\n        }\n\n        var suffix = this.domain.charAt(0) === '.' ? this.domain.substring(1) : this.domain;\n        return \"\".concat(this.storageKey).concat(suffix ? \"_\".concat(suffix) : '');\n      }\n      /*\n      * Data is saved as delimited values rather than JSO to minimize cookie space\n      * Should not change order of the items\n      */\n\n    }, {\n      key: \"save\",\n      value: function save(_ref2) {\n        var deviceId = _ref2.deviceId,\n            userId = _ref2.userId,\n            optOut = _ref2.optOut,\n            sessionId = _ref2.sessionId,\n            lastEventTime = _ref2.lastEventTime,\n            eventId = _ref2.eventId,\n            identifyId = _ref2.identifyId,\n            sequenceNumber = _ref2.sequenceNumber;\n        var value = [deviceId, Base64.encode(userId || ''), // used to convert not unicode to alphanumeric since cookies only use alphanumeric\n        optOut ? '1' : '', sessionId ? sessionId.toString(32) : '0', // generated when instantiated, timestamp (but re-uses session id in cookie if not expired) @TODO clients may want custom session id\n        lastEventTime ? lastEventTime.toString(32) : '0', // last time an event was set\n        eventId ? eventId.toString(32) : '0', identifyId ? identifyId.toString(32) : '0', sequenceNumber ? sequenceNumber.toString(32) : '0'].join('.');\n\n        if (this.disableCookieStorage) {\n          localStorage$1.setItem(this.storageKey, value);\n        } else {\n          baseCookie.set(this.getCookieStorageKey(), value, {\n            domain: this.cookieDomain,\n            secure: this.secure,\n            sameSite: this.sameSite,\n            expirationDays: this.expirationDays\n          });\n        }\n      }\n    }, {\n      key: \"load\",\n      value: function load() {\n        var str;\n\n        if (!this.disableCookieStorage) {\n          str = baseCookie.get(this.getCookieStorageKey() + '=');\n        }\n\n        if (!str) {\n          str = localStorage$1.getItem(this.storageKey);\n        }\n\n        if (!str) {\n          return null;\n        }\n\n        var values = str.split('.');\n        var userId = null;\n\n        if (values[1]) {\n          try {\n            userId = Base64.decode(values[1]);\n          } catch (e) {\n            userId = null;\n          }\n        }\n\n        return {\n          deviceId: values[0],\n          userId: userId,\n          optOut: values[2] === '1',\n          sessionId: parseInt(values[3], 32),\n          lastEventTime: parseInt(values[4], 32),\n          eventId: parseInt(values[5], 32),\n          identifyId: parseInt(values[6], 32),\n          sequenceNumber: parseInt(values[7], 32)\n        };\n      }\n    }]);\n\n    return MetadataStorage;\n  }();\n\n  var getUtmData = function getUtmData(rawCookie, query) {\n    // Translate the utmz cookie format into url query string format.\n    var cookie = rawCookie ? '?' + rawCookie.split('.').slice(-1)[0].replace(/\\|/g, '&') : '';\n\n    var fetchParam = function fetchParam(queryName, query, cookieName, cookie) {\n      return utils.getQueryParam(queryName, query) || utils.getQueryParam(cookieName, cookie);\n    };\n\n    var utmSource = fetchParam(Constants.UTM_SOURCE, query, 'utmcsr', cookie);\n    var utmMedium = fetchParam(Constants.UTM_MEDIUM, query, 'utmcmd', cookie);\n    var utmCampaign = fetchParam(Constants.UTM_CAMPAIGN, query, 'utmccn', cookie);\n    var utmTerm = fetchParam(Constants.UTM_TERM, query, 'utmctr', cookie);\n    var utmContent = fetchParam(Constants.UTM_CONTENT, query, 'utmcct', cookie);\n    var utmData = {};\n\n    var addIfNotNull = function addIfNotNull(key, value) {\n      if (!utils.isEmptyString(value)) {\n        utmData[key] = value;\n      }\n    };\n\n    addIfNotNull(Constants.UTM_SOURCE, utmSource);\n    addIfNotNull(Constants.UTM_MEDIUM, utmMedium);\n    addIfNotNull(Constants.UTM_CAMPAIGN, utmCampaign);\n    addIfNotNull(Constants.UTM_TERM, utmTerm);\n    addIfNotNull(Constants.UTM_CONTENT, utmContent);\n    return utmData;\n  };\n  /*\n   * Wrapper for a user properties JSON object that supports operations.\n   * Note: if a user property is used in multiple operations on the same Identify object,\n   * only the first operation will be saved, and the rest will be ignored.\n   */\n\n\n  var AMP_OP_ADD = '$add';\n  var AMP_OP_APPEND = '$append';\n  var AMP_OP_CLEAR_ALL = '$clearAll';\n  var AMP_OP_PREPEND = '$prepend';\n  var AMP_OP_SET = '$set';\n  var AMP_OP_SET_ONCE = '$setOnce';\n  var AMP_OP_UNSET = '$unset';\n  /**\n   * Identify API - instance constructor. Identify objects are a wrapper for user property operations.\n   * Each method adds a user property operation to the Identify object, and returns the same Identify object,\n   * allowing you to chain multiple method calls together.\n   * Note: if the same user property is used in multiple operations on a single Identify object,\n   * only the first operation on that property will be saved, and the rest will be ignored.\n   * See [Readme]{@link https://github.com/amplitude/Amplitude-Javascript#user-properties-and-user-property-operations}\n   * for more information on the Identify API and user property operations.\n   * @constructor Identify\n   * @public\n   * @example var identify = new amplitude.Identify();\n   */\n\n  var Identify = function Identify() {\n    this.userPropertiesOperations = {};\n    this.properties = []; // keep track of keys that have been added\n  };\n  /**\n   * Increment a user property by a given value (can also be negative to decrement).\n   * If the user property does not have a value set yet, it will be initialized to 0 before being incremented.\n   * @public\n   * @param {string} property - The user property key.\n   * @param {number|string} value - The amount by which to increment the user property. Allows numbers as strings (ex: '123').\n   * @return {Identify} Returns the same Identify object, allowing you to chain multiple method calls together.\n   * @example var identify = new amplitude.Identify().add('karma', 1).add('friends', 1);\n   * amplitude.identify(identify); // send the Identify call\n   */\n\n\n  Identify.prototype.add = function (property, value) {\n    if (type(value) === 'number' || type(value) === 'string') {\n      this._addOperation(AMP_OP_ADD, property, value);\n    } else {\n      utils.log.error('Unsupported type for value: ' + type(value) + ', expecting number or string');\n    }\n\n    return this;\n  };\n  /**\n   * Append a value or values to a user property.\n   * If the user property does not have a value set yet,\n   * it will be initialized to an empty list before the new values are appended.\n   * If the user property has an existing value and it is not a list,\n   * the existing value will be converted into a list with the new values appended.\n   * @public\n   * @param {string} property - The user property key.\n   * @param {number|string|list|object} value - A value or values to append.\n   * Values can be numbers, strings, lists, or object (key:value dict will be flattened).\n   * @return {Identify} Returns the same Identify object, allowing you to chain multiple method calls together.\n   * @example var identify = new amplitude.Identify().append('ab-tests', 'new-user-tests');\n   * identify.append('some_list', [1, 2, 3, 4, 'values']);\n   * amplitude.identify(identify); // send the Identify call\n   */\n\n\n  Identify.prototype.append = function (property, value) {\n    this._addOperation(AMP_OP_APPEND, property, value);\n\n    return this;\n  };\n  /**\n   * Clear all user properties for the current user.\n   * SDK user should instead call amplitude.clearUserProperties() instead of using this.\n   * $clearAll needs to be sent on its own Identify object. If there are already other operations, then don't add $clearAll.\n   * If $clearAll already in an Identify object, don't allow other operations to be added.\n   * @private\n   */\n\n\n  Identify.prototype.clearAll = function () {\n    if (Object.keys(this.userPropertiesOperations).length > 0) {\n      if (!this.userPropertiesOperations.hasOwnProperty(AMP_OP_CLEAR_ALL)) {\n        utils.log.error('Need to send $clearAll on its own Identify object without any other operations, skipping $clearAll');\n      }\n\n      return this;\n    }\n\n    this.userPropertiesOperations[AMP_OP_CLEAR_ALL] = '-';\n    return this;\n  };\n  /**\n   * Prepend a value or values to a user property.\n   * Prepend means inserting the value or values at the front of a list.\n   * If the user property does not have a value set yet,\n   * it will be initialized to an empty list before the new values are prepended.\n   * If the user property has an existing value and it is not a list,\n   * the existing value will be converted into a list with the new values prepended.\n   * @public\n   * @param {string} property - The user property key.\n   * @param {number|string|list|object} value - A value or values to prepend.\n   * Values can be numbers, strings, lists, or object (key:value dict will be flattened).\n   * @return {Identify} Returns the same Identify object, allowing you to chain multiple method calls together.\n   * @example var identify = new amplitude.Identify().prepend('ab-tests', 'new-user-tests');\n   * identify.prepend('some_list', [1, 2, 3, 4, 'values']);\n   * amplitude.identify(identify); // send the Identify call\n   */\n\n\n  Identify.prototype.prepend = function (property, value) {\n    this._addOperation(AMP_OP_PREPEND, property, value);\n\n    return this;\n  };\n  /**\n   * Sets the value of a given user property. If a value already exists, it will be overwriten with the new value.\n   * @public\n   * @param {string} property - The user property key.\n   * @param {number|string|list|boolean|object} value - A value or values to set.\n   * Values can be numbers, strings, lists, or object (key:value dict will be flattened).\n   * @return {Identify} Returns the same Identify object, allowing you to chain multiple method calls together.\n   * @example var identify = new amplitude.Identify().set('user_type', 'beta');\n   * identify.set('name', {'first': 'John', 'last': 'Doe'}); // dict is flattened and becomes name.first: John, name.last: Doe\n   * amplitude.identify(identify); // send the Identify call\n   */\n\n\n  Identify.prototype.set = function (property, value) {\n    this._addOperation(AMP_OP_SET, property, value);\n\n    return this;\n  };\n  /**\n   * Sets the value of a given user property only once. Subsequent setOnce operations on that user property will be ignored;\n   * however, that user property can still be modified through any of the other operations.\n   * Useful for capturing properties such as 'initial_signup_date', 'initial_referrer', etc.\n   * @public\n   * @param {string} property - The user property key.\n   * @param {number|string|list|boolean|object} value - A value or values to set once.\n   * Values can be numbers, strings, lists, or object (key:value dict will be flattened).\n   * @return {Identify} Returns the same Identify object, allowing you to chain multiple method calls together.\n   * @example var identify = new amplitude.Identify().setOnce('sign_up_date', '2016-04-01');\n   * amplitude.identify(identify); // send the Identify call\n   */\n\n\n  Identify.prototype.setOnce = function (property, value) {\n    this._addOperation(AMP_OP_SET_ONCE, property, value);\n\n    return this;\n  };\n  /**\n   * Unset and remove a user property. This user property will no longer show up in a user's profile.\n   * @public\n   * @param {string} property - The user property key.\n   * @return {Identify} Returns the same Identify object, allowing you to chain multiple method calls together.\n   * @example var identify = new amplitude.Identify().unset('user_type').unset('age');\n   * amplitude.identify(identify); // send the Identify call\n   */\n\n\n  Identify.prototype.unset = function (property) {\n    this._addOperation(AMP_OP_UNSET, property, '-');\n\n    return this;\n  };\n  /**\n   * Helper function that adds operation to the Identify's object\n   * Handle's filtering of duplicate user property keys, and filtering for clearAll.\n   * @private\n   */\n\n\n  Identify.prototype._addOperation = function (operation, property, value) {\n    // check that the identify doesn't already contain a clearAll\n    if (this.userPropertiesOperations.hasOwnProperty(AMP_OP_CLEAR_ALL)) {\n      utils.log.error('This identify already contains a $clearAll operation, skipping operation ' + operation);\n      return;\n    } // check that property wasn't already used in this Identify\n\n\n    if (this.properties.indexOf(property) !== -1) {\n      utils.log.error('User property \"' + property + '\" already used in this identify, skipping operation ' + operation);\n      return;\n    }\n\n    if (!this.userPropertiesOperations.hasOwnProperty(operation)) {\n      this.userPropertiesOperations[operation] = {};\n    }\n\n    this.userPropertiesOperations[operation][property] = value;\n    this.properties.push(property);\n  };\n\n  var commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n  function createCommonjsModule(fn, module) {\n    return module = {\n      exports: {}\n    }, fn(module, module.exports), module.exports;\n  }\n\n  var md5 = createCommonjsModule(function (module) {\n    (function ($) {\n      /*\n      * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n      * to work around bugs in some JS interpreters.\n      */\n      function safeAdd(x, y) {\n        var lsw = (x & 0xffff) + (y & 0xffff);\n        var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n        return msw << 16 | lsw & 0xffff;\n      }\n      /*\n      * Bitwise rotate a 32-bit number to the left.\n      */\n\n\n      function bitRotateLeft(num, cnt) {\n        return num << cnt | num >>> 32 - cnt;\n      }\n      /*\n      * These functions implement the four basic operations the algorithm uses.\n      */\n\n\n      function md5cmn(q, a, b, x, s, t) {\n        return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n      }\n\n      function md5ff(a, b, c, d, x, s, t) {\n        return md5cmn(b & c | ~b & d, a, b, x, s, t);\n      }\n\n      function md5gg(a, b, c, d, x, s, t) {\n        return md5cmn(b & d | c & ~d, a, b, x, s, t);\n      }\n\n      function md5hh(a, b, c, d, x, s, t) {\n        return md5cmn(b ^ c ^ d, a, b, x, s, t);\n      }\n\n      function md5ii(a, b, c, d, x, s, t) {\n        return md5cmn(c ^ (b | ~d), a, b, x, s, t);\n      }\n      /*\n      * Calculate the MD5 of an array of little-endian words, and a bit length.\n      */\n\n\n      function binlMD5(x, len) {\n        /* append padding */\n        x[len >> 5] |= 0x80 << len % 32;\n        x[(len + 64 >>> 9 << 4) + 14] = len;\n        var i;\n        var olda;\n        var oldb;\n        var oldc;\n        var oldd;\n        var a = 1732584193;\n        var b = -271733879;\n        var c = -1732584194;\n        var d = 271733878;\n\n        for (i = 0; i < x.length; i += 16) {\n          olda = a;\n          oldb = b;\n          oldc = c;\n          oldd = d;\n          a = md5ff(a, b, c, d, x[i], 7, -680876936);\n          d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n          c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n          b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n          a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n          d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n          c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n          b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n          a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n          d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n          c = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n          b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n          a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n          d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n          c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n          b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n          a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n          d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n          c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n          b = md5gg(b, c, d, a, x[i], 20, -373897302);\n          a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n          d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n          c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n          b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n          a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n          d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n          c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n          b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n          a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n          d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n          c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n          b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n          a = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n          d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n          c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n          b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n          a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n          d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n          c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n          b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n          a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n          d = md5hh(d, a, b, c, x[i], 11, -358537222);\n          c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n          b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n          a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n          d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n          c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n          b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n          a = md5ii(a, b, c, d, x[i], 6, -198630844);\n          d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n          c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n          b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n          a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n          d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n          c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n          b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n          a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n          d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n          c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n          b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n          a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n          d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n          c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n          b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n          a = safeAdd(a, olda);\n          b = safeAdd(b, oldb);\n          c = safeAdd(c, oldc);\n          d = safeAdd(d, oldd);\n        }\n\n        return [a, b, c, d];\n      }\n      /*\n      * Convert an array of little-endian words to a string\n      */\n\n\n      function binl2rstr(input) {\n        var i;\n        var output = '';\n        var length32 = input.length * 32;\n\n        for (i = 0; i < length32; i += 8) {\n          output += String.fromCharCode(input[i >> 5] >>> i % 32 & 0xff);\n        }\n\n        return output;\n      }\n      /*\n      * Convert a raw string to an array of little-endian words\n      * Characters >255 have their high-byte silently ignored.\n      */\n\n\n      function rstr2binl(input) {\n        var i;\n        var output = [];\n        output[(input.length >> 2) - 1] = undefined;\n\n        for (i = 0; i < output.length; i += 1) {\n          output[i] = 0;\n        }\n\n        var length8 = input.length * 8;\n\n        for (i = 0; i < length8; i += 8) {\n          output[i >> 5] |= (input.charCodeAt(i / 8) & 0xff) << i % 32;\n        }\n\n        return output;\n      }\n      /*\n      * Calculate the MD5 of a raw string\n      */\n\n\n      function rstrMD5(s) {\n        return binl2rstr(binlMD5(rstr2binl(s), s.length * 8));\n      }\n      /*\n      * Calculate the HMAC-MD5, of a key and some data (raw strings)\n      */\n\n\n      function rstrHMACMD5(key, data) {\n        var i;\n        var bkey = rstr2binl(key);\n        var ipad = [];\n        var opad = [];\n        var hash;\n        ipad[15] = opad[15] = undefined;\n\n        if (bkey.length > 16) {\n          bkey = binlMD5(bkey, key.length * 8);\n        }\n\n        for (i = 0; i < 16; i += 1) {\n          ipad[i] = bkey[i] ^ 0x36363636;\n          opad[i] = bkey[i] ^ 0x5c5c5c5c;\n        }\n\n        hash = binlMD5(ipad.concat(rstr2binl(data)), 512 + data.length * 8);\n        return binl2rstr(binlMD5(opad.concat(hash), 512 + 128));\n      }\n      /*\n      * Convert a raw string to a hex string\n      */\n\n\n      function rstr2hex(input) {\n        var hexTab = '0123456789abcdef';\n        var output = '';\n        var x;\n        var i;\n\n        for (i = 0; i < input.length; i += 1) {\n          x = input.charCodeAt(i);\n          output += hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f);\n        }\n\n        return output;\n      }\n      /*\n      * Encode a string as utf-8\n      */\n\n\n      function str2rstrUTF8(input) {\n        return unescape(encodeURIComponent(input));\n      }\n      /*\n      * Take string arguments and return either raw or hex encoded strings\n      */\n\n\n      function rawMD5(s) {\n        return rstrMD5(str2rstrUTF8(s));\n      }\n\n      function hexMD5(s) {\n        return rstr2hex(rawMD5(s));\n      }\n\n      function rawHMACMD5(k, d) {\n        return rstrHMACMD5(str2rstrUTF8(k), str2rstrUTF8(d));\n      }\n\n      function hexHMACMD5(k, d) {\n        return rstr2hex(rawHMACMD5(k, d));\n      }\n\n      function md5(string, key, raw) {\n        if (!key) {\n          if (!raw) {\n            return hexMD5(string);\n          }\n\n          return rawMD5(string);\n        }\n\n        if (!raw) {\n          return hexHMACMD5(key, string);\n        }\n\n        return rawHMACMD5(key, string);\n      }\n\n      if (module.exports) {\n        module.exports = md5;\n      } else {\n        $.md5 = md5;\n      }\n    })(commonjsGlobal);\n  });\n\n  var strictUriEncode = function strictUriEncode(str) {\n    return encodeURIComponent(str).replace(/[!'()*]/g, function (c) {\n      return '%' + c.charCodeAt(0).toString(16).toUpperCase();\n    });\n  };\n  /*\n  object-assign\n  (c) Sindre Sorhus\n  @license MIT\n  */\n\n  /* eslint-disable no-unused-vars */\n\n\n  var getOwnPropertySymbols = Object.getOwnPropertySymbols;\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n  var propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\n  function toObject(val) {\n    if (val === null || val === undefined) {\n      throw new TypeError('Object.assign cannot be called with null or undefined');\n    }\n\n    return Object(val);\n  }\n\n  function shouldUseNative() {\n    try {\n      if (!Object.assign) {\n        return false;\n      } // Detect buggy property enumeration order in older V8 versions.\n      // https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\n\n      var test1 = new String('abc'); // eslint-disable-line no-new-wrappers\n\n      test1[5] = 'de';\n\n      if (Object.getOwnPropertyNames(test1)[0] === '5') {\n        return false;\n      } // https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\n\n      var test2 = {};\n\n      for (var i = 0; i < 10; i++) {\n        test2['_' + String.fromCharCode(i)] = i;\n      }\n\n      var order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n        return test2[n];\n      });\n\n      if (order2.join('') !== '0123456789') {\n        return false;\n      } // https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\n\n      var test3 = {};\n      'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n        test3[letter] = letter;\n      });\n\n      if (Object.keys(Object.assign({}, test3)).join('') !== 'abcdefghijklmnopqrst') {\n        return false;\n      }\n\n      return true;\n    } catch (err) {\n      // We don't expect any of the above to throw, but better to be safe.\n      return false;\n    }\n  }\n\n  var objectAssign = shouldUseNative() ? Object.assign : function (target, source) {\n    var from;\n    var to = toObject(target);\n    var symbols;\n\n    for (var s = 1; s < arguments.length; s++) {\n      from = Object(arguments[s]);\n\n      for (var key in from) {\n        if (hasOwnProperty.call(from, key)) {\n          to[key] = from[key];\n        }\n      }\n\n      if (getOwnPropertySymbols) {\n        symbols = getOwnPropertySymbols(from);\n\n        for (var i = 0; i < symbols.length; i++) {\n          if (propIsEnumerable.call(from, symbols[i])) {\n            to[symbols[i]] = from[symbols[i]];\n          }\n        }\n      }\n    }\n\n    return to;\n  };\n  var token = '%[a-f0-9]{2}';\n  var singleMatcher = new RegExp(token, 'gi');\n  var multiMatcher = new RegExp('(' + token + ')+', 'gi');\n\n  function decodeComponents(components, split) {\n    try {\n      // Try to decode the entire string first\n      return decodeURIComponent(components.join(''));\n    } catch (err) {// Do nothing\n    }\n\n    if (components.length === 1) {\n      return components;\n    }\n\n    split = split || 1; // Split the array in 2 parts\n\n    var left = components.slice(0, split);\n    var right = components.slice(split);\n    return Array.prototype.concat.call([], decodeComponents(left), decodeComponents(right));\n  }\n\n  function decode(input) {\n    try {\n      return decodeURIComponent(input);\n    } catch (err) {\n      var tokens = input.match(singleMatcher);\n\n      for (var i = 1; i < tokens.length; i++) {\n        input = decodeComponents(tokens, i).join('');\n        tokens = input.match(singleMatcher);\n      }\n\n      return input;\n    }\n  }\n\n  function customDecodeURIComponent(input) {\n    // Keep track of all the replacements and prefill the map with the `BOM`\n    var replaceMap = {\n      '%FE%FF': \"\\uFFFD\\uFFFD\",\n      '%FF%FE': \"\\uFFFD\\uFFFD\"\n    };\n    var match = multiMatcher.exec(input);\n\n    while (match) {\n      try {\n        // Decode as big chunks as possible\n        replaceMap[match[0]] = decodeURIComponent(match[0]);\n      } catch (err) {\n        var result = decode(match[0]);\n\n        if (result !== match[0]) {\n          replaceMap[match[0]] = result;\n        }\n      }\n\n      match = multiMatcher.exec(input);\n    } // Add `%C2` at the end of the map to make sure it does not replace the combinator before everything else\n\n\n    replaceMap['%C2'] = \"\\uFFFD\";\n    var entries = Object.keys(replaceMap);\n\n    for (var i = 0; i < entries.length; i++) {\n      // Replace all decoded components\n      var key = entries[i];\n      input = input.replace(new RegExp(key, 'g'), replaceMap[key]);\n    }\n\n    return input;\n  }\n\n  var decodeUriComponent = function decodeUriComponent(encodedURI) {\n    if (typeof encodedURI !== 'string') {\n      throw new TypeError('Expected `encodedURI` to be of type `string`, got `' + typeof encodedURI + '`');\n    }\n\n    try {\n      encodedURI = encodedURI.replace(/\\+/g, ' '); // Try the built in decoder first\n\n      return decodeURIComponent(encodedURI);\n    } catch (err) {\n      // Fallback to a more advanced decoder\n      return customDecodeURIComponent(encodedURI);\n    }\n  };\n\n  function encoderForArrayFormat(opts) {\n    switch (opts.arrayFormat) {\n      case 'index':\n        return function (key, value, index) {\n          return value === null ? [encode(key, opts), '[', index, ']'].join('') : [encode(key, opts), '[', encode(index, opts), ']=', encode(value, opts)].join('');\n        };\n\n      case 'bracket':\n        return function (key, value) {\n          return value === null ? encode(key, opts) : [encode(key, opts), '[]=', encode(value, opts)].join('');\n        };\n\n      default:\n        return function (key, value) {\n          return value === null ? encode(key, opts) : [encode(key, opts), '=', encode(value, opts)].join('');\n        };\n    }\n  }\n\n  function parserForArrayFormat(opts) {\n    var result;\n\n    switch (opts.arrayFormat) {\n      case 'index':\n        return function (key, value, accumulator) {\n          result = /\\[(\\d*)\\]$/.exec(key);\n          key = key.replace(/\\[\\d*\\]$/, '');\n\n          if (!result) {\n            accumulator[key] = value;\n            return;\n          }\n\n          if (accumulator[key] === undefined) {\n            accumulator[key] = {};\n          }\n\n          accumulator[key][result[1]] = value;\n        };\n\n      case 'bracket':\n        return function (key, value, accumulator) {\n          result = /(\\[\\])$/.exec(key);\n          key = key.replace(/\\[\\]$/, '');\n\n          if (!result) {\n            accumulator[key] = value;\n            return;\n          } else if (accumulator[key] === undefined) {\n            accumulator[key] = [value];\n            return;\n          }\n\n          accumulator[key] = [].concat(accumulator[key], value);\n        };\n\n      default:\n        return function (key, value, accumulator) {\n          if (accumulator[key] === undefined) {\n            accumulator[key] = value;\n            return;\n          }\n\n          accumulator[key] = [].concat(accumulator[key], value);\n        };\n    }\n  }\n\n  function encode(value, opts) {\n    if (opts.encode) {\n      return opts.strict ? strictUriEncode(value) : encodeURIComponent(value);\n    }\n\n    return value;\n  }\n\n  function keysSorter(input) {\n    if (Array.isArray(input)) {\n      return input.sort();\n    } else if (typeof input === 'object') {\n      return keysSorter(Object.keys(input)).sort(function (a, b) {\n        return Number(a) - Number(b);\n      }).map(function (key) {\n        return input[key];\n      });\n    }\n\n    return input;\n  }\n\n  function extract(str) {\n    var queryStart = str.indexOf('?');\n\n    if (queryStart === -1) {\n      return '';\n    }\n\n    return str.slice(queryStart + 1);\n  }\n\n  function parse(str, opts) {\n    opts = objectAssign({\n      arrayFormat: 'none'\n    }, opts);\n    var formatter = parserForArrayFormat(opts); // Create an object with no prototype\n    // https://github.com/sindresorhus/query-string/issues/47\n\n    var ret = Object.create(null);\n\n    if (typeof str !== 'string') {\n      return ret;\n    }\n\n    str = str.trim().replace(/^[?#&]/, '');\n\n    if (!str) {\n      return ret;\n    }\n\n    str.split('&').forEach(function (param) {\n      var parts = param.replace(/\\+/g, ' ').split('='); // Firefox (pre 40) decodes `%3D` to `=`\n      // https://github.com/sindresorhus/query-string/pull/37\n\n      var key = parts.shift();\n      var val = parts.length > 0 ? parts.join('=') : undefined; // missing `=` should be `null`:\n      // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\n      val = val === undefined ? null : decodeUriComponent(val);\n      formatter(decodeUriComponent(key), val, ret);\n    });\n    return Object.keys(ret).sort().reduce(function (result, key) {\n      var val = ret[key];\n\n      if (Boolean(val) && typeof val === 'object' && !Array.isArray(val)) {\n        // Sort object keys, not values\n        result[key] = keysSorter(val);\n      } else {\n        result[key] = val;\n      }\n\n      return result;\n    }, Object.create(null));\n  }\n\n  var extract_1 = extract;\n  var parse_1 = parse;\n\n  var stringify = function stringify(obj, opts) {\n    var defaults = {\n      encode: true,\n      strict: true,\n      arrayFormat: 'none'\n    };\n    opts = objectAssign(defaults, opts);\n\n    if (opts.sort === false) {\n      opts.sort = function () {};\n    }\n\n    var formatter = encoderForArrayFormat(opts);\n    return obj ? Object.keys(obj).sort(opts.sort).map(function (key) {\n      var val = obj[key];\n\n      if (val === undefined) {\n        return '';\n      }\n\n      if (val === null) {\n        return encode(key, opts);\n      }\n\n      if (Array.isArray(val)) {\n        var result = [];\n        val.slice().forEach(function (val2) {\n          if (val2 === undefined) {\n            return;\n          }\n\n          result.push(formatter(key, val2, result.length));\n        });\n        return result.join('&');\n      }\n\n      return encode(key, opts) + '=' + encode(val, opts);\n    }).filter(function (x) {\n      return x.length > 0;\n    }).join('&') : '';\n  };\n\n  var parseUrl = function parseUrl(str, opts) {\n    return {\n      url: str.split('?')[0] || '',\n      query: parse(extract(str), opts)\n    };\n  };\n\n  var queryString = {\n    extract: extract_1,\n    parse: parse_1,\n    stringify: stringify,\n    parseUrl: parseUrl\n  };\n  /*\n   * Simple AJAX request object\n   */\n\n  var Request = function Request(url, data) {\n    this.url = url;\n    this.data = data || {};\n  };\n\n  Request.prototype.send = function (callback) {\n    var isIE = window.XDomainRequest ? true : false;\n\n    if (isIE) {\n      var xdr = new window.XDomainRequest();\n      xdr.open('POST', this.url, true);\n\n      xdr.onload = function () {\n        callback(200, xdr.responseText);\n      };\n\n      xdr.onerror = function () {\n        // status code not available from xdr, try string matching on responseText\n        if (xdr.responseText === 'Request Entity Too Large') {\n          callback(413, xdr.responseText);\n        } else {\n          callback(500, xdr.responseText);\n        }\n      };\n\n      xdr.ontimeout = function () {};\n\n      xdr.onprogress = function () {};\n\n      xdr.send(queryString.stringify(this.data));\n    } else {\n      var xhr = new XMLHttpRequest();\n      xhr.open('POST', this.url, true);\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === 4) {\n          callback(xhr.status, xhr.responseText);\n        }\n      };\n\n      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');\n      xhr.send(queryString.stringify(this.data));\n    } //log('sent request to ' + this.url + ' with data ' + decodeURIComponent(queryString(this.data)));\n\n  };\n  /*\n   * Wrapper for logging Revenue data. Revenue objects get passed to amplitude.logRevenueV2 to send to Amplitude servers.\n   * Note: price is the only required field. If quantity is not specified, then defaults to 1.\n   */\n\n  /**\n   * Revenue API - instance constructor. Revenue objects are a wrapper for revenue data.\n   * Each method updates a revenue property in the Revenue object, and returns the same Revenue object,\n   * allowing you to chain multiple method calls together.\n   * Note: price is a required field to log revenue events.\n   * If quantity is not specified then defaults to 1.\n   * See [Readme]{@link https://github.com/amplitude/Amplitude-Javascript#tracking-revenue} for more information\n   * about logging Revenue.\n   * @constructor Revenue\n   * @public\n   * @example var revenue = new amplitude.Revenue();\n   */\n\n\n  var Revenue = function Revenue() {\n    // required fields\n    this._price = null; // optional fields\n\n    this._productId = null;\n    this._quantity = 1;\n    this._revenueType = null;\n    this._properties = null;\n  };\n  /**\n   * Set a value for the product identifer.\n   * @public\n   * @param {string} productId - The value for the product identifier. Empty and invalid strings are ignored.\n   * @return {Revenue} Returns the same Revenue object, allowing you to chain multiple method calls together.\n   * @example var revenue = new amplitude.Revenue().setProductId('productIdentifier').setPrice(10.99);\n   * amplitude.logRevenueV2(revenue);\n   */\n\n\n  Revenue.prototype.setProductId = function setProductId(productId) {\n    if (type(productId) !== 'string') {\n      utils.log.error('Unsupported type for productId: ' + type(productId) + ', expecting string');\n    } else if (utils.isEmptyString(productId)) {\n      utils.log.error('Invalid empty productId');\n    } else {\n      this._productId = productId;\n    }\n\n    return this;\n  };\n  /**\n   * Set a value for the quantity. Note revenue amount is calculated as price * quantity.\n   * @public\n   * @param {number} quantity - Integer value for the quantity. If not set, quantity defaults to 1.\n   * @return {Revenue} Returns the same Revenue object, allowing you to chain multiple method calls together.\n   * @example var revenue = new amplitude.Revenue().setProductId('productIdentifier').setPrice(10.99).setQuantity(5);\n   * amplitude.logRevenueV2(revenue);\n   */\n\n\n  Revenue.prototype.setQuantity = function setQuantity(quantity) {\n    if (type(quantity) !== 'number') {\n      utils.log.error('Unsupported type for quantity: ' + type(quantity) + ', expecting number');\n    } else {\n      this._quantity = parseInt(quantity);\n    }\n\n    return this;\n  };\n  /**\n   * Set a value for the price. This field is required for all revenue being logged.\n   * Note revenue amount is calculated as price * quantity.\n   * @public\n   * @param {number} price - Double value for the quantity.\n   * @return {Revenue} Returns the same Revenue object, allowing you to chain multiple method calls together.\n   * @example var revenue = new amplitude.Revenue().setProductId('productIdentifier').setPrice(10.99);\n   * amplitude.logRevenueV2(revenue);\n   */\n\n\n  Revenue.prototype.setPrice = function setPrice(price) {\n    if (type(price) !== 'number') {\n      utils.log.error('Unsupported type for price: ' + type(price) + ', expecting number');\n    } else {\n      this._price = price;\n    }\n\n    return this;\n  };\n  /**\n   * Set a value for the revenueType (for example purchase, cost, tax, refund, etc).\n   * @public\n   * @param {string} revenueType - RevenueType to designate.\n   * @return {Revenue} Returns the same Revenue object, allowing you to chain multiple method calls together.\n   * @example var revenue = new amplitude.Revenue().setProductId('productIdentifier').setPrice(10.99).setRevenueType('purchase');\n   * amplitude.logRevenueV2(revenue);\n   */\n\n\n  Revenue.prototype.setRevenueType = function setRevenueType(revenueType) {\n    if (type(revenueType) !== 'string') {\n      utils.log.error('Unsupported type for revenueType: ' + type(revenueType) + ', expecting string');\n    } else {\n      this._revenueType = revenueType;\n    }\n\n    return this;\n  };\n  /**\n   * Set event properties for the revenue event.\n   * @public\n   * @param {object} eventProperties - Revenue event properties to set.\n   * @return {Revenue} Returns the same Revenue object, allowing you to chain multiple method calls together.\n   * @example var event_properties = {'city': 'San Francisco'};\n   * var revenue = new amplitude.Revenue().setProductId('productIdentifier').setPrice(10.99).setEventProperties(event_properties);\n   * amplitude.logRevenueV2(revenue);\n  */\n\n\n  Revenue.prototype.setEventProperties = function setEventProperties(eventProperties) {\n    if (type(eventProperties) !== 'object') {\n      utils.log.error('Unsupported type for eventProperties: ' + type(eventProperties) + ', expecting object');\n    } else {\n      this._properties = utils.validateProperties(eventProperties);\n    }\n\n    return this;\n  };\n  /**\n   * @private\n   */\n\n\n  Revenue.prototype._isValidRevenue = function _isValidRevenue() {\n    if (type(this._price) !== 'number') {\n      utils.log.error('Invalid revenue, need to set price field');\n      return false;\n    }\n\n    return true;\n  };\n  /**\n   * @private\n   */\n\n\n  Revenue.prototype._toJSONObject = function _toJSONObject() {\n    var obj = type(this._properties) === 'object' ? this._properties : {};\n\n    if (this._productId !== null) {\n      obj[Constants.REVENUE_PRODUCT_ID] = this._productId;\n    }\n\n    if (this._quantity !== null) {\n      obj[Constants.REVENUE_QUANTITY] = this._quantity;\n    }\n\n    if (this._price !== null) {\n      obj[Constants.REVENUE_PRICE] = this._price;\n    }\n\n    if (this._revenueType !== null) {\n      obj[Constants.REVENUE_REVENUE_TYPE] = this._revenueType;\n    }\n\n    return obj;\n  };\n\n  var uaParser = createCommonjsModule(function (module, exports) {\n    /*!\n     * UAParser.js v0.7.21\n     * Lightweight JavaScript-based User-Agent string parser\n     * https://github.com/faisalman/ua-parser-js\n     *\n     * Copyright © 2012-2019 Faisal Salman <f@faisalman.com>\n     * Licensed under MIT License\n     */\n    (function (window, undefined$1) {\n      //////////////\n      // Constants\n      /////////////\n      var LIBVERSION = '0.7.21',\n          EMPTY = '',\n          UNKNOWN = '?',\n          FUNC_TYPE = 'function',\n          OBJ_TYPE = 'object',\n          STR_TYPE = 'string',\n          MAJOR = 'major',\n          // deprecated\n      MODEL = 'model',\n          NAME = 'name',\n          TYPE = 'type',\n          VENDOR = 'vendor',\n          VERSION = 'version',\n          ARCHITECTURE = 'architecture',\n          CONSOLE = 'console',\n          MOBILE = 'mobile',\n          TABLET = 'tablet',\n          SMARTTV = 'smarttv',\n          WEARABLE = 'wearable',\n          EMBEDDED = 'embedded'; ///////////\n      // Helper\n      //////////\n\n      var util = {\n        extend: function extend(regexes, extensions) {\n          var mergedRegexes = {};\n\n          for (var i in regexes) {\n            if (extensions[i] && extensions[i].length % 2 === 0) {\n              mergedRegexes[i] = extensions[i].concat(regexes[i]);\n            } else {\n              mergedRegexes[i] = regexes[i];\n            }\n          }\n\n          return mergedRegexes;\n        },\n        has: function has(str1, str2) {\n          if (typeof str1 === \"string\") {\n            return str2.toLowerCase().indexOf(str1.toLowerCase()) !== -1;\n          } else {\n            return false;\n          }\n        },\n        lowerize: function lowerize(str) {\n          return str.toLowerCase();\n        },\n        major: function major(version) {\n          return typeof version === STR_TYPE ? version.replace(/[^\\d\\.]/g, '').split(\".\")[0] : undefined$1;\n        },\n        trim: function trim(str) {\n          return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n        }\n      }; ///////////////\n      // Map helper\n      //////////////\n\n      var mapper = {\n        rgx: function rgx(ua, arrays) {\n          var i = 0,\n              j,\n              k,\n              p,\n              q,\n              matches,\n              match; // loop through all regexes maps\n\n          while (i < arrays.length && !matches) {\n            var regex = arrays[i],\n                // even sequence (0,2,4,..)\n            props = arrays[i + 1]; // odd sequence (1,3,5,..)\n\n            j = k = 0; // try matching uastring with regexes\n\n            while (j < regex.length && !matches) {\n              matches = regex[j++].exec(ua);\n\n              if (!!matches) {\n                for (p = 0; p < props.length; p++) {\n                  match = matches[++k];\n                  q = props[p]; // check if given property is actually array\n\n                  if (typeof q === OBJ_TYPE && q.length > 0) {\n                    if (q.length == 2) {\n                      if (typeof q[1] == FUNC_TYPE) {\n                        // assign modified match\n                        this[q[0]] = q[1].call(this, match);\n                      } else {\n                        // assign given value, ignore regex match\n                        this[q[0]] = q[1];\n                      }\n                    } else if (q.length == 3) {\n                      // check whether function or regex\n                      if (typeof q[1] === FUNC_TYPE && !(q[1].exec && q[1].test)) {\n                        // call function (usually string mapper)\n                        this[q[0]] = match ? q[1].call(this, match, q[2]) : undefined$1;\n                      } else {\n                        // sanitize match using given regex\n                        this[q[0]] = match ? match.replace(q[1], q[2]) : undefined$1;\n                      }\n                    } else if (q.length == 4) {\n                      this[q[0]] = match ? q[3].call(this, match.replace(q[1], q[2])) : undefined$1;\n                    }\n                  } else {\n                    this[q] = match ? match : undefined$1;\n                  }\n                }\n              }\n            }\n\n            i += 2;\n          }\n        },\n        str: function str(_str, map) {\n          for (var i in map) {\n            // check if array\n            if (typeof map[i] === OBJ_TYPE && map[i].length > 0) {\n              for (var j = 0; j < map[i].length; j++) {\n                if (util.has(map[i][j], _str)) {\n                  return i === UNKNOWN ? undefined$1 : i;\n                }\n              }\n            } else if (util.has(map[i], _str)) {\n              return i === UNKNOWN ? undefined$1 : i;\n            }\n          }\n\n          return _str;\n        }\n      }; ///////////////\n      // String map\n      //////////////\n\n      var maps = {\n        browser: {\n          oldsafari: {\n            version: {\n              '1.0': '/8',\n              '1.2': '/1',\n              '1.3': '/3',\n              '2.0': '/412',\n              '2.0.2': '/416',\n              '2.0.3': '/417',\n              '2.0.4': '/419',\n              '?': '/'\n            }\n          }\n        },\n        device: {\n          amazon: {\n            model: {\n              'Fire Phone': ['SD', 'KF']\n            }\n          },\n          sprint: {\n            model: {\n              'Evo Shift 4G': '7373KT'\n            },\n            vendor: {\n              'HTC': 'APA',\n              'Sprint': 'Sprint'\n            }\n          }\n        },\n        os: {\n          windows: {\n            version: {\n              'ME': '4.90',\n              'NT 3.11': 'NT3.51',\n              'NT 4.0': 'NT4.0',\n              '2000': 'NT 5.0',\n              'XP': ['NT 5.1', 'NT 5.2'],\n              'Vista': 'NT 6.0',\n              '7': 'NT 6.1',\n              '8': 'NT 6.2',\n              '8.1': 'NT 6.3',\n              '10': ['NT 6.4', 'NT 10.0'],\n              'RT': 'ARM'\n            }\n          }\n        }\n      }; //////////////\n      // Regex map\n      /////////////\n\n      var regexes = {\n        browser: [[// Presto based\n        /(opera\\smini)\\/([\\w\\.-]+)/i, // Opera Mini\n        /(opera\\s[mobiletab]+).+version\\/([\\w\\.-]+)/i, // Opera Mobi/Tablet\n        /(opera).+version\\/([\\w\\.]+)/i, // Opera > 9.80\n        /(opera)[\\/\\s]+([\\w\\.]+)/i // Opera < 9.80\n        ], [NAME, VERSION], [/(opios)[\\/\\s]+([\\w\\.]+)/i // Opera mini on iphone >= 8.0\n        ], [[NAME, 'Opera Mini'], VERSION], [/\\s(opr)\\/([\\w\\.]+)/i // Opera Webkit\n        ], [[NAME, 'Opera'], VERSION], [// Mixed\n        /(kindle)\\/([\\w\\.]+)/i, // Kindle\n        /(lunascape|maxthon|netfront|jasmine|blazer)[\\/\\s]?([\\w\\.]*)/i, // Lunascape/Maxthon/Netfront/Jasmine/Blazer\n        // Trident based\n        /(avant\\s|iemobile|slim)(?:browser)?[\\/\\s]?([\\w\\.]*)/i, // Avant/IEMobile/SlimBrowser\n        /(bidubrowser|baidubrowser)[\\/\\s]?([\\w\\.]+)/i, // Baidu Browser\n        /(?:ms|\\()(ie)\\s([\\w\\.]+)/i, // Internet Explorer\n        // Webkit/KHTML based\n        /(rekonq)\\/([\\w\\.]*)/i, // Rekonq\n        /(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\\/([\\w\\.-]+)/i // Chromium/Flock/RockMelt/Midori/Epiphany/Silk/Skyfire/Bolt/Iron/Iridium/PhantomJS/Bowser/QupZilla/Falkon\n        ], [NAME, VERSION], [/(konqueror)\\/([\\w\\.]+)/i // Konqueror\n        ], [[NAME, 'Konqueror'], VERSION], [/(trident).+rv[:\\s]([\\w\\.]+).+like\\sgecko/i // IE11\n        ], [[NAME, 'IE'], VERSION], [/(edge|edgios|edga|edg)\\/((\\d+)?[\\w\\.]+)/i // Microsoft Edge\n        ], [[NAME, 'Edge'], VERSION], [/(yabrowser)\\/([\\w\\.]+)/i // Yandex\n        ], [[NAME, 'Yandex'], VERSION], [/(Avast)\\/([\\w\\.]+)/i // Avast Secure Browser\n        ], [[NAME, 'Avast Secure Browser'], VERSION], [/(AVG)\\/([\\w\\.]+)/i // AVG Secure Browser\n        ], [[NAME, 'AVG Secure Browser'], VERSION], [/(puffin)\\/([\\w\\.]+)/i // Puffin\n        ], [[NAME, 'Puffin'], VERSION], [/(focus)\\/([\\w\\.]+)/i // Firefox Focus\n        ], [[NAME, 'Firefox Focus'], VERSION], [/(opt)\\/([\\w\\.]+)/i // Opera Touch\n        ], [[NAME, 'Opera Touch'], VERSION], [/((?:[\\s\\/])uc?\\s?browser|(?:juc.+)ucweb)[\\/\\s]?([\\w\\.]+)/i // UCBrowser\n        ], [[NAME, 'UCBrowser'], VERSION], [/(comodo_dragon)\\/([\\w\\.]+)/i // Comodo Dragon\n        ], [[NAME, /_/g, ' '], VERSION], [/(windowswechat qbcore)\\/([\\w\\.]+)/i // WeChat Desktop for Windows Built-in Browser\n        ], [[NAME, 'WeChat(Win) Desktop'], VERSION], [/(micromessenger)\\/([\\w\\.]+)/i // WeChat\n        ], [[NAME, 'WeChat'], VERSION], [/(brave)\\/([\\w\\.]+)/i // Brave browser\n        ], [[NAME, 'Brave'], VERSION], [/(qqbrowserlite)\\/([\\w\\.]+)/i // QQBrowserLite\n        ], [NAME, VERSION], [/(QQ)\\/([\\d\\.]+)/i // QQ, aka ShouQ\n        ], [NAME, VERSION], [/m?(qqbrowser)[\\/\\s]?([\\w\\.]+)/i // QQBrowser\n        ], [NAME, VERSION], [/(baiduboxapp)[\\/\\s]?([\\w\\.]+)/i // Baidu App\n        ], [NAME, VERSION], [/(2345Explorer)[\\/\\s]?([\\w\\.]+)/i // 2345 Browser\n        ], [NAME, VERSION], [/(MetaSr)[\\/\\s]?([\\w\\.]+)/i // SouGouBrowser\n        ], [NAME], [/(LBBROWSER)/i // LieBao Browser\n        ], [NAME], [/xiaomi\\/miuibrowser\\/([\\w\\.]+)/i // MIUI Browser\n        ], [VERSION, [NAME, 'MIUI Browser']], [/;fbav\\/([\\w\\.]+);/i // Facebook App for iOS & Android\n        ], [VERSION, [NAME, 'Facebook']], [/safari\\s(line)\\/([\\w\\.]+)/i, // Line App for iOS\n        /android.+(line)\\/([\\w\\.]+)\\/iab/i // Line App for Android\n        ], [NAME, VERSION], [/headlesschrome(?:\\/([\\w\\.]+)|\\s)/i // Chrome Headless\n        ], [VERSION, [NAME, 'Chrome Headless']], [/\\swv\\).+(chrome)\\/([\\w\\.]+)/i // Chrome WebView\n        ], [[NAME, /(.+)/, '$1 WebView'], VERSION], [/((?:oculus|samsung)browser)\\/([\\w\\.]+)/i], [[NAME, /(.+(?:g|us))(.+)/, '$1 $2'], VERSION], [// Oculus / Samsung Browser\n        /((?:android.+)crmo|crios)\\/([\\w\\.]+)/i, // Chrome for Android/iOS\n        /android.+(chrome)\\/([\\w\\.]+)\\s+(?:mobile\\s?safari)/i], [[NAME, 'Chrome Mobile'], VERSION], [/android.+version\\/([\\w\\.]+)\\s+(?:mobile\\s?safari|safari)*/i // Android Browser\n        ], [VERSION, [NAME, 'Android Browser']], [/(sailfishbrowser)\\/([\\w\\.]+)/i // Sailfish Browser\n        ], [[NAME, 'Sailfish Browser'], VERSION], [/(chrome|omniweb|arora|[tizenoka]{5}\\s?browser)\\/v?([\\w\\.]+)/i // Chrome/OmniWeb/Arora/Tizen/Nokia\n        ], [NAME, VERSION], [/(dolfin)\\/([\\w\\.]+)/i // Dolphin\n        ], [[NAME, 'Dolphin'], VERSION], [/(qihu|qhbrowser|qihoobrowser|360browser)/i // 360\n        ], [[NAME, '360 Browser']], [/(coast)\\/([\\w\\.]+)/i // Opera Coast\n        ], [[NAME, 'Opera Coast'], VERSION], [/fxios\\/([\\w\\.-]+)/i // Firefox for iOS\n        ], [VERSION, [NAME, 'Firefox']], [/version\\/([\\w\\.]+).+?mobile\\/\\w+\\s(safari)/i // Mobile Safari\n        ], [VERSION, [NAME, 'Mobile Safari']], [/version\\/([\\w\\.]+).+?(mobile\\s?safari|safari)/i // Safari & Safari Mobile\n        ], [VERSION, NAME], [/webkit.+?(gsa)\\/([\\w\\.]+).+?(mobile\\s?safari|safari)(\\/[\\w\\.]+)/i // Google Search Appliance on iOS\n        ], [[NAME, 'GSA'], VERSION], [/webkit.+?(mobile\\s?safari|safari)(\\/[\\w\\.]+)/i // Safari < 3.0\n        ], [NAME, [VERSION, mapper.str, maps.browser.oldsafari.version]], [/(webkit|khtml)\\/([\\w\\.]+)/i], [NAME, VERSION], [// Gecko based\n        /(navigator|netscape)\\/([\\w\\.-]+)/i // Netscape\n        ], [[NAME, 'Netscape'], VERSION], [/(swiftfox)/i, // Swiftfox\n        /(icedragon|iceweasel|camino|chimera|fennec|maemo\\sbrowser|minimo|conkeror)[\\/\\s]?([\\w\\.\\+]+)/i, // IceDragon/Iceweasel/Camino/Chimera/Fennec/Maemo/Minimo/Conkeror\n        /(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\\/([\\w\\.-]+)/i, // Firefox/SeaMonkey/K-Meleon/IceCat/IceApe/Firebird/Phoenix\n        /(mozilla)\\/([\\w\\.]+).+rv\\:.+gecko\\/\\d+/i, // Mozilla\n        // Other\n        /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\\/\\s]?([\\w\\.]+)/i, // Polaris/Lynx/Dillo/iCab/Doris/Amaya/w3m/NetSurf/Sleipnir\n        /(links)\\s\\(([\\w\\.]+)/i, // Links\n        /(gobrowser)\\/?([\\w\\.]*)/i, // GoBrowser\n        /(ice\\s?browser)\\/v?([\\w\\._]+)/i, // ICE Browser\n        /(mosaic)[\\/\\s]([\\w\\.]+)/i // Mosaic\n        ], [NAME, VERSION]],\n        cpu: [[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\\)]/i // AMD64\n        ], [[ARCHITECTURE, 'amd64']], [/(ia32(?=;))/i // IA32 (quicktime)\n        ], [[ARCHITECTURE, util.lowerize]], [/((?:i[346]|x)86)[;\\)]/i // IA32\n        ], [[ARCHITECTURE, 'ia32']], [// PocketPC mistakenly identified as PowerPC\n        /windows\\s(ce|mobile);\\sppc;/i], [[ARCHITECTURE, 'arm']], [/((?:ppc|powerpc)(?:64)?)(?:\\smac|;|\\))/i // PowerPC\n        ], [[ARCHITECTURE, /ower/, '', util.lowerize]], [/(sun4\\w)[;\\)]/i // SPARC\n        ], [[ARCHITECTURE, 'sparc']], [/((?:avr32|ia64(?=;))|68k(?=\\))|arm(?:64|(?=v\\d+[;l]))|(?=atmel\\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i // IA64, 68K, ARM/64, AVR/32, IRIX/64, MIPS/64, SPARC/64, PA-RISC\n        ], [[ARCHITECTURE, util.lowerize]]],\n        device: [[/\\((ipad|playbook);[\\w\\s\\),;-]+(rim|apple)/i // iPad/PlayBook\n        ], [MODEL, VENDOR, [TYPE, TABLET]], [/applecoremedia\\/[\\w\\.]+ \\((ipad)/ // iPad\n        ], [MODEL, [VENDOR, 'Apple'], [TYPE, TABLET]], [/(apple\\s{0,1}tv)/i // Apple TV\n        ], [[MODEL, 'Apple TV'], [VENDOR, 'Apple'], [TYPE, SMARTTV]], [/(archos)\\s(gamepad2?)/i, // Archos\n        /(hp).+(touchpad)/i, // HP TouchPad\n        /(hp).+(tablet)/i, // HP Tablet\n        /(kindle)\\/([\\w\\.]+)/i, // Kindle\n        /\\s(nook)[\\w\\s]+build\\/(\\w+)/i, // Nook\n        /(dell)\\s(strea[kpr\\s\\d]*[\\dko])/i // Dell Streak\n        ], [VENDOR, MODEL, [TYPE, TABLET]], [/(kf[A-z]+)\\sbuild\\/.+silk\\//i // Kindle Fire HD\n        ], [MODEL, [VENDOR, 'Amazon'], [TYPE, TABLET]], [/(sd|kf)[0349hijorstuw]+\\sbuild\\/.+silk\\//i // Fire Phone\n        ], [[MODEL, mapper.str, maps.device.amazon.model], [VENDOR, 'Amazon'], [TYPE, MOBILE]], [/android.+aft([bms])\\sbuild/i // Fire TV\n        ], [MODEL, [VENDOR, 'Amazon'], [TYPE, SMARTTV]], [/\\((ip[honed|\\s\\w*]+);.+(apple)/i // iPod/iPhone\n        ], [MODEL, VENDOR, [TYPE, MOBILE]], [/\\((ip[honed|\\s\\w*]+);/i // iPod/iPhone\n        ], [MODEL, [VENDOR, 'Apple'], [TYPE, MOBILE]], [/(blackberry)[\\s-]?(\\w+)/i, // BlackBerry\n        /(blackberry|benq|palm(?=\\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\\s_-]?([\\w-]*)/i, // BenQ/Palm/Sony-Ericsson/Acer/Asus/Dell/Meizu/Motorola/Polytron\n        /(hp)\\s([\\w\\s]+\\w)/i, // HP iPAQ\n        /(asus)-?(\\w+)/i // Asus\n        ], [VENDOR, MODEL, [TYPE, MOBILE]], [/\\(bb10;\\s(\\w+)/i // BlackBerry 10\n        ], [MODEL, [VENDOR, 'BlackBerry'], [TYPE, MOBILE]], [// Asus Tablets\n        /android.+(transfo[prime\\s]{4,10}\\s\\w+|eeepc|slider\\s\\w+|nexus 7|padfone|p00c)/i], [MODEL, [VENDOR, 'Asus'], [TYPE, TABLET]], [/(sony)\\s(tablet\\s[ps])\\sbuild\\//i, // Sony\n        /(sony)?(?:sgp.+)\\sbuild\\//i], [[VENDOR, 'Sony'], [MODEL, 'Xperia Tablet'], [TYPE, TABLET]], [/android.+\\s([c-g]\\d{4}|so[-l]\\w+)(?=\\sbuild\\/|\\).+chrome\\/(?![1-6]{0,1}\\d\\.))/i], [MODEL, [VENDOR, 'Sony'], [TYPE, MOBILE]], [/\\s(ouya)\\s/i, // Ouya\n        /(nintendo)\\s([wids3u]+)/i // Nintendo\n        ], [VENDOR, MODEL, [TYPE, CONSOLE]], [/android.+;\\s(shield)\\sbuild/i // Nvidia\n        ], [MODEL, [VENDOR, 'Nvidia'], [TYPE, CONSOLE]], [/(playstation\\s[34portablevi]+)/i // Playstation\n        ], [MODEL, [VENDOR, 'Sony'], [TYPE, CONSOLE]], [/(sprint\\s(\\w+))/i // Sprint Phones\n        ], [[VENDOR, mapper.str, maps.device.sprint.vendor], [MODEL, mapper.str, maps.device.sprint.model], [TYPE, MOBILE]], [/(htc)[;_\\s-]+([\\w\\s]+(?=\\)|\\sbuild)|\\w+)/i, // HTC\n        /(zte)-(\\w*)/i, // ZTE\n        /(alcatel|geeksphone|nexian|panasonic|(?=;\\s)sony)[_\\s-]?([\\w-]*)/i // Alcatel/GeeksPhone/Nexian/Panasonic/Sony\n        ], [VENDOR, [MODEL, /_/g, ' '], [TYPE, MOBILE]], [/(nexus\\s9)/i // HTC Nexus 9\n        ], [MODEL, [VENDOR, 'HTC'], [TYPE, TABLET]], [/d\\/huawei([\\w\\s-]+)[;\\)]/i, /(nexus\\s6p|vog-l29|ane-lx1|eml-l29)/i // Huawei\n        ], [MODEL, [VENDOR, 'Huawei'], [TYPE, MOBILE]], [/android.+(bah2?-a?[lw]\\d{2})/i // Huawei MediaPad\n        ], [MODEL, [VENDOR, 'Huawei'], [TYPE, TABLET]], [/(microsoft);\\s(lumia[\\s\\w]+)/i // Microsoft Lumia\n        ], [VENDOR, MODEL, [TYPE, MOBILE]], [/[\\s\\(;](xbox(?:\\sone)?)[\\s\\);]/i // Microsoft Xbox\n        ], [MODEL, [VENDOR, 'Microsoft'], [TYPE, CONSOLE]], [/(kin\\.[onetw]{3})/i // Microsoft Kin\n        ], [[MODEL, /\\./g, ' '], [VENDOR, 'Microsoft'], [TYPE, MOBILE]], [// Motorola\n        /\\s(milestone|droid(?:[2-4x]|\\s(?:bionic|x2|pro|razr))?:?(\\s4g)?)[\\w\\s]+build\\//i, /mot[\\s-]?(\\w*)/i, /(XT\\d{3,4}) build\\//i, /(nexus\\s6)/i], [MODEL, [VENDOR, 'Motorola'], [TYPE, MOBILE]], [/android.+\\s(mz60\\d|xoom[\\s2]{0,2})\\sbuild\\//i], [MODEL, [VENDOR, 'Motorola'], [TYPE, TABLET]], [/hbbtv\\/\\d+\\.\\d+\\.\\d+\\s+\\([\\w\\s]*;\\s*(\\w[^;]*);([^;]*)/i // HbbTV devices\n        ], [[VENDOR, util.trim], [MODEL, util.trim], [TYPE, SMARTTV]], [/hbbtv.+maple;(\\d+)/i], [[MODEL, /^/, 'SmartTV'], [VENDOR, 'Samsung'], [TYPE, SMARTTV]], [/\\(dtv[\\);].+(aquos)/i // Sharp\n        ], [MODEL, [VENDOR, 'Sharp'], [TYPE, SMARTTV]], [/android.+((sch-i[89]0\\d|shw-m380s|gt-p\\d{4}|gt-n\\d+|sgh-t8[56]9|nexus 10))/i, /((SM-T\\w+))/i], [[VENDOR, 'Samsung'], MODEL, [TYPE, TABLET]], [// Samsung\n        /smart-tv.+(samsung)/i], [VENDOR, [TYPE, SMARTTV], MODEL], [/((s[cgp]h-\\w+|gt-\\w+|galaxy\\snexus|sm-\\w[\\w\\d]+))/i, /(sam[sung]*)[\\s-]*(\\w+-?[\\w-]*)/i, /sec-((sgh\\w+))/i], [[VENDOR, 'Samsung'], MODEL, [TYPE, MOBILE]], [/sie-(\\w*)/i // Siemens\n        ], [MODEL, [VENDOR, 'Siemens'], [TYPE, MOBILE]], [/(maemo|nokia).*(n900|lumia\\s\\d+)/i, // Nokia\n        /(nokia)[\\s_-]?([\\w-]*)/i], [[VENDOR, 'Nokia'], MODEL, [TYPE, MOBILE]], [/android[x\\d\\.\\s;]+\\s([ab][1-7]\\-?[0178a]\\d\\d?)/i // Acer\n        ], [MODEL, [VENDOR, 'Acer'], [TYPE, TABLET]], [/android.+([vl]k\\-?\\d{3})\\s+build/i // LG Tablet\n        ], [MODEL, [VENDOR, 'LG'], [TYPE, TABLET]], [/android\\s3\\.[\\s\\w;-]{10}(lg?)-([06cv9]{3,4})/i // LG Tablet\n        ], [[VENDOR, 'LG'], MODEL, [TYPE, TABLET]], [/(lg) netcast\\.tv/i // LG SmartTV\n        ], [VENDOR, MODEL, [TYPE, SMARTTV]], [/(nexus\\s[45])/i, // LG\n        /lg[e;\\s\\/-]+(\\w*)/i, /android.+lg(\\-?[\\d\\w]+)\\s+build/i], [MODEL, [VENDOR, 'LG'], [TYPE, MOBILE]], [/(lenovo)\\s?(s(?:5000|6000)(?:[\\w-]+)|tab(?:[\\s\\w]+))/i // Lenovo tablets\n        ], [VENDOR, MODEL, [TYPE, TABLET]], [/android.+(ideatab[a-z0-9\\-\\s]+)/i // Lenovo\n        ], [MODEL, [VENDOR, 'Lenovo'], [TYPE, TABLET]], [/(lenovo)[_\\s-]?([\\w-]+)/i], [VENDOR, MODEL, [TYPE, MOBILE]], [/linux;.+((jolla));/i // Jolla\n        ], [VENDOR, MODEL, [TYPE, MOBILE]], [/((pebble))app\\/[\\d\\.]+\\s/i // Pebble\n        ], [VENDOR, MODEL, [TYPE, WEARABLE]], [/android.+;\\s(oppo)\\s?([\\w\\s]+)\\sbuild/i // OPPO\n        ], [VENDOR, MODEL, [TYPE, MOBILE]], [/crkey/i // Google Chromecast\n        ], [[MODEL, 'Chromecast'], [VENDOR, 'Google'], [TYPE, SMARTTV]], [/android.+;\\s(glass)\\s\\d/i // Google Glass\n        ], [MODEL, [VENDOR, 'Google'], [TYPE, WEARABLE]], [/android.+;\\s(pixel c)[\\s)]/i // Google Pixel C\n        ], [MODEL, [VENDOR, 'Google'], [TYPE, TABLET]], [/android.+;\\s(pixel( [23])?( xl)?)[\\s)]/i // Google Pixel\n        ], [MODEL, [VENDOR, 'Google'], [TYPE, MOBILE]], [/android.+;\\s(\\w+)\\s+build\\/hm\\1/i, // Xiaomi Hongmi 'numeric' models\n        /android.+(hm[\\s\\-_]*note?[\\s_]*(?:\\d\\w)?)\\s+build/i, // Xiaomi Hongmi\n        /android.+(mi[\\s\\-_]*(?:a\\d|one|one[\\s_]plus|note lte)?[\\s_]*(?:\\d?\\w?)[\\s_]*(?:plus)?)\\s+build/i, // Xiaomi Mi\n        /android.+(redmi[\\s\\-_]*(?:note)?(?:[\\s_]*[\\w\\s]+))\\s+build/i // Redmi Phones\n        ], [[MODEL, /_/g, ' '], [VENDOR, 'Xiaomi'], [TYPE, MOBILE]], [/android.+(mi[\\s\\-_]*(?:pad)(?:[\\s_]*[\\w\\s]+))\\s+build/i // Mi Pad tablets\n        ], [[MODEL, /_/g, ' '], [VENDOR, 'Xiaomi'], [TYPE, TABLET]], [/android.+;\\s(m[1-5]\\snote)\\sbuild/i // Meizu\n        ], [MODEL, [VENDOR, 'Meizu'], [TYPE, MOBILE]], [/(mz)-([\\w-]{2,})/i], [[VENDOR, 'Meizu'], MODEL, [TYPE, MOBILE]], [/android.+a000(1)\\s+build/i, // OnePlus\n        /android.+oneplus\\s(a\\d{4})[\\s)]/i], [MODEL, [VENDOR, 'OnePlus'], [TYPE, MOBILE]], [/android.+[;\\/]\\s*(RCT[\\d\\w]+)\\s+build/i // RCA Tablets\n        ], [MODEL, [VENDOR, 'RCA'], [TYPE, TABLET]], [/android.+[;\\/\\s]+(Venue[\\d\\s]{2,7})\\s+build/i // Dell Venue Tablets\n        ], [MODEL, [VENDOR, 'Dell'], [TYPE, TABLET]], [/android.+[;\\/]\\s*(Q[T|M][\\d\\w]+)\\s+build/i // Verizon Tablet\n        ], [MODEL, [VENDOR, 'Verizon'], [TYPE, TABLET]], [/android.+[;\\/]\\s+(Barnes[&\\s]+Noble\\s+|BN[RT])(V?.*)\\s+build/i // Barnes & Noble Tablet\n        ], [[VENDOR, 'Barnes & Noble'], MODEL, [TYPE, TABLET]], [/android.+[;\\/]\\s+(TM\\d{3}.*\\b)\\s+build/i // Barnes & Noble Tablet\n        ], [MODEL, [VENDOR, 'NuVision'], [TYPE, TABLET]], [/android.+;\\s(k88)\\sbuild/i // ZTE K Series Tablet\n        ], [MODEL, [VENDOR, 'ZTE'], [TYPE, TABLET]], [/android.+[;\\/]\\s*(gen\\d{3})\\s+build.*49h/i // Swiss GEN Mobile\n        ], [MODEL, [VENDOR, 'Swiss'], [TYPE, MOBILE]], [/android.+[;\\/]\\s*(zur\\d{3})\\s+build/i // Swiss ZUR Tablet\n        ], [MODEL, [VENDOR, 'Swiss'], [TYPE, TABLET]], [/android.+[;\\/]\\s*((Zeki)?TB.*\\b)\\s+build/i // Zeki Tablets\n        ], [MODEL, [VENDOR, 'Zeki'], [TYPE, TABLET]], [/(android).+[;\\/]\\s+([YR]\\d{2})\\s+build/i, /android.+[;\\/]\\s+(Dragon[\\-\\s]+Touch\\s+|DT)(\\w{5})\\sbuild/i // Dragon Touch Tablet\n        ], [[VENDOR, 'Dragon Touch'], MODEL, [TYPE, TABLET]], [/android.+[;\\/]\\s*(NS-?\\w{0,9})\\sbuild/i // Insignia Tablets\n        ], [MODEL, [VENDOR, 'Insignia'], [TYPE, TABLET]], [/android.+[;\\/]\\s*((NX|Next)-?\\w{0,9})\\s+build/i // NextBook Tablets\n        ], [MODEL, [VENDOR, 'NextBook'], [TYPE, TABLET]], [/android.+[;\\/]\\s*(Xtreme\\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\\s+build/i], [[VENDOR, 'Voice'], MODEL, [TYPE, MOBILE]], [// Voice Xtreme Phones\n        /android.+[;\\/]\\s*(LVTEL\\-)?(V1[12])\\s+build/i // LvTel Phones\n        ], [[VENDOR, 'LvTel'], MODEL, [TYPE, MOBILE]], [/android.+;\\s(PH-1)\\s/i], [MODEL, [VENDOR, 'Essential'], [TYPE, MOBILE]], [// Essential PH-1\n        /android.+[;\\/]\\s*(V(100MD|700NA|7011|917G).*\\b)\\s+build/i // Envizen Tablets\n        ], [MODEL, [VENDOR, 'Envizen'], [TYPE, TABLET]], [/android.+[;\\/]\\s*(Le[\\s\\-]+Pan)[\\s\\-]+(\\w{1,9})\\s+build/i // Le Pan Tablets\n        ], [VENDOR, MODEL, [TYPE, TABLET]], [/android.+[;\\/]\\s*(Trio[\\s\\-]*.*)\\s+build/i // MachSpeed Tablets\n        ], [MODEL, [VENDOR, 'MachSpeed'], [TYPE, TABLET]], [/android.+[;\\/]\\s*(Trinity)[\\-\\s]*(T\\d{3})\\s+build/i // Trinity Tablets\n        ], [VENDOR, MODEL, [TYPE, TABLET]], [/android.+[;\\/]\\s*TU_(1491)\\s+build/i // Rotor Tablets\n        ], [MODEL, [VENDOR, 'Rotor'], [TYPE, TABLET]], [/android.+(KS(.+))\\s+build/i // Amazon Kindle Tablets\n        ], [MODEL, [VENDOR, 'Amazon'], [TYPE, TABLET]], [/android.+(Gigaset)[\\s\\-]+(Q\\w{1,9})\\s+build/i // Gigaset Tablets\n        ], [VENDOR, MODEL, [TYPE, TABLET]], [/\\s(tablet|tab)[;\\/]/i, // Unidentifiable Tablet\n        /\\s(mobile)(?:[;\\/]|\\ssafari)/i // Unidentifiable Mobile\n        ], [[TYPE, util.lowerize], VENDOR, MODEL], [/[\\s\\/\\(](smart-?tv)[;\\)]/i // SmartTV\n        ], [[TYPE, SMARTTV]], [/(android[\\w\\.\\s\\-]{0,9});.+build/i // Generic Android Device\n        ], [MODEL, [VENDOR, 'Generic']]],\n        engine: [[/windows.+\\sedge\\/([\\w\\.]+)/i // EdgeHTML\n        ], [VERSION, [NAME, 'EdgeHTML']], [/webkit\\/537\\.36.+chrome\\/(?!27)([\\w\\.]+)/i // Blink\n        ], [VERSION, [NAME, 'Blink']], [/(presto)\\/([\\w\\.]+)/i, // Presto\n        /(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\\/([\\w\\.]+)/i, // WebKit/Trident/NetFront/NetSurf/Amaya/Lynx/w3m/Goanna\n        /(khtml|tasman|links)[\\/\\s]\\(?([\\w\\.]+)/i, // KHTML/Tasman/Links\n        /(icab)[\\/\\s]([23]\\.[\\d\\.]+)/i // iCab\n        ], [NAME, VERSION], [/rv\\:([\\w\\.]{1,9}).+(gecko)/i // Gecko\n        ], [VERSION, NAME]],\n        os: [[// Windows based\n        /microsoft\\s(windows)\\s(vista|xp)/i // Windows (iTunes)\n        ], [NAME, VERSION], [/(windows)\\snt\\s6\\.2;\\s(arm)/i, // Windows RT\n        /(windows\\sphone(?:\\sos)*)[\\s\\/]?([\\d\\.\\s\\w]*)/i, // Windows Phone\n        /(windows\\smobile|windows)[\\s\\/]?([ntce\\d\\.\\s]+\\w)/i], [[NAME, mapper.str, maps.os.windows.name], [VERSION, mapper.str, maps.os.windows.version]], [/(win(?=3|9|n)|win\\s9x\\s)([nt\\d\\.]+)/i], [[NAME, 'Windows'], [VERSION, mapper.str, maps.os.windows.version]], [// Mobile/Embedded OS\n        /\\((bb)(10);/i // BlackBerry 10\n        ], [[NAME, 'BlackBerry'], VERSION], [/(blackberry)\\w*\\/?([\\w\\.]*)/i, // Blackberry\n        /(tizen|kaios)[\\/\\s]([\\w\\.]+)/i, // Tizen/KaiOS\n        /(android|webos|palm\\sos|qnx|bada|rim\\stablet\\sos|meego|sailfish|contiki)[\\/\\s-]?([\\w\\.]*)/i // Android/WebOS/Palm/QNX/Bada/RIM/MeeGo/Contiki/Sailfish OS\n        ], [NAME, VERSION], [/(symbian\\s?os|symbos|s60(?=;))[\\/\\s-]?([\\w\\.]*)/i // Symbian\n        ], [[NAME, 'Symbian'], VERSION], [/\\((series40);/i // Series 40\n        ], [NAME], [/mozilla.+\\(mobile;.+gecko.+firefox/i // Firefox OS\n        ], [[NAME, 'Firefox OS'], VERSION], [// Console\n        /(nintendo|playstation)\\s([wids34portablevu]+)/i, // Nintendo/Playstation\n        // GNU/Linux based\n        /(mint)[\\/\\s\\(]?(\\w*)/i, // Mint\n        /(mageia|vectorlinux)[;\\s]/i, // Mageia/VectorLinux\n        /(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\\/\\s-]?(?!chrom)([\\w\\.-]*)/i, // Joli/Ubuntu/Debian/SUSE/Gentoo/Arch/Slackware\n        // Fedora/Mandriva/CentOS/PCLinuxOS/RedHat/Zenwalk/Linpus\n        /(hurd|linux)\\s?([\\w\\.]*)/i, // Hurd/Linux\n        /(gnu)\\s?([\\w\\.]*)/i // GNU\n        ], [[NAME, 'Linux'], VERSION], [/(cros)\\s[\\w]+\\s([\\w\\.]+\\w)/i // Chromium OS\n        ], [[NAME, 'Chromium OS'], VERSION], [// Solaris\n        /(sunos)\\s?([\\w\\.\\d]*)/i // Solaris\n        ], [[NAME, 'Solaris'], VERSION], [// BSD based\n        /\\s([frentopc-]{0,4}bsd|dragonfly)\\s?([\\w\\.]*)/i // FreeBSD/NetBSD/OpenBSD/PC-BSD/DragonFly\n        ], [[NAME, 'Linux'], VERSION], [/(iphone)(?:.*os\\s*([\\w]*)\\slike\\smac|;\\sopera)/i // iOS\n        ], [[NAME, 'iPhone'], [VERSION, /_/g, '.']], [/(ipad)(?:.*os\\s*([\\w]*)\\slike\\smac|;\\sopera)/i // iOS\n        ], [[NAME, 'iPad'], [VERSION, /_/g, '.']], [/(haiku)\\s(\\w+)/i // Haiku\n        ], [NAME, VERSION], [/cfnetwork\\/.+darwin/i, /ip[honead]{2,4}(?:.*os\\s([\\w]+)\\slike\\smac|;\\sopera)/i // iOS\n        ], [[VERSION, /_/g, '.'], [NAME, 'iOS']], [/(mac\\sos\\sx)\\s?([\\w\\s\\.]*)/i, /(macintosh|mac(?=_powerpc)\\s)/i // Mac OS\n        ], [[NAME, 'Mac'], [VERSION, /_/g, '.']], [// Other\n        /((?:open)?solaris)[\\/\\s-]?([\\w\\.]*)/i, // Solaris\n        /(aix)\\s((\\d)(?=\\.|\\)|\\s)[\\w\\.])*/i, // AIX\n        /(plan\\s9|minix|beos|os\\/2|amigaos|morphos|risc\\sos|openvms|fuchsia)/i, // Plan9/Minix/BeOS/OS2/AmigaOS/MorphOS/RISCOS/OpenVMS/Fuchsia\n        /(unix)\\s?([\\w\\.]*)/i // UNIX\n        ], [NAME, VERSION]]\n      }; /////////////////\n      // Constructor\n      ////////////////\n\n      var UAParser = function UAParser(uastring, extensions) {\n        if (typeof uastring === 'object') {\n          extensions = uastring;\n          uastring = undefined$1;\n        }\n\n        if (!(this instanceof UAParser)) {\n          return new UAParser(uastring, extensions).getResult();\n        }\n\n        var ua = uastring || (window && window.navigator && window.navigator.userAgent ? window.navigator.userAgent : EMPTY);\n        var rgxmap = extensions ? util.extend(regexes, extensions) : regexes;\n\n        this.getBrowser = function () {\n          var browser = {\n            name: undefined$1,\n            version: undefined$1\n          };\n          mapper.rgx.call(browser, ua, rgxmap.browser);\n          browser.major = util.major(browser.version); // deprecated\n\n          return browser;\n        };\n\n        this.getCPU = function () {\n          var cpu = {\n            architecture: undefined$1\n          };\n          mapper.rgx.call(cpu, ua, rgxmap.cpu);\n          return cpu;\n        };\n\n        this.getDevice = function () {\n          var device = {\n            vendor: undefined$1,\n            model: undefined$1,\n            type: undefined$1\n          };\n          mapper.rgx.call(device, ua, rgxmap.device);\n          return device;\n        };\n\n        this.getEngine = function () {\n          var engine = {\n            name: undefined$1,\n            version: undefined$1\n          };\n          mapper.rgx.call(engine, ua, rgxmap.engine);\n          return engine;\n        };\n\n        this.getOS = function () {\n          var os = {\n            name: undefined$1,\n            version: undefined$1\n          };\n          mapper.rgx.call(os, ua, rgxmap.os);\n          return os;\n        };\n\n        this.getResult = function () {\n          return {\n            ua: this.getUA(),\n            browser: this.getBrowser(),\n            engine: this.getEngine(),\n            os: this.getOS(),\n            device: this.getDevice(),\n            cpu: this.getCPU()\n          };\n        };\n\n        this.getUA = function () {\n          return ua;\n        };\n\n        this.setUA = function (uastring) {\n          ua = uastring;\n          return this;\n        };\n\n        return this;\n      };\n\n      UAParser.VERSION = LIBVERSION;\n      UAParser.BROWSER = {\n        NAME: NAME,\n        MAJOR: MAJOR,\n        // deprecated\n        VERSION: VERSION\n      };\n      UAParser.CPU = {\n        ARCHITECTURE: ARCHITECTURE\n      };\n      UAParser.DEVICE = {\n        MODEL: MODEL,\n        VENDOR: VENDOR,\n        TYPE: TYPE,\n        CONSOLE: CONSOLE,\n        MOBILE: MOBILE,\n        SMARTTV: SMARTTV,\n        TABLET: TABLET,\n        WEARABLE: WEARABLE,\n        EMBEDDED: EMBEDDED\n      };\n      UAParser.ENGINE = {\n        NAME: NAME,\n        VERSION: VERSION\n      };\n      UAParser.OS = {\n        NAME: NAME,\n        VERSION: VERSION\n      }; ///////////\n      // Export\n      //////////\n      // check js environment\n\n      {\n        // nodejs env\n        if (module.exports) {\n          exports = module.exports = UAParser;\n        }\n\n        exports.UAParser = UAParser;\n      } // jQuery/Zepto specific (optional)\n      // Note:\n      //   In AMD env the global scope should be kept clean, but jQuery is an exception.\n      //   jQuery always exports to global scope, unless jQuery.noConflict(true) is used,\n      //   and we should catch that.\n\n      var $ = window && (window.jQuery || window.Zepto);\n\n      if ($ && !$.ua) {\n        var parser = new UAParser();\n        $.ua = parser.getResult();\n\n        $.ua.get = function () {\n          return parser.getUA();\n        };\n\n        $.ua.set = function (uastring) {\n          parser.setUA(uastring);\n          var result = parser.getResult();\n\n          for (var prop in result) {\n            $.ua[prop] = result[prop];\n          }\n        };\n      }\n    })(typeof window === 'object' ? window : commonjsGlobal);\n  });\n  var uaParser_1 = uaParser.UAParser;\n  /* jshint bitwise: false, laxbreak: true */\n\n  /**\n   * Source: [jed's gist]{@link https://gist.github.com/982883}.\n   * Returns a random v4 UUID of the form xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx,\n   * where each x is replaced with a random hexadecimal digit from 0 to f, and\n   * y is replaced with a random hexadecimal digit from 8 to b.\n   * Used to generate UUIDs for deviceIds.\n   * @private\n   */\n\n  var uuid = function uuid(a) {\n    return a // if the placeholder was passed, return\n    ? ( // a random number from 0 to 15\n    a ^ // unless b is 8,\n    Math.random() // in which case\n    * 16 // a random number from\n    >> a / 4 // 8 to 11\n    ).toString(16) // in hexadecimal\n    : ( // or otherwise a concatenated string:\n    [1e7] + // 10000000 +\n    -1e3 + // -1000 +\n    -4e3 + // -4000 +\n    -8e3 + // -80000000 +\n    -1e11 // -100000000000,\n    ).replace( // replacing\n    /[018]/g, // zeroes, ones, and eights with\n    uuid // random hex digits\n    );\n  };\n\n  var version = \"7.1.1\";\n\n  var getLanguage = function getLanguage() {\n    return navigator && (navigator.languages && navigator.languages[0] || navigator.language || navigator.userLanguage) || '';\n  };\n\n  var language = {\n    getLanguage: getLanguage\n  };\n  var platform = 'Web';\n  var DEFAULT_OPTIONS = {\n    apiEndpoint: 'api.amplitude.com',\n    batchEvents: false,\n    cookieExpiration: 365 * 10,\n    cookieName: 'amplitude_id',\n    // this is a deprecated option\n    sameSiteCookie: 'Lax',\n    // cookie privacy policy\n    cookieForceUpgrade: false,\n    deferInitialization: false,\n    disableCookies: false,\n    deviceIdFromUrlParam: false,\n    domain: '',\n    eventUploadPeriodMillis: 30 * 1000,\n    // 30s\n    eventUploadThreshold: 30,\n    forceHttps: true,\n    includeGclid: false,\n    includeReferrer: false,\n    includeUtm: false,\n    language: language.getLanguage(),\n    logLevel: 'WARN',\n    optOut: false,\n    onError: function onError() {},\n    platform: platform,\n    savedMaxCount: 1000,\n    saveEvents: true,\n    saveParamsReferrerOncePerSession: true,\n    secureCookie: false,\n    sessionTimeout: 30 * 60 * 1000,\n    trackingOptions: {\n      city: true,\n      country: true,\n      carrier: true,\n      device_manufacturer: true,\n      device_model: true,\n      dma: true,\n      ip_address: true,\n      language: true,\n      os_name: true,\n      os_version: true,\n      platform: true,\n      region: true,\n      version_name: true\n    },\n    unsetParamsReferrerOnNewSession: false,\n    unsentKey: 'amplitude_unsent',\n    unsentIdentifyKey: 'amplitude_unsent_identify',\n    uploadBatchSize: 100\n  };\n  var AsyncStorage;\n  var DeviceInfo;\n  /**\n   * AmplitudeClient SDK API - instance constructor.\n   * The Amplitude class handles creation of client instances, all you need to do is call amplitude.getInstance()\n   * @constructor AmplitudeClient\n   * @public\n   * @example var amplitudeClient = new AmplitudeClient();\n   */\n\n  var AmplitudeClient = function AmplitudeClient(instanceName) {\n    this._instanceName = utils.isEmptyString(instanceName) ? Constants.DEFAULT_INSTANCE : instanceName.toLowerCase();\n    this._unsentEvents = [];\n    this._unsentIdentifys = [];\n    this._ua = new uaParser(navigator.userAgent).getResult();\n    this.options = _objectSpread({}, DEFAULT_OPTIONS, {\n      trackingOptions: _objectSpread({}, DEFAULT_OPTIONS.trackingOptions)\n    });\n    this.cookieStorage = new cookieStorage().getStorage();\n    this._q = []; // queue for proxied functions before script load\n\n    this._sending = false;\n    this._updateScheduled = false;\n    this._onInit = []; // event meta data\n\n    this._eventId = 0;\n    this._identifyId = 0;\n    this._lastEventTime = null;\n    this._newSession = false; // sequence used for by frontend for prioritizing event send retries\n\n    this._sequenceNumber = 0;\n    this._sessionId = null;\n    this._isInitialized = false;\n    this._userAgent = navigator && navigator.userAgent || null;\n  };\n\n  AmplitudeClient.prototype.Identify = Identify;\n  AmplitudeClient.prototype.Revenue = Revenue;\n  /**\n   * Initializes the Amplitude Javascript SDK with your apiKey and any optional configurations.\n   * This is required before any other methods can be called.\n   * @public\n   * @param {string} apiKey - The API key for your app.\n   * @param {string} opt_userId - (optional) An identifier for this user.\n   * @param {object} opt_config - (optional) Configuration options.\n   * See [Readme]{@link https://github.com/amplitude/Amplitude-Javascript#configuration-options} for list of options and default values.\n   * @param {function} opt_callback - (optional) Provide a callback function to run after initialization is complete.\n   * @example amplitudeClient.init('API_KEY', 'USER_ID', {includeReferrer: true, includeUtm: true}, function() { alert('init complete'); });\n   */\n\n  AmplitudeClient.prototype.init = function init(apiKey, opt_userId, opt_config, opt_callback) {\n    var _this = this;\n\n    if (type(apiKey) !== 'string' || utils.isEmptyString(apiKey)) {\n      utils.log.error('Invalid apiKey. Please re-initialize with a valid apiKey');\n      return;\n    }\n\n    try {\n      _parseConfig(this.options, opt_config);\n\n      if (this.options.cookieName !== DEFAULT_OPTIONS.cookieName) {\n        utils.log.warn('The cookieName option is deprecated. We will be ignoring it for newer cookies');\n      }\n\n      this.options.apiKey = apiKey;\n      this._storageSuffix = '_' + apiKey + (this._instanceName === Constants.DEFAULT_INSTANCE ? '' : '_' + this._instanceName);\n      this._storageSuffixV5 = apiKey.slice(0, 6);\n      this._oldCookiename = this.options.cookieName + this._storageSuffix;\n      this._unsentKey = this.options.unsentKey + this._storageSuffix;\n      this._unsentIdentifyKey = this.options.unsentIdentifyKey + this._storageSuffix;\n      this._cookieName = Constants.COOKIE_PREFIX + '_' + this._storageSuffixV5;\n      this.cookieStorage.options({\n        expirationDays: this.options.cookieExpiration,\n        domain: this.options.domain,\n        secure: this.options.secureCookie,\n        sameSite: this.options.sameSiteCookie\n      });\n      this._metadataStorage = new MetadataStorage({\n        storageKey: this._cookieName,\n        disableCookies: this.options.disableCookies,\n        expirationDays: this.options.cookieExpiration,\n        domain: this.options.domain,\n        secure: this.options.secureCookie,\n        sameSite: this.options.sameSiteCookie\n      });\n      var hasOldCookie = !!this.cookieStorage.get(this._oldCookiename);\n      var hasNewCookie = !!this._metadataStorage.load();\n      this._useOldCookie = !hasNewCookie && hasOldCookie && !this.options.cookieForceUpgrade;\n      var hasCookie = hasNewCookie || hasOldCookie;\n      this.options.domain = this.cookieStorage.options().domain;\n\n      if (this.options.deferInitialization && !hasCookie) {\n        this._deferInitialization(apiKey, opt_userId, opt_config, opt_callback);\n\n        return;\n      }\n\n      if (type(this.options.logLevel) === 'string') {\n        utils.setLogLevel(this.options.logLevel);\n      }\n\n      var trackingOptions = _generateApiPropertiesTrackingConfig(this);\n\n      this._apiPropertiesTrackingOptions = Object.keys(trackingOptions).length > 0 ? {\n        tracking_options: trackingOptions\n      } : {};\n\n      if (this.options.cookieForceUpgrade && hasOldCookie) {\n        if (!hasNewCookie) {\n          _upgradeCookieData(this);\n        }\n\n        this.cookieStorage.remove(this._oldCookiename);\n      }\n\n      _loadCookieData(this);\n\n      this._pendingReadStorage = true;\n\n      var initFromStorage = function initFromStorage(storedDeviceId) {\n        _this.options.deviceId = _this._getInitialDeviceId(opt_config && opt_config.deviceId, storedDeviceId);\n        _this.options.userId = type(opt_userId) === 'string' && !utils.isEmptyString(opt_userId) && opt_userId || type(opt_userId) === 'number' && opt_userId.toString() || _this.options.userId || null;\n        var now = new Date().getTime();\n\n        if (!_this._sessionId || !_this._lastEventTime || now - _this._lastEventTime > _this.options.sessionTimeout) {\n          if (_this.options.unsetParamsReferrerOnNewSession) {\n            _this._unsetUTMParams();\n          }\n\n          _this._newSession = true;\n          _this._sessionId = now; // only capture UTM params and referrer if new session\n\n          if (_this.options.saveParamsReferrerOncePerSession) {\n            _this._trackParamsAndReferrer();\n          }\n        }\n\n        if (!_this.options.saveParamsReferrerOncePerSession) {\n          _this._trackParamsAndReferrer();\n        } // load unsent events and identifies before any attempt to log new ones\n\n\n        if (_this.options.saveEvents) {\n          _validateUnsentEventQueue(_this._unsentEvents);\n\n          _validateUnsentEventQueue(_this._unsentIdentifys);\n        }\n\n        _this._lastEventTime = now;\n\n        _saveCookieData(_this);\n\n        _this._pendingReadStorage = false;\n\n        _this._sendEventsIfReady(); // try sending unsent events\n\n\n        for (var i = 0; i < _this._onInit.length; i++) {\n          _this._onInit[i](_this);\n        }\n\n        _this._onInit = [];\n        _this._isInitialized = true;\n      };\n\n      if (AsyncStorage) {\n        this._migrateUnsentEvents(function () {\n          Promise.all([AsyncStorage.getItem(_this._storageSuffix), AsyncStorage.getItem(_this.options.unsentKey + _this._storageSuffix), AsyncStorage.getItem(_this.options.unsentIdentifyKey + _this._storageSuffix)]).then(function (values) {\n            if (values[0]) {\n              var cookieData = JSON.parse(values[0]);\n\n              if (cookieData) {\n                _loadCookieDataProps(_this, cookieData);\n              }\n            }\n\n            if (_this.options.saveEvents) {\n              _this._unsentEvents = _this._parseSavedUnsentEventsString(values[1]).map(function (event) {\n                return {\n                  event: event\n                };\n              }).concat(_this._unsentEvents);\n              _this._unsentIdentifys = _this._parseSavedUnsentEventsString(values[2]).map(function (event) {\n                return {\n                  event: event\n                };\n              }).concat(_this._unsentIdentifys);\n            }\n\n            if (DeviceInfo) {\n              Promise.all([DeviceInfo.getCarrier(), DeviceInfo.getModel(), DeviceInfo.getManufacturer(), DeviceInfo.getVersion(), DeviceInfo.getUniqueId()]).then(function (values) {\n                _this.deviceInfo = {\n                  carrier: values[0],\n                  model: values[1],\n                  manufacturer: values[2],\n                  version: values[3]\n                };\n                initFromStorage(values[4]);\n\n                _this.runQueuedFunctions();\n\n                if (type(opt_callback) === 'function') {\n                  opt_callback(_this);\n                }\n              })[\"catch\"](function (err) {\n                _this.options.onError(err);\n              });\n            } else {\n              initFromStorage();\n\n              _this.runQueuedFunctions();\n            }\n          })[\"catch\"](function (err) {\n            _this.options.onError(err);\n          });\n        });\n      } else {\n        if (this.options.saveEvents) {\n          this._unsentEvents = this._loadSavedUnsentEvents(this.options.unsentKey).map(function (event) {\n            return {\n              event: event\n            };\n          }).concat(this._unsentEvents);\n          this._unsentIdentifys = this._loadSavedUnsentEvents(this.options.unsentIdentifyKey).map(function (event) {\n            return {\n              event: event\n            };\n          }).concat(this._unsentIdentifys);\n        }\n\n        initFromStorage();\n        this.runQueuedFunctions();\n\n        if (type(opt_callback) === 'function') {\n          opt_callback(this);\n        }\n      }\n    } catch (err) {\n      utils.log.error(err);\n      this.options.onError(err);\n    }\n  };\n\n  AmplitudeClient.prototype.deleteLowerLevelDomainCookies = function () {\n    var host = getHost();\n    var cookieHost = this.options.domain && this.options.domain[0] === '.' ? this.options.domain.slice(1) : this.options.domain;\n\n    if (!cookieHost) {\n      return;\n    }\n\n    if (host !== cookieHost) {\n      if (new RegExp(cookieHost + '$').test(host)) {\n        var hostParts = host.split('.');\n        var cookieHostParts = cookieHost.split('.');\n\n        for (var i = hostParts.length; i > cookieHostParts.length; --i) {\n          var deleteDomain = hostParts.slice(hostParts.length - i).join('.');\n          baseCookie.set(this._cookieName, null, {\n            domain: '.' + deleteDomain\n          });\n        }\n\n        baseCookie.set(this._cookieName, null, {});\n      }\n    }\n  };\n\n  AmplitudeClient.prototype._getInitialDeviceId = function (configDeviceId, storedDeviceId) {\n    if (configDeviceId) {\n      return configDeviceId;\n    }\n\n    if (this.options.deviceIdFromUrlParam) {\n      return this._getDeviceIdFromUrlParam(this._getUrlParams());\n    }\n\n    if (this.options.deviceId) {\n      return this.options.deviceId;\n    }\n\n    if (storedDeviceId) {\n      return storedDeviceId;\n    }\n\n    return base64Id();\n  }; // validate properties for unsent events\n\n\n  var _validateUnsentEventQueue = function _validateUnsentEventQueue(queue) {\n    for (var i = 0; i < queue.length; i++) {\n      var userProperties = queue[i].event.user_properties;\n      var eventProperties = queue[i].event.event_properties;\n      var groups = queue[i].event.groups;\n      queue[i].event.user_properties = utils.validateProperties(userProperties);\n      queue[i].event.event_properties = utils.validateProperties(eventProperties);\n      queue[i].event.groups = utils.validateGroups(groups);\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._migrateUnsentEvents = function _migrateUnsentEvents(cb) {\n    var _this2 = this;\n\n    Promise.all([AsyncStorage.getItem(this.options.unsentKey), AsyncStorage.getItem(this.options.unsentIdentifyKey)]).then(function (values) {\n      if (_this2.options.saveEvents) {\n        var unsentEventsString = values[0];\n        var unsentIdentifyKey = values[1];\n        var itemsToSet = [];\n        var itemsToRemove = [];\n\n        if (!!unsentEventsString) {\n          itemsToSet.push(AsyncStorage.setItem(_this2.options.unsentKey + _this2._storageSuffix, JSON.stringify(unsentEventsString)));\n          itemsToRemove.push(AsyncStorage.removeItem(_this2.options.unsentKey));\n        }\n\n        if (!!unsentIdentifyKey) {\n          itemsToSet.push(AsyncStorage.setItem(_this2.options.unsentIdentifyKey + _this2._storageSuffix, JSON.stringify(unsentIdentifyKey)));\n          itemsToRemove.push(AsyncStorage.removeItem(_this2.options.unsentIdentifyKey));\n        }\n\n        if (itemsToSet.length > 0) {\n          Promise.all(itemsToSet).then(function () {})[\"catch\"](function (err) {\n            _this2.options.onError(err);\n          });\n        }\n      }\n    }).then(cb)[\"catch\"](function (err) {\n      _this2.options.onError(err);\n    });\n  };\n  /**\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._trackParamsAndReferrer = function _trackParamsAndReferrer() {\n    if (this.options.includeUtm) {\n      this._initUtmData();\n    }\n\n    if (this.options.includeReferrer) {\n      this._saveReferrer(this._getReferrer());\n    }\n\n    if (this.options.includeGclid) {\n      this._saveGclid(this._getUrlParams());\n    }\n  };\n  /**\n   * Parse and validate user specified config values and overwrite existing option value\n   * DEFAULT_OPTIONS provides list of all config keys that are modifiable, as well as expected types for values\n   * @private\n   */\n\n\n  var _parseConfig = function _parseConfig(options, config) {\n    if (type(config) !== 'object') {\n      return;\n    } // validates config value is defined, is the correct type, and some additional value sanity checks\n\n\n    var parseValidateAndLoad = function parseValidateAndLoad(key) {\n      if (!options.hasOwnProperty(key)) {\n        return; // skip bogus config values\n      }\n\n      var inputValue = config[key];\n      var expectedType = type(options[key]);\n\n      if (!utils.validateInput(inputValue, key + ' option', expectedType)) {\n        return;\n      }\n\n      if (expectedType === 'boolean') {\n        options[key] = !!inputValue;\n      } else if (expectedType === 'string' && !utils.isEmptyString(inputValue) || expectedType === 'number' && inputValue > 0) {\n        options[key] = inputValue;\n      } else if (expectedType === 'object') {\n        _parseConfig(options[key], inputValue);\n      }\n    };\n\n    for (var key in config) {\n      if (config.hasOwnProperty(key)) {\n        parseValidateAndLoad(key);\n      }\n    }\n  };\n  /**\n   * Run functions queued up by proxy loading snippet\n   * @private\n   */\n\n\n  AmplitudeClient.prototype.runQueuedFunctions = function () {\n    var queue = this._q;\n    this._q = [];\n\n    for (var i = 0; i < queue.length; i++) {\n      var fn = this[queue[i][0]];\n\n      if (type(fn) === 'function') {\n        fn.apply(this, queue[i].slice(1));\n      }\n    }\n  };\n  /**\n   * Check that the apiKey is set before calling a function. Logs a warning message if not set.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._apiKeySet = function _apiKeySet(methodName) {\n    if (utils.isEmptyString(this.options.apiKey)) {\n      utils.log.error('Invalid apiKey. Please set a valid apiKey with init() before calling ' + methodName);\n      return false;\n    }\n\n    return true;\n  };\n  /**\n   * Load saved events from localStorage. JSON deserializes event array. Handles case where string is corrupted.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._loadSavedUnsentEvents = function _loadSavedUnsentEvents(unsentKey) {\n    var savedUnsentEventsString = this._getFromStorage(localStorage$1, unsentKey);\n\n    var unsentEvents = this._parseSavedUnsentEventsString(savedUnsentEventsString, unsentKey);\n\n    this._setInStorage(localStorage$1, unsentKey, JSON.stringify(unsentEvents));\n\n    return unsentEvents;\n  };\n  /**\n   * Load saved events from localStorage. JSON deserializes event array. Handles case where string is corrupted.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._parseSavedUnsentEventsString = function _parseSavedUnsentEventsString(savedUnsentEventsString, unsentKey) {\n    if (utils.isEmptyString(savedUnsentEventsString)) {\n      return []; // new app, does not have any saved events\n    }\n\n    if (type(savedUnsentEventsString) === 'string') {\n      try {\n        var events = JSON.parse(savedUnsentEventsString);\n\n        if (type(events) === 'array') {\n          // handle case where JSON dumping of unsent events is corrupted\n          return events;\n        }\n      } catch (e) {}\n    }\n\n    utils.log.error('Unable to load ' + unsentKey + ' events. Restart with a new empty queue.');\n    return [];\n  };\n  /**\n   * Returns true if a new session was created during initialization, otherwise false.\n   * @public\n   * @return {boolean} Whether a new session was created during initialization.\n   */\n\n\n  AmplitudeClient.prototype.isNewSession = function isNewSession() {\n    return this._newSession;\n  };\n  /**\n   * Store callbacks to call after init\n   * @private\n   */\n\n\n  AmplitudeClient.prototype.onInit = function (callback) {\n    if (this._isInitialized) {\n      callback();\n    } else {\n      this._onInit.push(callback);\n    }\n  };\n  /**\n   * Returns the id of the current session.\n   * @public\n   * @return {number} Id of the current session.\n   */\n\n\n  AmplitudeClient.prototype.getSessionId = function getSessionId() {\n    return this._sessionId;\n  };\n  /**\n   * Increments the eventId and returns it.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype.nextEventId = function nextEventId() {\n    this._eventId++;\n    return this._eventId;\n  };\n  /**\n   * Increments the identifyId and returns it.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype.nextIdentifyId = function nextIdentifyId() {\n    this._identifyId++;\n    return this._identifyId;\n  };\n  /**\n   * Increments the sequenceNumber and returns it.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype.nextSequenceNumber = function nextSequenceNumber() {\n    this._sequenceNumber++;\n    return this._sequenceNumber;\n  };\n  /**\n   * Returns the total count of unsent events and identifys\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._unsentCount = function _unsentCount() {\n    return this._unsentEvents.length + this._unsentIdentifys.length;\n  };\n  /**\n   * Send events if ready. Returns true if events are sent.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._sendEventsIfReady = function _sendEventsIfReady() {\n    if (this._unsentCount() === 0) {\n      return false;\n    } // if batching disabled, send any unsent events immediately\n\n\n    if (!this.options.batchEvents) {\n      this.sendEvents();\n      return true;\n    } // if batching enabled, check if min threshold met for batch size\n\n\n    if (this._unsentCount() >= this.options.eventUploadThreshold) {\n      this.sendEvents();\n      return true;\n    } // otherwise schedule an upload after 30s\n\n\n    if (!this._updateScheduled) {\n      // make sure we only schedule 1 upload\n      this._updateScheduled = true;\n      setTimeout(function () {\n        this._updateScheduled = false;\n        this.sendEvents();\n      }.bind(this), this.options.eventUploadPeriodMillis);\n    }\n\n    return false; // an upload was scheduled, no events were uploaded\n  };\n  /**\n   * Helper function to fetch values from storage\n   * Storage argument allows for localStoraoge and sessionStoraoge\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._getFromStorage = function _getFromStorage(storage, key) {\n    return storage.getItem(key + this._storageSuffix);\n  };\n  /**\n   * Helper function to set values in storage\n   * Storage argument allows for localStoraoge and sessionStoraoge\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._setInStorage = function _setInStorage(storage, key, value) {\n    storage.setItem(key + this._storageSuffix, value);\n  };\n  /**\n   * Fetches deviceId, userId, event meta data from amplitude cookie\n   * @private\n   */\n\n\n  var _loadCookieData = function _loadCookieData(scope) {\n    if (!scope._useOldCookie) {\n      var props = scope._metadataStorage.load();\n\n      if (type(props) === 'object') {\n        _loadCookieDataProps(scope, props);\n      }\n\n      return;\n    }\n\n    var cookieData = scope.cookieStorage.get(scope._oldCookiename);\n\n    if (type(cookieData) === 'object') {\n      _loadCookieDataProps(scope, cookieData);\n\n      return;\n    }\n  };\n\n  var _upgradeCookieData = function _upgradeCookieData(scope) {\n    var cookieData = scope.cookieStorage.get(scope._oldCookiename);\n\n    if (type(cookieData) === 'object') {\n      _loadCookieDataProps(scope, cookieData);\n\n      _saveCookieData(scope);\n    }\n  };\n\n  var _loadCookieDataProps = function _loadCookieDataProps(scope, cookieData) {\n    if (cookieData.deviceId) {\n      scope.options.deviceId = cookieData.deviceId;\n    }\n\n    if (cookieData.userId) {\n      scope.options.userId = cookieData.userId;\n    }\n\n    if (cookieData.optOut !== null && cookieData.optOut !== undefined) {\n      // Do not clobber config opt out value if cookieData has optOut as false\n      if (cookieData.optOut !== false) {\n        scope.options.optOut = cookieData.optOut;\n      }\n    }\n\n    if (cookieData.sessionId) {\n      scope._sessionId = parseInt(cookieData.sessionId, 10);\n    }\n\n    if (cookieData.lastEventTime) {\n      scope._lastEventTime = parseInt(cookieData.lastEventTime, 10);\n    }\n\n    if (cookieData.eventId) {\n      scope._eventId = parseInt(cookieData.eventId, 10);\n    }\n\n    if (cookieData.identifyId) {\n      scope._identifyId = parseInt(cookieData.identifyId, 10);\n    }\n\n    if (cookieData.sequenceNumber) {\n      scope._sequenceNumber = parseInt(cookieData.sequenceNumber, 10);\n    }\n  };\n  /**\n   * Saves deviceId, userId, event meta data to amplitude cookie\n   * @private\n   */\n\n\n  var _saveCookieData = function _saveCookieData(scope) {\n    var cookieData = {\n      deviceId: scope.options.deviceId,\n      userId: scope.options.userId,\n      optOut: scope.options.optOut,\n      sessionId: scope._sessionId,\n      lastEventTime: scope._lastEventTime,\n      eventId: scope._eventId,\n      identifyId: scope._identifyId,\n      sequenceNumber: scope._sequenceNumber\n    };\n\n    if (AsyncStorage) {\n      AsyncStorage.setItem(scope._storageSuffix, JSON.stringify(cookieData));\n    }\n\n    if (scope._useOldCookie) {\n      scope.cookieStorage.set(scope.options.cookieName + scope._storageSuffix, cookieData);\n    } else {\n      scope._metadataStorage.save(cookieData);\n    }\n  };\n  /**\n   * Parse the utm properties out of cookies and query for adding to user properties.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._initUtmData = function _initUtmData(queryParams, cookieParams) {\n    queryParams = queryParams || this._getUrlParams();\n    cookieParams = cookieParams || this.cookieStorage.get('__utmz');\n    var utmProperties = getUtmData(cookieParams, queryParams);\n\n    _sendParamsReferrerUserProperties(this, utmProperties);\n  };\n  /**\n   * Unset the utm params from the Amplitude instance and update the identify.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._unsetUTMParams = function _unsetUTMParams() {\n    var identify = new Identify();\n    identify.unset(Constants.REFERRER);\n    identify.unset(Constants.UTM_SOURCE);\n    identify.unset(Constants.UTM_MEDIUM);\n    identify.unset(Constants.UTM_CAMPAIGN);\n    identify.unset(Constants.UTM_TERM);\n    identify.unset(Constants.UTM_CONTENT);\n    this.identify(identify);\n  };\n  /**\n   * The calling function should determine when it is appropriate to send these user properties. This function\n   * will no longer contain any session storage checking logic.\n   * @private\n   */\n\n\n  var _sendParamsReferrerUserProperties = function _sendParamsReferrerUserProperties(scope, userProperties) {\n    if (type(userProperties) !== 'object' || Object.keys(userProperties).length === 0) {\n      return;\n    } // setOnce the initial user properties\n\n\n    var identify = new Identify();\n\n    for (var key in userProperties) {\n      if (userProperties.hasOwnProperty(key)) {\n        identify.setOnce('initial_' + key, userProperties[key]);\n        identify.set(key, userProperties[key]);\n      }\n    }\n\n    scope.identify(identify);\n  };\n  /**\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._getReferrer = function _getReferrer() {\n    return document.referrer;\n  };\n  /**\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._getUrlParams = function _getUrlParams() {\n    return location.search;\n  };\n  /**\n   * Try to fetch Google Gclid from url params.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._saveGclid = function _saveGclid(urlParams) {\n    var gclid = utils.getQueryParam('gclid', urlParams);\n\n    if (utils.isEmptyString(gclid)) {\n      return;\n    }\n\n    var gclidProperties = {\n      'gclid': gclid\n    };\n\n    _sendParamsReferrerUserProperties(this, gclidProperties);\n  };\n  /**\n   * Try to fetch Amplitude device id from url params.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._getDeviceIdFromUrlParam = function _getDeviceIdFromUrlParam(urlParams) {\n    return utils.getQueryParam(Constants.AMP_DEVICE_ID_PARAM, urlParams);\n  };\n  /**\n   * Parse the domain from referrer info\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._getReferringDomain = function _getReferringDomain(referrer) {\n    if (utils.isEmptyString(referrer)) {\n      return null;\n    }\n\n    var parts = referrer.split('/');\n\n    if (parts.length >= 3) {\n      return parts[2];\n    }\n\n    return null;\n  };\n  /**\n   * Fetch the referrer information, parse the domain and send.\n   * Since user properties are propagated on the server, only send once per session, don't need to send with every event\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._saveReferrer = function _saveReferrer(referrer) {\n    if (utils.isEmptyString(referrer)) {\n      return;\n    }\n\n    var referrerInfo = {\n      'referrer': referrer,\n      'referring_domain': this._getReferringDomain(referrer)\n    };\n\n    _sendParamsReferrerUserProperties(this, referrerInfo);\n  };\n  /**\n   * Saves unsent events and identifies to localStorage. JSON stringifies event queues before saving.\n   * Note: this is called automatically every time events are logged, unless you explicitly set option saveEvents to false.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype.saveEvents = function saveEvents() {\n    try {\n      var serializedUnsentEvents = JSON.stringify(this._unsentEvents.map(function (_ref) {\n        var event = _ref.event;\n        return event;\n      }));\n\n      if (AsyncStorage) {\n        AsyncStorage.setItem(this.options.unsentKey + this._storageSuffix, serializedUnsentEvents);\n      } else {\n        this._setInStorage(localStorage$1, this.options.unsentKey, serializedUnsentEvents);\n      }\n    } catch (e) {}\n\n    try {\n      var serializedIdentifys = JSON.stringify(this._unsentIdentifys.map(function (unsentIdentify) {\n        return unsentIdentify.event;\n      }));\n\n      if (AsyncStorage) {\n        AsyncStorage.setItem(this.options.unsentIdentifyKey + this._storageSuffix, serializedIdentifys);\n      } else {\n        this._setInStorage(localStorage$1, this.options.unsentIdentifyKey, serializedIdentifys);\n      }\n    } catch (e) {}\n  };\n  /**\n   * Sets a customer domain for the amplitude cookie. Useful if you want to support cross-subdomain tracking.\n   * @public\n   * @param {string} domain to set.\n   * @example amplitudeClient.setDomain('.amplitude.com');\n   */\n\n\n  AmplitudeClient.prototype.setDomain = function setDomain(domain) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['setDomain'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!utils.validateInput(domain, 'domain', 'string')) {\n      return;\n    }\n\n    try {\n      this.cookieStorage.options({\n        expirationDays: this.options.cookieExpiration,\n        secure: this.options.secureCookie,\n        domain: domain,\n        sameSite: this.options.sameSiteCookie\n      });\n      this.options.domain = this.cookieStorage.options().domain;\n\n      _loadCookieData(this);\n\n      _saveCookieData(this);\n    } catch (e) {\n      utils.log.error(e);\n    }\n  };\n  /**\n   * Sets an identifier for the current user.\n   * @public\n   * @param {string} userId - identifier to set. Can be null.\n   * @example amplitudeClient.setUserId('joe@gmail.com');\n   */\n\n\n  AmplitudeClient.prototype.setUserId = function setUserId(userId) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['setUserId'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    try {\n      this.options.userId = userId !== undefined && userId !== null && '' + userId || null;\n\n      _saveCookieData(this);\n    } catch (e) {\n      utils.log.error(e);\n    }\n  };\n  /**\n   * Add user to a group or groups. You need to specify a groupType and groupName(s).\n   * For example you can group people by their organization.\n   * In that case groupType is \"orgId\" and groupName would be the actual ID(s).\n   * groupName can be a string or an array of strings to indicate a user in multiple gruups.\n   * You can also call setGroup multiple times with different groupTypes to track multiple types of groups (up to 5 per app).\n   * Note: this will also set groupType: groupName as a user property.\n   * See the [SDK Readme]{@link https://github.com/amplitude/Amplitude-Javascript#setting-groups} for more information.\n   * @public\n   * @param {string} groupType - the group type (ex: orgId)\n   * @param {string|list} groupName - the name of the group (ex: 15), or a list of names of the groups\n   * @example amplitudeClient.setGroup('orgId', 15); // this adds the current user to orgId 15.\n   */\n\n\n  AmplitudeClient.prototype.setGroup = function (groupType, groupName) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['setGroup'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!this._apiKeySet('setGroup()') || !utils.validateInput(groupType, 'groupType', 'string') || utils.isEmptyString(groupType)) {\n      return;\n    }\n\n    var groups = {};\n    groups[groupType] = groupName;\n    var identify = new Identify().set(groupType, groupName);\n\n    this._logEvent(Constants.IDENTIFY_EVENT, null, null, identify.userPropertiesOperations, groups, null, null, null);\n  };\n  /**\n   * Sets whether to opt current user out of tracking.\n   * @public\n   * @param {boolean} enable - if true then no events will be logged or sent.\n   * @example: amplitude.setOptOut(true);\n   */\n\n\n  AmplitudeClient.prototype.setOptOut = function setOptOut(enable) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['setOptOut'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!utils.validateInput(enable, 'enable', 'boolean')) {\n      return;\n    }\n\n    try {\n      this.options.optOut = enable;\n\n      _saveCookieData(this);\n    } catch (e) {\n      utils.log.error(e);\n    }\n  };\n\n  AmplitudeClient.prototype.setSessionId = function setSessionId(sessionId) {\n    if (!utils.validateInput(sessionId, 'sessionId', 'number')) {\n      return;\n    }\n\n    try {\n      this._sessionId = sessionId;\n\n      _saveCookieData(this);\n    } catch (e) {\n      utils.log.error(e);\n    }\n  };\n\n  AmplitudeClient.prototype.resetSessionId = function resetSessionId() {\n    this.setSessionId(new Date().getTime());\n  };\n  /**\n    * Regenerates a new random deviceId for current user. Note: this is not recommended unless you know what you\n    * are doing. This can be used in conjunction with `setUserId(null)` to anonymize users after they log out.\n    * With a null userId and a completely new deviceId, the current user would appear as a brand new user in dashboard.\n    * This uses src/uuid.js to regenerate the deviceId.\n    * @public\n    */\n\n\n  AmplitudeClient.prototype.regenerateDeviceId = function regenerateDeviceId() {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['regenerateDeviceId'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    this.setDeviceId(base64Id());\n  };\n  /**\n    * Sets a custom deviceId for current user. Note: this is not recommended unless you know what you are doing\n    * (like if you have your own system for managing deviceIds). Make sure the deviceId you set is sufficiently unique\n    * (we recommend something like a UUID - see src/uuid.js for an example of how to generate) to prevent conflicts with other devices in our system.\n    * @public\n    * @param {string} deviceId - custom deviceId for current user.\n    * @example amplitudeClient.setDeviceId('45f0954f-eb79-4463-ac8a-233a6f45a8f0');\n    */\n\n\n  AmplitudeClient.prototype.setDeviceId = function setDeviceId(deviceId) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['setDeviceId'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!utils.validateInput(deviceId, 'deviceId', 'string')) {\n      return;\n    }\n\n    try {\n      if (!utils.isEmptyString(deviceId)) {\n        this.options.deviceId = '' + deviceId;\n\n        _saveCookieData(this);\n      }\n    } catch (e) {\n      utils.log.error(e);\n    }\n  };\n  /**\n   * Sets user properties for the current user.\n   * @public\n   * @param {object} - object with string keys and values for the user properties to set.\n   * @param {boolean} - DEPRECATED opt_replace: in earlier versions of the JS SDK the user properties object was kept in\n   * memory and replace = true would replace the object in memory. Now the properties are no longer stored in memory, so replace is deprecated.\n   * @example amplitudeClient.setUserProperties({'gender': 'female', 'sign_up_complete': true})\n   */\n\n\n  AmplitudeClient.prototype.setUserProperties = function setUserProperties(userProperties) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['setUserProperties'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!this._apiKeySet('setUserProperties()') || !utils.validateInput(userProperties, 'userProperties', 'object')) {\n      return;\n    } // sanitize the userProperties dict before converting into identify\n\n\n    var sanitized = utils.truncate(utils.validateProperties(userProperties));\n\n    if (Object.keys(sanitized).length === 0) {\n      return;\n    } // convert userProperties into an identify call\n\n\n    var identify = new Identify();\n\n    for (var property in sanitized) {\n      if (sanitized.hasOwnProperty(property)) {\n        identify.set(property, sanitized[property]);\n      }\n    }\n\n    this.identify(identify);\n  };\n  /**\n   * Clear all of the user properties for the current user. Note: clearing user properties is irreversible!\n   * @public\n   * @example amplitudeClient.clearUserProperties();\n   */\n\n\n  AmplitudeClient.prototype.clearUserProperties = function clearUserProperties() {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['clearUserProperties'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!this._apiKeySet('clearUserProperties()')) {\n      return;\n    }\n\n    var identify = new Identify();\n    identify.clearAll();\n    this.identify(identify);\n  };\n  /**\n   * Applies the proxied functions on the proxied object to an instance of the real object.\n   * Used to convert proxied Identify and Revenue objects.\n   * @private\n   */\n\n\n  var _convertProxyObjectToRealObject = function _convertProxyObjectToRealObject(instance, proxy) {\n    for (var i = 0; i < proxy._q.length; i++) {\n      var fn = instance[proxy._q[i][0]];\n\n      if (type(fn) === 'function') {\n        fn.apply(instance, proxy._q[i].slice(1));\n      }\n    }\n\n    return instance;\n  };\n  /**\n   * Send an identify call containing user property operations to Amplitude servers.\n   * See [Readme]{@link https://github.com/amplitude/Amplitude-Javascript#user-properties-and-user-property-operations}\n   * for more information on the Identify API and user property operations.\n   * @param {Identify} identify_obj - the Identify object containing the user property operations to send.\n   * @param {Amplitude~eventCallback} opt_callback - (optional) callback function to run when the identify event has been sent.\n   * Note: the server response code and response body from the identify event upload are passed to the callback function.\n   * @example\n   * var identify = new amplitude.Identify().set('colors', ['rose', 'gold']).add('karma', 1).setOnce('sign_up_date', '2016-03-31');\n   * amplitude.identify(identify);\n   */\n\n\n  AmplitudeClient.prototype.identify = function (identify_obj, opt_callback) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['identify'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!this._apiKeySet('identify()')) {\n      if (type(opt_callback) === 'function') {\n        opt_callback(0, 'No request sent', {\n          reason: 'API key is not set'\n        });\n      }\n\n      return;\n    } // if identify input is a proxied object created by the async loading snippet, convert it into an identify object\n\n\n    if (type(identify_obj) === 'object' && identify_obj.hasOwnProperty('_q')) {\n      identify_obj = _convertProxyObjectToRealObject(new Identify(), identify_obj);\n    }\n\n    if (identify_obj instanceof Identify) {\n      // only send if there are operations\n      if (Object.keys(identify_obj.userPropertiesOperations).length > 0) {\n        return this._logEvent(Constants.IDENTIFY_EVENT, null, null, identify_obj.userPropertiesOperations, null, null, null, opt_callback);\n      } else {\n        if (type(opt_callback) === 'function') {\n          opt_callback(0, 'No request sent', {\n            reason: 'No user property operations'\n          });\n        }\n      }\n    } else {\n      utils.log.error('Invalid identify input type. Expected Identify object but saw ' + type(identify_obj));\n\n      if (type(opt_callback) === 'function') {\n        opt_callback(0, 'No request sent', {\n          reason: 'Invalid identify input type'\n        });\n      }\n    }\n  };\n\n  AmplitudeClient.prototype.groupIdentify = function (group_type, group_name, identify_obj, opt_callback) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['groupIdentify'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!this._apiKeySet('groupIdentify()')) {\n      if (type(opt_callback) === 'function') {\n        opt_callback(0, 'No request sent', {\n          reason: 'API key is not set'\n        });\n      }\n\n      return;\n    }\n\n    if (!utils.validateInput(group_type, 'group_type', 'string') || utils.isEmptyString(group_type)) {\n      if (type(opt_callback) === 'function') {\n        opt_callback(0, 'No request sent', {\n          reason: 'Invalid group type'\n        });\n      }\n\n      return;\n    }\n\n    if (group_name === null || group_name === undefined) {\n      if (type(opt_callback) === 'function') {\n        opt_callback(0, 'No request sent', {\n          reason: 'Invalid group name'\n        });\n      }\n\n      return;\n    } // if identify input is a proxied object created by the async loading snippet, convert it into an identify object\n\n\n    if (type(identify_obj) === 'object' && identify_obj.hasOwnProperty('_q')) {\n      identify_obj = _convertProxyObjectToRealObject(new Identify(), identify_obj);\n    }\n\n    if (identify_obj instanceof Identify) {\n      // only send if there are operations\n      if (Object.keys(identify_obj.userPropertiesOperations).length > 0) {\n        return this._logEvent(Constants.GROUP_IDENTIFY_EVENT, null, null, null, _defineProperty({}, group_type, group_name), identify_obj.userPropertiesOperations, null, opt_callback);\n      } else {\n        if (type(opt_callback) === 'function') {\n          opt_callback(0, 'No request sent', {\n            reason: 'No group property operations'\n          });\n        }\n      }\n    } else {\n      utils.log.error('Invalid identify input type. Expected Identify object but saw ' + type(identify_obj));\n\n      if (type(opt_callback) === 'function') {\n        opt_callback(0, 'No request sent', {\n          reason: 'Invalid identify input type'\n        });\n      }\n    }\n  };\n  /**\n   * Set a versionName for your application.\n   * @public\n   * @param {string} versionName - The version to set for your application.\n   * @example amplitudeClient.setVersionName('1.12.3');\n   */\n\n\n  AmplitudeClient.prototype.setVersionName = function setVersionName(versionName) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['setVersionName'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!utils.validateInput(versionName, 'versionName', 'string')) {\n      return;\n    }\n\n    this.options.versionName = versionName;\n  };\n  /**\n   * Private logEvent method. Keeps apiProperties from being publicly exposed.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._logEvent = function _logEvent(eventType, eventProperties, apiProperties, userProperties, groups, groupProperties, timestamp, callback) {\n    {\n      _loadCookieData(this); // reload cookie before each log event to sync event meta-data between windows and tabs\n\n    }\n\n    if (!eventType) {\n      if (type(callback) === 'function') {\n        callback(0, 'No request sent', {\n          reason: 'Missing eventType'\n        });\n      }\n\n      return;\n    }\n\n    if (this.options.optOut) {\n      if (type(callback) === 'function') {\n        callback(0, 'No request sent', {\n          reason: 'optOut is set to true'\n        });\n      }\n\n      return;\n    }\n\n    try {\n      var eventId;\n\n      if (eventType === Constants.IDENTIFY_EVENT || eventType === Constants.GROUP_IDENTIFY_EVENT) {\n        eventId = this.nextIdentifyId();\n      } else {\n        eventId = this.nextEventId();\n      }\n\n      var sequenceNumber = this.nextSequenceNumber();\n      var eventTime = type(timestamp) === 'number' ? timestamp : new Date().getTime();\n\n      if (!this._sessionId || !this._lastEventTime || eventTime - this._lastEventTime > this.options.sessionTimeout) {\n        this._sessionId = eventTime;\n      }\n\n      this._lastEventTime = eventTime;\n\n      _saveCookieData(this);\n\n      var osName = this._ua.browser.name;\n      var osVersion = this._ua.browser.major;\n      var deviceModel = this._ua.os.name;\n      var deviceManufacturer;\n      var versionName;\n      var carrier;\n      userProperties = userProperties || {};\n\n      var trackingOptions = _objectSpread({}, this._apiPropertiesTrackingOptions);\n\n      apiProperties = _objectSpread({}, apiProperties || {}, trackingOptions);\n      eventProperties = eventProperties || {};\n      groups = groups || {};\n      groupProperties = groupProperties || {};\n      var event = {\n        device_id: this.options.deviceId,\n        user_id: this.options.userId,\n        timestamp: eventTime,\n        event_id: eventId,\n        session_id: this._sessionId || -1,\n        event_type: eventType,\n        version_name: _shouldTrackField(this, 'version_name') ? this.options.versionName || versionName || null : null,\n        platform: _shouldTrackField(this, 'platform') ? this.options.platform : null,\n        os_name: _shouldTrackField(this, 'os_name') ? osName || null : null,\n        os_version: _shouldTrackField(this, 'os_version') ? osVersion || null : null,\n        device_model: _shouldTrackField(this, 'device_model') ? deviceModel || null : null,\n        device_manufacturer: _shouldTrackField(this, 'device_manufacturer') ? deviceManufacturer || null : null,\n        language: _shouldTrackField(this, 'language') ? this.options.language : null,\n        carrier: _shouldTrackField(this, 'carrier') ? carrier || null : null,\n        api_properties: apiProperties,\n        event_properties: utils.truncate(utils.validateProperties(eventProperties)),\n        user_properties: utils.truncate(utils.validateProperties(userProperties)),\n        uuid: uuid(),\n        library: {\n          name: 'amplitude-js',\n          version: version\n        },\n        sequence_number: sequenceNumber,\n        // for ordering events and identifys\n        groups: utils.truncate(utils.validateGroups(groups)),\n        group_properties: utils.truncate(utils.validateProperties(groupProperties)),\n        user_agent: this._userAgent\n      };\n\n      if (eventType === Constants.IDENTIFY_EVENT || eventType === Constants.GROUP_IDENTIFY_EVENT) {\n        this._unsentIdentifys.push({\n          event: event,\n          callback: callback\n        });\n\n        this._limitEventsQueued(this._unsentIdentifys);\n      } else {\n        this._unsentEvents.push({\n          event: event,\n          callback: callback\n        });\n\n        this._limitEventsQueued(this._unsentEvents);\n      }\n\n      if (this.options.saveEvents) {\n        this.saveEvents();\n      }\n\n      this._sendEventsIfReady(callback);\n\n      return eventId;\n    } catch (e) {\n      utils.log.error(e);\n    }\n  };\n\n  var _shouldTrackField = function _shouldTrackField(scope, field) {\n    return !!scope.options.trackingOptions[field];\n  };\n\n  var _generateApiPropertiesTrackingConfig = function _generateApiPropertiesTrackingConfig(scope) {\n    // to limit size of config payload, only send fields that have been disabled\n    var fields = ['city', 'country', 'dma', 'ip_address', 'region'];\n    var config = {};\n\n    for (var i = 0; i < fields.length; i++) {\n      var field = fields[i];\n\n      if (!_shouldTrackField(scope, field)) {\n        config[field] = false;\n      }\n    }\n\n    return config;\n  };\n  /**\n   * Remove old events from the beginning of the array if too many have accumulated. Default limit is 1000 events.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._limitEventsQueued = function _limitEventsQueued(queue) {\n    if (queue.length > this.options.savedMaxCount) {\n      queue.splice(0, queue.length - this.options.savedMaxCount);\n    }\n  };\n  /**\n   * This is the callback for logEvent and identify calls. It gets called after the event/identify is uploaded,\n   * and the server response code and response body from the upload request are passed to the callback function.\n   * @callback Amplitude~eventCallback\n   * @param {number} responseCode - Server response code for the event / identify upload request.\n   * @param {string} responseBody - Server response body for the event / identify upload request.\n   */\n\n  /**\n   * Log an event with eventType and eventProperties\n   * @public\n   * @param {string} eventType - name of event\n   * @param {object} eventProperties - (optional) an object with string keys and values for the event properties.\n   * @param {Amplitude~eventCallback} opt_callback - (optional) a callback function to run after the event is logged.\n   * Note: the server response code and response body from the event upload are passed to the callback function.\n   * @example amplitudeClient.logEvent('Clicked Homepage Button', {'finished_flow': false, 'clicks': 15});\n   */\n\n\n  AmplitudeClient.prototype.logEvent = function logEvent(eventType, eventProperties, opt_callback) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['logEvent'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    return this.logEventWithTimestamp(eventType, eventProperties, null, opt_callback);\n  };\n  /**\n   * Log an event with eventType and eventProperties and a custom timestamp\n   * @public\n   * @param {string} eventType - name of event\n   * @param {object} eventProperties - (optional) an object with string keys and values for the event properties.\n   * @param {number} timestamp - (optional) the custom timestamp as milliseconds since epoch.\n   * @param {Amplitude~eventCallback} opt_callback - (optional) a callback function to run after the event is logged.\n   * Note: the server response code and response body from the event upload are passed to the callback function.\n   * @example amplitudeClient.logEvent('Clicked Homepage Button', {'finished_flow': false, 'clicks': 15});\n   */\n\n\n  AmplitudeClient.prototype.logEventWithTimestamp = function logEvent(eventType, eventProperties, timestamp, opt_callback) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['logEventWithTimestamp'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!this._apiKeySet('logEvent()')) {\n      if (type(opt_callback) === 'function') {\n        opt_callback(0, 'No request sent', {\n          reason: 'API key not set'\n        });\n      }\n\n      return -1;\n    }\n\n    if (!utils.validateInput(eventType, 'eventType', 'string')) {\n      if (type(opt_callback) === 'function') {\n        opt_callback(0, 'No request sent', {\n          reason: 'Invalid type for eventType'\n        });\n      }\n\n      return -1;\n    }\n\n    if (utils.isEmptyString(eventType)) {\n      if (type(opt_callback) === 'function') {\n        opt_callback(0, 'No request sent', {\n          reason: 'Missing eventType'\n        });\n      }\n\n      return -1;\n    }\n\n    return this._logEvent(eventType, eventProperties, null, null, null, null, timestamp, opt_callback);\n  };\n  /**\n   * Log an event with eventType, eventProperties, and groups. Use this to set event-level groups.\n   * Note: the group(s) set only apply for the specific event type being logged and does not persist on the user\n   * (unless you explicitly set it with setGroup).\n   * See the [SDK Readme]{@link https://github.com/amplitude/Amplitude-Javascript#setting-groups} for more information\n   * about groups and Count by Distinct on the Amplitude platform.\n   * @public\n   * @param {string} eventType - name of event\n   * @param {object} eventProperties - (optional) an object with string keys and values for the event properties.\n   * @param {object} groups - (optional) an object with string groupType: groupName values for the event being logged.\n   * groupName can be a string or an array of strings.\n   * @param {Amplitude~eventCallback} opt_callback - (optional) a callback function to run after the event is logged.\n   * Note: the server response code and response body from the event upload are passed to the callback function.\n   * @example amplitudeClient.logEventWithGroups('Clicked Button', null, {'orgId': 24});\n   */\n\n\n  AmplitudeClient.prototype.logEventWithGroups = function (eventType, eventProperties, groups, opt_callback) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['logEventWithGroups'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!this._apiKeySet('logEventWithGroups()')) {\n      if (type(opt_callback) === 'function') {\n        opt_callback(0, 'No request sent', {\n          reason: 'API key not set'\n        });\n      }\n\n      return -1;\n    }\n\n    if (!utils.validateInput(eventType, 'eventType', 'string')) {\n      if (type(opt_callback) === 'function') {\n        opt_callback(0, 'No request sent', {\n          reason: 'Invalid type for eventType'\n        });\n      }\n\n      return -1;\n    }\n\n    return this._logEvent(eventType, eventProperties, null, null, groups, null, null, opt_callback);\n  };\n  /**\n   * Test that n is a number or a numeric value.\n   * @private\n   */\n\n\n  var _isNumber = function _isNumber(n) {\n    return !isNaN(parseFloat(n)) && isFinite(n);\n  };\n  /**\n   * Log revenue with Revenue interface. The new revenue interface allows for more revenue fields like\n   * revenueType and event properties.\n   * See [Readme]{@link https://github.com/amplitude/Amplitude-Javascript#tracking-revenue}\n   * for more information on the Revenue interface and logging revenue.\n   * @public\n   * @param {Revenue} revenue_obj - the revenue object containing the revenue data being logged.\n   * @example var revenue = new amplitude.Revenue().setProductId('productIdentifier').setPrice(10.99);\n   * amplitude.logRevenueV2(revenue);\n   */\n\n\n  AmplitudeClient.prototype.logRevenueV2 = function logRevenueV2(revenue_obj) {\n    if (this._shouldDeferCall()) {\n      return this._q.push(['logRevenueV2'].concat(Array.prototype.slice.call(arguments, 0)));\n    }\n\n    if (!this._apiKeySet('logRevenueV2()')) {\n      return;\n    } // if revenue input is a proxied object created by the async loading snippet, convert it into an revenue object\n\n\n    if (type(revenue_obj) === 'object' && revenue_obj.hasOwnProperty('_q')) {\n      revenue_obj = _convertProxyObjectToRealObject(new Revenue(), revenue_obj);\n    }\n\n    if (revenue_obj instanceof Revenue) {\n      // only send if revenue is valid\n      if (revenue_obj && revenue_obj._isValidRevenue()) {\n        return this.logEvent(Constants.REVENUE_EVENT, revenue_obj._toJSONObject());\n      }\n    } else {\n      utils.log.error('Invalid revenue input type. Expected Revenue object but saw ' + type(revenue_obj));\n    }\n  };\n\n  {\n    /**\n     * Log revenue event with a price, quantity, and product identifier. DEPRECATED - use logRevenueV2\n     * @public\n     * @deprecated\n     * @param {number} price - price of revenue event\n     * @param {number} quantity - (optional) quantity of products in revenue event. If no quantity specified default to 1.\n     * @param {string} product - (optional) product identifier\n     * @example amplitudeClient.logRevenue(3.99, 1, 'product_1234');\n     */\n    AmplitudeClient.prototype.logRevenue = function logRevenue(price, quantity, product) {\n      if (this._shouldDeferCall()) {\n        return this._q.push(['logRevenue'].concat(Array.prototype.slice.call(arguments, 0)));\n      } // Test that the parameters are of the right type.\n\n\n      if (!this._apiKeySet('logRevenue()') || !_isNumber(price) || quantity !== undefined && !_isNumber(quantity)) {\n        // utils.log('Price and quantity arguments to logRevenue must be numbers');\n        return -1;\n      }\n\n      return this._logEvent(Constants.REVENUE_EVENT, {}, {\n        productId: product,\n        special: 'revenue_amount',\n        quantity: quantity || 1,\n        price: price\n      }, null, null, null, null, null);\n    };\n  }\n  /**\n   * Remove events in storage with event ids up to and including maxEventId.\n   * @private\n   */\n\n  AmplitudeClient.prototype.removeEvents = function removeEvents(maxEventId, maxIdentifyId, status, response) {\n    _removeEvents(this, '_unsentEvents', maxEventId, status, response);\n\n    _removeEvents(this, '_unsentIdentifys', maxIdentifyId, status, response);\n  };\n  /**\n   * Helper function to remove events up to maxId from a single queue.\n   * Does a true filter in case events get out of order or old events are removed.\n   * @private\n   */\n\n\n  var _removeEvents = function _removeEvents(scope, eventQueue, maxId, status, response) {\n    if (maxId < 0) {\n      return;\n    }\n\n    var filteredEvents = [];\n\n    for (var i = 0; i < scope[eventQueue].length || 0; i++) {\n      var unsentEvent = scope[eventQueue][i];\n\n      if (unsentEvent.event.event_id > maxId) {\n        filteredEvents.push(unsentEvent);\n      } else {\n        if (unsentEvent.callback) {\n          unsentEvent.callback(status, response);\n        }\n      }\n    }\n\n    scope[eventQueue] = filteredEvents;\n  };\n  /**\n   * Send unsent events. Note: this is called automatically after events are logged if option batchEvents is false.\n   * If batchEvents is true, then events are only sent when batch criterias are met.\n   * @private\n   */\n\n\n  AmplitudeClient.prototype.sendEvents = function sendEvents() {\n    if (!this._apiKeySet('sendEvents()')) {\n      this.removeEvents(Infinity, Infinity, 0, 'No request sent', {\n        reason: 'API key not set'\n      });\n      return;\n    }\n\n    if (this.options.optOut) {\n      this.removeEvents(Infinity, Infinity, 0, 'No request sent', {\n        reason: 'Opt out is set to true'\n      });\n      return;\n    } // How is it possible to get into this state?\n\n\n    if (this._unsentCount() === 0) {\n      return;\n    } // We only make one request at a time. sendEvents will be invoked again once\n    // the last request completes.\n\n\n    if (this._sending) {\n      return;\n    }\n\n    this._sending = true;\n    var protocol = this.options.forceHttps ? 'https' : 'https:' === window.location.protocol ? 'https' : 'http';\n    var url = protocol + '://' + this.options.apiEndpoint; // fetch events to send\n\n    var numEvents = Math.min(this._unsentCount(), this.options.uploadBatchSize);\n\n    var mergedEvents = this._mergeEventsAndIdentifys(numEvents);\n\n    var maxEventId = mergedEvents.maxEventId;\n    var maxIdentifyId = mergedEvents.maxIdentifyId;\n    var events = JSON.stringify(mergedEvents.eventsToSend.map(function (_ref2) {\n      var event = _ref2.event;\n      return event;\n    }));\n    var uploadTime = new Date().getTime();\n    var data = {\n      client: this.options.apiKey,\n      e: events,\n      v: Constants.API_VERSION,\n      upload_time: uploadTime,\n      checksum: md5(Constants.API_VERSION + this.options.apiKey + events + uploadTime)\n    };\n    var scope = this;\n    new Request(url, data).send(function (status, response) {\n      scope._sending = false;\n\n      try {\n        if (status === 200 && response === 'success') {\n          scope.removeEvents(maxEventId, maxIdentifyId, status, response); // Update the event cache after the removal of sent events.\n\n          if (scope.options.saveEvents) {\n            scope.saveEvents();\n          } // Send more events if any queued during previous send.\n\n\n          scope._sendEventsIfReady(); // handle payload too large\n\n        } else if (status === 413) {\n          // utils.log('request too large');\n          // Can't even get this one massive event through. Drop it, even if it is an identify.\n          if (scope.options.uploadBatchSize === 1) {\n            scope.removeEvents(maxEventId, maxIdentifyId, status, response);\n          } // The server complained about the length of the request. Backoff and try again.\n\n\n          scope.options.uploadBatchSize = Math.ceil(numEvents / 2);\n          scope.sendEvents();\n        } // else {\n        //  all the events are still queued, and will be retried when the next\n        //  event is sent In the interest of debugging, it would be nice to have\n        //  something like an event emitter for a better debugging experince\n        //  here.\n        // }\n\n      } catch (e) {// utils.log('failed upload');\n      }\n    });\n  };\n  /**\n   * Merge unsent events and identifys together in sequential order based on their sequence number, for uploading.\n   * Identifys given higher priority than Events. Also earlier sequence given priority\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._mergeEventsAndIdentifys = function _mergeEventsAndIdentifys(numEvents) {\n    // coalesce events from both queues\n    var eventsToSend = [];\n    var eventIndex = 0;\n    var maxEventId = -1;\n    var identifyIndex = 0;\n    var maxIdentifyId = -1;\n\n    while (eventsToSend.length < numEvents) {\n      var unsentEvent = void 0;\n      var noIdentifys = identifyIndex >= this._unsentIdentifys.length;\n      var noEvents = eventIndex >= this._unsentEvents.length; // case 0: no events or identifys left\n      // note this should not happen, this means we have less events and identifys than expected\n\n      if (noEvents && noIdentifys) {\n        utils.log.error('Merging Events and Identifys, less events and identifys than expected');\n        break;\n      } // case 1: no identifys - grab from events\n      else if (noIdentifys) {\n          unsentEvent = this._unsentEvents[eventIndex++];\n          maxEventId = unsentEvent.event.event_id; // case 2: no events - grab from identifys\n        } else if (noEvents) {\n          unsentEvent = this._unsentIdentifys[identifyIndex++];\n          maxIdentifyId = unsentEvent.event.event_id; // case 3: need to compare sequence numbers\n        } else {\n          // events logged before v2.5.0 won't have a sequence number, put those first\n          if (!('sequence_number' in this._unsentEvents[eventIndex].event) || this._unsentEvents[eventIndex].event.sequence_number < this._unsentIdentifys[identifyIndex].event.sequence_number) {\n            unsentEvent = this._unsentEvents[eventIndex++];\n            maxEventId = unsentEvent.event.event_id;\n          } else {\n            unsentEvent = this._unsentIdentifys[identifyIndex++];\n            maxIdentifyId = unsentEvent.event.event_id;\n          }\n        }\n\n      eventsToSend.push(unsentEvent);\n    }\n\n    return {\n      eventsToSend: eventsToSend,\n      maxEventId: maxEventId,\n      maxIdentifyId: maxIdentifyId\n    };\n  };\n\n  {\n    /**\n     * Set global user properties. Note this is deprecated, and we recommend using setUserProperties\n     * @public\n     * @deprecated\n     */\n    AmplitudeClient.prototype.setGlobalUserProperties = function setGlobalUserProperties(userProperties) {\n      this.setUserProperties(userProperties);\n    };\n  }\n  /**\n   * Get the current version of Amplitude's Javascript SDK.\n   * @public\n   * @returns {number} version number\n   * @example var amplitudeVersion = amplitude.__VERSION__;\n   */\n\n  AmplitudeClient.prototype.__VERSION__ = version;\n  /**\n   * Determines whether or not to push call to this._q or invoke it\n   * @private\n   */\n\n  AmplitudeClient.prototype._shouldDeferCall = function _shouldDeferCall() {\n    return this._pendingReadStorage || this._initializationDeferred;\n  };\n  /**\n   * Defers Initialization by putting all functions into storage until users\n   * have accepted terms for tracking\n   * @private\n   */\n\n\n  AmplitudeClient.prototype._deferInitialization = function _deferInitialization() {\n    this._initializationDeferred = true;\n\n    this._q.push(['init'].concat(Array.prototype.slice.call(arguments, 0)));\n  };\n  /**\n   * Enable tracking via logging events and dropping a cookie\n   * Intended to be used with the deferInitialization configuration flag\n   * This will drop a cookie and reset initialization deferred\n   * @public\n   */\n\n\n  AmplitudeClient.prototype.enableTracking = function enableTracking() {\n    // This will call init (which drops the cookie) and will run any pending tasks\n    this._initializationDeferred = false;\n\n    _saveCookieData(this);\n\n    this.runQueuedFunctions();\n  };\n  /**\n   * Legacy API of Amplitude SDK - instance manager. Wraps around the current amplitude-client.js which provides more features\n   * Function calls directly on amplitude have been deprecated. Please call methods on the default shared instance: amplitude.getInstance() instead.\n   * See [Readme]{@link https://github.com/amplitude/Amplitude-Javascript#300-update-and-logging-events-to-multiple-amplitude-apps} for more information about this change.\n   * @constructor Amplitude\n   * @public\n   * @example var amplitude = new Amplitude();\n   */\n\n\n  var Amplitude = function Amplitude() {\n    this.options = _objectSpread({}, DEFAULT_OPTIONS);\n    this._q = [];\n    this._instances = {}; // mapping of instance names to instances\n  };\n\n  Amplitude.prototype.Identify = Identify;\n  Amplitude.prototype.Revenue = Revenue;\n\n  Amplitude.prototype.getInstance = function getInstance(instance) {\n    instance = utils.isEmptyString(instance) ? Constants.DEFAULT_INSTANCE : instance.toLowerCase();\n    var client = this._instances[instance];\n\n    if (client === undefined) {\n      client = new AmplitudeClient(instance);\n      this._instances[instance] = client;\n    }\n\n    return client;\n  };\n\n  {\n    /**\n     * Run functions queued up by proxy loading snippet\n     * @private\n     */\n    Amplitude.prototype.runQueuedFunctions = function () {\n      // run queued up old versions of functions\n      for (var i = 0; i < this._q.length; i++) {\n        var fn = this[this._q[i][0]];\n\n        if (type(fn) === 'function') {\n          fn.apply(this, this._q[i].slice(1));\n        }\n      }\n\n      this._q = []; // clear function queue after running\n      // run queued up functions on instances\n\n      for (var instance in this._instances) {\n        if (this._instances.hasOwnProperty(instance)) {\n          this._instances[instance].runQueuedFunctions();\n        }\n      }\n    };\n  }\n  {\n    /**\n     * Initializes the Amplitude Javascript SDK with your apiKey and any optional configurations.\n     * This is required before any other methods can be called.\n     * @public\n     * @param {string} apiKey - The API key for your app.\n     * @param {string} opt_userId - (optional) An identifier for this user.\n     * @param {object} opt_config - (optional) Configuration options.\n     * See [Readme]{@link https://github.com/amplitude/Amplitude-Javascript#configuration-options} for list of options and default values.\n     * @param {function} opt_callback - (optional) Provide a callback function to run after initialization is complete.\n     * @deprecated Please use amplitude.getInstance().init(apiKey, opt_userId, opt_config, opt_callback);\n     * @example amplitude.init('API_KEY', 'USER_ID', {includeReferrer: true, includeUtm: true}, function() { alert('init complete'); });\n     */\n    Amplitude.prototype.init = function init(apiKey, opt_userId, opt_config, opt_callback) {\n      this.getInstance().init(apiKey, opt_userId, opt_config, function (instance) {\n        // make options such as deviceId available for callback functions\n        this.options = instance.options;\n\n        if (type(opt_callback) === 'function') {\n          opt_callback(instance);\n        }\n      }.bind(this));\n    };\n    /**\n     * Returns true if a new session was created during initialization, otherwise false.\n     * @public\n     * @return {boolean} Whether a new session was created during initialization.\n     * @deprecated Please use amplitude.getInstance().isNewSession();\n     */\n\n\n    Amplitude.prototype.isNewSession = function isNewSession() {\n      return this.getInstance().isNewSession();\n    };\n    /**\n     * Returns the id of the current session.\n     * @public\n     * @return {number} Id of the current session.\n     * @deprecated Please use amplitude.getInstance().getSessionId();\n     */\n\n\n    Amplitude.prototype.getSessionId = function getSessionId() {\n      return this.getInstance().getSessionId();\n    };\n    /**\n     * Increments the eventId and returns it.\n     * @private\n     */\n\n\n    Amplitude.prototype.nextEventId = function nextEventId() {\n      return this.getInstance().nextEventId();\n    };\n    /**\n     * Increments the identifyId and returns it.\n     * @private\n     */\n\n\n    Amplitude.prototype.nextIdentifyId = function nextIdentifyId() {\n      return this.getInstance().nextIdentifyId();\n    };\n    /**\n     * Increments the sequenceNumber and returns it.\n     * @private\n     */\n\n\n    Amplitude.prototype.nextSequenceNumber = function nextSequenceNumber() {\n      return this.getInstance().nextSequenceNumber();\n    };\n    /**\n     * Saves unsent events and identifies to localStorage. JSON stringifies event queues before saving.\n     * Note: this is called automatically every time events are logged, unless you explicitly set option saveEvents to false.\n     * @private\n     */\n\n\n    Amplitude.prototype.saveEvents = function saveEvents() {\n      this.getInstance().saveEvents();\n    };\n    /**\n     * Sets a customer domain for the amplitude cookie. Useful if you want to support cross-subdomain tracking.\n     * @public\n     * @param {string} domain to set.\n     * @deprecated Please use amplitude.getInstance().setDomain(domain);\n     * @example amplitude.setDomain('.amplitude.com');\n     */\n\n\n    Amplitude.prototype.setDomain = function setDomain(domain) {\n      this.getInstance().setDomain(domain);\n    };\n    /**\n     * Sets an identifier for the current user.\n     * @public\n     * @param {string} userId - identifier to set. Can be null.\n     * @deprecated Please use amplitude.getInstance().setUserId(userId);\n     * @example amplitude.setUserId('joe@gmail.com');\n     */\n\n\n    Amplitude.prototype.setUserId = function setUserId(userId) {\n      this.getInstance().setUserId(userId);\n    };\n    /**\n     * Add user to a group or groups. You need to specify a groupType and groupName(s).\n     * For example you can group people by their organization.\n     * In that case groupType is \"orgId\" and groupName would be the actual ID(s).\n     * groupName can be a string or an array of strings to indicate a user in multiple gruups.\n     * You can also call setGroup multiple times with different groupTypes to track multiple types of groups (up to 5 per app).\n     * Note: this will also set groupType: groupName as a user property.\n     * See the [SDK Readme]{@link https://github.com/amplitude/Amplitude-Javascript#setting-groups} for more information.\n     * @public\n     * @param {string} groupType - the group type (ex: orgId)\n     * @param {string|list} groupName - the name of the group (ex: 15), or a list of names of the groups\n     * @deprecated Please use amplitude.getInstance().setGroup(groupType, groupName);\n     * @example amplitude.setGroup('orgId', 15); // this adds the current user to orgId 15.\n     */\n\n\n    Amplitude.prototype.setGroup = function (groupType, groupName) {\n      this.getInstance().setGroup(groupType, groupName);\n    };\n    /**\n     * Sets whether to opt current user out of tracking.\n     * @public\n     * @param {boolean} enable - if true then no events will be logged or sent.\n     * @deprecated Please use amplitude.getInstance().setOptOut(enable);\n     * @example: amplitude.setOptOut(true);\n     */\n\n\n    Amplitude.prototype.setOptOut = function setOptOut(enable) {\n      this.getInstance().setOptOut(enable);\n    };\n    /**\n      * Regenerates a new random deviceId for current user. Note: this is not recommended unless you know what you\n      * are doing. This can be used in conjunction with `setUserId(null)` to anonymize users after they log out.\n      * With a null userId and a completely new deviceId, the current user would appear as a brand new user in dashboard.\n      * This uses src/uuid.js to regenerate the deviceId.\n      * @public\n      * @deprecated Please use amplitude.getInstance().regenerateDeviceId();\n      */\n\n\n    Amplitude.prototype.regenerateDeviceId = function regenerateDeviceId() {\n      this.getInstance().regenerateDeviceId();\n    };\n    /**\n      * Sets a custom deviceId for current user. Note: this is not recommended unless you know what you are doing\n      * (like if you have your own system for managing deviceIds). Make sure the deviceId you set is sufficiently unique\n      * (we recommend something like a UUID - see src/uuid.js for an example of how to generate) to prevent conflicts with other devices in our system.\n      * @public\n      * @param {string} deviceId - custom deviceId for current user.\n      * @deprecated Please use amplitude.getInstance().setDeviceId(deviceId);\n      * @example amplitude.setDeviceId('45f0954f-eb79-4463-ac8a-233a6f45a8f0');\n      */\n\n\n    Amplitude.prototype.setDeviceId = function setDeviceId(deviceId) {\n      this.getInstance().setDeviceId(deviceId);\n    };\n    /**\n     * Sets user properties for the current user.\n     * @public\n     * @param {object} - object with string keys and values for the user properties to set.\n     * @param {boolean} - DEPRECATED opt_replace: in earlier versions of the JS SDK the user properties object was kept in\n     * memory and replace = true would replace the object in memory. Now the properties are no longer stored in memory, so replace is deprecated.\n     * @deprecated Please use amplitude.getInstance.setUserProperties(userProperties);\n     * @example amplitude.setUserProperties({'gender': 'female', 'sign_up_complete': true})\n     */\n\n\n    Amplitude.prototype.setUserProperties = function setUserProperties(userProperties) {\n      this.getInstance().setUserProperties(userProperties);\n    };\n    /**\n     * Clear all of the user properties for the current user. Note: clearing user properties is irreversible!\n     * @public\n     * @deprecated Please use amplitude.getInstance().clearUserProperties();\n     * @example amplitude.clearUserProperties();\n     */\n\n\n    Amplitude.prototype.clearUserProperties = function clearUserProperties() {\n      this.getInstance().clearUserProperties();\n    };\n    /**\n     * Send an identify call containing user property operations to Amplitude servers.\n     * See [Readme]{@link https://github.com/amplitude/Amplitude-Javascript#user-properties-and-user-property-operations}\n     * for more information on the Identify API and user property operations.\n     * @param {Identify} identify_obj - the Identify object containing the user property operations to send.\n     * @param {Amplitude~eventCallback} opt_callback - (optional) callback function to run when the identify event has been sent.\n     * Note: the server response code and response body from the identify event upload are passed to the callback function.\n     * @deprecated Please use amplitude.getInstance().identify(identify);\n     * @example\n     * var identify = new amplitude.Identify().set('colors', ['rose', 'gold']).add('karma', 1).setOnce('sign_up_date', '2016-03-31');\n     * amplitude.identify(identify);\n     */\n\n\n    Amplitude.prototype.identify = function (identify_obj, opt_callback) {\n      this.getInstance().identify(identify_obj, opt_callback);\n    };\n    /**\n     * Set a versionName for your application.\n     * @public\n     * @param {string} versionName - The version to set for your application.\n     * @deprecated Please use amplitude.getInstance().setVersionName(versionName);\n     * @example amplitude.setVersionName('1.12.3');\n     */\n\n\n    Amplitude.prototype.setVersionName = function setVersionName(versionName) {\n      this.getInstance().setVersionName(versionName);\n    };\n    /**\n     * This is the callback for logEvent and identify calls. It gets called after the event/identify is uploaded,\n     * and the server response code and response body from the upload request are passed to the callback function.\n     * @callback Amplitude~eventCallback\n     * @param {number} responseCode - Server response code for the event / identify upload request.\n     * @param {string} responseBody - Server response body for the event / identify upload request.\n     */\n\n    /**\n     * Log an event with eventType and eventProperties\n     * @public\n     * @param {string} eventType - name of event\n     * @param {object} eventProperties - (optional) an object with string keys and values for the event properties.\n     * @param {Amplitude~eventCallback} opt_callback - (optional) a callback function to run after the event is logged.\n     * Note: the server response code and response body from the event upload are passed to the callback function.\n     * @deprecated Please use amplitude.getInstance().logEvent(eventType, eventProperties, opt_callback);\n     * @example amplitude.logEvent('Clicked Homepage Button', {'finished_flow': false, 'clicks': 15});\n     */\n\n\n    Amplitude.prototype.logEvent = function logEvent(eventType, eventProperties, opt_callback) {\n      return this.getInstance().logEvent(eventType, eventProperties, opt_callback);\n    };\n    /**\n     * Log an event with eventType, eventProperties, and groups. Use this to set event-level groups.\n     * Note: the group(s) set only apply for the specific event type being logged and does not persist on the user\n     * (unless you explicitly set it with setGroup).\n     * See the [SDK Readme]{@link https://github.com/amplitude/Amplitude-Javascript#setting-groups} for more information\n     * about groups and Count by Distinct on the Amplitude platform.\n     * @public\n     * @param {string} eventType - name of event\n     * @param {object} eventProperties - (optional) an object with string keys and values for the event properties.\n     * @param {object} groups - (optional) an object with string groupType: groupName values for the event being logged.\n     * groupName can be a string or an array of strings.\n     * @param {Amplitude~eventCallback} opt_callback - (optional) a callback function to run after the event is logged.\n     * Note: the server response code and response body from the event upload are passed to the callback function.\n     * Deprecated Please use amplitude.getInstance().logEventWithGroups(eventType, eventProperties, groups, opt_callback);\n     * @example amplitude.logEventWithGroups('Clicked Button', null, {'orgId': 24});\n     */\n\n\n    Amplitude.prototype.logEventWithGroups = function (eventType, eventProperties, groups, opt_callback) {\n      return this.getInstance().logEventWithGroups(eventType, eventProperties, groups, opt_callback);\n    };\n    /**\n     * Log revenue with Revenue interface. The new revenue interface allows for more revenue fields like\n     * revenueType and event properties.\n     * See [Readme]{@link https://github.com/amplitude/Amplitude-Javascript#tracking-revenue}\n     * for more information on the Revenue interface and logging revenue.\n     * @public\n     * @param {Revenue} revenue_obj - the revenue object containing the revenue data being logged.\n     * @deprecated Please use amplitude.getInstance().logRevenueV2(revenue_obj);\n     * @example var revenue = new amplitude.Revenue().setProductId('productIdentifier').setPrice(10.99);\n     * amplitude.logRevenueV2(revenue);\n     */\n\n\n    Amplitude.prototype.logRevenueV2 = function logRevenueV2(revenue_obj) {\n      return this.getInstance().logRevenueV2(revenue_obj);\n    };\n    /**\n     * Log revenue event with a price, quantity, and product identifier. DEPRECATED - use logRevenueV2\n     * @public\n     * @param {number} price - price of revenue event\n     * @param {number} quantity - (optional) quantity of products in revenue event. If no quantity specified default to 1.\n     * @param {string} product - (optional) product identifier\n     * @deprecated Please use amplitude.getInstance().logRevenueV2(revenue_obj);\n     * @example amplitude.logRevenue(3.99, 1, 'product_1234');\n     */\n\n\n    Amplitude.prototype.logRevenue = function logRevenue(price, quantity, product) {\n      return this.getInstance().logRevenue(price, quantity, product);\n    };\n    /**\n     * Remove events in storage with event ids up to and including maxEventId.\n     * @private\n     */\n\n\n    Amplitude.prototype.removeEvents = function removeEvents(maxEventId, maxIdentifyId) {\n      this.getInstance().removeEvents(maxEventId, maxIdentifyId);\n    };\n    /**\n     * Send unsent events. Note: this is called automatically after events are logged if option batchEvents is false.\n     * If batchEvents is true, then events are only sent when batch criterias are met.\n     * @private\n     * @param {Amplitude~eventCallback} callback - (optional) callback to run after events are sent.\n     * Note the server response code and response body are passed to the callback as input arguments.\n     */\n\n\n    Amplitude.prototype.sendEvents = function sendEvents(callback) {\n      this.getInstance().sendEvents(callback);\n    };\n    /**\n     * Set global user properties. Note this is deprecated, and we recommend using setUserProperties\n     * @public\n     * @deprecated\n     */\n\n\n    Amplitude.prototype.setGlobalUserProperties = function setGlobalUserProperties(userProperties) {\n      this.getInstance().setUserProperties(userProperties);\n    };\n  }\n  /**\n   * Get the current version of Amplitude's Javascript SDK.\n   * @public\n   * @returns {number} version number\n   * @example var amplitudeVersion = amplitude.__VERSION__;\n   */\n\n  Amplitude.prototype.__VERSION__ = version;\n  /* jshint expr:true */\n\n  var old = window.amplitude || {};\n  var newInstance = new Amplitude();\n  newInstance._q = old._q || [];\n  /**\n  * Instantiates Amplitude object and runs all queued function logged by stubbed methods provided by snippets\n  * Event queue allows async loading of SDK to not blocking client's app\n  */\n\n  for (var instance in old._iq) {\n    // migrate each instance's queue\n    if (old._iq.hasOwnProperty(instance)) {\n      newInstance.getInstance(instance)._q = old._iq[instance]._q || [];\n    }\n  } // If SDK is enabled as snippet, process the events queued by stubbed function\n\n\n  {\n    newInstance.runQueuedFunctions();\n  } // export the instance\n\n  return newInstance;\n});"],"sourceRoot":""}