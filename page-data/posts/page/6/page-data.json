{"componentChunkName":"component---src-templates-posts-page-template-index-tsx","path":"/posts/page/6/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"id":"56876858-4dc2-5375-a626-823564681f17","tableOfContents":"<ul>\n<li>\n<p><a href=\"#compressor\">Compressor</a></p>\n<ul>\n<li><a href=\"#compressror-%EA%B5%AC%ED%98%84%ED%95%B4%EB%B3%B4%EA%B8%B0\">Compressror 구현해보기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#reverb\">Reverb</a></p>\n<ul>\n<li><a href=\"#convolution-reverb\">Convolution Reverb</a></li>\n<li><a href=\"#convolution-reverb-%EA%B5%AC%ED%98%84%ED%95%B4%EB%B3%B4%EA%B8%B0\">Convolution Reverb 구현해보기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#delay\">Delay</a></p>\n<ul>\n<li><a href=\"#delay-%EA%B5%AC%ED%98%84%ED%95%B4%EB%B3%B4%EA%B8%B0\">Delay 구현해보기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#filter\">Filter</a></p>\n<ul>\n<li><a href=\"#filter-%EA%B5%AC%ED%98%84%ED%95%B4%EB%B3%B4%EA%B8%B0\">Filter 구현해보기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#eq\">EQ</a></p>\n<ul>\n<li><a href=\"#%EA%B7%B8%EB%9E%98%ED%94%BD-eq-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0\">그래픽 EQ 구현하기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 저번 포스팅에 이어 HTML5 Audio API를 사용하여 실제로 오디오 이펙터를 만드는 과정에 대해서 포스팅 하려고 한다. 저번 포스팅에서 이미 이야기 했듯이 Audio API는 여러 개의 노드를 연결하여 오디오의 흐름을 만들어 내는 것을 기본 개념으로 가지고 있고, 이펙터를 만들기 위해 필요한 몇 개의 추상화된 노드들을 기본적으로 제공해주기 때문에 그렇게 어려울 건 없다.","html":"<p>이번 포스팅에서는 <a href=\"/2019/08/19/javascript-audio-effectors-gain/\">저번 포스팅</a>에 이어 HTML5 Audio API를 사용하여 실제로 오디오 이펙터를 만드는 과정에 대해서 포스팅 하려고 한다.</p>\n<p>저번 포스팅에서 이미 이야기 했듯이 Audio API는 여러 개의 노드를 연결하여 오디오의 흐름을 만들어 내는 것을 기본 개념으로 가지고 있고, 이펙터를 만들기 위해 필요한 몇 개의 추상화된 노드들을 기본적으로 제공해주기 때문에 그렇게 어려울 건 없다.</p>\n<!-- more -->\n<p>우리는 단지 우리가 만드려고 하는 이펙터들이 각각 어떤 역할을 하며, 어떤 원리를 가지고 있고, 어떤 용도로 사용되는지만 알고 있으면 된다. 오디오에 사용하는 이펙터는 그 종류가 굉장히 많기 때문에 모든 이펙터를 만들어 볼 수는 없고, 필자가 생각했을 때 가장 대표적으로 많이 사용되는 기본적인 이펙터 5개 정도를 구현해볼 생각이다.</p>\n<p>기본적으로 오디오를 로드하여 소스 노드(Source Node)를 생성하는 과정은 이미 저번 포스팅에서 설명했기 때문에 따로 설명하지 않겠다. 이번 포스팅에서는 바로 이펙터를 구현하는 내용부터 설명한다. 모든 이펙터는 먼저 해당 이펙터가 하는 일과 원리에 대해서 간략하게 설명하고 이후 묻지도 따지지도 않고 바로 구현 들어가도록 하겠다.</p>\n<p>자, 그럼 하나하나 뜯어보도록 하자.</p>\n<h2 id=\"compressor\" style=\"position:relative;\">Compressor<a href=\"#compressor\" aria-label=\"compressor permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/a32ed4690c9c17197a82088952b74f1e/b12f7/compressor.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 65.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC9ElEQVR42iVSW0/TABjto4kPxhgjKHc3YGzCkLq262Bu3dbZbm032t3asg46WbuVbXTjMrmIQowiGkVkQwENIAkJCBp98tEfZtXk5OTLSb6ck5wD/Pz1O5mrZStr+sqrlY3t+u5Bfe/wPxr7R41/XN872tk/mlt9U1x8sf62UVl6ltFqrxuHwLvd4yvm4U5HeNAXc9NiIj3Jj6tiVhNlLZVRkxklNa4mpZwwoTrwlNXNEXF5CBttGfAKag34cHDaMejrx+JunJYfTiratCRPRrhkUswU9RmtXClVZrVy1RBBb9Tq5cmUCuGpNrsvV3kK7BycNXWDvSiNU6Mb62t7ezuf9j9+2Nk+PPz8/fv5t4uzi/PT4y8H689XQQ9l8/K0kEdI8aYFkctLQOPzSQsY7BthXVhQ17WVJ8sbr9bfb29t17febr4xjq2tTUOp6CW7i7zjTcmFqisktkKUrD8GGp+OW9HRPjfnQN1ZWcyr2SlNqepFfVqbntbm5/RqpThTLWcn0jbYb/Mm6MS4IxBvG2ZlfRmo7x/fginbfa4XxKyQAZ8N8Rlshfx3nIF+J27AjgYNWNCQ4WGCaQvKtLsiE0bsv89Q2OqOmuDwg4QayZS6oEgglotkyj0uluQLjFTq98SNqH3DozY3hxBjQ/54q5MZLy0C73ePmh2kZYTpAHElX1yo1dqHCKVQWlx4ZELoYrk6PzsP+mKJdK4XoSwoPVWaQYlEMxTOFBcAYwBNdqwXDXeBuP0+A2LR2xAx6IlCfs6oAMHjUCAG+lijbTNMmiDC4WWsKNlsx6TC3F/nARcx5GE67vohPO4kUp1g0GAPLXXDIZQU3LTUg4QsCGmGCDNEDod4myt03QxJ+Rng5eZHLEgNOAOXWgYxgiWj/OX2ex6CpTnxign2kjGKFW5YXBYYv2aGr3cjQnqiB8SAq2Y2rQInX3/4aSEiKlRykuFzUVGleSUq5rnMlLEHVipwkmYojKBQKSUi5iNCjh3LYxS/tPb6DwF8FVn0mZKkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"compressor\" title=\"\" src=\"/static/a32ed4690c9c17197a82088952b74f1e/6af66/compressor.png\" srcset=\"/static/a32ed4690c9c17197a82088952b74f1e/69538/compressor.png 160w,\n/static/a32ed4690c9c17197a82088952b74f1e/72799/compressor.png 320w,\n/static/a32ed4690c9c17197a82088952b74f1e/6af66/compressor.png 640w,\n/static/a32ed4690c9c17197a82088952b74f1e/d9199/compressor.png 960w,\n/static/a32ed4690c9c17197a82088952b74f1e/b12f7/compressor.png 1020w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>컴프레서(Compressor)는 소리가 일정 크기 이상으로 커질 경우에 이를 꾹꾹 눌러서 다시 작은 소리로 만드는 일종의 압축기 역할을 하는 이펙터이다. 이렇게 소리의 크기를 조절하는 이펙터를 다이나믹 이펙터(Dynamic Effector)라고 한다.</p>\n<p>기본적으로 오디오 소스를 사용할 때 기본적으로 컴프레서를 걸어놓고 믹싱을 시작하는 경우가 많은데, 이는 오디오 신호가 일정 크기 이상으로 갑자기 커졌을 때 발생하는 클리핑(Clipping) 현상을 방어하기 위해서이기도 하다. 그럼 여기서 한가지 의문이 들 수 있는데,</p>\n<blockquote>\n<p>아니 단순히 클리핑을 막는 거면 그냥 Gain을 줄이면 해결되는 거 아니야?</p>\n</blockquote>\n<p>맞다. 사실 게인을 줄여도 어느 정도 클리핑을 방어할 수는 있다. 하지만 일반적으로 음악이란 셈여림이 존재하기 때문에 무작정 게인을 낮추면 작은 소리는 아예 입력되지도 않는 슬픈 상황이 발생하게 된다.</p>\n<p>예를 들어 여러분이 노래방에 갔을 때를 생각해보자. 일반적으로 발라드를 부른다면 노래의 도입부에서는 잔잔한 느낌으로 조용히 부르다가 후렴에서는 고음을 내기위해 성대를 통과하는 공기의 압력이 올라가며 음량이 커진다.</p>\n<p>이때 무작정 게인을 낮춰서 녹음하는 방향으로 접근한다면 필연적으로 가장 큰 소리인 후렴의 빵빵 지르는 소리의 크기에 게인을 맞출 수 밖에 없고, 그러면 도입부의 잔잔한 부분은 거의 입력되지 않을 것이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/e94b2e7a65da940d05a7df7a850aac9d/80e3c/buzz.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEBf/EABYBAQEBAAAAAAAAAAAAAAAAAAIAAf/aAAwDAQACEAMQAAAByXSl0ows/8QAGxAAAQQDAAAAAAAAAAAAAAAAAgABESESMTP/2gAIAQEAAQUCiiDFPTyi5lv/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAYEQACAwAAAAAAAAAAAAAAAAAAAQIRIf/aAAgBAgEBPwFy0s//xAAZEAACAwEAAAAAAAAAAAAAAAAAEQECQRD/2gAIAQEABj8CeEaxCKc//8QAHBABAAICAwEAAAAAAAAAAAAAAQARIVExQZHB/9oACAEBAAE/IbOo1cewacGoFEZILtjU91/IlaqrP//aAAwDAQACAAMAAAAQyC//xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8QAyf/xAAWEQEBAQAAAAAAAAAAAAAAAAAAASH/2gAIAQIBAT8QszL/xAAaEAEBAQADAQAAAAAAAAAAAAABEQAhMVFh/9oACAEBAAE/EB/qBR1cZ8PIvmjiSJ5ihS2q6vsxBwCr4zkTAq1d/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"buzz\" title=\"\" src=\"/static/e94b2e7a65da940d05a7df7a850aac9d/c08c5/buzz.jpg\" srcset=\"/static/e94b2e7a65da940d05a7df7a850aac9d/0913d/buzz.jpg 160w,\n/static/e94b2e7a65da940d05a7df7a850aac9d/cb69c/buzz.jpg 320w,\n/static/e94b2e7a65da940d05a7df7a850aac9d/c08c5/buzz.jpg 640w,\n/static/e94b2e7a65da940d05a7df7a850aac9d/80e3c/buzz.jpg 720w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>창법에 따라 조금씩 다르지만 이 음량 차이는 생각보다 크다.</small>\n</center>\n<p>이때 컴프레서로 입력 게인을 적당한 수준으로 높혀주고 너무 큰 소리는 압축하여 노래 도입부의 작은 소리와 후렴부의 큰 소리의 격차를 좁혀 전체적인 소리의 크기를 맞추기 위해서 사용하는 것이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/d9f4ff329a6c4d949f007ffc87a38afd/fb4e7/audio-compression.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 38.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABH0lEQVR42l1Q25LDIAjN///ePna6bdIYN3c1mosILCbdfahzRoHDAaQAJEEi/gOdeLvIbL2vytd2HCgukg7pZuHbQUQqdmTBhhSAViAxVsB8p+yuxKqqx2fdKL0zr0Qm8RhpBAbiwjlrjTl2ofJZnB36Psbjcvc1TGUpxnC7wevFtSK5tWalGKCw1oUQtNZt207T5JyLMfZ9z0SiCd47Y3JRY9w0iYAi7NZBCBIsHo9Ho1T5LJumSUn+mzVz1x0nPTY6HnkKSGkYBjGkujGzZGbxNd7V53yzsTo3P/O0/f2eEC/KL75rW7s40QGy7K/wkFf1gQWwrtRUKqW7jdhHzHFZYcR+x68ZBPNBhTT6AJ7NF+9/2nY7F/mm6D3af+YvnCrO+RaF5TIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"audio compression\" title=\"\" src=\"/static/d9f4ff329a6c4d949f007ffc87a38afd/6af66/audio-compression.png\" srcset=\"/static/d9f4ff329a6c4d949f007ffc87a38afd/69538/audio-compression.png 160w,\n/static/d9f4ff329a6c4d949f007ffc87a38afd/72799/audio-compression.png 320w,\n/static/d9f4ff329a6c4d949f007ffc87a38afd/6af66/audio-compression.png 640w,\n/static/d9f4ff329a6c4d949f007ffc87a38afd/d9199/audio-compression.png 960w,\n/static/d9f4ff329a6c4d949f007ffc87a38afd/21b4d/audio-compression.png 1280w,\n/static/d9f4ff329a6c4d949f007ffc87a38afd/fb4e7/audio-compression.png 1519w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Threshold를 넘어선 세기의 신호를 압축해서 Threshold 밑으로 들어가도록 만든다</small>\n</center>\n<p>또한 필자가 컴프레서 소리를 압축한다고 했는데, 소리를 압축한다는 것이 뭔지 잘 이해가 안갈 수 있다. 대표적인 예로 우리가 일반적인 음원에서 듣고 있는 “퍽!”, “탁!” 하는 깔끔한 드럼소리가 바로 압축된 소리이다. <small>(보통 이렇게 팍팍치는 소리를 Damping이라고 한다.)</small></p>\n<p>일반적으로 드럼을 녹음하면 드럼 특유의 통이 울리는 잔향이 남는데, 이 소리를 컴프레서로 압축하면 우리가 일반적으로 듣는 깔끔한 드럼소리로 만들 수 있다.</p>\n<p>그 외에도 베이스에 컴프레서를 사용하여 단단한 느낌을 부여하거나 멀리 있는 소리를 가까이로 끌어오거나 그 반대 역할도 할 수 있는 등, 컴프레서만 잘 사용해도 소리에 굉장히 많은 느낌을 부여할 수 있다. 그래서 필자에게 사운드 엔지니어닝을 알려주셨던 선생님도 컴프레서의 중요성을 굉장히 강조하셨던 기억이 난다.</p>\n<p>컴프레서는 몇가지 값들을 사용하여 신호를 언제부터 압축할 것인지, 어느 정도의 속도로 압축할 것인지와 같은 세팅을 할 수 있도록 설계되었다. HTML5 Audio API에서 제공하는 <code class=\"language-text\">DynamicsCompressorNode</code>도 이 값들을 동일하게 제공하고 있으므로 우리는 이 값들이 어떤 의미를 가지고 있는지 알아야 올바른 방법으로 이 노드를 사용할 수 있다.</p>\n<h4 id=\"threshold\" style=\"position:relative;\">Threshold<a href=\"#threshold\" aria-label=\"threshold permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>Threshold는 소리를 어느 크기부터 압축할 것인지를 정하는 임계점을 의미한다. 단위는 DB(데시벨)을 사용한다.</p>\n<h4 id=\"ratio\" style=\"position:relative;\">Ratio<a href=\"#ratio\" aria-label=\"ratio permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>Ratio는 Threshold를 넘은 소리가 어느 정도의 비율로 줄어들 것인지를 정하는 값이다. 이 값은 <code class=\"language-text\">입력:출력</code>의 비를 의미하기 때문에 일반적으로는 <code class=\"language-text\">2:1</code>, <code class=\"language-text\">5:1</code>와 같은 비율로 이야기한다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 292px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/4928391f2babd8b6166e59f0d6730a60/2e9f9/ratio.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 97.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAA51AAAOdQG5Y1EyAAAB0ElEQVR42pWT20/CMBjF+f+fNT56JWHGxOALMQa5BE3gSUPETKeBMW7bWMsu7MamZyuOuuCFL1nSNv3tnJ5+LXzsVjHKti3fDzAp7ISGYTgej02Ter6/GwxyMBjYts0MJLBpWf8hV6tVjkzgvf2DmarxS1tJWZYdx8ltK5wcn5YE4ReYafJkEIRYTOCr8hWhNI6in84JzcwtpXQ6nRqGYaf/KtRqdUoXcRzlLiTTXC6XGFuWhZyBBUGwWCyWrpvA5cuyQQjvGQ6jKILmcDh0Xdf3/dlsNplMIIuVfn+gaepa+ejwyCCUh2ESsKqq8/kcu5/SEkWx2+3K8pAQouuq43oJfHd3n9qOM7eAO51OvV5vNBrtdluSJCizwLKK0oySJoECDzebzVKpBAxR4ZA4oWmaEMQ2XdcpIZqq6sY8DyMh+IThnAir+KvYdAPz2SIktvXPtlvDfN/CJK/DV6a5gTVNG41Gbnp1LLC87PfZ6stXAvd6PeTpeR4w2EYqGDhcBTAWJg/4RRRbrdbmVeFDG2AHeogxCIyN2RS9cXN9XalUqtVbQRDOzy+KZ0VcwPb3DDJnW3p9fe49K4oivb0ryujh4RGxrmE+kqw9c4tb0/4EM4F9Se9NBhwAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"ratio\" title=\"\" src=\"/static/4928391f2babd8b6166e59f0d6730a60/2e9f9/ratio.png\" srcset=\"/static/4928391f2babd8b6166e59f0d6730a60/69538/ratio.png 160w,\n/static/4928391f2babd8b6166e59f0d6730a60/2e9f9/ratio.png 292w\" sizes=\"(max-width: 292px) 100vw, 292px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>하지만 HTML5 Audio API의 속성에서는 단위가 조금 다르다. 공식 문서에는 “출력 값의 1db를 변경하기 위해 필요한 db값”이라고 적혀있는데 그냥 이 속성에 <code class=\"language-text\">12</code>를 할당하면 압축 비율이 <code class=\"language-text\">12:1</code>라고 생각하면 된다.</p>\n<p>보통 컴프레서를 적당히 걸었다고 하면 <code class=\"language-text\">4:1</code> 정도의 비율을 말하기 때문에 해당 속성의 기본 값인 <code class=\"language-text\">12:1</code>은 상당히 하드한 압축 비율이라고 할 수 있다.</p>\n<h4 id=\"attack\" style=\"position:relative;\">Attack<a href=\"#attack\" aria-label=\"attack permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>Attack은 소리를 어느 정도의 빠르기로 압축할 것인지를 정하는 값이다. Threshold를 넘은 값을 얼마나 빠르게 때려서 눌러 담을 지를 정하면 된다고 생각하자.</p>\n<p>많은 분들이 여기서 정해주는 어택 타임이 “Attack이 시작되는 시간”으로 잘못 알고 있는 데, 사실 신호의 크기가 Threshold를 넘으면 Attack 자체는 바로 시작된다. 우리가 정해주는 어택 타임은 정해진 “Ratio로 정해준 비율까지 도달하는 데 걸리는 시간”이다.</p>\n<p>단위는 보통 밀리초(Milliseconds)를 사용하지만 Audio API에서는 초(Seconds)를 사용한다.</p>\n<h4 id=\"release\" style=\"position:relative;\">Release<a href=\"#release\" aria-label=\"release permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>Attack이 소리를 누르는 빠르기였다면 Release는 압축한 소리를 어느 정도의 빠르기로 다시 풀어줄 것인가를 정하는 값이다. 이때 풀어주는 값은 소리의 원래 크기가 아니라 표준 음량인 10db에 도달하는 시간을 목표로 한다.</p>\n<p>Release도 Attack과 마찬가지로 단위는 보통 밀리초를 사용하지만 Audio API에서는 초를 사용한다.</p>\n<h4 id=\"knee\" style=\"position:relative;\">Knee<a href=\"#knee\" aria-label=\"knee permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>Knee는 사실 대부분의 하드웨어 컴프레서에는 없는 기능이지만 소프트웨어 컴프레서에서는 꽤 자주 볼 수 있는 기능이다. 이 값은 컴프레서가 얼마나 자연스럽게 적용될 것인지를 결정한다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/aaa2aa40a71cd57ae933e06492b31b1f/68e9c/hard-soft-compression.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 45.62500000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7zAAAO8wEcU5k6AAAA7ElEQVR42mWR2w6DIBBE+f9/1KiJd4zxUlFQ2yPbEhvnQWFmZ9gF5Zw7z/N9A9txHJdlYb3v+3EcT9UYw1r1fW+tFVaqt22DYcE21IlK0LquxoMaVVWVmIPGdhgGrTVM0zRBpUf4l4f2uMx5nrdtS1gcx0mSpGlaliU2DHVdo3ZdRwtRFMHD0CwMlstMn6Ry5uGBjTp4MXMy8xMxzzMMWyJQOUzhcR7vf8iQ8HimaXpeKscoAtDcDwTzhZQ4FszG5YkkgJQnUPzsDUxCqzQmZlS5fAET0TAFX7P0UBRF7pFl2f1tBGRJASpjBv4DXHMHixSVCw8AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"hard soft compression\" title=\"\" src=\"/static/aaa2aa40a71cd57ae933e06492b31b1f/6af66/hard-soft-compression.png\" srcset=\"/static/aaa2aa40a71cd57ae933e06492b31b1f/69538/hard-soft-compression.png 160w,\n/static/aaa2aa40a71cd57ae933e06492b31b1f/72799/hard-soft-compression.png 320w,\n/static/aaa2aa40a71cd57ae933e06492b31b1f/6af66/hard-soft-compression.png 640w,\n/static/aaa2aa40a71cd57ae933e06492b31b1f/68e9c/hard-soft-compression.png 654w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>위 그림의 그래프의 꺾이는 정도가 컴프레서가 얼마나 서서히 적용되는지를 보여주고 있다. 이때 빠르게 팍! 적용하는 컴프레션을 Hard하다고 하고 천천히 적용하는 컴프레션을 Soft하다고 한다.</p>\n<h3 id=\"compressror-구현해보기\" style=\"position:relative;\">Compressror 구현해보기<a href=\"#compressror-%EA%B5%AC%ED%98%84%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"compressror 구현해보기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>사실 위에서 이야기 했듯이 HTML5 Audio API는 자체적으로 <code class=\"language-text\">DynamicsCompressorNode</code>를 제공하기 때문에 우리가 소리를 압축하는 알고리즘을 직접 구현할 필요가 없다. 단지 노드를 생성한 후 연결해주기만 하면 될 뿐이다.</p>\n<p>이번에는 사용자가 업로드한 오디오 파일에서 오디오 버퍼를 추출하여 소스 노드를 생성하는 것이 아니라 <code class=\"language-text\">&lt;audio></code> 태그에서 추출하여 소스 노드를 생성하는 방식으로 진행하도록 하겠다. <small>(이렇게 하면 코드가 훨씬 간단해진다)</small> 지금 생성한 소스노드는 앞으로 다른 이펙터를 구현할 때도 계속 사용할 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> audioContext <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token punctuation\">(</span>AudioContext <span class=\"token operator\">||</span> webkitAudioContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> audioDOM <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my-audio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> sourceNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createMediaElementSource</span><span class=\"token punctuation\">(</span>audioDOM<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> threshold <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">24</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> attack <span class=\"token operator\">=</span> <span class=\"token number\">0.003</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> release <span class=\"token operator\">=</span> <span class=\"token number\">0.25</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> ratio <span class=\"token operator\">=</span> <span class=\"token number\">12</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> knee <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> compressorNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createDynamicsCompressor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompressorNode<span class=\"token punctuation\">.</span>threshold<span class=\"token punctuation\">.</span><span class=\"token function\">setValueAtTime</span><span class=\"token punctuation\">(</span>threshold<span class=\"token punctuation\">,</span> audioContext<span class=\"token punctuation\">.</span>currentTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompressorNode<span class=\"token punctuation\">.</span>attack<span class=\"token punctuation\">.</span><span class=\"token function\">setValueAtTime</span><span class=\"token punctuation\">(</span>attack<span class=\"token punctuation\">,</span> audioContext<span class=\"token punctuation\">.</span>currentTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompressorNode<span class=\"token punctuation\">.</span>release<span class=\"token punctuation\">.</span><span class=\"token function\">setValueAtTime</span><span class=\"token punctuation\">(</span>release<span class=\"token punctuation\">,</span> audioContext<span class=\"token punctuation\">.</span>currentTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompressorNode<span class=\"token punctuation\">.</span>ratio<span class=\"token punctuation\">.</span><span class=\"token function\">setValueAtTime</span><span class=\"token punctuation\">(</span>ratio<span class=\"token punctuation\">,</span> audioContext<span class=\"token punctuation\">.</span>currentTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompressorNode<span class=\"token punctuation\">.</span>knee<span class=\"token punctuation\">.</span><span class=\"token function\">setValueAtTime</span><span class=\"token punctuation\">(</span>knee<span class=\"token punctuation\">,</span> audioContext<span class=\"token punctuation\">.</span>currentTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> inputGainNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> outputGainNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nsourceNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>inputGainNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninputGainNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>compressorNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompressorNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>outputGainNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\noutputGainNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>audioContext<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>필자는 소스 > 게인 > 컴프레서 > 게인의 순서로 오디오 소스의 흐름을 생성했는데, 사실 이건 개인의 취향이다. 하지만 일반적으로 대부분의 컴프레서는 인풋 게인과 아웃풋 게인을 모두 가지고 있으므로 필자도 이와 동일하게 구현했다.</p>\n<p>이후 소스노드를 재생해보면 압축된 소리를 들을 수 있긴 한데, 사실 사운드 엔지니어가 아닌 일반인이 소리의 미세한 압축의 정도를 느끼기는 힘드므로 위의 값들을 조금 극단적으로 바꿔보는 것을 추천한다.</p>\n<h2 id=\"reverb\" style=\"position:relative;\">Reverb<a href=\"#reverb\" aria-label=\"reverb permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/168b553805699d40f75aa40227c69521/e3f06/reverb.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 53.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABgNoc2Cyf/8QAHBAAAQQDAQAAAAAAAAAAAAAAAgABAxESITEy/9oACAEBAAEFAnjoY/ZdN3wDStf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAEAAwAAAAAAAAAAAAAAAAARECBB/9oACAEBAAY/AljKf//EABsQAQADAAMBAAAAAAAAAAAAAAEAESExUWGB/9oACAEBAAE/ITe9ryZx1KHMfCKQuVFayKuf/9oADAMBAAIAAwAAABCrz//EABYRAAMAAAAAAAAAAAAAAAAAABARIf/aAAgBAwEBPxBUf//EABYRAAMAAAAAAAAAAAAAAAAAABARIf/aAAgBAgEBPxBwf//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExUXFhgZH/2gAIAQEAAT8QW++xj9uVzEbtvEvD3EXuMJVpG0jSX4xGWaXon//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"reverb\" title=\"\" src=\"/static/168b553805699d40f75aa40227c69521/c08c5/reverb.jpg\" srcset=\"/static/168b553805699d40f75aa40227c69521/0913d/reverb.jpg 160w,\n/static/168b553805699d40f75aa40227c69521/cb69c/reverb.jpg 320w,\n/static/168b553805699d40f75aa40227c69521/c08c5/reverb.jpg 640w,\n/static/168b553805699d40f75aa40227c69521/e3f06/reverb.jpg 643w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>리버브(Reverb)는 소리에 울림을 통해 공간감을 부여하는 공간계 이펙터이다. 소리에 울림을 통해 공간감을 부여한다는 게 어떤 의미일까?</p>\n<p>사실 우리는 소리를 듣고 현재 있는 공간이 넓은지 좁은지, 이 공간이 거친 벽면으로 이루어져 있는지, 아니면 유리같은 맨들맨들한 공간으로 이루어져 있는지를 대략적으로 파악할 수 있다. 그 차이가 워낙 미세해서 훈련되지 않은 사람이라면 알아채기 힘들 뿐이다.</p>\n<p>어떻게 이런 일이 가능할까? 바로 소리의 반사에 의한 잔향 때문이다. 먼저, 소리를 듣고 공간의 크기를 감지하는 원리는 간단하다. 필자가 어떤 방 안에서 소리를 “왁!”하고 지른 뒤 얼마 후에 첫번째 반사음이 들리는지를 감지하면 된다.</p>\n<p>하지만 이 첫번째 반사음은 밀리초 단위의 굉장히 빠른 속도로 다시 필자에게 돌아오기 때문에 1초, 2초 이렇게 세는 것이 아니라 그냥 느껴야하는 것이다. 이때 이 반사음을 초기 반사음(Early Reflection)이라고 한다.</p>\n<p>하지만 여기서 끝이 아니다. 소리가 한번 반사되어 여러분의 귀로 전달된 뒤에도 반사는 계속 될 것이다. 이때 이 잔향들은 공간의 사방팔방으로 부딪히고 반사되어 여러분의 귀로 다시 돌아올 것이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/3457634accb0a45c9bd6199020317de9/2bef9/reflection.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 46.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7zAAAO8wEcU5k6AAABwUlEQVR42l2RWW/TQBSF80/5JTyUB5SqvIDECxSJCipBW+jqSlWhJK5jgSjQdImdOIuz2HGc2p7FM7Znxh6ciE0cnbd7vivdeypMsNJC5kIWoshFIX5ZikIWeZFnPMtYxssYz1KWMc7+ZCpBFGCCBQKp7zEEFluWg5IBENxcX6ulNP1wb79eq6t11R7aUkqe8wU8Gg8xAjwhnGe54IXMly4iEFmd7slpXdlVdl5uP37y/O274zdbh4bZ/geejDCMshhSwRKRYUZKJyKllDqO22joTx+tvVdOjmqfVe3rp5o282d/YddzCYIJAYjROQmn8dwjQSySMAx73Z7RalVXqz8MY2j3e5blz2fF4jW/b8Y0TmmcxABxMsF+HzgTNLujIKExpQhhbBomAABiFEHABOe5YOV5+RKOE5IlJCUQcmqEg4Z7pbs3Gy3l2Ljtu8k0oCQV8n8VcllEBcaIIBDDIEhRc9apjb6dj5sPvjy793pj5UWvutl5+Kpzf91c3bTWj+x9zf144Z1fzZvdkKS0UvYRRQGEUYiBG3nDO2ccTL87t7rVvmz7F4anXboH2mjrw2DnbLCn2oo+3j41d8+MCKGfxXPjjIB+Rd8AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"reflection\" title=\"\" src=\"/static/3457634accb0a45c9bd6199020317de9/6af66/reflection.png\" srcset=\"/static/3457634accb0a45c9bd6199020317de9/69538/reflection.png 160w,\n/static/3457634accb0a45c9bd6199020317de9/72799/reflection.png 320w,\n/static/3457634accb0a45c9bd6199020317de9/6af66/reflection.png 640w,\n/static/3457634accb0a45c9bd6199020317de9/d9199/reflection.png 960w,\n/static/3457634accb0a45c9bd6199020317de9/2bef9/reflection.png 1024w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>초록색 선이 초기 반사음, 사방팔방 부딪히는 파란색 선이 바로 잔향이다</small>\n</center>\n<p>이때 이 잔향이 얼마나 오래 들리는가, 얼마나 선명하게 들리는가와 같은 특성이 방의 재질을 결정한다. 이야기만 들으면 이렇게 소리를 듣고 공간을 판별한다는 것이 불가능한 것 같지만 여러분이 이미 평소에 듣고 음악에는 모두 이 원리를 적용한 공간적 설계가 함께 담겨있다.</p>\n<p>이렇게 리버브는 말 그대로 잔향을 만들어내기만 하면 되기 때문에 하드웨어 리버브 중에서는 스프링이나 철판 등의 재료를 장비 내부에 넣어놓고 오디오를 재생하여 재료가 떨리며 발생한 잔향을 증폭하는 방식을 사용하는 것도 있다. 즉, 뜯어보면 장비 내부에 스프링이나 철판 하나 딸랑 들어있다는 것이다. <small>(이런 단순한 구조로 좋은 소리를 뽑는다는 게 더 무섭…)</small></p>\n<p>그러나 리버브를 소프트웨어로 구현할 때는 이야기가 조금 다르다. 컴퓨터는 스프링이나 철판의 떨림과 같은 자연적인 아날로그 신호를 생성할 수 없으므로 직접 계산을 통해 구현해야한다. 이때 소프트웨어 리버브는 크게 두 가지 종류로 나누어지는데 바로 Convolution Reverb와 Algorithm Reverb이다.</p>\n<p>하지만 이 포스팅에서 두 리버브를 모두 구현하기에는 글이 너무 길어질 것 같으므로 아쉬운대로 컨볼루션 리버브에 초점을 맞춰 진행하겠다. <small>(알고리즘 리버브만 해도 포스팅 하나 분량이다.)</small></p>\n<h3 id=\"convolution-reverb\" style=\"position:relative;\">Convolution Reverb<a href=\"#convolution-reverb\" aria-label=\"convolution reverb permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>컨볼루션 리버브(Convolution Reverb)는 실제 공간의 잔향을 녹음한 후에 잔향 오디오 소스와 원본 오디오 소스를 실제 공간의 울림을 원본 오디오 소스에 합성하는 방법이다.</p>\n<p>이때 실제 공간의 잔향을 녹음하는 대표적인 방법을 간단하게 설명하자면, 녹음하고자 하는 공간에 순수한 사인파(Sine Wave)의 소리를 낮은 주파수부터 높은 주파수까지 쭈우우욱 이어서 틀고 그때 발생하는 잔향을 녹음하는 것이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/139d22412a234cb2ac3a54c80f1ef282/46590/ir-recording.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 95.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwT/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAa01zxrFI74LLA//xAAZEAEBAAMBAAAAAAAAAAAAAAABAAIQISL/2gAIAQEAAQUCnWXWYCDyA3//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAZEAABBQAAAAAAAAAAAAAAAAAAARAgIYH/2gAIAQEABj8CljWh/8QAHBAAAwABBQAAAAAAAAAAAAAAAAERQRAhMVFh/9oACAEBAAE/IX1qil28HIcixKBGGYJahs//2gAMAwEAAgADAAAAELwvPP/EABURAQEAAAAAAAAAAAAAAAAAAAEg/9oACAEDAQE/ECP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhMWFB/9oACAEBAAE/EA3fpLnCDS59gENtqLQhtsAPZm2lLnkO2loT5U1kCXU//9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"ir recording\" title=\"\" src=\"/static/139d22412a234cb2ac3a54c80f1ef282/c08c5/ir-recording.jpg\" srcset=\"/static/139d22412a234cb2ac3a54c80f1ef282/0913d/ir-recording.jpg 160w,\n/static/139d22412a234cb2ac3a54c80f1ef282/cb69c/ir-recording.jpg 320w,\n/static/139d22412a234cb2ac3a54c80f1ef282/c08c5/ir-recording.jpg 640w,\n/static/139d22412a234cb2ac3a54c80f1ef282/6a068/ir-recording.jpg 960w,\n/static/139d22412a234cb2ac3a54c80f1ef282/eea4a/ir-recording.jpg 1280w,\n/static/139d22412a234cb2ac3a54c80f1ef282/46590/ir-recording.jpg 2561w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>공간의 IR을 녹음하는 모습 - 출처: http://www.alanjshan.com/impulse-response-capture/</small>\n</center>\n<p>이때 이 잔향 신호를 Impulse Response(IR)이라고 부르기 때문에 컨볼루션 리버브는 IR 리버브라는 이름으로도 불린다. 이렇게 녹음한 IR은 원본 소스에 컨볼루션(Convolution), 또는 합성곱이라고 불리우는 연산을 통해 합쳐지게 된다.</p>\n<p>이 컨볼루션이라는 개념을 수학적으로 접근하기 시작하면 머리도 아프고 또 포스팅이 길어지니까 간단하게 정의해보자면, 그냥 서로 다른 정보들을 섞는 것이라고 표현할 수 있다.</p>\n<p>이 포스팅을 읽는 분들은 아마 개발자 분들이 많을 테니 우리에게 좀 더 친숙한 머신러닝을 사용하여 컨볼루션을 설명하자면 학습 알고리즘 중 하나인 <a href=\"https://en.wikipedia.org/wiki/Convolutional_neural_network\" target=\"_blank\" rel=\"nofollow\">CNN(Convolution Neural Network)</a>을 예로 들어볼 수 있겠다.</p>\n<p>CNN에서도 첫번째 레이어의 이미지를 두번째 레이어로 보낼 때 행렬로 구현한 커널<small>(또는 필터)</small>와 이미지를 섞어서 피처맵을 생성한 후 다음 레이어로 보내게된다. 이때 첫번째 레이어의 이미지와 커널의 정보가 섞인 것이라고 생각할 수 있다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/380a88c34eac31f9a0af42f7f4de4002/0b533/convolution.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 38.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1klEQVR42mN4/Pjx8+cvHj1+8uD+/Z8/f/7////7929Pnz598/r182fPHj58/OXrN6Dgv79/37179/btu8+fPn358uXTp89AQYZbt249evTkzt37ly5d+vnrF1Do16+ft2/fOnr06JEjRy9euvLt+4//IPDvzp07J06cvHrlyvUbNy5cvPz37z+Gvdt37t68+eCO7avmL1g0cwZI1b9/P3/8ePz4ycNHj758/fr371+g4O07d4KDg8PCQkNCgHSIn6/f/fv3GTbO6VvYVpgX5VcY5jy9o/7f//+PHj18//793z9/gOSvX79ev3nz6tWrM2fO8PDwcHJwcnFyiouK8nJzX716lcHDSKsh2ac81rMjw/fY5iU/f/4CevjDhw9///4B6gFqfvPmDdC3586d4+Hm4eXllZSQUFJU5OPlO3/+PIOVkpi7gXJuoG1Dovv+NXN//Pz54sWLt2/fAh0P1Pb792+gTqApFy9cEBYW5uXhFRQUlJOV4eHiAhrHUJ/ol+iib6vA56cnvnV+5w+wzcDwBGoD2g8k34PBqVOnGGCAhYWFjYUFpPn0vq0nd29cOWfS8hn9V0/shQTYfyQACTCgiXV1dU1NTS3NzS0tLRP6+1++fAkAiH1QfGGJI9IAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"convolution\" title=\"\" src=\"/static/380a88c34eac31f9a0af42f7f4de4002/0b533/convolution.png\" srcset=\"/static/380a88c34eac31f9a0af42f7f4de4002/69538/convolution.png 160w,\n/static/380a88c34eac31f9a0af42f7f4de4002/72799/convolution.png 320w,\n/static/380a88c34eac31f9a0af42f7f4de4002/0b533/convolution.png 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>원본 이미지와 커널을 섞어서 새로운 정보인 피처맵을 만들어낸다</small>\n</center>\n<p>오디오에서의 컨볼루션 리버브도 이와 마찬가지다. 이 경우에는 섞어야하는 정보가 원본 소스와 IR이 된 것 뿐이다.</p>\n<p>컨볼루션은 원본 소스와 IR이라는 두 오디오 소스의 주파수 스펙트럼을 곱하는 과정이기 때문에 이를 통해 두 소스 간에 겹치는 주파수는 강조되고 겹치지 않는 주파수는 감쇠된다. 이렇게 원본 소스와 IR 간 겹치는 주파수가 강조되면 원본 소스는 IR의 음질의 특성을 띄게 되는데, 이게 바로 컨볼루션 리버브의 원리이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c055ddb7e8755ffb1cfef849a60b862f/5a190/signal-convolution.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 82.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAFxGAABcRgEUlENBAAACIElEQVR42m1Ta2OjIBDM//9x109tEpPGmPSiBBVUQB4CN0guvfa6vkbYWWaXZRNj9N7jHVbLv3nkCZZleU5lT4wAbPBhjBlj5nmWUmptp2kSQjpnx3EEdM5xxvgw3+m43+/qur5er33fJ7LWGk5rVMT2jAXciI7FjAlZEBaQjJPq8uvlZbfbEUKEEIlsrc1o1RUB2zaBxYX6FtbRoFRY3IInJ4JwkJnIUAW1iYxHCcn0JCOmgo93GrVJgRoSVXL+NOj9lI14i3MTGbuy15RpOtiuZxcyfBDT3vvqzq93TRvWMEI0Y7NSab0NSsU5x/rWGG2sc54PfdPdftfX90NR7PdVeS72u/djsXt7O5/P2+3+dCqHYXjknGU/jWnONU9ph8V6G3+yh+xnztkWv0xmwu2Dx5tKimLgMov5gZy24S8ZHtIKaaXzbrKjcEI5NS+z9poZBmC8ccFBjsw5QzYSQOapcmrsBq6wD0rdu/7jRi5VtT1si1NxuVxO1el4Pr4Wr4fyMInpUbB/93ngkbHUMkr5rjPjyAc+KCnhM6sZJcWvmMRjn58FW8lBytB16Db0c6zrR4YIvjb1fzl/JUdAuTYJvCkFSKNNE581DWvXPVZGDBwM1Bz6+163rcUEAKU4IZZz23WWEEWpaVvTNBIOjGmRc0ajKqVQ89Qn1oTgQc6gLMu6vq29jbNl4QLO2ooWlET+tvtZfD60KJL61tNf7Q/9w9fqrhB2GAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"signal convolution\" title=\"\" src=\"/static/c055ddb7e8755ffb1cfef849a60b862f/6af66/signal-convolution.png\" srcset=\"/static/c055ddb7e8755ffb1cfef849a60b862f/69538/signal-convolution.png 160w,\n/static/c055ddb7e8755ffb1cfef849a60b862f/72799/signal-convolution.png 320w,\n/static/c055ddb7e8755ffb1cfef849a60b862f/6af66/signal-convolution.png 640w,\n/static/c055ddb7e8755ffb1cfef849a60b862f/5a190/signal-convolution.png 800w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>원본 신호와 녹음한 IR 신호를 컨볼루션 연산한 모습</small>\n</center>\n<p>사실 HTML5 Audio API는 컨볼루션 연산을 대신 수행해주는 <code class=\"language-text\">ConvolverNode</code>를 제공하기 때문에 컨볼루션이 무엇인지 몰라도 컨볼루션 리버브를 만드는 데는 아무 문제가 없다.</p>\n<p>그러나 적어도 이 이펙터가 2개의 신호 정보를 곱해서 새로운 신호를 만들어내는 원리를 가지고 있다는 것을 알아야 필자가 왜 이런 코드를 작성하는지도 알 수 있기 때문에 대략적인 설명을 하는 것이다.</p>\n<p>어쨌든 컨볼루션 리버브의 대략적인 원리를 파악했다면 이제 바로 만들어보도록 하자.</p>\n<h3 id=\"convolution-reverb-구현해보기\" style=\"position:relative;\">Convolution Reverb 구현해보기<a href=\"#convolution-reverb-%EA%B5%AC%ED%98%84%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"convolution reverb 구현해보기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>먼저 HTML5 Audio API는 <code class=\"language-text\">ReverbNode</code> 같은 건 제공하지 않는다. 하지만 위에서 설명했듯이 컨볼루션 연산을 지원하는 <code class=\"language-text\">ConvolverNode</code>를 제공해주고 있기 때문에 우리는 잔향 소스인 IR(Impulse Response)만 직접 만들어주면 된다.</p>\n<p>그리고 일반적으로 리버브는 <code class=\"language-text\">wet</code>과 <code class=\"language-text\">dry</code>라는 수치로 원본 소스와 잔향 소스를 비율에 맞게 섞을 수 있도록 제작되므로 필자도 동일하게 코드를 작성하겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> mix <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> time <span class=\"token operator\">=</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> decay <span class=\"token operator\">=</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>리버브의 사용할 3개의 변수를 먼저 설명하자면, <code class=\"language-text\">mix</code>는 wet/dry의 비율을 의미하고, <code class=\"language-text\">time</code>은 잔향의 길이, <code class=\"language-text\">decay</code>는 잔향이 감소하는 빠르기를 의미한다. 그럼 이제 이 값들을 사용하여 직접 IR을 생성해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">generateImpulseResponse</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> sampleRate <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span>sampleRate<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> length <span class=\"token operator\">=</span> sampleRate <span class=\"token operator\">*</span> time<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> impulse <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createBuffer</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> length<span class=\"token punctuation\">,</span> sampleRate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> leftImpulse <span class=\"token operator\">=</span> impulse<span class=\"token punctuation\">.</span><span class=\"token function\">getChannelData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> rightImpulse <span class=\"token operator\">=</span> impulse<span class=\"token punctuation\">.</span><span class=\"token function\">getChannelData</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    leftImpulse<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> i <span class=\"token operator\">/</span> length<span class=\"token punctuation\">,</span> deacy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    rightImpulse<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> i <span class=\"token operator\">/</span> length<span class=\"token punctuation\">,</span> deacy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> impulse<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>뭔가 복잡해보이지만 뜯어보면 별 거 없다. <code class=\"language-text\">sampleRate</code>는 우리가 생성하고자 하는 <code class=\"language-text\">IR</code>의 샘플레이트, 즉 음질을 의미하고 <code class=\"language-text\">length</code>는 <code class=\"language-text\">sampleRate * time</code>, 즉 <code class=\"language-text\">time</code>초 만큼의 잔향을 표현하기 위한 버퍼의 길이를 의미한다.</p>\n<p>그리고 그냥 버퍼 노드를 하나 생성한 다음 <code class=\"language-text\">-1 ~ 1</code>의 무작위 값을 생성한 후 <code class=\"language-text\">1 - i / length</code>에 <code class=\"language-text\">decay</code>를 제곱한 후 방금 생성한 난수에 곱해준다. 이러면 <code class=\"language-text\">i</code>값이 커질수록 값이 작아질 것이고, <code class=\"language-text\">deacy</code> 값이 커질수록 더 빠르게 작아질 것이다. 이는 잔향의 감쇠를 표현 해준 것이다. 이후 이 샘플을 방금 만든 버퍼 노드에 쭈르륵 담아주면 끝이다.</p>\n<p>이렇게 생성된 IR 버퍼를 파형으로 표현해보면 대략 다음과 같은 모양을 가질 것이다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/2e23d03eabacbb33bc757852ef9e0434/212bf/decay.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 126.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAZABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECBAX/xAAXAQEBAQEAAAAAAAAAAAAAAAABAgAD/9oADAMBAAIQAxAAAAHVfnbp52DMWgJB3//EABoQAAICAwAAAAAAAAAAAAAAAAEDEBECEiD/2gAIAQEAAQUCxlRZY2gChz//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAACAQUAAAAAAAAAAAAAAAABEQAQMDFBof/aAAgBAQAGPwKpQYe5jtj/xAAdEAACAgEFAAAAAAAAAAAAAAAAAREhURAxcbHw/9oACAEBAAE/IWUV0e2GQ9ZmRFwHJEJKi8D1Z//aAAwDAQACAAMAAAAQAx+w/8QAFxEBAQEBAAAAAAAAAAAAAAAAARARYf/aAAgBAwEBPxBRm8n/xAAXEQEAAwAAAAAAAAAAAAAAAAAQAREh/9oACAECAQE/ENgo/8QAIBABAAICAgEFAAAAAAAAAAAAAQARITFBURBhcYGRsf/aAAgBAQABPxBBVvgG4C8p7iCqvPxMg4bUGeGWh6mWn5FYsNdxiWhu9svq+5a8lQ0eN5//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"decay\" title=\"\" src=\"/static/2e23d03eabacbb33bc757852ef9e0434/c08c5/decay.jpg\" srcset=\"/static/2e23d03eabacbb33bc757852ef9e0434/0913d/decay.jpg 160w,\n/static/2e23d03eabacbb33bc757852ef9e0434/cb69c/decay.jpg 320w,\n/static/2e23d03eabacbb33bc757852ef9e0434/c08c5/decay.jpg 640w,\n/static/2e23d03eabacbb33bc757852ef9e0434/212bf/decay.jpg 768w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>쨘, 이렇게 간단하게 IR을 생성해보았다. 이제 <code class=\"language-text\">ConvolverNode</code>를 사용하여 원본 소스와 이 IR을 합성해주는 것만 남았다. 리버브 이펙터의 오디오 흐름을 만들기 위해서 필요한 노드들을 먼저 생성해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> inputNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> wetGainNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> dryGainNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> reverbNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createConvolver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> outputNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>위에서도 설명했듯이 일반적인 리버브 이펙터는 wet/dry라는 수치를 사용하여 원본 소스와 리버브가 적용된 소스를 섞어서 출력하는 기능을 제공한다. 이때 dry한 소스는 리버브 이펙터를 거치지 않고 바로 <code class=\"language-text\">outputNode</code>로 연결되서 출력되어야 하며, wet한 소스는 우리가 만든 <code class=\"language-text\">reverbNode</code>를 한번 거치고 <code class=\"language-text\">outputNode</code>로 출력되어야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">sourceNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>inputNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Dry 소스 노드 연결</span>\ninputNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>dryGainNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndryGainNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>outputNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndryGainNode<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> mix<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// IR을 생성하여 Convolver의 오디오 버퍼에 입력해준다.</span>\nreverbNode<span class=\"token punctuation\">.</span>buffer <span class=\"token operator\">=</span> <span class=\"token function\">generateImpulseResponse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Wet 소스 노드 연결</span>\ninputNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>reverbNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nreverbNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>wetGainNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwebGainNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>outputNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwetGainNode<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">.</span>vaule <span class=\"token operator\">=</span> mix<span class=\"token punctuation\">;</span>\n\noutputNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>audioContext<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이렇게 컨볼루션 리버브를 간단하게 구현해보았다. 사실 컨볼루션 리버브의 퀄리티에 가장 큰 영향을 끼치는 것은 IR의 퀄리티인데, 우리는 대충 만든 샘플 오디오로 IR을 만들었으므로 이 리버브의 퀄리티는 좋을 수가 없다. 그러나 소스 노드를 재생해서 들어보면 신기하게도 소리에 공간감이 부여된 것을 들어볼 수 있다.</p>\n<p>만약 기회가 된다면 다음에는 알고리즘 리버브의 구현체도 한번 포스팅 해보도록 하겠다. 알고리즘 리버브는 실제 공간의 잔향을 녹음하여 사용하는 컨볼루션 리버브와는 다르게 100% 알고리즘으로만 구현된 리버브이다. 그렇기 때문에 약간 인위적인 느낌이 나기는 하지만 컨볼루션 리버브와는 또 색다른 느낌을 부여할 수 있으므로 사운드 엔지니어들은 이 두가지 리버브의 특성을 파악하고 적재적소에 사용한다.</p>\n<p>그렇기 때문에 개발자들에게는 오히려 컨볼루션 리버브보다 알고리즘 리버브 쪽이 더 이해가 잘될 수 있으나, <code class=\"language-text\">ConvolverNode</code> 하나와 대충 만든 IR만 있으면 나머지는 알아서 다 연산해주는 컨볼루션 리버브와는 다르게 알고리즘 리버브는 진짜 밑바닥부터 만들어야한다. 그래서 아쉽지만 알고리즘 리버브는 다음에 포스팅 하도록 하겠다.</p>\n<p>만약 알고리즘 리버브의 구현체가 궁금하신 분은 <a href=\"https://github.com/evan-moon/simple-waveform-visualizer/blob/master/src/lib/effects/AlgorithmReverb.js\" target=\"_blank\" rel=\"nofollow\">필자의 깃허브 레파지토리</a>에서 확인해볼 수 있다.</p>\n<h2 id=\"delay\" style=\"position:relative;\">Delay<a href=\"#delay\" aria-label=\"delay permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/6c84397372fb970c1df011b86b5edfef/29177/delay.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 38.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBP/EABUBAQEAAAAAAAAAAAAAAAAAAAED/9oADAMBAAIQAxAAAAHPUhaAP//EABcQAAMBAAAAAAAAAAAAAAAAAAECERD/2gAIAQEAAQUCLYZf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGxAAAQQDAAAAAAAAAAAAAAAAAQAQETFBUaH/2gAIAQEABj8CEnivOm//xAAZEAEBAQADAAAAAAAAAAAAAAABEQAhMUH/2gAIAQEAAT8hSAWVcs4h9Y6zrf/aAAwDAQACAAMAAAAQdC//xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QQ22//8QAFxEBAAMAAAAAAAAAAAAAAAAAAAERMf/aAAgBAgEBPxCMU//EABkQAAIDAQAAAAAAAAAAAAAAAAEhABFRMf/aAAgBAQABPxBUKIoScjwgC2cEcAZd5P/Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"delay\" title=\"\" src=\"/static/6c84397372fb970c1df011b86b5edfef/c08c5/delay.jpg\" srcset=\"/static/6c84397372fb970c1df011b86b5edfef/0913d/delay.jpg 160w,\n/static/6c84397372fb970c1df011b86b5edfef/cb69c/delay.jpg 320w,\n/static/6c84397372fb970c1df011b86b5edfef/c08c5/delay.jpg 640w,\n/static/6c84397372fb970c1df011b86b5edfef/29177/delay.jpg 749w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>딜레이(Delay)는 리버브와 같은 공간계 이펙터이고 소리를 반복해서 들려준다는 점이 같기 때문에 비슷하다고 생각할 수 있지만 그 원리와 용도는 많이 다르다.</p>\n<p>먼저, 딜레이는 단순히 소리를 반복하는 효과이지만 리버브는 공간 내에서의 복잡한 반사음을 흉내내는 것이므로 딜레이만 사용하면 리버브와 같은 자연스러운 공간감을 표현하기가 힘들다.</p>\n<p>방금 만들어봤던 리버브 이펙터는 사실적인 공간 표현이 목적이기 때문에 컨볼루션이나 복잡한 알고리즘을 사용하지만 딜레이는 그냥 원본 소스를 잠깐 지연시켰다가 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>초 후에 다시 틀어주면서 조금씩 소리를 작게 해주면 끝이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/ecca82a37017f0e66ca8ff5f4c42f25d/1f083/reverb_vs_delay.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3UlEQVR42p1SPW8aQRDlH7uMlCJKE6VwOnf5AenduCIgwUl2QUMTO0LojiMgA/e9s7v3/TxzYAFx7EheaW53b3fevvdmemmawliL1XKJ2f09qqrCO0Yjn7Zt/V5RFEiVAsoSTZJ2p5o0wjD6ZyYnIcsyJEnSzXVdnwOWDJQRgamh5QsyrGmgVLNf5wWSTB2pNA2GwyEGgwFGoxGWrOwloDA8A2yhDhgFO6DsOUNRled5Z88LhvIzjCIY9pK2W+RlgTg22O00cquZncaO98ZoVqIRM1trZX8MrXUjjwRB4PcEWV4jxYlbwsODi8UiwCawnKwRxOwnz0prpBy0B+jiFFA8jeN4D3g6RMJBxvuqbLllxOi6ruB5Lpv8B6vVCuv1mn1UkLZKuPqyfm4p8VFyTuIIKBdJE3JVwv21ZEkJt0zcAYkV8qCErA95/+vDkkHY6LTCj+8Zgq79Wj7Eq33oOA4mkwmm0ynG47Gsn1/ithFAZliZCt8+Z/jyFbi9FUmvG7bZbDCfz+G6LmazGRdxcQQUhkorlFTi8lOKDx+Bi4sWV1fA3R1YOt4EP5XMlvg9rihxuSnchjQepNT/aanft3RzY+j62pDjGHp8LIgL092TiKLo78g8z6t83//9BM+R5WNJLGHCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"reverb vs delay\" title=\"\" src=\"/static/ecca82a37017f0e66ca8ff5f4c42f25d/6af66/reverb_vs_delay.png\" srcset=\"/static/ecca82a37017f0e66ca8ff5f4c42f25d/69538/reverb_vs_delay.png 160w,\n/static/ecca82a37017f0e66ca8ff5f4c42f25d/72799/reverb_vs_delay.png 320w,\n/static/ecca82a37017f0e66ca8ff5f4c42f25d/6af66/reverb_vs_delay.png 640w,\n/static/ecca82a37017f0e66ca8ff5f4c42f25d/1f083/reverb_vs_delay.png 660w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Echo(Delay)와 Reverb의 차이</small>\n</center>\n<p>딜레이는 이렇게 간단한 원리를 가지고 있기 때문에 만드는 것 역시 그렇게 어렵지 않다.</p>\n<h3 id=\"delay-구현해보기\" style=\"position:relative;\">Delay 구현해보기<a href=\"#delay-%EA%B5%AC%ED%98%84%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"delay 구현해보기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>HTML5의 Audio API는 인풋으로 받은 신호를 지연시켜서 다시 출력하는 <code class=\"language-text\">DelayNode</code>를 제공해주기 때문에 우리는 이 노드를 사용하여 간단하게 딜레이 이펙터를 구현할 수 있다.</p>\n<p>그러나 단순히 <code class=\"language-text\">DelayNode</code>만 사용한다면 단 한번의 지연만 발생시킬 수 있기 때문에 우리는 한가지 얌생이를 사용하여 딜레이를 구현할 것이다. 먼저 딜레이에 필요한 변수들을 선언해보도록 하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> mix <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> feedback <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> time <span class=\"token operator\">=</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>리버브와 마찬가지로 대부분의 딜레이 이펙터도 wet/dry 값을 사용하여 원본 소스와 딜레이된 소스를 섞어서 출력해주는 기능을 가지고 있기 때문에 필자도 동일하게 구현해줄 것이다. 그리고 <code class=\"language-text\">feedback</code> 변수는 원본 소스가 한번 딜레이될 때 감소시킬 음량이고 <code class=\"language-text\">time</code> 변수는 메아리들의 간격을 의미한다. 딜레이에 사용할 변수들을 모두 선언했다면 이제 노드들을 만들 차레이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> inputNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> wetGainNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> dryGainNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> feedbackNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> delayNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createDelay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> outputNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">webGainNode</code>와 <code class=\"language-text\">dryGainNode</code>는 리버브와 동일하기 때문에 그냥 넘어가고, 새로운 노드인 <code class=\"language-text\">feedbackNode</code>와 <code class=\"language-text\">delayNode</code>에 집중해보자. 사실상 딜레이 이펙터는 이 두개의 노드가 핵심이다. 먼저, 딜레이 이펙터가 하는 일에 대해서 다시 한번 살펴보자.</p>\n<blockquote>\n<p>입력 -> 지연 -> 감소된 신호 출력 -> 입력 -> 지연 -> 감소된 신호 출력…</p>\n</blockquote>\n<p>딜레이 이펙터가 하는 일은 이게 전부다. 신호를 조금씩 지연시키고 감소된 신호를 다시 출력하는 일을 반복한다. 그래서 필자는 <code class=\"language-text\">delayNode</code>와 <code class=\"language-text\">feedbackNode</code>를 서로 연결해주는 방법으로 이 이펙터를 구현하려고 한다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/4d190f766bb560920bc66390824efb6c/29114/delay-nodes.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUklEQVR42mP4jxv8AgM8ChjwyH3+/Onjxw///v3DqXnHuXUZ00MqF6dXL8kEMjafWg0U3bTqZFrI9MrMJVVZS4GMzatPgQRPrsyaEVa1OAOoMnNGKFAjQ9f6KokEBvtqFccaNfF4hpYVpUB1tfkLxRkSbVWr7NSqRRni6wsXAwUblxbJpjA41mo41qjLJDF0ratiuPn0yorDc9cdX7z22MIVh+fceHIZqO78mTtLZx9cufDwygWHgQwgFygIlAIqgKsEasTi579///78+RNZBMgFCmLxMzA8/vz9A0d//4EUXXtwae2xJRtPLAeitUeXXHt4CWTov7/IKoEa0W3+8/c3kOxYXamVy+tap+1Wr6uVy9e2qhws9YdAVEFUbDy5LHGyT9H8+OJ58UDGhhNLwd75Q2w8f/76+dXrl2/fvfny5TPJiQQYQr9//wECrEEF0QwAoJQty6GnAz4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"delay nodes\" title=\"\" src=\"/static/4d190f766bb560920bc66390824efb6c/6af66/delay-nodes.png\" srcset=\"/static/4d190f766bb560920bc66390824efb6c/69538/delay-nodes.png 160w,\n/static/4d190f766bb560920bc66390824efb6c/72799/delay-nodes.png 320w,\n/static/4d190f766bb560920bc66390824efb6c/6af66/delay-nodes.png 640w,\n/static/4d190f766bb560920bc66390824efb6c/d9199/delay-nodes.png 960w,\n/static/4d190f766bb560920bc66390824efb6c/21b4d/delay-nodes.png 1280w,\n/static/4d190f766bb560920bc66390824efb6c/29114/delay-nodes.png 1920w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>이렇게 간단한 연결만으로 딜레이를 구현할 수 있다</small>\n</center>\n<p>이렇게 노드들을 연결하게되면 <code class=\"language-text\">DelayNode</code>를 통해 입력된 오디오 신호가 지연된 후 <code class=\"language-text\">FeedbackNode</code>와 <code class=\"language-text\">OutputNode</code>로 출력되고, <code class=\"language-text\">FeedbackNode</code>를 통해서 게인이 감소된 소리는 다시 <code class=\"language-text\">DelayNode</code>로 입력되어 지연된 후 <code class=\"language-text\">OutputNode</code>로 출력될 것이다. 그럼 위 그림대로 한번 노드들을 연결해보도록 하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">sourceNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>inputNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Dry 소스 노드 연결</span>\ninputNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>dryGainNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndryGainNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>outputNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndryGainNode<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> mix<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Delay 루프 생성</span>\ndelayNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>feedbackNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfeedbackNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>delayNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Wet 소스 노드 연결</span>\ninputNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>delayNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndelayNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>wetGainNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwetGainNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>outputNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwetGainNode<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">.</span>vaule <span class=\"token operator\">=</span> mix<span class=\"token punctuation\">;</span>\n\noutputNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>audioContext<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이제 소스 노드를 재생해보면 딜레이 이펙터를 통해 메아리가 치는 듯한 효과가 적용된 소리를 들어볼 수 있다.</p>\n<h2 id=\"filter\" style=\"position:relative;\">Filter<a href=\"#filter\" aria-label=\"filter permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/39acf359c2bf68c771d7db4d300523e5/54bf4/filter.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACVUlEQVR42n2S62/SUBjG+4+ZuCkQNtrSy+k5vcM2NtyAkTHuhbbQFlqg5TLXdTpxLsY4Y2L84N/n4YOJiYnJkydPzsnvfd9zIWzHm8yXlr/2o5t5/LR6eH77+D358mvz8UcQP9mLu844rHVsqJfSQErKlZakvSBZuViioEwMJks3jDujWa0zcqPEixI3TGbxk7veWvO4562aZlBpmvLJOSqeiuoRg1QSqhma3z+kibYZ9N3I9NdeFLvR3SLeDidh35mbwXo4XTWtacOYdO2ZUqq8yjGvKS6dB4yo5QVIMjRh+ZvJ6l2UPG4/f4s/PX/4+jPePrrR7XTz3t/cm/6q74SGs9BOq3sH1P5hHpegocwIgGJIomG44/mtu7wzJsuBF5rBJozvMeytkuDmoefMO/Zs4EYYfpndwdgpQSme1+XjMlFtm23b74xn10P3eui1rKnpR71xYHiLcXgznEbdUWC4oX5WTeGZaR53ZqSC4YW4LoETBRVS2F0DhXQa6Tmg5qUiLe7yZd+uNHt49031auD4jf7oqmc1jBHucWU4RJaBKQrkWMAKgBMALwAkAiDwvMADCGiGZjiG4dhyvdV3ZuV6+6zWOrtsWcG6Ow6ILIsgAgUNaZqoqUjXUEEXsevqLhR0qahLsgQqjY7lL2stA+ui0cUHrHdtQhBhUYeKglRVxL7Tn/D3CgXEAw5lWQjUI1Qo0Wj31ISiyZIiyar8HyFJAvqJcnpBS3qahST+J0hNMwKRyQspit87yO8fMv8qRfIZIHI6IqHMasc5qGAYYxkWvqK43+hILPd7Ms/OAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"filter\" title=\"\" src=\"/static/39acf359c2bf68c771d7db4d300523e5/6af66/filter.png\" srcset=\"/static/39acf359c2bf68c771d7db4d300523e5/69538/filter.png 160w,\n/static/39acf359c2bf68c771d7db4d300523e5/72799/filter.png 320w,\n/static/39acf359c2bf68c771d7db4d300523e5/6af66/filter.png 640w,\n/static/39acf359c2bf68c771d7db4d300523e5/d9199/filter.png 960w,\n/static/39acf359c2bf68c771d7db4d300523e5/54bf4/filter.png 1007w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>필터(Filter)는 무언가를 걸러내는 도구 혹은 개념을 의미한다. 우리는 이미 필터라는 개념을 평소에 많이 사용하고 있기 때문에 그렇게 이해하기 어려운 개념은 아닐 것이다. 그리고 오디오 이펙터에서의 필터는 바로 주파수를 걸러내는 역할을 한다.</p>\n<p>쉽게 말하면 필터는 오디오의 음역대 중 특정한 음역대만 콕 집어내어 없애버릴 수 있는 이펙터인 것이다. 그래서 필터는 주로 소리에 섞여있는 노이즈를 걸러내거나 너무 낮거나 너무 높아서 쓸데없는 울림을 생성하는 주파수를 걸러내는데 많이 사용된다.</p>\n<p>이러한 필터의 특성을 잘 사용하면 상당히 재미있는 짓을 많이 할 수 있는데 대표적인 예를 두개 정도 들자면, 바로 전화기에서 나오는 목소리를 만들거나 클럽에서 나는 음악 소리와 같은 소리를 만드는 경우가 있다.</p>\n<p>먼저, 전화기에서 나오는 목소리는 전체 주파수 중에서 특정한 대역의 주파수만 통과시키는 <code class=\"language-text\">Bandpass</code> 필터를 사용하여 만들어 낼 수 있다. 전화기가 전송할 수 있는 주파수 대역에 한계가 있다는 것을 이용하여 인간의 목소리 대역인 100 ~ 250hz의 주파수를 제외한 나머지 주파수를 모두 잘라내는 것이다.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.49999999999999%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/JrbkbKt1iEM?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<center>\n  <small>위 영상의 5:00 경 \"Hey, kitty~\" 하는 부분이 필터가 적용된 목소리이다.</small>\n  <br />\n  <br />\n</center>\n<p>그러므로 사람의 목소리 소스에 필터를 사용하여 100 ~ 250hz 대역을 제외하고 나머지 주파수를 모두 날려버리게되면 우리가 일반적으로 전화를 할때 들리는 목소리로 만들어낼 수 있는 것이다.</p>\n<p>클럽에서 나는 음악 소리도 비슷한 원리로 만들어내는 것이다. 클럽의 특성 상 보통 지하에 위치하고 좁은 입구를 가지고 있는 경우가 많다. 그런 상황에서 클럽에서 노래를 틀게되면 소리가 밖으로 빠져나올 수 있는 통로가 거의 없기 때문에 우리가 지상에서 클럽에서 틀고 있는 노래를 들어보면 굉장히 묵직한 “붐~ 붐~“하는 소리가 들리게 된다.</p>\n<p>클럽 음악의 특성 상 강한 드럼과 베이스로 인해 저음이 부각되는 경우가 많고, 고음보다는 저음의 물체 투과율이 높기 때문에 클럽 외부에서는 상대적으로 고음에 비해 많이 투과된 저음을 위주로 듣게 되는 것이다. 이러한 파동의 특성은 소리에 한정되는 것은 아니고 빛과 같은 다른 파동또한 고주파의 에너지 손실률이 저주파보다 높다.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.49999999999999%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/qmhwHUHc1Hc?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<center>\n  <small>6:27초부터 낮은 주파수만 통과시키는 Lowpass 필터를 사용한 소리로 변하는 부분이 나온다</small>\n  <br />\n  <br />\n</center>\n<p>이렇듯 사운드 엔지니어들은 특정 상황의 소리가 어떻게 들리는지 분석하고 필터를 포함한 여러가지 이펙터들을 사용하여 그 상황의 현장감을 부여하기도 한다.</p>\n<p>다행히도 HTML5 Audio API는 이런 필터를 만들 수 있는 <code class=\"language-text\">BiquadFilterNode</code>를 제공해주고 있기 때문에 우리가 직접 오디오 버퍼를 까서 주파수를 분석해야하는 슬픈 상황은 피할 수 있다. 우리는 이 노드가 제공하는 값들이 어떤 것을 의미하는지만 알고 있으면 된다.</p>\n<p>그럼 <code class=\"language-text\">BiquadFilterNode</code>가 제공하는 속성들이 무엇을 의미하는지 하나하나 살펴보도록 하자.</p>\n<h4 id=\"frequency\" style=\"position:relative;\">Frequency<a href=\"#frequency\" aria-label=\"frequency permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>Frequency는 어떤 대역의 주파수를 걸러낼 것인지를 정하는 값이다. 단위는 hz(헤르츠)를 사용하며, 10hz부터 오디오의 샘플레이트의 절반까지의 값을 할당할 수 있다. 만약 오디오 소스의 샘플레이트가 44,100hz라면 22,050까지를 할당할 수 있다는 의미이다.</p>\n<h4 id=\"q\" style=\"position:relative;\">Q<a href=\"#q\" aria-label=\"q permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>신호를 걸러낸다는 것은 기본적으로 칼처럼 딱 자를 수 있는 것이 아니다. 소리 자체는 아날로그 신호이기 때문에 네모 반듯하게 잘라낼 수 없고 어느 정도 바운더리를 가지고 걸러낼 수밖에 없는데, 이때 Q는 특정 주파수를 걸러낼 때 얼마나 예민하게 걸러낼 수 있는 지를 의미한다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 560px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/bd13c5d375c2729ffbcba3539fc82f14/b06ae/filter-q.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjklEQVR42o1TXW/CMAzk//87HpDgAY0KRKHtSqt8OU7i7ppAB2ibdqLIdXK+szGrKSOlFDMQMPN6vd7tdtvtFt/7/X6z2Vyv10kkMKeMwlrhEZG+7621RGSUatuuadp2ftouo2maYRjarq+vTVUdzufzNxlwzpV67H3XdpIrTg9IhtFKjwMsoOgLGZqFbCyNn58hs5/Jc2siMd9ZLt/Jxpg72ZEdevfKXlyU4JuMIcEGWirv2jGNvfFRnoCjJXjucRVCOJ1OKJavTJpY9AByTO+2f1AGua7rmSwpzuQg+uZDciH9i1xV1TiOUAbBc4iqx5mikCRNf9tGKoSIHxnvllMMnNQADYhbH+8r9JB+Vy7HHkCJMAm75Aw6mJNRMHb0/qvtkoWydn5ePDISg3grMU6oATs+WGJCOzGiRxSgxXYhD7ebMzqSZU8x32Jn2JrgLJLeGnyM1tgxssaq8V0ZY2AOSqkccA4IysZapTXmgjzmCnEiX/yvln/VfQcfAXb4cPi4XOrj8Ygmy9Fs+wlfnjxs6L3IYCoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"filter q\" title=\"\" src=\"/static/bd13c5d375c2729ffbcba3539fc82f14/b06ae/filter-q.png\" srcset=\"/static/bd13c5d375c2729ffbcba3539fc82f14/69538/filter-q.png 160w,\n/static/bd13c5d375c2729ffbcba3539fc82f14/72799/filter-q.png 320w,\n/static/bd13c5d375c2729ffbcba3539fc82f14/b06ae/filter-q.png 560w\" sizes=\"(max-width: 560px) 100vw, 560px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>Q에는 0.0001 ~ 1000 사이의 값을 할당할 수 있으며, Q의 값이 높을 수록 잡아낸 주파수를 더 예민하게 걸러낼 수 있다. 그러나 오디오 신호를 필터링 할 때 Q가 너무 높다면 자연스럽게 들리지 않고 인위적으로 들릴 수 있기 때문에 적당한 값을 찾는 것이 중요하다.</p>\n<h4 id=\"type\" style=\"position:relative;\">Type<a href=\"#type\" aria-label=\"type permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p><code class=\"language-text\">BiquadFilterNode</code>로는 여러가지 타입의 필터를 만들어 낼 수 있는데, 크게는 주파수를 아예 걸러내버리는 타입과, 특정 주파수를 증폭시키거나 감소시킬 수 있는 타입으로 나눠진다.</p>\n<h5 id=\"주파수를-걸러내는-타입\" style=\"position:relative;\">주파수를 걸러내는 타입<a href=\"#%EC%A3%BC%ED%8C%8C%EC%88%98%EB%A5%BC-%EA%B1%B8%EB%9F%AC%EB%82%B4%EB%8A%94-%ED%83%80%EC%9E%85\" aria-label=\"주파수를 걸러내는 타입 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<ul>\n<li><code class=\"language-text\">lowpass(highcut)</code>: 지정한 주파수보다 높은 주파수를 모두 걸러낸다.</li>\n<li><code class=\"language-text\">highpass(lowcut)</code>: 지정한 주파수보다 낮은 주파수를 모두 걸러낸다.</li>\n<li><code class=\"language-text\">bandpass</code>: 지정한 주파수를 제외한 모든 주파수를 걸러낸다.</li>\n<li><code class=\"language-text\">notch</code>: 지정한 주파수를 걸러낸다.</li>\n</ul>\n<h5 id=\"주파수를-증폭감소하는-타입\" style=\"position:relative;\">주파수를 증폭/감소하는 타입<a href=\"#%EC%A3%BC%ED%8C%8C%EC%88%98%EB%A5%BC-%EC%A6%9D%ED%8F%AD%EA%B0%90%EC%86%8C%ED%95%98%EB%8A%94-%ED%83%80%EC%9E%85\" aria-label=\"주파수를 증폭감소하는 타입 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<ul>\n<li><code class=\"language-text\">lowshelf</code>: 지정한 주파수보다 낮은 주파수를 증폭/감소 시킨다.</li>\n<li><code class=\"language-text\">highshelf</code>: 지정한 주파수보다 높은 주파수를 증폭/감소 시킨다.</li>\n<li><code class=\"language-text\">peaking</code>: 지정한 주파수를 증폭/감소 시킨다.</li>\n</ul>\n<p>이 중 주파수를 증폭/감소시키는 타입은 밑에서 후술할 EQ(Equalizer)에서도 사용할 수 있다. 이번에는 단순히 주파수를 걸러내는 필터를 만들 예정이므로 필자는 주파수를 걸러내는 타입만을 사용하여 필터를 구현할 것이다.</p>\n<p>필자는 특정 주파수보다 높은 주파수를 모두 걸러내는 Lowpass 필터와 특정 주파수보다 낮은 주파수를 모두 걸러내는 Highpass 필터를 구현할 것이다. 그럼 한번 간단하게 필터를 구현해보도록 하자.</p>\n<h3 id=\"filter-구현해보기\" style=\"position:relative;\">Filter 구현해보기<a href=\"#filter-%EA%B5%AC%ED%98%84%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"filter 구현해보기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>우선 AudioContext 객체의 <code class=\"language-text\">createBiquadFilter</code> 메소드를 사용하여 <code class=\"language-text\">BiquadFilterNode</code>를 생성한다. 필자가 가지고 있는 오디오 샘플은 44,100hz의 샘플레이트를 가지고 있으므로 Lowpass 필터의 주파수는 1,000hz로 Highpass 필터의 주파수는 20,000hz로 설정하겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> lowpassFilterNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createBiquadFilter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nlowpassFilterNode<span class=\"token punctuation\">.</span>type <span class=\"token operator\">=</span> <span class=\"token string\">'lowpass'</span><span class=\"token punctuation\">;</span>\nlowpassFilterNode<span class=\"token punctuation\">.</span>frequency<span class=\"token punctuation\">.</span><span class=\"token function\">setValueAtTime</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> audioContext<span class=\"token punctuation\">.</span>currentTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> highpassFilterNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createBiquadFilter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nhighpassFilterNode<span class=\"token punctuation\">.</span>type <span class=\"token operator\">=</span> <span class=\"token string\">'highpass'</span><span class=\"token punctuation\">;</span>\nhighpassFilterNode<span class=\"token punctuation\">.</span>frequency<span class=\"token punctuation\">.</span><span class=\"token function\">setValueAtTime</span><span class=\"token punctuation\">(</span><span class=\"token number\">20000</span><span class=\"token punctuation\">,</span> audioContext<span class=\"token punctuation\">.</span>currentTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Q값을 따로 설정해주지 않았는데, 그래도 사실 상관없다. <code class=\"language-text\">BiquadFilterNode</code>의 Q는 기본 값으로 350을 가지고 있고 이 값은 너무 과하지도 부족하지도 않은 적당한 값이기 때문에 그냥 기본 값을 사용할 것이다.<small>(조금 귀찮기도 하다.)</small></p>\n<p>이제 생성한 필터 노드들을 오디오 소스와 연결해주면 1,000hz보다 낮고 20,000hz보다 높은 주파수가 제거된 오디오 샘플을 들어볼 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">sourceNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>lowpassFilterNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nlowpassFilterNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>highpassFilterNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nhighpassFilterNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>audioContext<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>여기까지 읽으신 분들은 슬슬 느끼기 시작했겠지만 사실 HTML5 Audio API가 워낙 잘 만들어져있어서 개발자가 만져야할 부분이 거의 없다. 필자는 <code class=\"language-text\">BiquadFilterNode</code>의 존재를 알기 전에는 “와 이거 필터는 어떻게 만들지…?”라고 고민했었는데 사실 제일 고민할 필요가 없는 놈이었다. <small>(그래서 약간 허무하기도 했다.)</small></p>\n<h2 id=\"eq\" style=\"position:relative;\">EQ<a href=\"#eq\" aria-label=\"eq permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/b972a654c602720bb3a9d335899a0d25/c1b63/parametric-eq.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACmUlEQVR42j2RS28TVxiG5xdwB9meGXvseC5nbrbHM2PHcUKJg517CARBAiQBJBBBgqAoMgSQCpuy6YIFrVSpXVa0UretuuAnsOT3PJyZIBav3ve7nO92FOF6RK0WjWYT27ZxHBvLMtF1DU1Tczbrdcm6tI99xyyhlnIul/U8r2oYKK4bEIRNwnYfL4ikDnGEoKRqqJouWaeYab2c64yLqkpJy3wVtHJFDuKQDVarmyj6RIDhxNTdNEdVpFhBSk1y3Z9kwutiiATDS6g6CfVwGje8iAgk94bU/C6m08GwIkpVD8VsXsJN5yUWEMl8DiceYbeH1JuDnOO5TXrL9xGdRazWZWZ+2KY3s4WQb7zOUs5ONJCDJShWMsTtryH6V/Cn12nMbBDP3mBaFli+94qd17+x/8u/HP7+iQfv/mS0PWawvMfU3Dbe1CqBfOf1VnFls3rYRzlae8CLq3v8eH2fJ2uP2BjeYriww+LNZyzcPmT17hGjrYMcK7sv2bz/jqcP/+DN6/94Pv6H8eFfjA/+ZriyRy0r+HHrBR/vvOJg/TFpfx0/6za5gi3XsOJ57CSDXCldzG2RLLE02ufR7gfeHv3P+58+8+vPX1jbGKPZbZT3156wOb+N3pql1hpgRXPyTnOY0TGs9uUc2S0tiey+cW+DQBauNWeJpq7RvbiFK5sWJpoooRFyVqJiBlTtBiX5W067nQfL8tdVK6YoYvSkR6HWwoguobodJpxpbH9AodpAqCmFSkjJjlHKokvBjOWKI8qiw4miyfmqw8mSzSlNcEqVWpPacDlZtDhd8aXtcEbzOVcOZdzmQsnL807rAsVvd/FaCVF3hqDVwXZDiQaO15Ac0JCxdjpJM0q/+zJ2PJnnHWvbD7/ZIV8B/qNr5c4oeIoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"parametric eq\" title=\"\" src=\"/static/b972a654c602720bb3a9d335899a0d25/6af66/parametric-eq.png\" srcset=\"/static/b972a654c602720bb3a9d335899a0d25/69538/parametric-eq.png 160w,\n/static/b972a654c602720bb3a9d335899a0d25/72799/parametric-eq.png 320w,\n/static/b972a654c602720bb3a9d335899a0d25/6af66/parametric-eq.png 640w,\n/static/b972a654c602720bb3a9d335899a0d25/d9199/parametric-eq.png 960w,\n/static/b972a654c602720bb3a9d335899a0d25/c1b63/parametric-eq.png 1200w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>Equalizer(EQ, 이퀄라이저)는 이름에서도 알 수 있듯이 일종의 주파수 평탄화 작업(Frequancy Equalizing)을 하는 목적으로 사용하는 이펙터이다.</p>\n<p>EQ는 컴프레서와 함께 오디오 믹싱의 기본으로 깔고 들어가는 이펙터인데, 원본 소스에서 쓸데없는 소리를 없애고 다른 소리들과의 조화를 이루도록 하는 용도로 주로 사용한다. EQ는 결국 주파수를 컨트롤하는 이펙터이므로 필터를 사용하여 구현하는데, 이미 우리는 필터를 한번 만들어봤기 때문에 EQ 정도는 뚝딱 만들 수 있다.</p>\n<p>EQ는 크게 파라메트릭 이퀄라이저(Parametric EQ)와 그래픽 이퀄라이저(Graphic EQ) 두 가지 종류로 나누어지는데, 필자는 이 중 그래픽 이퀄라이저를 구현할 예정이다. 참고로 상단의 그림은 파라메트릭 EQ인데, 그냥 이미지가 더 멋있어서 넣었다. 참고로 그래픽 EQ는 이렇게 생겼다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/810256ab252fd73a1c3030c32279669f/49e4f/graphic-eq.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 71.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAQD/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAclaJliP/8QAHBAAAgEFAQAAAAAAAAAAAAAAAAEDAgQRExQh/9oACAEBAAEFAud5cDFbs2+uYVZ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGxAAAQQDAAAAAAAAAAAAAAAAAAEQMTJBkaH/2gAIAQEABj8Csmi/CTJKt//EABwQAAICAgMAAAAAAAAAAAAAAAABESFRgTGR8f/aAAgBAQABPyHAtjCdh1cXopBOh4Apq5Z//9oADAMBAAIAAwAAABAYz//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/EEf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAgEBPxBY/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAITFhsf/aAAgBAQABPxDoHs88NxX40NWnd6o/dakCgQhMggdStGdoYZWb/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"graphic eq\" title=\"\" src=\"/static/810256ab252fd73a1c3030c32279669f/c08c5/graphic-eq.jpg\" srcset=\"/static/810256ab252fd73a1c3030c32279669f/0913d/graphic-eq.jpg 160w,\n/static/810256ab252fd73a1c3030c32279669f/cb69c/graphic-eq.jpg 320w,\n/static/810256ab252fd73a1c3030c32279669f/c08c5/graphic-eq.jpg 640w,\n/static/810256ab252fd73a1c3030c32279669f/49e4f/graphic-eq.jpg 836w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>짙은 아날로그의 향수가 풍겨오는 그래픽 EQ의 비주얼</small>\n</center>\n<p>두 개의 EQ 모두 장단점이 존재하는데, 일단 그래픽 EQ의 장점은 파라메트릭 EQ에 비해 조절할 수 있는 주파수 대역의 수가 많고 직관적인 인터페이스를 가지고 있다는 것이다. 여러분은 이 단락의 맨 위에 첨부된 파라메트릭 EQ 이미지를 보고 “엥? 파라메트릭도 나름 직관적인데?”라고 하실 수 있는데, 원래 하드웨어 파라메트릭 EQ는 이렇게 생겼다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/351a26bf4458838f2afdbc6e4cb82da6/07f3a/hardware-parametric-eq.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 20.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAEABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMC/8QAFgEBAQEAAAAAAAAAAAAAAAAABAAC/9oADAMBAAIQAxAAAAHExB6DV//EABgQAQADAQAAAAAAAAAAAAAAAAIAEiEi/9oACAEBAAEFAkeqwnP/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAADAAAAAAAAAAAAAAAAAAAAATH/2gAIAQEABj8CrKys/8QAGRAAAgMBAAAAAAAAAAAAAAAAAAERUcHw/9oACAEBAAE/IUyts7sl1n//2gAMAwEAAgADAAAAEHwv/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAx/9oACAEDAQE/EBF//8QAFREBAQAAAAAAAAAAAAAAAAAAEEH/2gAIAQIBAT8Qp//EABoQAAICAwAAAAAAAAAAAAAAAAABETEhQWH/2gAIAQEAAT8QexUtXY1UBmG79H//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"hardware parametric eq\" title=\"\" src=\"/static/351a26bf4458838f2afdbc6e4cb82da6/c08c5/hardware-parametric-eq.jpg\" srcset=\"/static/351a26bf4458838f2afdbc6e4cb82da6/0913d/hardware-parametric-eq.jpg 160w,\n/static/351a26bf4458838f2afdbc6e4cb82da6/cb69c/hardware-parametric-eq.jpg 320w,\n/static/351a26bf4458838f2afdbc6e4cb82da6/c08c5/hardware-parametric-eq.jpg 640w,\n/static/351a26bf4458838f2afdbc6e4cb82da6/07f3a/hardware-parametric-eq.jpg 740w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>까만 것은 노브요. 하얀 것은 숫자로다.</small>\n  <br>\n</center>\n<p>그래서 그래픽 EQ는 보통 빠른 대응이 필요한 공연장같은 곳에서 많이 사용되고 있으며, 짬이 많이 쌓인 시니어 사운드 엔지니어들은 공연장에서 하울링<small>(노래방에서 삐- 하며 가끔 나는 날카로운 소리)</small>이 발생하면 바로 해당 주파수를 캐치해서 그래픽 EQ로 죽여버리는 무서운 스킬을 가지고 있다.</p>\n<p>그래픽 EQ의 단점은 조절할 수 있는 주파수 대역이 정해져 있다는 것과 주파수의 세밀한 조정이 힘들다는 것이다. 반면 파라메트릭 EQ는 그래픽 EQ와 다르게 조절할 수 있는 주파수 대역까지 모두 정해줄 수 있다.</p>\n<p>그러나 한번에 조절할 수 있는 주파수의 개수는 그래픽 EQ에 비해 크게 부족하다. 일반적인 파라메트릭 EQ가 3-5개의 주파수 대역을 조절할 수 있는 반면에 그래픽 EQ는 한번에 조절 가능한 주파수가 40개가 넘어가는 굇수도 존재한다.</p>\n<p>필자 생각에 하드웨어 파라메트릭 EQ의 최대 단점은 바로 직관적이지 않은 인터페이스를 가지고 있다는 것인데, 이 단점은 소프트웨어로 구현하면 UI로 커버할 수 있는 영역이기도 하고 대부분의 녹음실에서는 즉각적인 대응보다는 계속 소리를 들어보면서 이퀄라이징을 할 수 있는 상황이 대부분이기 때문에 많은 소프트웨어 EQ가 주파수 대역 조절에 자유도가 높은 파라메트릭 EQ로 구현된다.</p>\n<p>하지만 필자가 만드는 데모처럼 간단히 구현해보는 상황에서는 저 위에 하드웨어 파라메트릭 EQ와 비슷한 UI로 구현될 것이 뻔하므로 필자는 상대적으로 UI 만들기가 쉬운 그래픽 EQ를 선택했다.<small>(이 말이 잘 이해가 안된다면 EQ 챕터의 가장 위에 첨부한 파라메트릭 EQ를 한번 보고 오자)</small></p>\n<p>위에서 한번 이야기했듯이 EQ는 필터를 사용하여 구현하므로 그렇게 복잡하지 않다. 그럼 이제 한번 간단하게 뚝딱 만들어보도록 하자.</p>\n<h3 id=\"그래픽-eq-구현하기\" style=\"position:relative;\">그래픽 EQ 구현하기<a href=\"#%EA%B7%B8%EB%9E%98%ED%94%BD-eq-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0\" aria-label=\"그래픽 eq 구현하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>위에서 그래픽 EQ 이미지를 봤다면 알겠지만 이 친구는 조절할 수 있는 주파수 대역의 개수가 정해져 있는 장비이다. 그렇기 때문에 필자도 조절할 수 있는 주파수가 들어있는 배열을 하나 선언하고 이 배열을 이터레이션하면서 필터들을 생성할 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> frequencies <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">63</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">160</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">250</span><span class=\"token punctuation\">,</span> <span class=\"token number\">315</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">630</span><span class=\"token punctuation\">,</span> <span class=\"token number\">800</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1250</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1600</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">2500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3150</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이때 주의해야할 점이 있다. EQ는 여러 개의 필터를 사용하기 때문에 각 필터를 서로 체이닝해서 연결해주어야한다. 이때 필터의 게인이 1보다 조금이라도 높다면 한번 필터를 통과할 때마다 소리가 조금씩 증폭되어 여러분의 귀에 들어올 때 쯤이면 엄청 큰 소리가 되어 여러분의 고막을 영원히 이별시킬 수도 있다.</p>\n<blockquote>\n<p>🚨 <strong>그렇기 때문에 반드시 필터들의 게인을 0 이하로 설정해주어야 한다.</strong></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> inputNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsourceNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>inputNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> filters <span class=\"token operator\">=</span> frequencies<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">frequency<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">,</span> array</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> filterNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createBiquadFilter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  filterNode<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  filterNode<span class=\"token punctuation\">.</span>frequency<span class=\"token punctuation\">.</span><span class=\"token function\">setValueAtTime</span><span class=\"token punctuation\">(</span>frequency<span class=\"token punctuation\">,</span> audioContext<span class=\"token punctuation\">.</span>currentTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    filterNode<span class=\"token punctuation\">.</span>type <span class=\"token operator\">=</span> <span class=\"token string\">'lowshelf'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">===</span> array<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    filterNode<span class=\"token punctuation\">.</span>type <span class=\"token operator\">=</span> <span class=\"token string\">'highshelf'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    filterNode<span class=\"token punctuation\">.</span>type <span class=\"token operator\">=</span> <span class=\"token string\">'peaking'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> filterNode<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nfilters<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prev<span class=\"token punctuation\">,</span> current</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  prev<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>currentNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> currentNode<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> inputNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> outputNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfilters<span class=\"token punctuation\">[</span>filters<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>outputNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\noutputNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>audioContext<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">map</code> 메소드 내부의 <code class=\"language-text\">if</code> 문을 보면 해당 첫번째 필터와 마지막 필터의 타입만 다르게 주고 있는 것을 볼 수 있는데, 이는 Shelf 타입의 필터를 사용하여 첫번째 필터의 주파수보다 낮은 주파수와 마지막 필터의 주파수보다 높은 주파수까지 모두 커버하기 위해서이다. <small>(필터 타입이 잘 기억나지 않는다면 Filter 부분을 다시 보고 오자)</small></p>\n<p>그 후 생성된 필터를 <code class=\"language-text\">reduce</code> 메소드를 통해 모두 체이닝해주고 <code class=\"language-text\">outputNode</code>와도 연결해주었다. 여기까지 작성한 후 <code class=\"language-text\">sourceNode</code>를 재생시켜보면 아무 변화도 없는 것을 알 수 있다.</p>\n<p>당연히 모든 필터의 게인이 <code class=\"language-text\">0</code>이기 때문에 아무런 변화가 없는 것이다. 이때 저 필터들의 값을 <code class=\"language-text\">-1 ~ 1</code>사이의 랜덤한 난수로 할당하면 소리가 조금씩 변하는 것을 들어볼 수도 있다. 필자는 개인적으로 <code class=\"language-text\">input[type=\"range\"]</code> 엘리먼트와 연동하여 필터들의 게인을 조절할 수 있도록 만들고 직접 이것저것 만져보는 것을 추천한다.</p>\n<p>또한 가장 낮은 주파수와 높은 주파수의 필터를 Shelf 타입으로 설정했기 때문에 이 필터들의 게인을 낮추면 Lowpass 필터나 Highpass 필터와 같은 효과도 낼 수 있다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>자, 여기까지 대표적으로 많이 사용하는 이펙터들인 컴프레서, 리버브, 딜레이, 필터, EQ를 만들어보았다. 사실 이 5개 외에도 재밌는 여러가지 이펙터가 있지만 분량조절 대실패로 인해 여기까지만 노는 것으로 하겠다.</p>\n<p>필터를 만들 때 한번 이야기 했듯이 HTML5 Audio API는 굉장히 높은 수준의 추상화된 노드를 제공해주기 때문에 사실 개발자가 직접 구현할 것들이 별로 없다. 이는 다르게 말하면 세밀한 수준의 구현이 힘들다는 뜻이기도 하지만 필자가 무슨 오디오 이펙터 회사를 차릴 것도 아니기 때문에 단순 재미로 만들어보기에는 충분한 것 같다.</p>\n<p>이렇게 여러가지 이펙터를 구현해보며 필자도 예전에 사운드 엔지니어로 일할 때의 추억이 새록새록 떠오르기도 했고 또 이펙터에 대해서 새롭게 알게된 내용도 있어서 굉장히 재밌게 작업을 했다. 필자는 포스팅에 작성한 이펙터 외에도 여러가지 이펙터를 계속 구현해볼 예정이므로 관심있는 분들은 <a href=\"https://github.com/evan-moon/simple-waveform-visualizer\" target=\"_blank\" rel=\"nofollow\">필자의 깃허브</a>에서 한번 쓱 둘러보고 PR을 날려도 된다. <small>(좋은 건 나누면 배가 되는 법이다.)</small></p>\n<p>이상으로 JavaScript로 오디오 이펙터를 만들어보자 - 나만의 소리 만들기 포스팅을 마친다.</p>","fields":{"slug":"20190821-javascript-audio-effectors-practice","path":"/2019/08/21/javascript-audio-effectors-practice/","lang":"ko"},"frontmatter":{"title":"[JavaScript 오디오 이펙터 만들기] 오디오 이펙터로 나만의 소리 만들기","subTitle":"Logic Pro, Pro Tools처럼? 웹에서 오디오 이펙트 구현하기","date":"Aug 21, 2019","categories":["프로그래밍","오디오"],"tags":["JavaScript","자바스크립트","Audio","오디오 이펙터","JavaScript Audio API","Logic Pro X","로직프로","Protools","프로툴즈","Cubase","큐베이스","Audio Plugin","Compressor","Delay","Reverb","EQ"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/026a9fe9c894f201ec1e45217221447c/3a812/thumbnail.jpg","srcSet":"/static/026a9fe9c894f201ec1e45217221447c/3a812/thumbnail.jpg 320w,\n/static/026a9fe9c894f201ec1e45217221447c/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/026a9fe9c894f201ec1e45217221447c/fc5c5/thumbnail.webp 320w,\n/static/026a9fe9c894f201ec1e45217221447c/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/026a9fe9c894f201ec1e45217221447c/2d839/thumbnail.jpg","srcSet":"/static/026a9fe9c894f201ec1e45217221447c/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/026a9fe9c894f201ec1e45217221447c/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"86eaf521-bcde-5dc6-8ec6-ea5f74108a67","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%98%A4%EB%94%94%EC%98%A4-%EC%8B%A0%ED%98%B8%EB%8A%94-%ED%9D%90%EB%A5%B4%EB%8A%94-%EA%B2%83%EC%9D%B4%EB%8B%A4\">오디오 신호는 흐르는 것이다</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%98%A4%EB%94%94%EC%98%A4%EC%9D%98-%EC%9D%8C%EB%9F%89%EC%9D%84-%EC%A1%B0%EC%A0%88%ED%95%98%EA%B8%B0\">오디오의 음량을 조절하기</a></p>\n<ul>\n<li><a href=\"#gain%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80%EC%9A%94\">Gain이란 무엇인가요?</a></li>\n<li><a href=\"#gain-node%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EC%9D%8C%EB%9F%89%EC%9D%84-%EC%A1%B0%EC%A0%88%ED%95%B4%EB%B3%B4%EC%9E%90\">Gain Node를 사용하여 음량을 조절해보자</a></li>\n</ul>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 컴퓨터는 어떻게 소리를 들을까? 포스팅에서 진행했던 오디오 파형 그리기에 이어서 오디오에 여러가지 효과를 줄 수 있는 이펙터를 만드는 과정을 설명하려고 한다. HTML5의 Audio API는 오디오에 효과를 줄 수 있는 여러가지 노드를 제공하는데, 대부분의 이펙터는 이 노드들만 사용해도 구현할 수 있을 정도로 완성도있는 API를 제공한다.","html":"<p>이번 포스팅에서는 <a href=\"/2019/07/10/javascript-audio-waveform/\">컴퓨터는 어떻게 소리를 들을까?</a> 포스팅에서 진행했던 오디오 파형 그리기에 이어서 오디오에 여러가지 효과를 줄 수 있는 이펙터를 만드는 과정을 설명하려고 한다. HTML5의 Audio API는 오디오에 효과를 줄 수 있는 여러가지 노드를 제공하는데, 대부분의 이펙터는 이 노드들만 사용해도 구현할 수 있을 정도로 완성도있는 API를 제공한다.</p>\n<!-- more -->\n<p>또한 이 포스팅은 총 두편에 나눠서 작성될 예정이며, 이번 포스팅에서는 HTML5 Audio API의 개요와 오디오의 음량을 조절할 수 있는 <code class=\"language-text\">GainNode</code>를 사용하는 방법에 대해서, 다음 포스팅에서는 좀 더 복잡한 오디오 이펙터들에 대한 설명과 제작 과정을 설명할 예정이다.</p>\n<p>지난 포스팅에서 이미 오디오에 관한 기본적인 이론을 설명했으니 이번에는 기본적인 이론이 아니라 실제로 녹음실에서 오디오를 어떤 방식으로 컨트롤하고 효과를 주는 지에 대한 방법에 대해 초점을 맞추고 설명을 진행하도록 하겠다.</p>\n<h2 id=\"오디오-신호는-흐르는-것이다\" style=\"position:relative;\">오디오 신호는 흐르는 것이다<a href=\"#%EC%98%A4%EB%94%94%EC%98%A4-%EC%8B%A0%ED%98%B8%EB%8A%94-%ED%9D%90%EB%A5%B4%EB%8A%94-%EA%B2%83%EC%9D%B4%EB%8B%A4\" aria-label=\"오디오 신호는 흐르는 것이다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>일반적인 녹음실에서 우리는 마이크를 통해서 오디오를 녹음하거나 혹은 이미 녹음된 오디오를 <a href=\"https://www.apple.com/kr/logic-pro/\" target=\"_blank\" rel=\"nofollow\">Logic Pro</a>나 <a href=\"https://www.steinberg.net/cubase/\" target=\"_blank\" rel=\"nofollow\">Cubase</a>와 같은 DAW(Digital Audio Workstation)으로 불러와서 사용하게 된다. 이때 처음으로 받게되는 이 오디오를 소스(Source)라고 한다.</p>\n<p>이 소스는 앰프, 컴프레서, 이퀄라이저 등 오디오에 특별한 느낌을 줄 수 있는 여러가지 이펙터들을 지나서 최종적으로 스피커나 헤드폰을 통해서 출력되게 된다. 이 흐름을 알고나면 HTML5의 Audio API가 제공하는 노드(Node)의 개념을 쉽게 이해할 수 있다. 일단 이해를 돕기 위해 필자가 예전에 사운드 엔지니어로 일할 때 사용했던 시스템을 예로 들겠다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/aff4396076e86089c7d109c73767fe80/768c6/mixer.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABUBAQEAAAAAAAAAAAAAAAAAAAIB/9oADAMBAAIQAxAAAAGVitK2kAH/AP/EABoQAAIDAQEAAAAAAAAAAAAAAAECAAMSEyL/2gAIAQEAAQUCGrIiuFR/KWZhtM6Gf//EABURAQEAAAAAAAAAAAAAAAAAAAAS/9oACAEDAQE/AVP/xAAWEQEBAQAAAAAAAAAAAAAAAAAAEyH/2gAIAQIBAT8B1N//xAAbEAABBAMAAAAAAAAAAAAAAAAAAREhMQIQQf/aAAgBAQAGPwJk4ZQTZTlNr//EABwQAQACAgMBAAAAAAAAAAAAAAEAESFxMUFhsf/aAAgBAQABPyEd3SUajEYJc0iO6bRzgeCLc/J//9oADAMBAAIAAwAAABAvL//EABcRAQEBAQAAAAAAAAAAAAAAAAEAEUH/2gAIAQMBAT8QMhnL/8QAGBEBAAMBAAAAAAAAAAAAAAAAAQARITH/2gAIAQIBAT8QTgMjZuf/xAAcEAEBAQACAwEAAAAAAAAAAAABEQAhQWHB4fD/2gAIAQEAAT8Qjk3IGDawGHY8e8DoLRjvO4ySfGToNE/POfqr5z//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"mixer\" title=\"\" src=\"/static/aff4396076e86089c7d109c73767fe80/c08c5/mixer.jpg\" srcset=\"/static/aff4396076e86089c7d109c73767fe80/0913d/mixer.jpg 160w,\n/static/aff4396076e86089c7d109c73767fe80/cb69c/mixer.jpg 320w,\n/static/aff4396076e86089c7d109c73767fe80/c08c5/mixer.jpg 640w,\n/static/aff4396076e86089c7d109c73767fe80/6a068/mixer.jpg 960w,\n/static/aff4396076e86089c7d109c73767fe80/eea4a/mixer.jpg 1280w,\n/static/aff4396076e86089c7d109c73767fe80/768c6/mixer.jpg 3264w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>필자가 예전에 사용했던 장비들</small>\n</center>\n<p>사진의 중앙에 있는 커다란 장비는 아마 여러분도 TV에서 몇번 보았던 장비일 것이다. 이 장비는 여러 개의 채널로 나눠진 오디오 소스의 볼륨이나 패닝, 이퀄라이징까지 할 수 있는 일종의 컨트롤 타워 역할을 하는 믹싱 콘솔이다.</p>\n<p>그리고 믹싱 콘솔의 오른쪽에 있는 것들이 바로 오디오에 효과를 줄 수 있는 이펙터들이다. 보통은 믹싱 콘솔 양쪽에 가득 채워놓고 쓰는데 저 사진은 아직 녹음실 셋업이 덜 끝났을 때라서 몇가지 장비만 들어가 있다. 그리고 사진에는 나오지 않았지만 따로 콘솔 랙(Console Rack)이라는 선반을 두고 거기에도 이펙터들이 가득 채워져 있다.</p>\n<p>그리고 이펙터들의 위쪽을 보면 붉은색 선이 꽂혀있는 것을 볼 수 있는데, 저 장비가 오디오의 흐름을 컨트롤할 수 있는 패치 테이블(Patch Table)이라고 하는 장비이다.</p>\n<p>보통 사운드 엔지니어들은 같은 역할을 하는 이펙터라고 하더라도 여러 종류의 장비를 사용하게 되는데, 이는 같은 역할을 하는 이펙터라고 하더라도 장비마다 조금씩 소리가 다를 수 있기 때문이다.</p>\n<p>즉, 같은 리버브를 사용한다고 해도 최종적으로 만들고자하는 소리가 어떤 느낌인지에 따라 A 리버브를 사용할 수도 있고 B 리버브를 사용할 수도 있다는 것이다. 그래서 이런 소리의 질을 만드는 고유한 알고리즘은 이펙터 제조 회사들의 기업 비밀이다.</p>\n<p>하지만 다른 이펙터를 사용하고 싶을 때마다 장비에 꽂혀있는 케이블을 일일히 하나하나 빼서 다시 다른 장비에 연결하는 것은 비효율적이기도 하고 케이블을 계속 뺐다가 꼈다가 하면 장비에 손상이 갈수도 있기 때문에 모든 장비의 라인을 저 패치 테이블에 연결해놓고 사용하는 것이다. 게다가 케이블은 대부분 장비 뒤쪽에 위치하기 때문에 저 믹싱 콘솔을 앞으로 살짝 밀고 봐야하는데, 딱 봐도 저 큰 장비를 계속 밀었다 당겼다 하기에는 무거워 보이지 않는가? 허리 나간다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/97c640bdaae9f458bb8b30c0717df899/6a068/patch_table_chart.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgADBP/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAepDQVKT/8QAFRABAQAAAAAAAAAAAAAAAAAAEAH/2gAIAQEAAQUCY//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAQEBAAAAAAAAAAAAAAAAADEAIP/aAAgBAQAGPwJnP//EABgQAQADAQAAAAAAAAAAAAAAAAEAEVEQ/9oACAEBAAE/IS8QvEp2AgGc/9oADAMBAAIAAwAAABATz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAAIBBAMAAAAAAAAAAAAAAAERACFBYZExUXH/2gAIAQEAAT8QIrmYvjVGW6iiQXk6iuIAEJ//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"patch table chart\" title=\"\" src=\"/static/97c640bdaae9f458bb8b30c0717df899/c08c5/patch_table_chart.jpg\" srcset=\"/static/97c640bdaae9f458bb8b30c0717df899/0913d/patch_table_chart.jpg 160w,\n/static/97c640bdaae9f458bb8b30c0717df899/cb69c/patch_table_chart.jpg 320w,\n/static/97c640bdaae9f458bb8b30c0717df899/c08c5/patch_table_chart.jpg 640w,\n/static/97c640bdaae9f458bb8b30c0717df899/6a068/patch_table_chart.jpg 960w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>패치 테이블은 대략 이런 느낌으로 정리된다</small>\n</center>\n<p>사운드 엔지니어는 이렇게 복잡한 여러 개의 장비 사이를 흘러다니는 오디오 신호의 흐름을 패치 테이블을 통해서 한번에 파악하고 컨트롤 할 수 있다. 소리를 컨트롤하는 사람에게 오디오 신호의 흐름이라는 개념은 굉장히 중요하다. 필자가 방금 예로 든 하드웨어 장비 뿐만 아니라 소프트웨어로 구현된 이펙터를 사용하려할때도 결국은 이 흐름을 프로그램 내부에서 그대로 구현해줘야하기 때문이다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 390px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/ee078a891d7c62fa2cd1603c31529ad2/727ba/protools.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 144.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAIAAAAl5NuSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFZ0lEQVR42k2Ud5PbxhnG8X1i6y7jEksWLV1hLweQYEFZ7C4aQfQOUuw8nu5ULZ3KKRPP2M7EcibfJPkjnynvyeOMMfvHbx/gWbz7bGHqzSbRNKQo5UqlWqsjTAilp+VyrV6XFYwprdZq5WpVQgpR1VqjierVGCtTQ9dbDeYfVxd/u9z/8+31i2n+/aPpT8+efHz9CvjlrPj5+dNfXn9/vZw/zZK/P3/688sXPz3ef0jCj8+ffnzx7F9PLpmVJKwta+9MvH7P5bu7CbAD4HQ54AvXCQb8hDvbWuO9684lgW80ECJj3RwOh4yAxOm6yGYJx3H8gJ+uinyRclyXH/SKVT5dFjzPc10uX2SzVTEYDttn7WSWgAVmyvihF+dBNst0XTctI53G2Sw1DNMw9XQWp9PEsixN1265iG3bpiqBD6IsjJOYeXN9/fzZy5v3H7bb7dXlFczx3bubq6tL6F6/fvPu7furq6s/8BPgN9dvX726vrn5wARhGGVumkfj8XgymaRTP05Cx3bGYzOM/CDwXdc1x6Yf+GHsARuG4fketCiKmMnYURCihGoqVGcCIFmBoinVoHJxKI/HFsEqxRomoI8lSRr2BUUmoiAxAmarrYctrspynaF8VmsfNdlKr8/1Ru1656TTL/f6bG/YabGnDbbMj846XIMdnbR7pwO5wbDD00qrdFK5W6kedwblW67erdVPW92TcqtU69yt1o9bXLnSLpUb92qtB412rT18UONKnFBlYCE9x4+gTlk2TTvwo0A3dIwh+zCIPVU3CWwtHdjXDEPBmqaHfhx4keeGjDWxHMcOoxBjeKF68Pi+rhvQ/YQ+JATsuo4fBoZpKooCafm+F4ZgtiwX3LZNCOxxDb62JxMA6N6ybf/GMNAtq+pvumkYsDQMQigIApFvEqxAkkEQiv0mhCuKousFSOCwPJJk2XU9Rewq0lAQxTBKeq0HaMQy8/n80aM5lusIiWmaLpdrRaoRIsPyL5cbgjpYGQCvVhuMzhSZh9G324tB91uNdpnlcjmfL6jSVJCUZdlqvSWoQYkcRfFqvVNxh+BhFCWb7Y5iFiMe9N354xF/39B6zGDQt22HkDaluNfrWRZMvg3T7PV405xQyqmq2O8PIHxV5SkdgQ4pCaMjQjiGUhrHcR81CMWQJPwEWNUJQkoYRCN8pqiComDYnQLhEB3JEkrjvMHfFynHgCGOk4HSBDMEFoW3rGoEAgv9SCAsVkUw+H4g0S6YBUFM4qw1+E4Cs4zkPC94dGsQBCHL8j5qaoYqCKM0TuHPRJc/GRKBdKGK4XBU5NM6/52kdhnYI0mS2q5FqaprRpbmjjuGs02JmiXAlq5rwGmSuR6suXqrpwWkYU1M5rhx94tvPv+6dFA7Kx3Xv/3y3i032AdHlXuf+E6tUzqu3v+69PkX39ypnN0rN47+8vDOn786aPZLcA3xEhKojhER+CGrEAmrimoobK+FsIioTHWZ4zsyHikEwRTYbkuUuR7P6pbEWPZe03PX22jGWiEzwyh0Y4rpktB8bM09b+14lwqZWtbcdlaaMV/vfv3rj/+9+eHfr97/h1E1H1Nb1X1RNmU0JqpLVVeSx5JsgqibgUIcYA3YCGQFrs3UCy+9cO/458xqtdjtto8v9lEUFEV2cbG/uDgvijSKQuDz812RZ3Ec7gGBiywMvd12uVrNN+s5M5s9WiyW6/UGzg0s+Gq1hgZ7EI4jiMvlCkTg3/UELjPAxRJMC2axmG82axg1DIMsS6EKaABwXEHcbjd5Dn8L/q9HYQS4WYNpwxyeSIen8mEZHTwcHByNDk8RNADoggivDo7/wEdCqXF4wv3pmP3smP3sf1kksuUwHGIfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"protools\" title=\"\" src=\"/static/ee078a891d7c62fa2cd1603c31529ad2/727ba/protools.png\" srcset=\"/static/ee078a891d7c62fa2cd1603c31529ad2/69538/protools.png 160w,\n/static/ee078a891d7c62fa2cd1603c31529ad2/72799/protools.png 320w,\n/static/ee078a891d7c62fa2cd1603c31529ad2/727ba/protools.png 390w\" sizes=\"(max-width: 390px) 100vw, 390px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>위 사진은 전 세계 녹음실 중 90%가 사용하고 있는 <a href=\"https://www.avid.com/pro-tools\" target=\"_blank\" rel=\"nofollow\">Protools</a>라는 DAW의 믹서 창이다.</p>\n<p>사진에 강조된 부분에 <code class=\"language-text\">Vocal Bus</code>라고 적혀있는 곳을 보면 맨 오른쪽 채널은 위쪽에 위치하고 있고 나머지 채널은 아래쪽에 위치하고 있다. <code class=\"language-text\">I/O</code> 메뉴에서 위쪽은 In을 의미하고 아래쪽은 Out을 의미하기 때문에 이 그림에서 오디오의 흐름은 대략 다음과 같이 나타날 수 있다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1f5d5ab85ca31673a0509d50c23f23f9/29114/auxes.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVR42mP4TwFg+P7z9/XHb68+enP10dsbT979/P2XBM1Hrz3jDZmqkDRPOm62YPj0c7ef/f/35+/ffyjg/z+IahQxoOYnbz7XLTlWv/Q4EDUsPf7m0/e/f379+UOU/Qwnbz5XTp1nUrDMtHCZWvqCS/de/vv968evHxfunTxz5+jZu8dO3z7y4es7iLXPLp27f+zAw5NH7h3e9+n5U4ZHrz9VLDhSs+hY9cKjVQuPPH/3+fePnw+e3bOrUnGoVvVo1DcqFN15dgNQ8+ePH2Y4G7WrCk4yV60XZTg6tZvh1K0XyinzDfOW6mUvVk1bcPn+q3+/f37/+R1oM9Da8/dOAG1+/+UtUPPfv3+BNj84fujR6WP3j+7/9OwJw+PXn6sXHwV6u3bJMSD5+uO3P7+J9vOx688Ew6cpJM9VSJorGjUDe2j/Qw7tvxAE5DF8+/n70v3XF+8B0avLD17//P2HhHimJIUBAF7SQPGmG4PXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"auxes\" title=\"\" src=\"/static/1f5d5ab85ca31673a0509d50c23f23f9/6af66/auxes.png\" srcset=\"/static/1f5d5ab85ca31673a0509d50c23f23f9/69538/auxes.png 160w,\n/static/1f5d5ab85ca31673a0509d50c23f23f9/72799/auxes.png 320w,\n/static/1f5d5ab85ca31673a0509d50c23f23f9/6af66/auxes.png 640w,\n/static/1f5d5ab85ca31673a0509d50c23f23f9/d9199/auxes.png 960w,\n/static/1f5d5ab85ca31673a0509d50c23f23f9/21b4d/auxes.png 1280w,\n/static/1f5d5ab85ca31673a0509d50c23f23f9/29114/auxes.png 1920w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<blockquote>\n<p>이때 저 네모 하나하나가 HTML5의 Audio API에서 제공해주는 노드와 정확히 같은 개념이다. 즉, JavaScript로 저 흐름을 완벽히 동일하게 구현할 수 있다는 뜻이다.</p>\n</blockquote>\n<p>이해를 돕기 위해 저 노드들의 역할에 대해서 조금 더 부가설명을 하자면, 일단 <code class=\"language-text\">Lead Vox</code>는 말 그대로 보컬의 노래 소스를 가진 노드이고 <code class=\"language-text\">LeadVxDbl</code>은 노래를 풍부하게 들리게 하기 위해 같은 멜로디를 한번 더 녹음한 것, 즉 더블링 작업을 한 노드이다. 그리고 <code class=\"language-text\">Vox Fill</code>은 화음을 쌓은 코러스를 담은 노드이다.</p>\n<p>그리고 보컬이 노래한 이 오디오 소스를 모두 <code class=\"language-text\">Vocal Bus</code>라는 노드로 모으고 있다. 이렇게 하는 이유는 여러 개의 오디오 소스에 이펙터를 각각 사용하면 노드마다 조금씩 소리의 느낌이 달라질 수 있기 때문에 <code class=\"language-text\">Vocal Bus</code>라는 하나의 노드로 오디오 신호를 모은 다음 해당 노드에만 이펙터를 걸어주는 것이다.</p>\n<p>이렇게 하면 모든 노드에 이펙터를 사용하지않고 하나의 노드에만 이펙터를 사용해도 되기 때문에 메모리 비용도 아낄 수 있고, 보컬이라는 하나의 소스에 동일한 느낌을 부여할 수 있다.</p>\n<p>그리고 최종적으로 신호가 들어가는 <code class=\"language-text\">Sub Master</code> 노드는 아마 최종 아웃풋으로 소리가 나가기 전에 한번 더 이펙터 처리를 하고 싶어서 생성한 것일 테고, Sub Master까지 도달한 오디오는 아웃풋, 즉 스피커를 통해 출력되어 우리의 귀로 들어오게 되는 것이다. 결국 in > out > in > out의 계속된 반복이라고 보면 된다. 그래서 필자가 오디오의 흐름이라고 표현하는 것이다.</p>\n<p>이제 오디오 소스의 흐름이라는 것이 대략 이해가 되었으면 한번 직접 HTML5의 Audio API를 사용해서 이 흐름을 구현해보도록 하자.</p>\n<h2 id=\"오디오의-음량을-조절하기\" style=\"position:relative;\">오디오의 음량을 조절하기<a href=\"#%EC%98%A4%EB%94%94%EC%98%A4%EC%9D%98-%EC%9D%8C%EB%9F%89%EC%9D%84-%EC%A1%B0%EC%A0%88%ED%95%98%EA%B8%B0\" aria-label=\"오디오의 음량을 조절하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>위에서 이야기했듯이 이번 포스팅에서는 본격적으로 이펙터를 구현해보기에 앞서 오디오의 흐름을 직접 구현해보고 체험해보는 것에 초점을 맞출 것이다.</p>\n<p>그래서 이펙터라기에는 조금 애매한 단순한 구조의 흐름을 만들어보려고 한다. 바로 오디오의 음량을 조절하는 흐름이다. HTML5 Audio API의 <code class=\"language-text\">GainNode</code>를 사용하면 오디오 소스의 음량을 손쉽게 조절할 수 있다.</p>\n<h3 id=\"gain이란-무엇인가요\" style=\"position:relative;\">Gain이란 무엇인가요?<a href=\"#gain%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80%EC%9A%94\" aria-label=\"gain이란 무엇인가요 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>게인(Gain)이란 쉽게 말하면 입력 볼륨을 의미한다. 게인을 사용하여 마이크에서 오디오 믹서나 녹음기로 오디오 신호를 보낼 때 그 신호량을 컨트롤하는 것이다. 처음 오디오에 입문하시는 분들이 게인(Gain)과 볼륨(Volume)의 차이에 대해 헷갈려하시는데, 쉽게 말하면 게인은 “입력 신호를 조절하는 것”이고 볼륨은 “출력 신호를 조절하는 것”이다.</p>\n<p>만약 <code class=\"language-text\">100</code> 정도 세기의 신호를 처리할 수 있는 녹음기가 있다고 생각해보자. 이때 우리가 마이크에 대고 <code class=\"language-text\">80</code> 정도의 세기로 소리를 왁! 지르면 이 녹음기는 무리없이 이 신호를 받아들일 수 있지만, <code class=\"language-text\">150</code>의 세기로 소리를 지르게 되면 이 녹음기는 <code class=\"language-text\">50</code>만큼의 소리를 받아들이지 못하고 그대로 유실시킨다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f0119ca780b0c91668fc8bf38f66aefd/d44c9/clipping.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 46.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsRAAALEQF/ZF+RAAABpUlEQVR42j2RbW/aMBSF8///xKR9mlQhCm0gpcoySCm0lHZtWQeIJh1hQEji6zgvjkmCdyFar2zr6LHPlXyPIqWkAJQQFIeyPBwOKMqySJOkLIojRHKCeCL5fIOl4CYAQWU+0uNFnufvtu3udlVHefJjbVxX7PcnI5JS8X1vZdv283Pk7YizDFZOXpY8SazJq/XzMY4iDhB7HsKNZc0fx+vZjDPG41iITGFJEr0vQFMDQ/cadd/QeZaFk5dAbXq1M7aYE7Pnt9U0YnR0R66vUMNwEE5/k9G9kuV5sJgzswttNfyhw0WD9U1oXQT1GnS0aHiLGltTvcP6Pdo1qKEHZ9+o1oLWpZIXRRrH7KZHzmtscEua5+n0LRr0/a9fmKGzG5M06tg0uh9mf1f0+grUZtj9joK0LxUAIL5P0Nw3ydOYjO5ElgkhvI621VrkYcRmU3h9yaVMPM9tqwjp05i9TRJnqcRxhFEtLQsN280mDMOM870Qfz4+1s4SB5Zyjg9wyIyF01+TteNwzrE9LuWUaonOavz/A5Nbd1vBKryq8I+fIUsp/wEwLufZteHIRgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"clipping\" title=\"\" src=\"/static/f0119ca780b0c91668fc8bf38f66aefd/6af66/clipping.png\" srcset=\"/static/f0119ca780b0c91668fc8bf38f66aefd/69538/clipping.png 160w,\n/static/f0119ca780b0c91668fc8bf38f66aefd/72799/clipping.png 320w,\n/static/f0119ca780b0c91668fc8bf38f66aefd/6af66/clipping.png 640w,\n/static/f0119ca780b0c91668fc8bf38f66aefd/d44c9/clipping.png 722w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>회색으로 표시된 부분이 잘려나간 신호이다.</small>\n</center>\n<p>이 현상은 여러분도 살면서 몇번 경험한 현상일텐데, 스피커로 소리를 엄청 크게 틀면 지지직거리는 잡음이 발생하는 것을 들어본 적이 있을 것이다. 이렇게 장비가 처리할 수 있는 신호의 세기를 넘어가는 현상을 클리핑(Clipping)이라고 한다. 말 그래도 신호가 잘려나가는 것이다.</p>\n<p>이렇게 잘려나간 신호는 위 그림에서 볼 수 있듯이 머리가 네모 반듯한 사각파의 형태를 가지게 되는데, 이 사각파는 우리가 EDM 등에서 멜로디를 표현할 때 많이 들을 수 있는 신디사이저 리드(Lead) 계열의 “쭈와앙~” 하는 금속성 소리를 낸다. 말로는 잘 이해가 안될테니 한번 음악으로 들어보면서 잠시 쉬어가도록 하자. 아마 클럽 좀 다녀보신 분들은 “아! 이 소리”할 것이다.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.49999999999999%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/usXhiWE2Uc0?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<center>\n  <small>해당 곡의 인트로가 끝나는 35초부터 메인 멜로디를 맡는 악기가 사각파를 사용한 리드이다.</small>\n  <br />\n  <br />\n</center>\n<p>아무래도 리드는 악기로써 파형이 어느 정도 정제된 상태이기 때문에 클리핑이 발생했을 때 나는 소리는 이것보다 더 거칠고 날카롭다. 참고로 이렇게 파형에 따라 소리가 달라진다는 개념은 왜곡계(Distortion) 이펙터를 만들때도 사용하는 개념이기 때문에 기억해두면 좋다.</p>\n<p>어쨌든 이런 클리핑 문제 때문에 사운드 엔지니어들은 오디오 소스와 다음 장비 사이에 게인을 조절할 수 있는 장치를 두고, 장비가 받아들일 수 있는 신호의 세기에 맞춰서 알맞게 게인을 조절하여 소스 오디오의 신호가 커지더라도 모든 신호를 다 담을 수 있도록 한다.</p>\n<p>반대로 볼륨은 소리를 내보낼 때 얼마나 증폭시킬 것이냐를 의미한다. 많은 분들이 게인과 볼륨을 헷갈려하는 이유가 둘 다 소리를 증폭시키거나 감소시키는 역할을 하기 때문인데, 볼륨은 이미 입력된 신호를 출력할 때 건드리는 것이기 때문에 클리핑이 발생하더라도 볼륨을 줄이면 신호가 돌아오지만 녹음할 때 게인을 잘못 설정하여 유실된 소리는 다시 돌아오지 않는다.</p>\n<p>신호 입력 단계에서 이미 유실된 것이기 때문에 영원한 이별인 것이다. 게다가 녹음이라는 특성 상 그 원본 소스는 사람인 경우가 많다. 결국 이 유실된 신호를 다시 살려낼 수 없기 때문에 게인을 잘못 설정하면 다시 녹음을 해야하는 슬픈 상황이 벌어질 수 있는 것이다.</p>\n<p>그래서 사운드 엔지니어들은 소리를 녹음할 때 게인을 잘 다루는 것을 엄청 중요하게 생각한다. 사실 게인만 해도 좀 더 깊이 들어가면 하고 싶은 이야기가 많지만, 이 포스팅은 오디오 전문 포스팅이 아니므로 그냥 비슷한 거라고 생각하고 넘어가도 상관없다.</p>\n<p>이제 게인이 무엇인지 이해했다면 <code class=\"language-text\">GainNode</code>와 함께 오디오 소스의 신호 세기를 조절해서 소리의 크기를 변형시켜보자!</p>\n<h3 id=\"gain-node를-사용하여-음량을-조절해보자\" style=\"position:relative;\">Gain Node를 사용하여 음량을 조절해보자<a href=\"#gain-node%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EC%9D%8C%EB%9F%89%EC%9D%84-%EC%A1%B0%EC%A0%88%ED%95%B4%EB%B3%B4%EC%9E%90\" aria-label=\"gain node를 사용하여 음량을 조절해보자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>일단 게인을 사용해보려면 오디오 소스가 필요하다. 오디오 소스는 HTML5의 <code class=\"language-text\">&lt;audio></code> 태그를 사용하거나 사용자가 직접 업로드한 파일에서 추출하는 두가지 방법이 있는데, 필자는 이 중 후자의 방법을 사용하였다.</p>\n<p>이것도 엄밀히 말하자면 <code class=\"language-text\">&lt;audio></code>태그를 사용하여 소스를 추출했을 때와 파일 버퍼에서 직접 추출했을 때는 다른 소스 노드 객체가 생성되긴 하지만 기능상 큰 차이 없으므로 그냥 개인의 취향대로 하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> audioContext <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token punctuation\">(</span>Audiocontext <span class=\"token operator\">||</span> webkitAudioContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio-uploader'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onchange</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">evt</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> evt<span class=\"token punctuation\">.</span>currentTarget<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  reader<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token parameter\">evt</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">decodeAudioData</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> sourceNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createBufferSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    sourceNode<span class=\"token punctuation\">.</span>buffer <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>sourceNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">AudioBufferSourceNode <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">buffer</span><span class=\"token operator\">:</span> AudioBuffer<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">playbackRate</span><span class=\"token operator\">:</span> AudioParam<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">detune</span><span class=\"token operator\">:</span> AudioParam<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">loop</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">loopStart</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> …<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>우선 간단한 설명을 하자면 <code class=\"language-text\">buffer</code> 변수에 담긴 오디오 데이터는 raw한 오디오 데이터일 뿐 아직 하나의 노드가 아니기 때문에 사용할 수 없는 상태이다. 그렇기 때문에 <code class=\"language-text\">createBufferSource</code> 메소드를 사용하여 소스 노드를 생성한 후 해당 소스 노드에 오디오 데이터를 입력해줘야만 비로소 오디오 데이터를 사용할 수 있는 상태가 되는 것이다.</p>\n<p>이때 필자는 사용자가 업로드한 파일에서 직접 오디오 버퍼 데이터를 뽑아와서 노드를 만든 것이기 때문에 <code class=\"language-text\">createBufferSource</code> 메소드를 사용하여 소스 노드를 생성했지만, 만약 <code class=\"language-text\">&lt;audio></code> 태그에서 추출한 오디오 데이터를 사용하여 소스 노드를 생성하고 싶다면 <code class=\"language-text\">createMediaElementSource</code> 메소드를 사용해야 한다.</p>\n<p>그럼 이제 <code class=\"language-text\">GainNode</code>를 생성하고 소스 노드에 연결만 시켜주면 바로 이 오디오 소스의 음량을 조절할 수 있게 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> gainNode <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsourceNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>gainNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngainNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>audioContext<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>이 코드에서 소스 > 게인 노드 > 데스티네이션으로 설정된 오디오의 흐름이 보인다면 사실상 Audio API에 대한 이해는 거의 끝났다고 봐도 무방하다. 위에서도 말했듯이 오디오를 컨트롤할 때는 이 개념을 이해하는 게 제일 중요하기 때문이다.</p>\n<p>또한 <code class=\"language-text\">gainNode</code>가 연결된 <code class=\"language-text\">audioContext.destination</code>은 최종 아웃풋, 즉 스피커로 향하는 정보를 가지고 있다. 그럼 이제 여기서 오디오의 소리를 증폭시키거나 감소시키려면 어떻게 해야할까?</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">gainNode<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">1.2</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 또는</span>\ngainNode<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">.</span><span class=\"token function\">setValueAtTime</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">,</span> audioContext<span class=\"token punctuation\">.</span>currentTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 그 후 소스를 재생해보자</span>\nsourceNode<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>[Warinig] 너무 값을 크게 올리면 재생했을 때 고막 터집니다.</p>\n</blockquote>\n<p>간단하다. 그냥 <code class=\"language-text\">GainNode.gain.value</code>에 접근해서 값을 변경해주면 된다. 게인 같은 경우는 값에 직접 접근하여 변경하는 것이 가능하지만 다른 노드의 경우 자신의 값을 직접 변경하는 것이 허용되지 않는 경우가 있는데, 이럴 때는 <code class=\"language-text\">setValueAtTime</code> 메소드를 사용하면 된다.</p>\n<p><code class=\"language-text\">setValueAtTime</code> 메소드는 일종의 스케줄러같은 개념인데, 두번째 인자로 넘긴 시간이 지난 후에 값을 적용하는 기능을 가지고 있다. 이때 인자로 넘기는 시간의 단위는 초(Seconds)이다. <code class=\"language-text\">audioContext.currentTime</code>을 인자로 사용하면 곧바로 값의 변경이 적용된다.</p>\n<p>필자는 처음에 이런 노드들의 값을 변경할 때 헷갈렸던 것이 하나 있는데, 바로 노드에 입력할 수 있는 최소값과 최대값이다. 즉, 이 노드가 가지는 값의 범위를 알 수가 없었다. 물론 공식 문서에 다 나와있긴 하지만 그걸 어느 세월에 하나하나 검색해서 보겠는가?</p>\n<p>그래서 문서를 조금 더 뒤져보니 이 노드들이 가지는 값은 공통적으로 <code class=\"language-text\">AudioParam</code> 타입이라는 것을 알 수 있었다. 이 타입은 <code class=\"language-text\">min</code>, <code class=\"language-text\">max</code>, <code class=\"language-text\">defaultValue</code>, <code class=\"language-text\">value</code> 속성을 가지고 있었고, 이 값들은 <code class=\"language-text\">input[type=\"range\"]</code>를 사용하여 오디오를 컨트롤할때 유용하게 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>gainNode<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">AudioParam <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">automationRate</span><span class=\"token operator\">:</span> <span class=\"token string\">\"a-rate\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">defaultValue</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">minValue</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">3.4028234663852886e+38</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">maxValue</span><span class=\"token operator\">:</span> <span class=\"token number\">3.4028234663852886e+38</span><span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>이 값을 잘 확인하고 게인의 값을 설정하면 적어도 고막과 이어폰이 터져나가는 불상사는 방지할 수 있을 것이다. 위에서 말했듯이 컴퓨터가 처리할 수 있는 신호의 세기를 넘어가게 되면 클리핑 현상이 발생하면서 찢어지는 듯한 소리가 나기 때문에 만약 이어폰을 끼고 있었다면 농담이 아니고 진짜 귀에 무리가 갈 수도 있다.</p>\n<p>자, 이렇게 간단하게 오디오 소스의 게인을 조절해보았다. 나머지 이펙터들도 대부분 이런 느낌으로 구현된다. 간혹 조금 더 복잡한 연결이 필요한 이펙터들이 있긴 하지만 대부분의 경우 간단한 몇개의 노드를 연결하는 것만으로 구현할 수 있기 때문에 그렇게 어렵지 않다.</p>\n<p><a href=\"/2019/08/21/javascript-audio-effectors-practice/\">다음 포스팅</a>에서는 이번에 알아본 개념을 바탕으로 소리를 압축하거나 공간감을 부여하고, 특정 주파수를 잘라내어 소리에 특별한 느낌을 줄 수 있는 다른 이펙터들을 만들어보도록 하겠다.</p>\n<p>또한 기회가 된다면 이미 존재하는 오디오 소스를 변형하는 이펙터가 아니라 진짜로 오디오 신호 자체를 만들어 낼 수 있는 오실레이터(Oscillator)를 사용하여 나만의 악기를 만들어볼 수 있는 포스팅도 진행할 예정이다.</p>\n<p>이상으로 JavaScript로 오디오 이펙터를 만들어보자 - 소리의 흐름을 파악하자 포스팅을 마친다.</p>","fields":{"slug":"20190819-javascript-audio-effectors-gain","path":"/2019/08/19/javascript-audio-effectors-gain/","lang":"ko"},"frontmatter":{"title":"[JavaScript 오디오 이펙터 만들기] 소리의 흐름을 파악하자","subTitle":"GainNode부터 시작하는 오디오 이펙터 개발","date":"Aug 19, 2019","categories":["프로그래밍","오디오"],"tags":["JavaScript","자바스크립트","Audio","오디오 이펙터","JavaScript Audio API","Logic Pro X","로직프로","Protools","프로툴즈","Cubase","큐베이스","Audio Plugin","Compressor","Delay","Reverb","EQ"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/026a9fe9c894f201ec1e45217221447c/3a812/thumbnail.jpg","srcSet":"/static/026a9fe9c894f201ec1e45217221447c/3a812/thumbnail.jpg 320w,\n/static/026a9fe9c894f201ec1e45217221447c/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/026a9fe9c894f201ec1e45217221447c/fc5c5/thumbnail.webp 320w,\n/static/026a9fe9c894f201ec1e45217221447c/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/026a9fe9c894f201ec1e45217221447c/2d839/thumbnail.jpg","srcSet":"/static/026a9fe9c894f201ec1e45217221447c/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/026a9fe9c894f201ec1e45217221447c/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"b5b53232-a775-55d7-8053-ae1b2c3646d9","tableOfContents":"<ul>\n<li><a href=\"#%EB%82%B4%EA%B0%80-%EB%A7%8C%EB%93%A0-%EB%A0%88%EA%B1%B0%EC%8B%9C-%EC%BD%94%EB%93%9C\">내가 만든 레거시 코드</a></li>\n<li><a href=\"#%EA%B8%B0%EC%88%A0%EB%A7%8C%EB%8A%A5%EC%A3%BC%EC%9D%98%EC%97%90%EC%84%9C-%EC%A1%B0%EC%A7%81%EC%9D%84-%EB%B3%B4%EB%8A%94-%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%A1%9C\">기술만능주의에서 조직을 보는 개발자로</a></li>\n<li><a href=\"#%EA%B0%99%EC%9D%80-%ED%8C%80%EC%9D%B4%EB%9D%BC%EB%8A%94-%EA%B2%83\">같은 팀이라는 것</a></li>\n<li><a href=\"#%EB%8B%A4%EB%A5%B8-%EC%82%AC%EB%9E%8C%EC%9D%84-%EB%8F%84%EC%99%80%EC%A3%BC%EB%8A%94-%EC%82%AC%EB%9E%8C%EC%9C%BC%EB%A1%9C\">다른 사람을 도와주는 사람으로</a></li>\n<li><a href=\"#%EC%95%84%EC%8B%B8%EC%97%90%EC%84%9C-%EB%82%98%EB%A6%84-%EC%9D%B8%EC%8B%B8%EB%A1%9C\">아싸에서 나름 인싸로</a></li>\n<li><a href=\"#%EB%8A%A5%EB%A0%A5%EC%9E%88%EB%8A%94-%ED%8C%80%EC%9B%90%EB%93%A4%EC%9D%B4-%EC%A3%BC%EB%8A%94-%EC%9E%90%EA%B7%B9\">능력있는 팀원들이 주는 자극</a></li>\n<li><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></li>\n</ul>","excerpt":"오늘, 2019년 8월 16일을 마지막으로 지난 2년 동안 근무했던 회사를 떠나게 되었다. 지금은 사무실에서 말년의 여유를 즐기며 이 포스팅을 서두를 작성하고 있다. 그래서 이번 포스팅에서는 지난 2년 간 필자가 이 회사를 다니면서 느꼈던 점이나 입사 당시와 비교해서 지금 달라진 점들에 대해서 회고를 진행하려고 한다.","html":"<p>오늘, 2019년 8월 16일을 마지막으로 지난 2년 동안 근무했던 회사를 떠나게 되었다. 지금은 사무실에서 말년의 여유를 즐기며 이 포스팅을 서두를 작성하고 있다. 그래서 이번 포스팅에서는 지난 2년 간 필자가 이 회사를 다니면서 느꼈던 점이나 입사 당시와 비교해서 지금 달라진 점들에 대해서 회고를 진행하려고 한다.</p>\n<!-- more -->\n<p>필자가 처음 이 회사에 입사했을 때는 직원 수 13명 정도에 아직 Series A 투자도 받지 못했던 신생 스타트업이었지만, 지금은 어느 덧 120억 정도의 Series B 투자도 받고 직원 수도 50명 정도 되는 규모의 회사가 되었다. 필자도 회사가 이렇게 성장하는 것을 직접 경험하는 것이 처음이었기에 재밌는 점도 있었지만 한편으로는 조직이 커짐에 따라 변해가는 사내 문화와 조직의 분위기를 보면서 규모가 작을 때에 대한 향수를 느끼기도 했었다.</p>\n<p>어쨌든 필자는 이제 휴식과 재정비를 위해 오늘을 마지막으로 회사를 그만 두게 되었으니 입사 당시의 기억부터 2년이 지난 오늘까지의 기억을 되짚어 보며 한번 회고를 진행해보도록 하겠다.</p>\n<h2 id=\"내가-만든-레거시-코드\" style=\"position:relative;\">내가 만든 레거시 코드<a href=\"#%EB%82%B4%EA%B0%80-%EB%A7%8C%EB%93%A0-%EB%A0%88%EA%B1%B0%EC%8B%9C-%EC%BD%94%EB%93%9C\" aria-label=\"내가 만든 레거시 코드 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>필자는 이 회사에 입사하기 전에 아는 분과 함께 하던 스타트업을 시원하게 말아먹고 2개월 정도 혼자서 토이 프로젝트로 이것저것 만들면서 놀고 있는 한량 개발자였다. 하루는 홍대에 있는 필자의 단골 카페에서 혼자 코딩을 하고 있었는데 왠 이상한 외국인 아저씨가 링크드인으로 면접 제안 메세지를 보낸 것이다.</p>\n<p>그래서 몇 마디를 나눠보니 그 분이 지금 만들고 있는 서비스도 나름 재밌을 것 같았고, 회사의 분위기나 비전도 필자와 잘 맞을 것 같아서 그 다음 주에 바로 면접을 진행했고, 면접이 끝난 그 자리에서 바로 합격 통보를 받았다. 그 당시 주고 받았던 질답 중에 지금까지 기억나는 질답은 딱 이거 하나다.</p>\n<blockquote>\n<p><strong>CTO</strong>: 혹시 VueJS 하실 수 있으세요? 저희가 이런 거를 만들어 보려고 하는데… <small>(다른 서비스의 컴포넌트를 보여줌)</small></p>\n<p><strong>필자</strong>: Vue는 거의 안 써보긴 했는데… 뭐 개인적으로 공부 하면서 하면 만들 수 있을 것 같네요.</p>\n</blockquote>\n<p>면접이 끝나고 나서 생각해보니 “이 사람들 도대체 뭘 보고 날 뽑은거지…?”라는 생각이 들 정도로 프론트엔드에 대한 깊은 질문이나 코드 테스트도 없었는데, 입사 첫 날에 바로 현재 상황을 파악할 수 있었다. 일단 필자가 이 회사의 첫번째 프론트엔드 개발자였다. CTO가 기존 Django로만 작성된 프로젝트를 운영하다가 프론트엔드 프레임워크의 필요성을 느끼고 React를 도입하려다가 한번 실패하고 차선책으로 Vue를 어떻게든 돌아가게만 적용해놓은 상황이었다.</p>\n<p>하지만 당시 CTO는 백엔드 개발자였기 때문에 프론트엔드에 전문성을 가진 누군가가 이 상황을 타개해줬으면 했던 것이고 그래서 필자가 간택당한 것이다. 그래서 필자가 입사한 다음 했던 첫 작업이 바로 <a href=\"https://gulpjs.com/\" target=\"_blank\" rel=\"nofollow\">Gulp</a>와 <a href=\"https://webpack.js.org/\" target=\"_blank\" rel=\"nofollow\">Webpack</a>을 사용해서 프론트엔드 빌드 프로세스를 만들고, 번들링되어 나온 파일들을 Django와 연동시키는 그런 작업이었다.</p>\n<p>하지만 당시 비즈니스 상황 상 프론트엔드 어플리케이션을 Django로부터 완전 분리해서 작성할 수가 없었기에 Django가 서버에서 자체 템플릿 엔진을 사용하여 한번 HTML을 렌더하고 클라이언트에서 Vue가 2차 렌더링을 진행하는 방식으로 적용할 수 밖에 없었다.</p>\n<p>그리고 2019년 현재 구글에 “Django Vue”라고 검색해보면 Django 템플릿과 Vue를 동시에 사용할 수 있는 방법을 설명한 몇 개의 포스팅이 나오지만 필자가 이 작업을 진행했던 2017년 5월에는 그런 레퍼런스가 단 한개도 존재하지 않았기 때문에 모든 것을 필자 스스로 설계하고 아이디어를 짜내서 연동해야했다.</p>\n<p>당시에 이 작업으로 포스팅을 작성했으면 좋았을 것 같은데 입사한지 얼마 되지 않았을 때라 포스팅이고 나발이고 일단 전체 코드를 파악하는 것만 해도 정신이 없었다.</p>\n<p>결국 이 어플리케이션은 현재 프론트엔드 챕터에게 레거시라고 불리며 필자를 포함한 그 누구도 건드리기 싫어하는 어플리케이션이 되었는데, 뭐 사실 그때 당시에는 그게 최선이긴 했기 때문에 당시 결정에 후회는 없다. 하지만 필자가 작성한 코드가 시간이 지나서 다른 개발자들에게 레거시라고 불리게 되는 경험은 처음이었기에 나름 흥미로웠다.</p>\n<p>이 코드는 사실 그 당시 필자가 만들면서도 “이거 나중에 분명히 문제될 것 같은데…?”라고 생각할 정도로 일반적인 프론트엔드들이 이해하기 힘든 기형적인 구조였다.</p>\n<p>문제가 많아서 일일히 나열하기는 힘들지만 대표적인 이슈는 바로 여러 개의 Vue 인스턴스가 존재한다는 것과 DJango를 할 줄 알아야 수정이 가능한 부분이 있다는 것, 그리고 기존 코드에서 bower 패키지를 사용하고 있었기 때문에 bower를 걷어내고 npm으로 완전히 갈아타는 것이 불가능하다는 것이었다. 물론 이 이슈는 현재진행형이다.</p>\n<p>이런 것들이 하나하나 쌓여서 결국 기술 부채가 누적되는 것이기 때문에 언젠가 청산을 하긴 해야 했다. 그래서 필자는 퇴사 후 현 직장과 2개월 프리랜서 계약을 체결하고 이 레거시 어플리케이션에 붙어있는 프론트엔드 어플리케이션을 전부 새로 만든 프론트엔드 어플리케이션 프로젝트로 마이그레이션하는 작업을 진행하기로 하였다. <small>(내 똥은 내가 치운다! 라는 느낌이랄까)</small></p>\n<h2 id=\"기술만능주의에서-조직을-보는-개발자로\" style=\"position:relative;\">기술만능주의에서 조직을 보는 개발자로<a href=\"#%EA%B8%B0%EC%88%A0%EB%A7%8C%EB%8A%A5%EC%A3%BC%EC%9D%98%EC%97%90%EC%84%9C-%EC%A1%B0%EC%A7%81%EC%9D%84-%EB%B3%B4%EB%8A%94-%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%A1%9C\" aria-label=\"기술만능주의에서 조직을 보는 개발자로 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>이 내용은 <a href=\"/2019/06/06/what-is-good-programmer\">좋은 개발자란 무엇일까?</a>라는 포스팅에서도 한번 언급한 적이 있었는데, 처음 필자가 이 회사에 입사했을 때 필자가 생각하는 좋은 개발자의 기준은 “요구사항을 빠르고 완벽하게 개발하는 개발자”였고 필자의 개발 스타일은 “빠르게는 만들지만 자잘한 버그가 많은 스타일”이었다.</p>\n<p>그래서 필자는 당시 이 단점을 보완하기 위해 유닛 테스트나 실수를 줄일 수 있는 설계 패턴 등을 통해서 신뢰성이 떨어지는 필자 코드에 대한 방어선을 펼치는 방향으로 노력을 했었다.</p>\n<p>하지만 필자의 첫 직장과 다르게 여기서는 CTO가 모든 의사결정을 하지 않고 프론트엔드 어플리케이션에 대한 의사결정은 프론트엔드 개발자가 하는 구조였다. 단순히 필자의 단점을 보완하는 것 뿐만 아니라 비즈니스에 유연하게 대응할 수 있는 설계와 인프라, 현재 어플리케이션이 가지고 있는 문제점의 분석 등 많은 것을 함께 해야했던 것이다. 또한 팀 외부와 소통하는 것 또한 필자가 프론트엔드 개발자로써 직접 해야했다. <small>(특히 마케팅팀과 SEO, 유저 행동 데이터 수집 등에 대해 많은 커뮤니케이션을 했었다)</small></p>\n<p>이 과정에서 필자가 생각하고 있던 개발의 영역이 많이 확장되게 되었는데, 기존에는 “내가 어떻게 하면 더 개발을 잘할 수 있을까?”를 위주로 고민했다면 이 과정을 겪고 나서는 “이 어플리케이션이 어떻게 하면 더 발전할 수 있을까?”를 더 고민하게 되었다. 더 나아가서 지금은 어플리케이션 뿐만 아니라 “이 팀이 어떻게 하면 더 효율적으로 일할 수 있을까?”까지 고민하고 있는 상황이다.</p>\n<h2 id=\"같은-팀이라는-것\" style=\"position:relative;\">같은 팀이라는 것<a href=\"#%EA%B0%99%EC%9D%80-%ED%8C%80%EC%9D%B4%EB%9D%BC%EB%8A%94-%EA%B2%83\" aria-label=\"같은 팀이라는 것 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>필자가 입사하고 얼마 되지 않았을 때 회사가 Series A 투자를 받게 되었는데, 그때 CEO가 했던 약속이 “우리 투자받으면 해외로 한번 워크샵가자!”였었다. 그래서 필자는 입사한지 거의 한달만에 베트남 다낭으로 워크샵을 떠나게 되었다. <small>(개꿀)</small></p>\n<p>대략 3박 4일 정도였던 것 같은데 문제는 한국으로 귀국하기 바로 전날 밤에 터졌다. 필자가 워크샵을 오기 전에 개발했던 기능이 있었는데 이 기능이 Internet Explorer에서 아예 작동하지않고 있었던 것이다. 그 기능이 배포된 지는 대략 3주 정도 되었고, 유저들이 IE에서 해당 기능을 사용하지 못하자 데이터 플로우 차트가 이상하게 그려지기 시작했던 것이다.</p>\n<p>당시 사내에 IE를 사용하는 사람이 단 한명도 없었기에 이 문제를 조기에 발견하지 못했다. 하지만 제일 큰 책임은 해당 기능을 개발하고 제대로 크로스 브라우징을 테스트하지않았던 필자에게 있었다. 그래서 필자는 그 이야기를 듣자마자 바로 맥북을 펴고 핫픽스를 하기 시작했는데 그때 시간은 이미 00시를 넘기고 있었다.</p>\n<p>그때 들었던 감정은 음, 테스트를 제대로 하지 않았다는 자책감과 나의 부주의함으로 인해 회사에 피해를 끼쳤다는 미안함이었던 것 같다. 어쨌든 이걸 빨리 고쳐야하니 정신없이 분석하면서 원인을 찾게 되었는데, 제일 큰 문제는 바로 <code class=\"language-text\">Array.prototype.findIndex</code> 메소드를 babel이 제대로 트랜스파일링 해주지 않았던 것이었고 그 외 자잘한 이슈도 몇개 더 있었다.<small>(필자는 이 이후로 babel을 안 믿는다)</small></p>\n<p>다행히 빠르게 버그 원인을 알아냈지만 진짜 문제는 베트남 인터넷이 너무 느려서 소스를 빌드하고 해당 기능의 작동을 확인하는 것도 오래 걸리고 문제가 발생한 부분이 서버와의 API 통신을 담당하는 모듈이라서 해당 모듈을 사용하는 핵심 기능을 전부 테스트해야 했었다. 게다가 그걸 고치는 과정에서 빌드 프로세스도 갑자기 맛이 가는 등 연쇄적으로 문제가 커져서 픽스 시간은 점점 늘어났다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1ec95d12d2fb2770a8c661464bc589a6/e67a8/vietnam_commit.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 48.12500000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACBklEQVR42lVS2W7TUBD1RyB4aZaWJM5mO15iO95jx46zN7RC4qnlhYKE2iJVIKEC4ssPM4MUwcPRjOfee+bMHCt3qYVVkMAIluhpAbr/QNVDdMYBGl0b/UkMJ6phuAUmfgmTMKXvoZXCmpWECpozh7Io15jlBymOqcAYWRnFDLqbo0ekZ0Q4oofx4gAvWVO8RFoeka+uMfEW8NMNgvkONpEqWVbATbZSvBj5OOtYpMgRVYxWj3LC0EzgJxtYQSV3/XSLuDhgbGdw47U00km9kiQ5/GwnCpv0sN13/0NLnQohj8wj8qhMwKRhvqcxc9jhUs4MjwjLska2vIZDRd4BEzAxq+MohJTzGY/qEVlaHZFVb7DYvBWSqNjLOphUCaOMxqhFumpE6JIJFwMPfSMmQ2anBnxmk3H6NBeVbIKYQqtg0om/EA6lrrnjlSyXL/IjdpEvqHp0UshEbAKPOa+vJF/u38mqkvKScPyrMErITeomvwQRqbSrEY8+cNFQaacUm/2p1E1qppHzZljBohW56RoDO6V6hUlQYkh/hlJlJZxpiZ7qotOh3TV0NJoGWm0T7XMCxSZ9a1qMJN7C8yqJabpDURxhmhmCWY0wWMGxyRT3+SPGPx7QffqAlw83ePV4S3hP+e0JL+5vcP71DuavL9Ce72H8fJTc+f2E198+QaP3XBt8/4w/8RJRAlcfsh0AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"vietnam commit\" title=\"\" src=\"/static/1ec95d12d2fb2770a8c661464bc589a6/6af66/vietnam_commit.png\" srcset=\"/static/1ec95d12d2fb2770a8c661464bc589a6/69538/vietnam_commit.png 160w,\n/static/1ec95d12d2fb2770a8c661464bc589a6/72799/vietnam_commit.png 320w,\n/static/1ec95d12d2fb2770a8c661464bc589a6/6af66/vietnam_commit.png 640w,\n/static/1ec95d12d2fb2770a8c661464bc589a6/d9199/vietnam_commit.png 960w,\n/static/1ec95d12d2fb2770a8c661464bc589a6/21b4d/vietnam_commit.png 1280w,\n/static/1ec95d12d2fb2770a8c661464bc589a6/e67a8/vietnam_commit.png 1740w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>추억돋는 그 날의 커밋들</small>\n</center>\n<p>결국 이런 저런 이슈들이 겹쳐서 최종 릴리즈는 오전 5시가 넘어서야 할 수 있었다. 이때 중요한 점은 모든 팀원들이 그때까지 필자와 함께 밤을 샜다는 것이다. 사실 이건 100% 프론트엔드 이슈였다. 당시 프론트엔드 개발자는 필자밖에 없었고 나머지는 전부 모바일 앱 개발자, 백엔드 개발자였기 때문에 다른 개발자 분들이 픽스를 도와줄 수 있는 것도 아니었다. 게다가 필자와 함께 밤을 새준 사람 중에는 UI/UX 디자이너도 있었다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/49d6e434dc93474e187027d99852edd6/2a4bc/hotfix.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEPUlEQVR42h2T21OTZxCHvxs7MhwkGE6ShpMhhEC+hISEyPkQCAcHFaMIyqQwWFCoIiBoASEi4ni2akWsIxW1UtCCoMKgFhC0qLXjSC/aGXvR/hdVnr7Ti9+87+zF7m93n5XOnD7EX//M83Z5kvmXw4yMf0v/9eOUlRdTujWfjSUOTEYDZrORwsIsFp6M8eH9G94vzbH08yOW5h//r7npe0zcvY7U2bGXD3/P8eq3cV69G+fl2zHe/TFDY0s1bYdr6e5pxGjQYbOZyMtLY/L+EMuvngvNsvhknGdTo0xN/MCdwct0f92ItH9fJb//OcPLX39i8fU9ni7e5fnr+xxoq6G2voIuTz1JibGk2mUcOXaGb/azMDNB24F6ylwl5OVmICfoWRcaQmhoMFJ1dSlv3j1g/pcRZl8MMz13i6ei9bbOOtzVWznc/uVKvFb9yW7Vk5Fm5sbAGSZGb6LVRBOgUBAYuBaFvz9+vn7ir0Tavq2AhaUfebZwm5n5ISafDvJ4doh2TwNlFUW0H6lDF63CYool2RrPN2c93L89gNUsC1fBqFShBCqVrPHzQ6HwRyoqSGdm9numnt3g4ZPrjE0NCF2j52Tzx9RUI3k51jFNtKpJjl+PUdbQe7SZ0aF+USCBz1atwtfXh9VeXkK+eIlXyky3MDE9wCOR7IFINvLgMqOTV+g71/Jvgj6SQG8vz65dxWqDVi3aDKPpKzeXTnRgtxhIsRrITLGQnZZIaa4Gm0mHZDCs5+J3bQzd6+PsQDPd52rxnNvDsdP7P2k0ary9vB/uK3N6HNZYYtTKFVkXQWRYEGZZz7ETp2hr76aifDvpccFYNCqkuNgoSquS2d3iIK9MizkvlKJyAw0Nro9RIQGEK1ZfGOxtK+yo2YGsj1zRfB6EUuFHSMAaWo+2c2t6hNYjjQSK+fl4+yAlGnU4t8hsqUhk5+50quqcXLvqYWy4f6W9cQ+u/Pxliz5xuiTXwSanbSVcFSIchpISG8nBulJu3+qht7uGtFg1crjApqnBTcnGdMGYjW0uBz1d9Vw600X/eQ+ezi4q3Q0EB6uIjoomMkIlNhnAGh9ftBFqGmrc7K+uYFdJLq48OwWpJqTBy73UVW0nZr2aOE24kBplgD8VZUW07qvCmZH8yaSL+Zio16FcG4AqbB1ZmSkUFzqYvHOV5RePWJy5S5+nhQsnO5CuHGuiWtxr2LogwsNCMItN2a0JlG7OFpeQi7s8l+JsmQyLBrsxirJN2ZztO0SzKJZj1rJZoFVZ6qT2ix1cOtmO1FrnIkWOQSF4SjTGsWVzDjlZScKFmTTRgtOZSlqKCXtSHPFibga9BjlOi0pAHRKkJDlJJBTH4XYVcfFUJ9L54y0crK+kac9OtopZFOSnCHe5bBJOMrOtyMYYNmwwku9IpbggQ7BnIs1uJkvENgjQbbpIbBFBHN67k8mRfv4DPm5rxw/Jbs0AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"hotfix\" title=\"\" src=\"/static/49d6e434dc93474e187027d99852edd6/6af66/hotfix.png\" srcset=\"/static/49d6e434dc93474e187027d99852edd6/69538/hotfix.png 160w,\n/static/49d6e434dc93474e187027d99852edd6/72799/hotfix.png 320w,\n/static/49d6e434dc93474e187027d99852edd6/6af66/hotfix.png 640w,\n/static/49d6e434dc93474e187027d99852edd6/d9199/hotfix.png 960w,\n/static/49d6e434dc93474e187027d99852edd6/21b4d/hotfix.png 1280w,\n/static/49d6e434dc93474e187027d99852edd6/2a4bc/hotfix.png 3264w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>새벽 한시에도 옆을 함께 지켜준 팀원들</small>\n</center>\n<p>이때 필자는 팀원들한테 미안하면서도 굉장히 고마운 마음이 들었다. 당시 당황한 마음으로 버그 픽스하고 있는 필자에게 팀원들은 괜찮으니까 천천히 꼼꼼히 고치라면서 격려도 해주고 먹을 것도 가져다주고 도와줄 게 없는 지 물어봐주기도 했다.</p>\n<p>앞으로도 다른 회사에서 또 이런 팀을 만나볼 수 있을까라는 생각이 들 정도로 정말 고마운 분들이었고 다들 각자의 길을 찾아나선 지금도 물론 꾸준히 연락을 주고 받으면서 잘 지내고 있다. <small>(어제는 퇴사 선물도 받았다.)</small></p>\n<p>필자는 사실 개인주의적인 성향이 강한 사람이었는데 이런 경험들은 필자가 팀의 발전에 대해서 꾸준히 고민할 수 있게 만들어준 소중한 경험이 되었다.</p>\n<h2 id=\"다른-사람을-도와주는-사람으로\" style=\"position:relative;\">다른 사람을 도와주는 사람으로<a href=\"#%EB%8B%A4%EB%A5%B8-%EC%82%AC%EB%9E%8C%EC%9D%84-%EB%8F%84%EC%99%80%EC%A3%BC%EB%8A%94-%EC%82%AC%EB%9E%8C%EC%9C%BC%EB%A1%9C\" aria-label=\"다른 사람을 도와주는 사람으로 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>작년 여름 쯤에, 필자가 입사할 때부터 CX팀에서 일하던 분이 보직 변경을 통해 PO(Product Owner)로 오게된 일이 있었다. 물론 이 분의 전공은 이 쪽 분야가 아니기도 하고 프로덕트와 관련된 일을 해본 경험도 거의 없었기 때문에 신입과 다름 없는 상태였다.</p>\n<p>그러다가 팀을 스쿼드 편제로 나누게 되면서 이 분과 필자는 같은 스쿼드에서 함께 일을 하게 되었는데, 처음 같이 일을 할때는 사실 별로 이 분에 대해서 신경을 안썼다. 뭐 알아서 잘하시겠지… 혹여나 못하더라도 나나 누군가가 커버할 수 있겠지 정도?</p>\n<p>하지만 같이 일을 하게 되면서 그 전까지는 몰랐던 이 분의 새로운 모습들을 많이 보게 되었다. 비록 남들보다 경험은 적을지라도 굉장히 프로덕트를 만든다는 일에 열정적이었고, 또 질문도 굉장히 많이 하시는 편이었는데 질문의 질이 굉장히 좋았다. 그래서였는지 이 분이 필자에게 개발에 대한 질문을 할 때마다 필자도 점점 열의를 가지고 가르쳐드리게 되었는데, 이 분은 항상 그 점에 있어서 필자에게 고맙다는 이야기를 많이 해줬었다.</p>\n<p>필자 또한 필자가 알고 있는 지식을 그 분에게 알려드리면서 실제로 그 분이 빠르게 성장하는 모습을 보고 나니 필자도 기분이 굉장히 좋았다. 내가 이미 알고 있는 별 것 아니라고 생각했던 지식이 다른 사람에게는 굉장한 도움이 될 수 있다는 생각을 이때 처음으로 하게 되었던 것 같다.</p>\n<p>그리고 그 분의 스쿼드 운영 스타일은 개발자와 디자이너들이 모두 자유롭게 아이디어를 내고 본인이 그걸 취합하고 정리하면서 진행하는 참여형이었는데 그 분의 경험과 실력이 점점 쌓이면서 시너지 효과가 발생해서 팀의 생산성도 높아지고 팀의 사기와 분위기도 많이 좋았던 기억이 난다. 결국 필자가 그 분에게 개발에 대한 지식을 알려줬던 그 행동이 필자와 그 분뿐만 아니라 팀 전체에 영향을 주었던 것이다.</p>\n<p>그런 과정을 겪으면서 필자는 “개인이 각자 잘하면 팀은 알아서 잘 굴러간다”와 같은 생각에 더 이상 동의하지 않게 되었다.</p>\n<h2 id=\"아싸에서-나름-인싸로\" style=\"position:relative;\">아싸에서 나름 인싸로<a href=\"#%EC%95%84%EC%8B%B8%EC%97%90%EC%84%9C-%EB%82%98%EB%A6%84-%EC%9D%B8%EC%8B%B8%EB%A1%9C\" aria-label=\"아싸에서 나름 인싸로 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>필자는 원래 사람 만나는 것을 별로 좋아하는 편이 아니었다. 하지만 이 직장에서 많은 일을 겪으면서 뭔가 성격이 좀 변했다고 해야하나…? 갑자기 인싸 짓을 하고 다니기 시작했다.</p>\n<p>처음 입사했을 때 필자와 며칠 차이로 입사했던 백엔드 개발자분이 계셨는데, 이 분과는 입사하고 거의 한달 정도는 업무 이야기 외에 별로 말을 안할 정도로 사람한테 관심이 없었다. <small>(이 분도 낯가리는 성격이라 둘 다 말을 잘 안걸었다)</small></p>\n<p>근데 지금은 어떤 분이 새로 입사하면 먼저 말도 걸기도 하고 다른 팀과 같이 술을 마시거나 게임도 하러가는 등 인싸같은 행동을 많이 하게 되었는데, 지금 생각해보면 아마도 작년의 번아웃이 뭔가 계기가 되었던 것 같다.</p>\n<p>필자는 2018년 여름 쯤에 한번 번아웃을 크게 겪은 적이 있었는데, 그 전까지 필자는 1년 365일 매일 코딩만 하는 사람이었다. 평일에는 밤 11시까지 야근하고 집에 와서 새벽 2-3시까지 토이 프로젝트를 하고, 주말에는 친구들과 또 다른 토이 프로젝트를 진행하고는 했던 그런 시기였다. 그렇게 일주일 내내 하루에 무조건 코딩을 7시간 씩은 했던 것 같다.</p>\n<p>필자는 이 생활을 군대 전역 후 대학교에 복학했던 2014년부터 계속 해왔으니 번아웃이 왔던 2018년에는 대략 5년 정도 그렇게 살아왔던 셈이다. 그러다가 갑자기 번아웃이 찾아왔는데, 그때는 그냥 코딩 자체에 흥미가 떨어져서 아무것도 하기 싫었다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/d35831406969526b9dd2ed48ac0e03b8/7f15f/contributions.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA3UlEQVR42iWPyW6EQAxE+f9fyyW3iTJZJMIEhrXbvUDTwIshlixL5SqXqzgOmJOQ1oWoc06elFZy3vGLZV6jttBJzRRrQjK6T/hrZuWtqgmkvLAfO0VKC0/7poIHrS0ZXMMoDeIcne2Z3MDka+7NK5/9i3IqxAu9GowilOM7xivPN2x7ojgdnnqglhuN3On9FxIMzkdc8EocaaWidZUa1DRjS4gJ682FP+wHo/tVzcRZxaLRfoylc4bBB/32jL1x7Ad50+h7Zs5Oo0b94B/fNm3Fz/gSe76nG2VfXrs/IVEyreqgrgEAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"contributions\" title=\"\" src=\"/static/d35831406969526b9dd2ed48ac0e03b8/6af66/contributions.png\" srcset=\"/static/d35831406969526b9dd2ed48ac0e03b8/69538/contributions.png 160w,\n/static/d35831406969526b9dd2ed48ac0e03b8/72799/contributions.png 320w,\n/static/d35831406969526b9dd2ed48ac0e03b8/6af66/contributions.png 640w,\n/static/d35831406969526b9dd2ed48ac0e03b8/d9199/contributions.png 960w,\n/static/d35831406969526b9dd2ed48ac0e03b8/21b4d/contributions.png 1280w,\n/static/d35831406969526b9dd2ed48ac0e03b8/7f15f/contributions.png 1530w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>듬성듬성한 필자의 2018년 깃허브 잔디</small>\n</center>\n<p>지금 생각해봐도 굉장히 당혹스러운 감정이었다. 코딩이 그렇게 즐겁고 재밌어서 5년 내내 매일 7-8시간씩 코딩을 했던 사람이었는데 하루 아침에 갑자기 코딩이 싫어지게 되는 기분이란 꽤나 이상한 감정이다. “내가 왜 이렇게까지 아둥바둥해야하지?”라는 회의감도 들었고 “이러다가 뒤쳐지는 거 아니야?”라는 불안함도 동시에 들었다. “개발이 나랑 맞지 않나?”라는 생각도 들었던 것 같다.</p>\n<p>이 당시 필자가 잘못 했던 것은 바로 일하기 싫은 티를 너무 팍팍 내고 다닌 것이었다. 이 당시 필자의 속마음은 “아 너무 재미없고 힘들다. 회사 그만 둘까…?”였기 때문에 팀원들과도 거리를 두고 업무 태도도 불량했다. 낮에는 업무를 설렁설렁하고 혼자 야근하면서 일을 끝내는 경우가 많았기 때문에 일이 밀리거나 하지는 않았지만 팀원들과 커뮤니케이션을 많이 못했었다.</p>\n<p>나중에 들어보니 당시 필자와 함께 오래 일했던 팀원들은 “얘 갑자기 뭔가 맛이 갔는데…?”라는 생각을 하고 필자에게 먼저 다가와 주었지만, 필자를 잘 몰랐던 다른 팀 분들은 업무를 제대로 하지 않는다고 생각하기도 했다고 한다. 그래서 당시 팀 리더가 필자에게 티타임을 신청하고 잠깐 이야기를 나눴었는데, 그때 그 분이 했던 말이 아직도 기억에 남는다.</p>\n<blockquote>\n<p>에반이 힘든 건 에반 개인의 문제가 아니라 팀의 문제에요. 팀이 도와줄 수 있는 건 최대한 도와줄게요.</p>\n<p>대신 뭐 때문에 힘든지는 이야기 해줘야해요.</p>\n</blockquote>\n<p>이 이야기를 듣고 솔직히 감동까지는 아니였지만 “맞네. 우리는 팀이었지.”라는 생각이 새삼스럽게 다시 들었었다. 그래서 이때부터 필자는 주변에 계신 분들께 필자의 현재 상황을 설명하고 많은 조언을 들을 수 있었는데, 주변에 계신 분들이 전부 똑같이 이야기한 것이 바로 “좀 쉬어라”였다.</p>\n<p>매일 야근하고 주말에도 코딩하고 취미도 없고 연애도 하지 않는 생활이 필자를 지치게 만들었다는 것이다. 이런 피로감은 어느 순간 슬금슬금 생기다가 어떤 임계점을 넘어가는 순간 빵! 터지게 되는 경우가 많고, 지금이 바로 그 타이밍이라고 했다. 그래서 다들 코딩말고 좀 다른 것도 해보면서 쉬라는 조언을 많이 해주셨었다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/297c425f303ec54bca9a42de3c3151a7/6a068/hwan.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 96.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIDAQT/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQP/2gAMAwEAAhADEAAAAbrIH6ENxjQV0Wf/xAAYEAADAQEAAAAAAAAAAAAAAAAAEBEBEv/aAAgBAQABBQJ06KQmL//EABURAQEAAAAAAAAAAAAAAAAAAAEg/9oACAEDAQE/AWP/xAAWEQEBAQAAAAAAAAAAAAAAAAABABD/2gAIAQIBAT8BiDP/xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAcEAEAAQQDAAAAAAAAAAAAAAABABARMWFBUXH/2gAIAQEAAT8hDcDdXqFxeIeIdUxif//aAAwDAQACAAMAAAAQ1Bi//8QAFREBAQAAAAAAAAAAAAAAAAAAEAH/2gAIAQMBAT8QFP/EABkRAQACAwAAAAAAAAAAAAAAAAEAERAhUf/aAAgBAgEBPxC24tEDmP/EAB0QAQADAAEFAAAAAAAAAAAAAAEAESFBEDFxofH/2gAIAQEAAT8QJBxfFRuItMe8QZe3ADb7dKLW68z7jEMYJ//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"hwan\" title=\"\" src=\"/static/297c425f303ec54bca9a42de3c3151a7/c08c5/hwan.jpg\" srcset=\"/static/297c425f303ec54bca9a42de3c3151a7/0913d/hwan.jpg 160w,\n/static/297c425f303ec54bca9a42de3c3151a7/cb69c/hwan.jpg 320w,\n/static/297c425f303ec54bca9a42de3c3151a7/c08c5/hwan.jpg 640w,\n/static/297c425f303ec54bca9a42de3c3151a7/6a068/hwan.jpg 960w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>평소에도 이런 이야기를 주변에서 많이들 해주셨다</small>\n</center>\n<p>그래서 이때 필자는 거의 매일 술먹고 당구치고 노래방에 가는 등 나름 필자 기준에서는 스트레스를 풀기 위한 방탕한 생활을 했었는데, 이때 개발팀 외에 다른 팀에 있는 사람들과 많이 친해질 수 있었다. 개발팀끼리 놀 때는 거의 프로그래밍이나 조직문화같이 어느 정도 일과 관련된 이야기를 많이 나누었는데, 다른 팀 사람들과 술을 마시게 되니 새로운 이야기들을 들어볼 수 있어서 좋았다.</p>\n<p>그렇게 다른 팀들의 이야기를 들었던 경험들은 회사에서 일을 할 때도 필자가 다른 팀의 상황을 조금 더 이해하고 배려할 수 있는 기반이 될 수 있었다.</p>\n<h2 id=\"능력있는-팀원들이-주는-자극\" style=\"position:relative;\">능력있는 팀원들이 주는 자극<a href=\"#%EB%8A%A5%EB%A0%A5%EC%9E%88%EB%8A%94-%ED%8C%80%EC%9B%90%EB%93%A4%EC%9D%B4-%EC%A3%BC%EB%8A%94-%EC%9E%90%EA%B7%B9\" aria-label=\"능력있는 팀원들이 주는 자극 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>이것 또한 주관적인 평가겠지만 필자가 생각했을 때 필자가 지난 2년간 이 직장에서 함께 일했던 팀원들은 대부분 자기주도적인 업무를 하며 능동적인 의사결정과 전문분야에 대한 스킬도 좋았던 것 같다. 물론 개발자만 이야기하는 것이 아니라 다른 팀에 있는 분들도 포함하는 이야기이다.</p>\n<p>물론 가장 큰 자극은 같은 팀에서 일하는 개발자들로부터 많이 받게 되었는데, 가장 많은 자극을 받았던 팀원은 아무래도 같은 프론트엔드 개발자가 아닐까 싶다. 이 분은 바로 어제까지 필자와 함께 일했던 시니어 프론트엔드 개발자이다. 이 분은 사실 개발에 엄청난 열정을 가지고 집에서도 공부하고 그런 스타일은 아니다. 하지만 아무렇지 않게 툭툭 던지는 아이디어가 문제를 바로 해결할 수 있을 정도로 신박한 것들이 많았다.</p>\n<p>물론 이 아이디어들은 자바스크립트에 대한 깊은 이해가 없이는 나올 수 없는 것들이었고, 이 분이 입사한지 이틀만에 필자가 일주일 동안 고민했던 문제를 단박에 풀어버리는 것을 보고 “역시 세상엔 굇수가 많군”이라는 생각이 다시 들었던 것 같다.</p>\n<p>외부 SDK 스크립트 로드가 끝나는 시점을 알 수가 없어서 어플리케이션 초기화 시 해당 SDK가 담기는 전역 변수가 <code class=\"language-text\">null</code>인 일종의 타이밍 이슈였는데, 필자는 이걸 <code class=\"language-text\">setTimeout</code>으로 간신히 작동하게만 만들어 놓고 더 이상 아이디어가 없어서 방치하고 있던 상황이었다. 근데 이 분이 이 문제를 보자마자 <code class=\"language-text\">isLoaded</code> 변수를 <code class=\"language-text\">Promise</code>로 선언하고 외부 SDK 로드가 끝나면 해당 프로미스를 <code class=\"language-text\">resolve</code>하는 방식으로 해결했다. <small>(지금 생각해도 변태같지만 신박한 방법이다.)</small></p>\n<p>그리고 필자가 Express로 작성한 프론트엔드 렌더 서버에 있던 메모리 릭도 이 분이 해결했었는데, 이 문제는 필자가 몇번 개선은 해서 당장은 문제가 없었지만 누수 자체는 그래도 조금씩 발생하고 있었다. 그런 와중에 이 시니어분이 프론트엔드에서 사용하고 있는 외부 패키지들을 최신화했는데 갑자기 메모리 릭이 가속화된 상황이었다. 하지만 필자는 이 문제의 근본적인 원인이 무엇인지 파악하지 못하고 있는 상태였다. 그래서 이 분이 이 이슈를 가져가서 고치기로 했는데, 예상보다 빠른 시간 안에 문제를 해결해서 꽤나 놀랬던 기억이 난다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/51c26b7dc9828c24efdf3695a5df7ca6/22475/leak_fix.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 37.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHUlEQVR42p2P3U7CQBCF+/5voAmGGBPDhRcmvoHRRMXQQC2KUNpSaIF2oWjLT2k/h4YYrxSc5GRPZs5+u6P50YKpEoUx2XLFsZVlmdwN2SRzEuWjFduM7TQie+1itXoky43ECoriMOV5XmrHId8KUF748Mbc3LWpNZ1vYF4cDt1V6eUsgZblc6Lb1NoenyWQo4A/pd27EdXWgOqLy6UxIE7/Bv4202rvY87MIeemy4XhMkvW+xX4V2lX1oSK6VExHE51h26UEK82zOSnStYP0zXBYslQ1FMJ5mRBw48xxguceYotvb5KiSQ/k7x22/G5fnJ4dkOaXkC952GOIjqBoiG+YQe0Roq67fPYH6EPQ3SZP4jf9Zr+fibZt0DxBSoiZHLOHyBEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"leak fix\" title=\"\" src=\"/static/51c26b7dc9828c24efdf3695a5df7ca6/6af66/leak_fix.png\" srcset=\"/static/51c26b7dc9828c24efdf3695a5df7ca6/69538/leak_fix.png 160w,\n/static/51c26b7dc9828c24efdf3695a5df7ca6/72799/leak_fix.png 320w,\n/static/51c26b7dc9828c24efdf3695a5df7ca6/6af66/leak_fix.png 640w,\n/static/51c26b7dc9828c24efdf3695a5df7ca6/d9199/leak_fix.png 960w,\n/static/51c26b7dc9828c24efdf3695a5df7ca6/22475/leak_fix.png 1039w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>드라마틱한 트랜잭션 타임의 변화</small>\n</center>\n<p>클라이언트에서만 사용할 수 있게 설계된 일부 외부 패키지가 서버사이드 렌더링 타이밍 때 사용되면서 발생하는 누수였는데, 필자는 이런 상황이 발생할 수 있을 것이라는 경우의 수조차 생각하지 못했었다.</p>\n<p>그 외에도 같이 오래 일했던 백엔드 개발자 분에게도 설계나 비즈니스를 보는 관점 등에 대해서 좋은 영향을 많이 받았고, 야근을 좋아하는 모바일 개발자에게는 프로덕트에 대한 열정을 배웠다. 솔직히 팀원들에게 배운 것들이 너무 많아서 이런 것들을 하나하나 다 나열하자면 한도 끝도 없으니 이 정도만 이야기하도록 하겠다. <small>(아마 본인들은 이 글만 보면 누군지 다 알듯)</small></p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>지난 2년 동안 이 팀에서 정말 많은 일을 함께 겪었던 팀원들에게 감사의 말을 전하고 싶다.</p>\n<p>여러분과 함께 일했던 2년은, 경력과 직종에 상관없이 개발자로써 또는 한명의 인간으로써 굉장히 많은 것을 배울 수 있었던 기회였다. 개발자가 아닌 분들에게서는 개발을 넘어선 다른 분야의 지식도 함께 배울 수 있었다. 필자에게 여러분은 어떤 때에는 프로페셔널한 팀원이었고 어떤 때에는 같이 일하는 친구같은 느낌이었다. 비록 회사를 떠나며 함께 일할 수 없게 되었지만 다른 곳에서 또 만날 수 있게 되기를 바란다.</p>\n<p>2년 동안 좋은 추억을 만들어준 여러분께 감사하다는 말을 전하며 이 글을 마친다.</p>","fields":{"slug":"20190817-leave-the-company","path":"/2019/08/17/leave-the-company/","lang":"ko"},"frontmatter":{"title":"2년 동안 근무했던 회사를 떠나며","subTitle":"3년을 보낸 회사를 떠나며 쓴 글","date":"Aug 17, 2019","categories":["에세이"],"tags":["퇴사","회고","Soomgo","숨고","개발자"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/15ebe84d379b3bd595f1f31f4322a1ea/3a812/thumbnail.jpg","srcSet":"/static/15ebe84d379b3bd595f1f31f4322a1ea/3a812/thumbnail.jpg 320w,\n/static/15ebe84d379b3bd595f1f31f4322a1ea/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/15ebe84d379b3bd595f1f31f4322a1ea/fc5c5/thumbnail.webp 320w,\n/static/15ebe84d379b3bd595f1f31f4322a1ea/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/15ebe84d379b3bd595f1f31f4322a1ea/2d839/thumbnail.jpg","srcSet":"/static/15ebe84d379b3bd595f1f31f4322a1ea/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/15ebe84d379b3bd595f1f31f4322a1ea/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"1990302c-84cf-56e9-bb5d-ba625c094ca7","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%9D%BC%EB%B0%98%EC%A0%81%EC%9D%B8-%EC%82%B0%EC%88%A0-%ED%8F%89%EA%B7%A0-%EA%B3%B5%EC%8B%9D%EC%9D%98-%EB%AC%B8%EC%A0%9C%EC%A0%90\">일반적인 산술 평균 공식의 문제점</a></p>\n</li>\n<li>\n<p><a href=\"#%ED%8F%89%EA%B7%A0-%ED%95%84%ED%84%B0-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98\">평균 필터 알고리즘</a></p>\n<ul>\n<li><a href=\"#%EB%AC%B4%EC%8A%A8-%EC%9B%90%EB%A6%AC%EB%A1%9C-%EC%9D%B4%EB%A0%87%EA%B2%8C-%EB%90%98%EB%8A%94%EA%B1%B4%EA%B0%80%EC%9A%94\">무슨 원리로 이렇게 되는건가요?</a></li>\n</ul>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 실시간으로 빠르게 쌓이는 데이터들의 평균을 효율적으로 구할 수 있는 방법에 대해서 간단하게 설명하려고 한다. 이런 실시간 데이터의 평균을 구해야하는 경우는 생각보다 꽤 많은데, 서버 엔진의 액세스 로그에 쌓이는 응답들의 평균 응답 시간을 구한다던가, 센서에서 들어오는 값들의 평균을 구한다던가 하는 경우이다.","html":"<p>이번 포스팅에서는 실시간으로 빠르게 쌓이는 데이터들의 평균을 효율적으로 구할 수 있는 방법에 대해서 간단하게 설명하려고 한다. 이런 실시간 데이터의 평균을 구해야하는 경우는 생각보다 꽤 많은데, 서버 엔진의 액세스 로그에 쌓이는 응답들의 평균 응답 시간을 구한다던가, 센서에서 들어오는 값들의 평균을 구한다던가 하는 경우이다.</p>\n<!-- more -->\n<p>이때 이런 데이터들은 빠르게는 1ms 정도의 간격으로 수집되는 경우도 비일비재하기 때문에, 데이터를 입력받자마자 빠르게 처리해야하는 성능이 굉장히 중요하다.</p>\n<p>이때 우리가 이 데이터들을 가지고 실시간으로 평균을 구해야한다면, 일반적으로 생각나는 평균의 수식은 <code class=\"language-text\">전체 데이터의 총합 / 데이터 배열의 길이</code>일 것이다. 이렇게 구한 평균 값을 <code class=\"language-text\">산술 평균</code>이라고 한다.</p>\n<p>그러나 우리가 일반적으로 산술 평균을 구하는 방법은 데이터를 실시간으로 빠르게 처리해야하는 시스템과는 별로 맞지 않는 방법이다. 왜 그럴까?</p>\n<h2 id=\"일반적인-산술-평균-공식의-문제점\" style=\"position:relative;\">일반적인 산술 평균 공식의 문제점<a href=\"#%EC%9D%BC%EB%B0%98%EC%A0%81%EC%9D%B8-%EC%82%B0%EC%88%A0-%ED%8F%89%EA%B7%A0-%EA%B3%B5%EC%8B%9D%EC%9D%98-%EB%AC%B8%EC%A0%9C%EC%A0%90\" aria-label=\"일반적인 산술 평균 공식의 문제점 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>일반적으로 우리가 산술 평균을 구한다고 할때 떠오르는 공식은 다음과 같다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>A</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo>+</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><mi>n</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">Average(n) = \\frac{1}{n}\\sum_{k=1}^{n}x_k = \\frac{x_1 + x_2 + ... + x_n}{n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9535em;vertical-align:-1.3021em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3021em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.9463em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">...</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></div>\n<p>수식으로 보면 조금 복잡해보일 수 있지만 결국 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span>를 1로 초기화하고, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span>가 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>이 될 때까지 이터레이션을 돌리며 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>부터 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>까지 전부 더한 다음 마지막으로 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>을 곱해주는 것, 결국 우리가 학교에서 배웠던 일반적인 평균 알고리즘이다. 이렇게 데이터를 모두 모아서 한번에 연산하는 방식을 배치식(Batch Expression)이라고 부른다.</p>\n<p>배치식의 단점은 바로 시간 복잡도가 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span>이라는 것이다. 이건 데이터의 숫자가 적을 때는 큰 문제가 없더라도 계속 해서 누적되는 실시간 데이터를 빠르게 처리해야하는 시스템에서는 치명적인 단점이 된다.</p>\n<p>간단하게 1부터 100,000까지의 평균을 반복적으로 구하는 배치식 평균 알고리즘의 수행 시간을 확인해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">let</span> avg <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> numbers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">average</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">numbers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> sum <span class=\"token operator\">=</span> numbers<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prev<span class=\"token punctuation\">,</span> current</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> prev <span class=\"token operator\">+</span> current<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> sum <span class=\"token operator\">/</span> numbers<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token string\">'avg1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> k <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> k <span class=\"token operator\">&lt;</span> <span class=\"token number\">100001</span><span class=\"token punctuation\">;</span> k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  numbers<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  avg <span class=\"token operator\">=</span> <span class=\"token function\">average</span><span class=\"token punctuation\">(</span>numbers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">timeEnd</span><span class=\"token punctuation\">(</span><span class=\"token string\">'avg1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">그래서 평균은? -> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>avg<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>실시간 데이터 처리를 흉내낸 간단한 코드를 작성했다. <code class=\"language-text\">numbers</code> 배열에는 반복적으로 새로운 데이터가 입력되고 그때마다 새로운 평균을 구한다. 첫번째 <code class=\"language-text\">for</code>문은 실시간으로 입력되는 데이터 환경을 구현하기 위한 것이므로 시간 복잡도에서 제외하고 <code class=\"language-text\">getAvg</code> 함수의 내부만 봐도, 한번 평균을 구할 때마다 지금까지 누적한 전체 데이터의 배열을 처음부터 순회하며 총합을 구하는 모습을 볼 수 있다.</p>\n<p>그래서 결국 이 알고리즘이 100,000개 데이터의 평균을 구하는 데 소요된 시간은…</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ node average.js\navg1: 8146.261ms\n그래서 평균은? -> 50000.5</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">8146ms</code> 정도? 대략 8초라는 엄청 나게 긴 시간이다. 실시간 데이터 처리 시스템에서 어떤 값을 처리하는데 8초가 걸린다면 그건 그냥 망한거다. <small>(사실 1초만 넘어도 망했다고 한다.)</small></p>\n<p>게다가 실시간 데이터의 특성 상 데이터의 양은 점점 누적되어 늘어날 수 밖에 없는데, 100,000개 처리하는데 8초가 걸린다면 1,000,000개 처리면 대충 80초 정도 걸리지 않을까?</p>\n<p>사실 배치식의 단점은 시간이 단순히 오래 걸린다는게 아니라, 이처럼 데이터가 늘어나면 수행시간도 비례해서 늘어난다는 것이다.</p>\n<p>또한 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>번째 데이터까지 합친 평균을 계산할 때 이전 평균 계산 결과를 전혀 사용하지 못하므로 결국 지금까지 들어온 모든 데이터를 저장하고 있어야 하는데, 이때 불필요한 메모리 자원도 낭비되게 된다. 그럼 데이터가 늘어나도 언제나 수행 속도가 일정한 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span> 평균 알고리즘이 있을까?</p>\n<h2 id=\"평균-필터-알고리즘\" style=\"position:relative;\">평균 필터 알고리즘<a href=\"#%ED%8F%89%EA%B7%A0-%ED%95%84%ED%84%B0-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98\" aria-label=\"평균 필터 알고리즘 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>있다. 바로 평균 필터(Average Filter) 알고리즘이다. 이 알고리즘은 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>번째 데이터가 들어온 데이터 셋의 평균을 구할 때 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span> 까지의 평균을 재사용할 수 있는 알고리즘이다. 이런 알고리즘을 재귀식(Recurrence Expression)이라고 한다. <small>(참고로 재귀식은 재귀함수보다 좀 더 포괄적인 개념이다.)</small></p>\n<p>재귀식인 평균 필터 알고리즘을 사용하면 이전에 들어온 데이터를 전부 저장해놓을 필요도 없고 몇개의 데이터가 누적되든 반드시 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span>의 시간 복잡도를 보장한다. 그래서 이 알고리즘은 센서에서 짧은 간격으로 들어오는 데이터들을 실시간으로 처리해야하는 IOT나 임베디드 분야에서 더 많이 사용된다. <small>(필자도 이 쪽 분야에서 일하는 형한테 처음 배웠다.)</small></p>\n<p>하지만 다짜고짜 수학으로 들어가면 재미가 없으니, 이해를 돕기 위해 이번에는 먼저 코드와 수행시간을 확인해보고나서 이 알고리즘에 대한 설명을 하도록 하겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">let</span> avg <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">cumulativeAverage</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">prevAvg<span class=\"token punctuation\">,</span> newNumber<span class=\"token punctuation\">,</span> listLength</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> oldWeight <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>listLength <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> listLength<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> newWeight <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">/</span> listLength<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>prevAvg <span class=\"token operator\">*</span> oldWeight<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>newNumber <span class=\"token operator\">*</span> newWeight<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token string\">'avg2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> k <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> k <span class=\"token operator\">&lt;</span> <span class=\"token number\">100001</span><span class=\"token punctuation\">;</span> k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  avg <span class=\"token operator\">=</span> <span class=\"token function\">cumulativeAverage</span><span class=\"token punctuation\">(</span>avg<span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">timeEnd</span><span class=\"token punctuation\">(</span><span class=\"token string\">'avg2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">그래서 평균은? -> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>avg<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">cumulativeAverage</code> 함수는 이전 데이터까지의 평균과 새로 들어온 데이터, 총 데이터 개수 이렇게 3개의 인자를 사용하는 함수이다. 그리고 간단한 수식을 통해서 바로 평균을 계산한다. 위에서 작성한 <code class=\"language-text\">average</code> 함수와 가장 큰 차이점이 있다면, 함수 내부에 이터레이션이 없다는 것이다.</p>\n<p>위에서 봤던 배치식 평균 알고리즘은 100,000개 데이터의 평균을 실시간으로 구해내는데 8초의 시간이 소요되었지만 이 친구는 급이 다르다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ node average.js\navg: 4.631ms\n그래서 평균은? -> 50000.5</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>쨘, <code class=\"language-text\">8000ms</code>에서 <code class=\"language-text\">4ms</code>가 되었다. 뭐 이건 사실 당연한 사실이다. 평균을 구하기 위해 전체 데이터를 순회할 필요가 없이 단순한 연산만 반복하면 되기 때문이다. 데이터의 개수를 1,000,000개로 늘려도 수행시간은 대략 <code class=\"language-text\">10ms</code> 정도로, 크게 변하지 않는다.</p>\n<p>그리고 이 코드에서 데이터의 양을 100,000에서 1,000,000으로 늘렸을 때 시간이 늘어난 이유는 그저 <code class=\"language-text\">for</code>문이 더 오래 도니까 그런 것인데, 실시간 데이터 처리 시스템에서는 이렇게 이터레이션을 돌면서 데이터를 입력하는 것 아니라 말 그래도 비동기적으로 쭉쭉 데이터가 들어오고 이벤트 리스너를 통해 평균 함수를 실행할 것이므로 결국 실제 사용 사례에서는 항상 균일한 수행 속도를 가지게 된다고 생각할 수 있다.</p>\n<p>그럼 이 알고리즘은 어떤 원리로 작동하는 것일까?</p>\n<h3 id=\"무슨-원리로-이렇게-되는건가요\" style=\"position:relative;\">무슨 원리로 이렇게 되는건가요?<a href=\"#%EB%AC%B4%EC%8A%A8-%EC%9B%90%EB%A6%AC%EB%A1%9C-%EC%9D%B4%EB%A0%87%EA%B2%8C-%EB%90%98%EB%8A%94%EA%B1%B4%EA%B0%80%EC%9A%94\" aria-label=\"무슨 원리로 이렇게 되는건가요 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>구글에 “평균 필터 알고리즘”을 검색해보면 이미 많은 분들이 배치식에서 재귀식을 유도해내는 과정을 많이 포스팅 해놓은 것을 볼 수 있었다. 하지만 이런 포스팅들의 특성 상 글쓴이 본인의 아카이브 느낌이 강하기 때문에 친절한 설명은 딱히 없었던 것 같다.</p>\n<p>그리고 그렇게 수식을 유도하며 설명하는 방법은 수학과 친하지 않은 사람에게는 직관적인 설명이 될 수 없다. 그래서 필자는 배치식에서 재귀식을 유도하는 방법 보다 좀 더 직관적이고 간단한 느낌으로 설명해보려고 한다. 일단 평균 필터 알고리즘의 공식을 한번 보자.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>A</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>n</mi></mfrac><mi>A</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">Average(n) = \\frac{n-1}{n}Average(n-1) + \\frac{1}{n}x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></div>\n<p>이 식의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>은 현재까지의 전체 데이터 길이, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Average(n-1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span>는 이전 데이터까지의 평균, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>은 이번에 새로 들어온 데이터를 의미한다. 그렇다면 이 식이 의미하는 것이 뭐길래 평균을 구할 수 있도록 해주는 것일까?</p>\n<p>이 식에서 중요한 키워드는 바로 가중치이다. 우리가 배치식을 버리고 재귀식을 사용하기 위한 조건은 바로 “이전 평균 값을 활용할 수 있을 것”이었다. 그러기위해 우리는 새로운 평균을 구하기 위해 사용할 이전 평균 값이 새로운 평균 값에 끼칠 영향을 계산해줘야 하는 것이다.</p>\n<p>식을 자세히 보면 이전 평균 값인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Average(n-1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span>에는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>n</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{n-1}{n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>이 곱해지고 있다. 이때 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>n</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{n-1}{n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>이 의미하는 것이 바로 가중치이다. 또 새로 들어온 데이터인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>을 보면 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>이 곱해지고 있는데, 이 또한 새로운 데이터의 가중치이다.</p>\n<p>좀 더 빠른 이해를 돕기 위해 간단한 예시를 보면서 설명하도록 하겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> prevData <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> prevAverage <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 2.5</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>여기 길이가 <code class=\"language-text\">4</code>인 간단한 데이터셋이 있다. <code class=\"language-text\">prevAverage</code>는 여러분이 좀 더 직관적으로 이해할 수 있도록 그냥 배치식을 하드코딩했고, 할당된 값은 <code class=\"language-text\">1, 2, 3, 4</code>의 평균인 <code class=\"language-text\">2.5</code>가 된다.</p>\n<p>이때 이 데이터셋에 <code class=\"language-text\">5</code>라는 값이 새로 들어오면 배열의 길이는 <code class=\"language-text\">5</code>가 될 것이다. 이때 배치식을 사용하며 계산하게 되면 <code class=\"language-text\">1</code>부터 <code class=\"language-text\">5</code>까지 모두 더한 후 배열의 길이인 <code class=\"language-text\">5</code>로 나누게 될 것이고, 재귀식을 사용하면 기존 4개 원소의 평균이었던 <code class=\"language-text\">2.5</code>에 가중치인 <code class=\"language-text\">4/5</code>를 곱해주고 새로 들어온 <code class=\"language-text\">5</code>에도 가중치인 <code class=\"language-text\">1/5</code>를 곱한 후 서로 더하기만 하면 된다.</p>\n<p>한번 아래 코드를 콘솔에서 실행시켜보고 결과를 확인해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> batch <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> recurrenced <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2.5</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">4</span> <span class=\"token operator\">/</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">/</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>batch<span class=\"token punctuation\">,</span> recurrenced<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 3 3</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>결과는 둘 다 <code class=\"language-text\">3</code>으로 동일하게 출력된다. 즉, 쉽게 말하자면 이전 평균의 값과 새로운 데이터가 새로운 평균에서 얼마 만큼의 비중을 가지고 있는지를 계산해서 더해주는 것이다.</p>\n<p>이제 대충 이해가 되었으리라 생각한다. 만약 배치식에서 재귀식을 유도하는 과정이 궁금하신 분은 구글에 “평균 필터”라고 검색해보면 다른 분들이 작성해놓은 많은 포스팅이 있으니 그 쪽을 참고해보도록 하자. 필자는 개인적으로 그런 수식 유도 과정보다 이 알고리즘이 작동하는 추상적인 개념을 이해하는 것이 더 중요하다고 생각하기 때문에 이 포스팅에서는 별도의 유도 과정을 적지는 않겠다.</p>\n<p>이상으로 실시간 데이터의 평균을 효율적으로 구하기 포스팅을 마친다.</p>","fields":{"slug":"20190811-average-filter","path":"/2019/08/11/average-filter/","lang":"ko"},"frontmatter":{"title":"실시간 데이터의 평균을 효율적으로 구하기","subTitle":"데이터가 많아질수록 평균 계산이 느려진다고? 이렇게 해결하자","date":"Aug 11, 2019","categories":["프로그래밍","알고리즘"],"tags":["수학","평균구하기","알고리즘","Average","Algorithm","누적평균"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/52ce705a7a96f11e55a6da43bb404bd8/3a812/thumbnail.jpg","srcSet":"/static/52ce705a7a96f11e55a6da43bb404bd8/3a812/thumbnail.jpg 320w,\n/static/52ce705a7a96f11e55a6da43bb404bd8/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/52ce705a7a96f11e55a6da43bb404bd8/fc5c5/thumbnail.webp 320w,\n/static/52ce705a7a96f11e55a6da43bb404bd8/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/52ce705a7a96f11e55a6da43bb404bd8/2d839/thumbnail.jpg","srcSet":"/static/52ce705a7a96f11e55a6da43bb404bd8/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/52ce705a7a96f11e55a6da43bb404bd8/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"5a935b2f-2abd-5a56-9823-d8d97799183a","tableOfContents":"<ul>\n<li><a href=\"#nodejs-%EC%9D%B8%EC%8A%A4%ED%8E%99%ED%84%B0-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\">NodeJS 인스펙터 사용하기</a></li>\n<li><a href=\"#%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%88%84%EC%88%98-%EC%9B%90%EC%9D%B8\">메모리 누수 원인</a></li>\n<li><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\">해결 방법</a></li>\n<li><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></li>\n</ul>","excerpt":"이번 포스팅에서는 최근에 고쳤던 Webpack Watch 기능의 메모리 누수에 대해서 간략하게 남겨보려고 한다. 필자가 회사에서 개발한 프로젝트가 점점 커짐에 따라서 Watch 중에 빌드를 여러 번 돌리게되면 어느 순간 갑자기 가 뜨면서 프로세스가 죽어버리는 이슈가 발생하였다. 이 문제는 사실 꽤 예전부터 발생했던 이슈지만 계속 비즈니스 이슈를 개발하느라고 외면받고 있던 이슈였는데 우연히 기회가 되어 해당 이슈를 자세히 들여다 볼 수 있었다.","html":"<p>이번 포스팅에서는 최근에 고쳤던 Webpack Watch 기능의 메모리 누수에 대해서 간략하게 남겨보려고 한다. 필자가 회사에서 개발한 프로젝트가 점점 커짐에 따라서 Watch 중에 빌드를 여러 번 돌리게되면 어느 순간 갑자기 <code class=\"language-text\">out of memory</code>가 뜨면서 프로세스가 죽어버리는 이슈가 발생하였다. 이 문제는 사실 꽤 예전부터 발생했던 이슈지만 계속 비즈니스 이슈를 개발하느라고 외면받고 있던 이슈였는데 우연히 기회가 되어 해당 이슈를 자세히 들여다 볼 수 있었다.</p>\n<!-- more -->\n<p>사실 구글에 <code class=\"language-text\">webpack watch memory leak</code>이라고 검색만 해봐도 같은 이슈로 고통받고 있는 전세계의 동지들이 많다는 것을 알 수 있다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/719ca011fe26513ab9402af9feb1e870/71ee9/out-of-memory.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACAklEQVR42n1U2ZKjMAzkN7ZmchAIN4Q73DBAMfP/P6R1yzEzSc3uQ5exLLfUkozmeAGFt4QcL6SLaT1BN66Mi3nd9+eL+cu5xfbDSSdtmGZaty/qhpGqpqXiXlPddlRWDSVZIfaV+K7FWUd5WdEtydknK+68V3eMq03vR0Fouz4BpuXQ8XxhnHRjB6K+H8+/4nA6C3999+EMozghiVRET/nbDyOyHI+utsNSlDQlGYF0Q9pfA2qoH9JP85LudctS73XD+zQvuL4IBPmQfksyitOMz2BTCmUCLmlwxmFWlEwM4BJscZqzk5L/LVVmpcqjVGDVkFE3TNSNE/UPYI8mSLS7Ai+IyA1CCqIbl8Z2PXL9gIneDicpGYRtP3CXx4+Z5nWjcV6o6Xq29+MHDZPEtKy8x1nd9pSKQJCN0bM9nwzLJg0ZSMKJL8Gx7UG+PC4P1IqzaV7ZDgUg+PN2eJKuwIQAMsQ89oJ02bZHpitnDazbJwcAMeSidj+HXXVca0RGy/pJpegsOoWaqM4Brh8Ku/9kwxBjbtEwwBRSsTJhnTZUlQOPDJx/Pid5wdkJLMfdiWAD8P3tK8amK3qKIzkmtsgEBLikSLC+vm81Rq+vimsYOwm5TkBZWT7ebs0DjLnEPAZRzJHl8Ep5kPYvaFUpHndRcafxU8AKEtRSyXh9Xv8j/AvgrcdZKPOTrQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"out of memory\" title=\"\" src=\"/static/719ca011fe26513ab9402af9feb1e870/6af66/out-of-memory.png\" srcset=\"/static/719ca011fe26513ab9402af9feb1e870/69538/out-of-memory.png 160w,\n/static/719ca011fe26513ab9402af9feb1e870/72799/out-of-memory.png 320w,\n/static/719ca011fe26513ab9402af9feb1e870/6af66/out-of-memory.png 640w,\n/static/719ca011fe26513ab9402af9feb1e870/d9199/out-of-memory.png 960w,\n/static/719ca011fe26513ab9402af9feb1e870/71ee9/out-of-memory.png 1081w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Webpack을 사용하다보면 자주 볼 수 있는 슬픈 화면</small>\n</center>\n<p>일단 이 문제의 가장 유명한 해결 방법은 바로 NodeJS의 <code class=\"language-text\">--max-old-space-size</code>을 사용하여 Old Space의 영역을 늘리는 것이다. 원래 Old Space의 기본 크기는 64비트 기준 1.4GB 정도이지만 이렇게 메모리가 터지는 경우 Old Space에 4GB나 8GB를 할당할 것을 권장하는 해결 방법이 많다.</p>\n<p>사실 이 방법을 사용하면 왠만큼 해결은 된다. 메모리 누수는 일반적으로 GC(가비지 컬렉팅) 때 수집되어야 할 쓰레기가 제대로 수집되지 않아서 발생하는 경우가 대부분인데, 이때 수집되지않은 쓰레기 객체들은 모두 Old Space에 있기 때문이다. 하지만 이 방법은 근본적인 해결 방법이 아니라 그냥 메모리가 터지는 시점을 좀 더 늦춘 것 뿐이다.</p>\n<blockquote>\n<p>Old Space에 4GB를 할당해주고 20번 빌드했더니 메모리가 터져서 Old Space에 8GB를 할당했다? 그레봤자 약 40번 정도 빌드하면 언젠간 또 터진다.</p>\n</blockquote>\n<p>그렇다고 이렇게 해결하는 것이 틀린 방법인 건 아니다. 필자도 사실 이미 <code class=\"language-text\">--max-old-space-size=4096</code> 옵션을 통해 Old Space에 4GB 정도를 할당해주고 있었다. 하지만 이건 마치 뭐랄까, 진통제 같은 느낌이지 근본적인 치료는 아니기 때문에 이번 기회에 필자는 이 이슈의 원인을 찾아내어 제대로 고쳐보고 싶었다.</p>\n<h2 id=\"nodejs-인스펙터-사용하기\" style=\"position:relative;\">NodeJS 인스펙터 사용하기<a href=\"#nodejs-%EC%9D%B8%EC%8A%A4%ED%8E%99%ED%84%B0-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"nodejs 인스펙터 사용하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>먼저, 이런 메모리 누수가 고치기 까다로운 이유는 원인 추적이 힘들기 때문이다. 예를 들어 <code class=\"language-text\">TypeError</code>같은 경우는 로그에 아주 명확하게 어디서, 왜 타입에러가 발생했는지 알려주지만 메모리 누수는 그딴 거 없다.</p>\n<p>그냥 쭉쭉 잘 실행되고 있는 듯 보이다가 어느 순간 픽! <code class=\"language-text\">out of memory</code>를 남기고 프로그램이 죽어버리기 때문이다. 프로그램이 죽으면서 마지막 힘을 짜내어 몇 줄의 Stack Trace를 남겨주긴 하지만, 표면적인 원인만 보여주는 느낌이기 때문에 메모리 누수를 고칠 때는 별 도움이 안되었던 것 같다.</p>\n<p>그래서 이런 메모리 누수를 고칠 때는 가장 먼저, 자바스크립트의 Heap을 뜯어봐야한다. 프로그램 내에서 어떤 놈이 메모리를 점점 갉아먹고 있는 지 부터 파악하는 것이다. NodeJS를 실행시킬 때 몇가지 옵션을 사용하면 구글 크롬(Chrome)의 개발자 도구를 사용하여 Heap의 스냅샷을 찍을 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">node</span> <span class=\"token parameter variable\">--inspect</span> --inspect-brk server</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 556px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f8fc7cade4bf23104fdd937cddf97b42/96638/inspector.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 63.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB1ElEQVR42q2Ry5KaUBCGeYHJ1nUUUOQihdzvIAKCY6Uqr5Gss82b/+nu6Iw6U5VNFl3N+c/fX/dplP54RFVVmE4TsjzD959nNEONOIwxDAOmaZI8jiPSNEVZlvLd9z1OpxP2ex+LxQKmuYVhGFCiukaSJGjqBp6/x/yjQ1D4cJ0daSWO1LBtWxwOB3ieR4C9nDk6unNsC19eXghoSii/qGsSBBioa0A5CVKMNJFHE26TA3zfl6l2ux2KohCw7wekVWibGrswheXHsC0Ltm1D+Z3nSKjo9XJBFEVSfHk9EzCBU01I4hhd1yEMQwHO84wsy5BTXdtUMF0PVlwjIEZIAykOGV3XxWazkZF5D7quY7vdwjQ2km/BE/CTszTDQDs/DiOm+Uxr6XG+fMNImhIRkHezXq8FpOuawPm8vmbWNU2ThkHg00tigXX9SKsiMOWOoBzKarUSM0OyvERFP4cL/8J1WLSbujkgL0rR2atpKvnXpFWI4kR8y+VXMEuAqqrKwTD4Wc7VsMStmWVaBLZFV69+nSZnLwe/hDX2vgEFyhAKvrhpHPfwD/qT/wF46/JcqKra2x4f9Y/+T4HytH8U3se9X7kB7uP9jz9qn+nPfuW++/+IP7o1kh1aOCtnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"inspector\" title=\"\" src=\"/static/f8fc7cade4bf23104fdd937cddf97b42/96638/inspector.png\" srcset=\"/static/f8fc7cade4bf23104fdd937cddf97b42/69538/inspector.png 160w,\n/static/f8fc7cade4bf23104fdd937cddf97b42/72799/inspector.png 320w,\n/static/f8fc7cade4bf23104fdd937cddf97b42/96638/inspector.png 556w\" sizes=\"(max-width: 556px) 100vw, 556px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p><code class=\"language-text\">--inspect</code> 옵션을 사용하여 어플리케이션을 시작하고나서 구글 크롬의 아무 창이나 선택한 후 개발자 도구를 켜보면 왼쪽 구석에 NodeJS의 아이콘이 생긴 것을 확인할 수 있다. 그 아이콘을 누르면 NodeJS를 프로파일링할 수 있는 새로운 인스펙터가 나타난다. 그리고 <code class=\"language-text\">--inspect-brk</code> 옵션은 코드를 실행하기 전 Debug Pause 기능을 이용하여 실행을 멈춰준다. 개발자가 직접 Resume 버튼을 눌러주면 코드가 실행된다.</p>\n<h2 id=\"메모리-누수-원인\" style=\"position:relative;\">메모리 누수 원인<a href=\"#%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%88%84%EC%88%98-%EC%9B%90%EC%9D%B8\" aria-label=\"메모리 누수 원인 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>필자도 맨 처음에 했던 일이 바로 NodeJS의 인스펙터를 사용하여 Heap 스냅샷을 찍어보는 것이었다. 사실 필자는 이 이슈가 일반적인 메모리 누수 상황과는 조금 다르다고 생각했는데, 보통 일반적인 메모리 누수는 대략 이런 시나리오로 그려진다.</p>\n<blockquote>\n<ol>\n<li>객체를 생성!</li>\n<li>객체 참조를 해제함!</li>\n<li>근데 GC가 안됨…? 뭐지…?</li>\n<li>알고 보니 다른 놈이 참조를 하고 있었다는 결말</li>\n</ol>\n</blockquote>\n<p>그렇기 때문에 보통 메모리 누수는 “어떤 놈이 해제되어야 할 객체를 참조하고 있는거지?”로 시작하는 경우가 많다. 그래서 보통 객체 할당을 하고 한번 Heap 스냅샷을 찍고, 다시 객체 참조를 해제한 다음 다시 Heap 스냅샷을 찍은 후 그 두 스냅샷을 비교하는 방법으로 디버깅을 진행한다. 분명히 나는 참조를 해제했는데 뭔가 아직도 유지되고 있는 놈이 보인다? 바로 그 놈이 범인일 가능성이 높다. 이 범인 색출이 오지게 힘들긴 하지만…</p>\n<p>하지만 Webpack의 메모리 누수 이슈는 이런 복잡한 이슈는 아닌 것 같았다. Stack Overflow에서 다른 사람들의 사례를 보면 프로젝트가 작을 때는 별 문제 없다가 프로젝트가 커질수록 이런 문제가 발생한다는 사례가 많았고, 필자 또한 그런 상황이었기 때문에 처음부터 방향은 “혹시 빌드할 때마다 파일이 계속 누적되고 있나?”라는 가설로 잡았기 때문이다.</p>\n<p>그래서 가설을 확인하기 위해 일단 빌드를 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>번 진행한 후, 메모리 사용량의 변화를 살펴보기 위해 매 빌드마다 Heap 스냅샷을 찍었고, 그 결과 <code class=\"language-text\">Memory File System</code> 이라는 놈이 점점 비대해지고 있는 것을 발견했다.</p>\n<table>\n<thead>\n<tr>\n<th>빌드 횟수</th>\n<th>MFS의 메모리 사용량(byte)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>21,034,701</td>\n</tr>\n<tr>\n<td>2</td>\n<td>38,776,735</td>\n</tr>\n<tr>\n<td>3</td>\n<td>45,209,592</td>\n</tr>\n<tr>\n<td>4</td>\n<td>51,642,543</td>\n</tr>\n<tr>\n<td>7</td>\n<td>83,807,008</td>\n</tr>\n<tr>\n<td>10</td>\n<td>122,404,490</td>\n</tr>\n<tr>\n<td>13</td>\n<td>180,301,478</td>\n</tr>\n</tbody>\n</table>\n<p>여기까지 확인한 후 <code class=\"language-text\">Memory File System</code> 객체의 내부를 한번 까봤더니 예상한 대로 번들링했던 모든 파일이 계속 누적되고 있는 것을 확인할 수 있었다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/bc66d327ef24fa7aa752904a24cc3a4a/2e367/mfs.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 130.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAABYlAAAWJQFJUiTwAAADAUlEQVR42o1V25baMAzkU8q1CcSxc4PcDAmw29PT//8eVSPb2bAL7T7oGAIMM5qRvGiODf3u/tDQjHQf3+lqb2T7M10uAzWnhtqmpbquqSzKqYqioLIsvxSeL5arJRVJSVadyewz6ipLWmuq6iOlOqUojmj3c0v43mq9lHO9XtNy+YOLn61WU+H5YrPZ0Ga7pjwpqFYNdZmlJm3JpsxSj9Qnli7pQG3S0enATPcVHVRCTdfT8VSTMZkwi+P4ERAs8eNWdfJjgF3NnQY+b3z2rACAlTpSwfLa3gpgnuei6BPgRgA7Zbl6ATynF7rqmwADEO91ZCg1miz391Q3lGWO3X6/F8nAmgEWAgSGTdIysysNKWoUyWhBFmfcV0MdmwZAsEMBEOweARVL9gy7pBe5o7mK5JHB8RkANQP29szOtxNgkiRPAA+Fk8sMcUIipF708CAZgB0DnjhOkPwaMEiWaqV3YNez1JF7iTKxEcliiO8hAA+Hw1fAUrksoldgGZjBmJt5k/ci2bDk84WathPAsiyeM8xnptRJIycA0T/pIf+REVM0m2Inl18ydLHppeAyQGEKHIb0M58mMpPLte8h6rnLHhDM4ChMwDmEXvJrM3N5nsPnDL3LnZ+UORgkg2kADDnMWO5LhmXictj7HILhXcwYJeQAzOKcJ8WZAsnoH7bMv2OjXA3eDACjwDTEprMfk1JV1SvAR1MGvxzu2buAY85hCmIzBwRDpdRzyQEQJX0Tdy9u6/BM60hPORSX/8cwSAYbgIWlgF46yR/L4XgCw+J1D8tPy8GN21XA3rJf8tyESbFzU745KRg1Z4gbwdYDYlJaHxsjOXy1HOYM/SxDLgyBMWEfhm0TJgXB/pbLltlBNhhCMv7AfN7YeTaZ8nRjB0DZNukogOFeAftTwnfK4eii4xdE7qcliqKvd8o82ABzE+ImBZ+BOS4qxderjJ+Pznz8Frvdju/dHZVpxSuKeyjVy6a5ZrypNY9g/iZnoxhQ1aQzn0XeiWCIPiLc2+2W/gL8njeHrKhC/QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"mfs\" title=\"\" src=\"/static/bc66d327ef24fa7aa752904a24cc3a4a/6af66/mfs.png\" srcset=\"/static/bc66d327ef24fa7aa752904a24cc3a4a/69538/mfs.png 160w,\n/static/bc66d327ef24fa7aa752904a24cc3a4a/72799/mfs.png 320w,\n/static/bc66d327ef24fa7aa752904a24cc3a4a/6af66/mfs.png 640w,\n/static/bc66d327ef24fa7aa752904a24cc3a4a/d9199/mfs.png 960w,\n/static/bc66d327ef24fa7aa752904a24cc3a4a/2e367/mfs.png 1066w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>징글징글한 것들...</small>\n</center>\n<p>왜 이런 문제가 발생했을까? 그 이유는 해당 프로젝트의 Webpack 세팅의 번들 파일 이름 패턴이 <code class=\"language-text\">client-bundle.[chunkhash].js</code>로 되어있었기 때문이다. <code class=\"language-text\">chunkhash</code>나 <code class=\"language-text\">hash</code> 옵션은 매 번들링 때 새로운 파일명을 만들어주므로 운영환경에서 발생하는 파일 캐싱 이슈에 대해서 자유롭게 해준다. 하지만 개발 환경에서는 이 옵션이 오히려 독이 된 것이다.</p>\n<p>Webpack은 개발 서버를 띄울 때 번들링된 파일을 <code class=\"language-text\">memory-fs</code>라는 라이브러리를 사용하여 저장한다. 이 라이브러리는 그냥 내부적으로 맵(Map)을 가지고 있고 파일 내용은 파일의 각 라인을 원소로 가지고 있는 배열이다. 즉 번들링된 파일 이름이 <code class=\"language-text\">main.js</code>이면 다음과 같은 구조를 가진 객체가 생성된다는 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token constant\">MFS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">'main.js'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'var a = 1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'console.log(a)'</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>만약 필자가 <code class=\"language-text\">main.js</code> 파일이나 여기서 종속된 모듈을 수정하면 <code class=\"language-text\">main.js</code>는 다시 번들링 될 것이고 <code class=\"language-text\">MFS</code> 객체의 <code class=\"language-text\">main.js</code>키의 값을 새로 번들링된 파일의 내용으로 변경할 것이다. 그러나 문제는 <code class=\"language-text\">chunkhash</code>나 <code class=\"language-text\">hash</code>와 같이 빌드 때마다 파일 이름이 변경되는 경우에 생긴다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token constant\">MFS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">'main.1111.js'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'var a = 1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 기존 파일</span>\n  <span class=\"token string-property property\">'main.2222.js'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'var a = 2'</span><span class=\"token punctuation\">]</span> <span class=\"token comment\">// 새로 번들링된 파일</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">main.1111.js</code>는 이전 빌드 때 생성된 번들이고 <code class=\"language-text\">main.2222.js</code>는 이번 빌드 때 생성된 번들이다. <code class=\"language-text\">chunkhash</code>, <code class=\"language-text\">hash</code>는 파일을 다시 번들링하면 해쉬값이 변경되므로 번들링된 파일의 이름이 달라지게 되고, 결과적으로 <code class=\"language-text\">MFS</code> 객체에 저장되어있던 이전 버전 번들은 교체되지 않고 남아있게 된다. 즉, 파일이 누적된다.</p>\n<p>이 객체 자체나, 파일 라인들을 담고 있는 배열, 라인들의 값을 가지고 있는 문자열 모두 당연히 메모리에 저장되고, <code class=\"language-text\">memory-fs</code>가 이 친구들을 계속 참조하고 있으니 결과적으로 Old Space로 넘어간 후에도 계속 GC에 수집되지 않았던 것이다.</p>\n<h2 id=\"해결-방법\" style=\"position:relative;\">해결 방법<a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\" aria-label=\"해결 방법 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>사실 이 문제를 처음 접했을 때 3가지 정도의 해결 방법을 생각했었다.</p>\n<blockquote>\n<ol>\n<li>개발 환경일 때는 파일 이름 패턴에 <code class=\"language-text\">hash</code>나 <code class=\"language-text\">chunkhash</code>를 사용하지 않는다.</li>\n<li>Webpack의 compiler hook에서 이전 빌드의 번들을 직접 제거(<code class=\"language-text\">HotModuleReplacement</code>가 사용하는 방법임)</li>\n<li>그냥 Old Space를 늘려준다. <small>(자존심을 버린 최후의 방법)</small></li>\n</ol>\n</blockquote>\n<p>사실 1번 방법인 파일 이름 패턴에서 chunkhash를 제거하는 것만으로도 해결되는 문제긴 하지만, 혹시 모르니 다음 차선책까지 생각해둔 것이다. 필자는 보통 이런 문제를 만나면 한번에 해결된다는 기대를 잘 안하는 편이다. <small>(높은 데서 떨어지면 더 아픈 법이다. 아예 기대를 말자)</small></p>\n<p>하지만 다행히도 1번 해결 방법으로 한 방에 해결이 되었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// webpack.client.config.js</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">const</span> isLocal <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">===</span> <span class=\"token string\">'local'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n \nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">output</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">filename</span><span class=\"token operator\">:</span> isLocal <span class=\"token operator\">?</span> <span class=\"token string\">'client-bundle.[name].js'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'client-bundle.[chunkhash].js'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">Built at: <span class=\"token number\">2019</span>-08-06 <span class=\"token number\">10</span>:29:34\n                                                     Asset       Size       Chunks             Chunk Names\n                                      client-bundle.app.js   <span class=\"token number\">4.16</span> MiB          app  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  app\n                                  client-bundle.app.js.map   <span class=\"token number\">2.98</span> MiB          app  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  app\n                                     client-bundle.chat.js    <span class=\"token number\">815</span> KiB         chat  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  chat\n                                 client-bundle.chat.js.map    <span class=\"token number\">503</span> KiB         chat  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  chat\n                                client-bundle.chat~user.js    <span class=\"token number\">312</span> KiB    chat~user  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  chat~user\n                            client-bundle.chat~user.js.map    <span class=\"token number\">200</span> KiB    chat~user  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  chat~user\n                                 client-bundle.polyfill.js   <span class=\"token number\">6.24</span> KiB     polyfill  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  polyfill\n                             client-bundle.polyfill.js.map   <span class=\"token number\">6.23</span> KiB     polyfill  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  polyfill\n                                   client-bundle.search.js    <span class=\"token number\">254</span> KiB       search  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  search\n                               client-bundle.search.js.map    <span class=\"token number\">224</span> KiB       search  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  search\n                              client-bundle.style-guide.js    <span class=\"token number\">135</span> KiB  style-guide  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  style-guide\n                          client-bundle.style-guide.js.map    <span class=\"token number\">105</span> KiB  style-guide  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  style-guide\n                                     client-bundle.user.js    <span class=\"token number\">134</span> KiB         user  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  user\n                                 client-bundle.user.js.map   <span class=\"token number\">70.2</span> KiB         user  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  user\n                                   client-bundle.vendor.js    <span class=\"token number\">4.6</span> MiB       vendor  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  vendor\n                               client-bundle.vendor.js.map   <span class=\"token number\">5.25</span> MiB       vendor  <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>  vendor\n  fontawesome-webfont.eot?674f50d287a8c48dc19ba404d20fe713    <span class=\"token number\">162</span> KiB               <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>\n  fontawesome-webfont.ttf?b06871f281fee6b241d60582ae9369b9    <span class=\"token number\">162</span> KiB               <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>\nfontawesome-webfont.woff2?af7ae505a9eed503f8b8e6982036873e   <span class=\"token number\">75.4</span> KiB               <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>\n fontawesome-webfont.woff?fee66e712a8a08eef5805a46892932ad   <span class=\"token number\">95.7</span> KiB               <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>\n                                                index.html  <span class=\"token number\">804</span> bytes               <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>\n                                                     sw.js   <span class=\"token number\">4.79</span> KiB               <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>\n                                                 sw.js.map    <span class=\"token number\">4.2</span> KiB               <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span>\n                              vue-ssr-client-manifest.json    <span class=\"token number\">108</span> KiB               <span class=\"token punctuation\">[</span>emitted<span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>파일 이름 패턴에서 <code class=\"language-text\">chunkhash</code>을 삭제하고 <code class=\"language-text\">name</code>을 추가했기 때문에 이제 몇 번을 빌드하든 <code class=\"language-text\">client-bundle.app.js</code>처럼 늘 같은 이름으로 번들이 생성될 것이다. 그리고 위에서 얘기했듯 <code class=\"language-text\">memory-fs</code>는 파일 이름을 맵의 키로 사용하기 때문에 새로운 파일을 맵에 저장할 때 그 파일과 같은 이름을 가진 이전 빌드의 번들은 자동으로 덮어씌워질 것이다.</p>\n<p>아래는 해당 작업을 수행한 후 다시 Heap 스냅샷 사용하여 분석해본 <code class=\"language-text\">Memory File System</code> 내 dist 객체의 크기이다.</p>\n<table>\n<thead>\n<tr>\n<th>빌드 횟수</th>\n<th>MFS의 메모리 사용량(byte)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>21,031,408</td>\n</tr>\n<tr>\n<td>2</td>\n<td>21,023,274</td>\n</tr>\n<tr>\n<td>3</td>\n<td>21,023,224</td>\n</tr>\n<tr>\n<td>4</td>\n<td>21,023,310</td>\n</tr>\n</tbody>\n</table>\n<p>이제 여러 번 빌드를 하더라도 <code class=\"language-text\">memory-fs</code>가 사용하는 메모리가 점점 증가하지 않게 되었고 프론트엔드 챕터 개발자들은 드디어 쾌적한 환경에서 개발을 계속 할 수 있게 되었다!</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>사실 이 이슈는 처음 이슈를 접했을 때 세운 가설이 딱 맞아들어가서 빠르게 해결할 수 있었던 케이스였다. 하지만 그 가설을 증명하는데는 거의 하루 종일 걸렸는데, 그 이유는 구글 크롬 인스펙터가 Heap 스냅샷을 한번 찍는데 시간이 너무 오래 걸려서이다. 아니 무슨 한번 찍는데 거의 3-4분이 걸려…</p>\n<p>막상 원인을 파악하고 가설도 증명하고나니 해결 방법은 굉장히 심플했는데, 뭔가 손 안대고 코 푼 느낌이랄까…? 뭐 어쨌든 쉽게 해결할 수 있어서 다행이었다.</p>\n<p>이상으로 Webpack Watch의 메모리 누수 고치기 포스팅을 마친다.</p>","fields":{"slug":"20190808-fix-webpack-dev-memory-leak","path":"/2019/08/08/fix-webpack-dev-memory-leak/","lang":"ko"},"frontmatter":{"title":"Webpack Watch의 메모리 누수 고치기","subTitle":"Chrome DevTools와 Heap Snapshot으로 메모리 누수 추적하기","date":"Aug 08, 2019","categories":["프로그래밍","웹"],"tags":["Webpack","웹팩","JavaScript","자바스크립트","NodeJS","webpack dev server","webpack dev middleware","memory-fs","MFS","Memory leak","메모리 누수","Out of memory"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/089564f2795d80e2fcfd651cd02ef782/d803c/thumbnail.png","srcSet":"/static/089564f2795d80e2fcfd651cd02ef782/d803c/thumbnail.png 320w,\n/static/089564f2795d80e2fcfd651cd02ef782/2a1fd/thumbnail.png 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/089564f2795d80e2fcfd651cd02ef782/fc5c5/thumbnail.webp 320w,\n/static/089564f2795d80e2fcfd651cd02ef782/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/089564f2795d80e2fcfd651cd02ef782/01fb2/thumbnail.png","srcSet":"/static/089564f2795d80e2fcfd651cd02ef782/01fb2/thumbnail.png 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/089564f2795d80e2fcfd651cd02ef782/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"062e2c75-66f7-5ce6-9b71-71f0afed9fbc","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EA%B5%B3%EC%9D%B4-%EA%B0%9C%EB%B0%9C%EC%9E%90%EA%B0%80-%EC%A1%B0%EC%A7%81%EB%AC%B8%ED%99%94%EC%97%90-%EA%B9%8C%EC%A7%80-%EA%B4%80%EC%8B%AC%EC%9D%84-%EA%B0%80%EC%A0%B8%EC%95%BC%ED%95%98%EB%82%98%EC%9A%94\">굳이 개발자가 조직문화에 까지 관심을 가져야하나요?</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%9A%B0%EB%A6%AC%EB%B6%80%ED%84%B0-%EB%A8%BC%EC%A0%80-%ED%96%89%EB%B3%B5%ED%95%B4%EC%A7%80%EC%9E%90\">우리부터 먼저 행복해지자</a></p>\n<ul>\n<li><a href=\"#%EB%8F%99%EB%A3%8C%EB%A5%BC-%EC%A1%B4%EC%A4%91%ED%95%98%EC%9E%90\">동료를 존중하자</a></li>\n<li><a href=\"#%EC%A1%B0%EC%A7%81-%EC%95%88%EC%97%90%EC%84%9C-%EB%82%98%EC%9D%98-%ED%96%89%EB%B3%B5%EC%9D%84-%EC%B0%BE%EC%95%84%EB%B3%B4%EC%9E%90\">조직 안에서 나의 행복을 찾아보자</a></li>\n<li><a href=\"#%EB%82%B4%EA%B0%80-%EC%BB%A8%ED%8A%B8%EB%A1%A4%ED%95%A0-%EC%88%98-%EC%97%86%EB%8A%94-%EA%B2%83%EC%97%90-%EC%A7%91%EC%B0%A9%ED%95%98%EC%A7%80-%EB%A7%90%EC%9E%90\">내가 컨트롤할 수 없는 것에 집착하지 말자</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"우리는 개발자이기 이전에 어떤 조직의 구성원이기 때문에 조직문화로부터 생각보다 많은 영향을 받고 있다. 그렇기 때문에 우리는 한 조직의 일원으로 이 조직이 건강한 조직인지, 우리가 활기차고 생산성있게 일하고 있는지 끊임없는 관심을 가져야 한다. 하지만 필자는 대부분의 개발자들이 기술이나 개발 문화에 대해서는 많은 관심을 기울이지만 조직 문화에 대해서는 별로 관심이 없는 모습을 종종 보아왔다. 쌓여있는 업무를 처리하거나 매년 쏟아져나오는 프레임워크와 새로운 패러다임을 공부하기도 벅차기도하고 개발팀 내부에서 조직문화 때문에 발생하는 이슈가 별로 없기 때문이기도 한 것 같다.","html":"<p>우리는 개발자이기 이전에 어떤 조직의 구성원이기 때문에 조직문화로부터 생각보다 많은 영향을 받고 있다. 그렇기 때문에 우리는 한 조직의 일원으로 이 조직이 건강한 조직인지, 우리가 활기차고 생산성있게 일하고 있는지 끊임없는 관심을 가져야 한다.</p>\n<p>하지만 필자는 대부분의 개발자들이 기술이나 개발 문화에 대해서는 많은 관심을 기울이지만 조직 문화에 대해서는 별로 관심이 없는 모습을 종종 보아왔다. 쌓여있는 업무를 처리하거나 매년 쏟아져나오는 프레임워크와 새로운 패러다임을 공부하기도 벅차기도하고 개발팀 내부에서 조직문화 때문에 발생하는 이슈가 별로 없기 때문이기도 한 것 같다.</p>\n<!-- more -->\n<p>실제로 필자가 지난 4년 간 개발자로 일해오며 시니어 개발자들에게 조직 문화에 대한 질문을 했을 때 돌아오는 대답은 대략 이랬다.</p>\n<blockquote>\n<p>조직문화…? 조직문화 중요하죠. 근데 지금 이슈 쳐내기도 너무 정신이 없어서…</p>\n</blockquote>\n<p>그리고 필자에게 이런 대답을 해주셨던 시니어 개발자들은 직장 내에서 진짜로 겁나 바쁜 상태인 경우가 많았다. 하지만 이렇게 얘기할 수 있는 것도 사실 조직문화라는 키워드가 개인의 우선 순위에서 밀렸기 때문이라고 볼 수 있기 때문에 상대적으로 그 분들에게 조직문화에 대한 중요성이 와닿지 않은 경우라고 생각한다.</p>\n<p>그래서 이 포스팅에서는 우리같은 조직원들이 왜 이런 조직문화에 관심을 가져야하는지, 또 우리가 조직문화를 위해 당장 실천할 수 있는 게 뭔지 한번 이야기 해보려고 한다. 물론 좋은 조직문화 형성에는 조직의 리더인 CEO의 역할이 가장 중요하기는 하지만 필자는 CEO였던 적도 없고, 또 앞으로도 그냥 코딩이나 하면서 살고 싶지 CEO 같은 건 별로 할 생각이 없으므로 조직원의 입장에서만 이 이야기를 풀어볼 것이다.</p>\n<h2 id=\"굳이-개발자가-조직문화에-까지-관심을-가져야하나요\" style=\"position:relative;\">굳이 개발자가 조직문화에 까지 관심을 가져야하나요?<a href=\"#%EA%B5%B3%EC%9D%B4-%EA%B0%9C%EB%B0%9C%EC%9E%90%EA%B0%80-%EC%A1%B0%EC%A7%81%EB%AC%B8%ED%99%94%EC%97%90-%EA%B9%8C%EC%A7%80-%EA%B4%80%EC%8B%AC%EC%9D%84-%EA%B0%80%EC%A0%B8%EC%95%BC%ED%95%98%EB%82%98%EC%9A%94\" aria-label=\"굳이 개발자가 조직문화에 까지 관심을 가져야하나요 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>여러분들 중에서는 이런 생각이 드는 분도 분명히 있을 것이다. 굳이 개발자가 조직문화까지 관심을 가지는 게 맞는 것일까? 조직문화는 컬쳐 담당자나 CEO가 관심을 가지고 개선을 주도하는 것이 맞지 않나?</p>\n<p>사실 맞다. 올바른 조직문화의 정착은 컬쳐팀의 주요 목표이기도 하고 간혹 컬쳐팀이 없다면 HR팀이 담당하는 경우도 있다. 그리고 CEO가 조직문화의 개선에 관심이 없으면 아무리 직원들이 조직문화의 개선을 외쳐도 개선이 되지 않는 것도 맞다. 그렇다면 다시 이런 질문을 던져볼 수 있겠다.</p>\n<blockquote>\n<p>그럼 조직문화는 내 담당도 아니고… 나는 개발자니까 프로그래밍을 잘하는 것에 집중해야 하지 않을까?</p>\n</blockquote>\n<p>음, 그 말도 맞다. 개발자로써 당연히 프로그래밍을 잘하면 좋다. 사실 프로그래밍을 잘한다는 사실 자체 보다는 프로그래밍을 잘하고 싶은 욕구가 있어야하는 것이 더 중요하다고 생각한다. 이건 개발자라는 직업을 가진 사람으로써 기본적인 욕구이자 직업적인 책임이다.</p>\n<p>냉정해보이지만 사실 당연한 개념인데, 어떤 사람이 오버워치 프로게이머인데 티어가 브론즈라고 생각해보자. 여기서부터 벌써 “응? 브론즈?”라는 생각이 들 것이다. 게다가 이 사람이 5년 동안 심해에만 머물러 있다면 이건 뭔가 잘못된 거다.</p>\n<p>하지만 어쨌든 프로그램으로 먹고 사는 사람에게 프로그래밍을 잘한다는 것은 결국 패시브 스킬 같은 것이다. 좋은 개발자는 프로그래밍을 넘어선 부분도 생각해야한다. 결국 우리는 컴퓨터와 사람 사이에서 일하는 사람들이기 때문에 컴퓨터 바깥의 세상으로부터 자유롭지 못하기 때문이다.</p>\n<p>그 컴퓨터 바깥의 세상에는 나와 함께 일하는 팀원이 있고, 그 너머에는 우리 팀 전체, 또 그 너머에는 우리 회사가 있다. 다시 강조해서 말하지만 우리는 절대 컴퓨터랑만 일하는 사람들이 아니라는 점을 명심하자. 심지어 여러분이 세계 곳곳을 여행하며 원격 근무하는 디지털 노마드라고 하더라도 한국의 업무 시간에 맞춰서 새벽에 스카이프에 접속해야하는 일은 비일비재할 것이다.</p>\n<p>결국 우리는 어쩔 수 없이 조직에 영향을 받을 수 밖에 없고, 좋은 조직문화는 결국 조직원 개개인의 행복이나 업무의 성취감, 비전에도 영향을 끼친다. 이것이 필자가 생각하는 개발자도 조직문화에 관심을 가져야하는 이유이다.</p>\n<p>조직문화에 관심을 가진다는 것은 당연히 좋은 조직문화에 대해서 고민한다는 것도 포함한다. 좋은 조직문화는 보통 하루아침에 뚝딱 만들어지는 것이 아니기 때문에 우리 같은 팀원들과 CEO같은 리더들의 노력이 함께 어우러져야 겨우겨우 조직에 자리잡을 수 있다.</p>\n<p>그렇다면 우리가 당장 내일부터 조직문화를 위해, 즉 우리 팀을 위해 할 수 있는 행동은 어떤 것이 있을까?</p>\n<h2 id=\"우리부터-먼저-행복해지자\" style=\"position:relative;\">우리부터 먼저 행복해지자<a href=\"#%EC%9A%B0%EB%A6%AC%EB%B6%80%ED%84%B0-%EB%A8%BC%EC%A0%80-%ED%96%89%EB%B3%B5%ED%95%B4%EC%A7%80%EC%9E%90\" aria-label=\"우리부터 먼저 행복해지자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>필자는 “개인이 행복하면 조직도 행복하다”라고 생각하는 사람이다. 여러분이 매일 아침 출근하는 길이 지옥같고 사무실에서는 아무 재미없는 일만 하느라 멍하게 코딩만 한다면 그 조직은 건강한 조직일까? 필자 생각에는 아닐 가능성이 높다. 게다가 이런 문제는 흔히 말하는 사회생활 때문에 겉으로 보기에는 잘 드러나지 않는다.</p>\n<p>사실 필자가 이야기하는 “개인이 행복하면 조직도 행복하다”라는 말은 뜬구름 잡는 이야기가 아니다. 이미 행복과 같은 긍정적인 감정을 가진 사람이 업무 효율성이나 집중도, 능력 발전도가 더 좋다는 연구 결과가 이미 많이 나와있기 때문이다. 개인의 이러한 발전은 결과적으로 조직에도 긍정적인 영향을 끼칠 수 밖에 없다.</p>\n<p>이 분야에서 나름 알려진 개념은 긍정심리자본이 있는데, 이 개념은 경영학자인 프레드 루선스(Fred Luthans)가 2000년에 창시한 개념이다. 이 개념은 이미 논문도 많고 연구도 활발히 진행되고 있는 개념이기 때문에 한번쯤 구글링해보는 것을 추천한다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/a06d0f2a9dcbf57e6a25a15daca59fa4/8454b/googled.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 87.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC70lEQVR42o1U227aQBDl/z8lfe0P9KWKlASigjEGbHy/YXzDd685PTZJ2gYidaXRrmflmTlz5uwsDBMEjgOH5vs+0jSFbdsIwxBd103Wtu1dq5sWQIvv8xY/pBKXrsAsjFJEUYiyLNE0zWR5nqIoclRVyR8bCCHQi/5q/dUmXy+Ai4AZCXhJz2OHWccsXV3jfQlxwTnvGbBnkg51JXC54L/XLDud4Bk6xDBMjqKs8bTYYbFUsd4aWCoaDNeEd/Rg+CYOjs5vC0mSYHj7Z0z4nnQW88KwrI/LEaKqqZCVDeTNBtvdHr+WEtbrLVbSGmt5jQ3vNryL4/i2wrYskAc+Lm8BRTfg5FYI7RLJsUGWdYQuphY09cDEf/Bf7vRiVp/PSBhwYJMnyEUJabnF62KF5UqCSZg7cw+dUG3fJmQDqnWAbpsTgTcBqzxHkSYfjobjoGoaNtsdIV8Dy/IWu/0BmmZANw2YloHDQWPy4g5kzpkfBIRzzSb6gRXXE2RHy+AaOSKvwpGWhA0qtqAte7SFuM9yx4rGgc5Y6bgqjpAsK5AkGUuSsZRWJGDLihX8fHzE6+sShkaWo2wa7puA45COpY+KGNe47/Ya4XFEdJss69wt7Pfsncbe6RqVZMF1HQRE9jno7HOGrhXw9Qy2liB0z3B4Dt0CgZ3jFBSoyhYXDF8yPRsdfzurqpogKgqJUPecR3max72qYiXzvFPIsDFVl6bZbcCbCgnZcXxYlg/T9AjdwYE9CzhajmNT9xE8z2PfPZzP+W0PPzuaZoDn1jiSUf1QQlUJ128QBg2SuKM6OkTHlg9ID8eumbhkshrFub8GFGL4kN24yqqG7rpwj8G0O0cfbhhQxy40x6SOXcRJjiylIOICbcNXh+oaH5UvKmw4NjJenueYzxfUsMLvDQwyresGW7BjVRosW+d+oDSTfyE/PHzD89PLO2fs4QDLzGFbOSGd4ToFe0m2R23HDU4nwjSLCWYU1Xx12knnY6VjwN+kD1t/7MjvUAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"googled\" title=\"\" src=\"/static/a06d0f2a9dcbf57e6a25a15daca59fa4/6af66/googled.png\" srcset=\"/static/a06d0f2a9dcbf57e6a25a15daca59fa4/69538/googled.png 160w,\n/static/a06d0f2a9dcbf57e6a25a15daca59fa4/72799/googled.png 320w,\n/static/a06d0f2a9dcbf57e6a25a15daca59fa4/6af66/googled.png 640w,\n/static/a06d0f2a9dcbf57e6a25a15daca59fa4/d9199/googled.png 960w,\n/static/a06d0f2a9dcbf57e6a25a15daca59fa4/21b4d/googled.png 1280w,\n/static/a06d0f2a9dcbf57e6a25a15daca59fa4/8454b/googled.png 1798w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>구글에 \"긍정심리자본\"이라고 검색하면 많은 학술자료가 나온다</small>\n</center>\n<p>그럼 조직 안에서 개인이 행복해지려면 어떻게 해야할까? 사실 조직 자체에서 조직원들이 행복할 수 있도록 관심을 가지고 고민하며 도와주는 것이 좋긴 하지만 아쉽게도 아직까지 많은 조직들은 이런 행복의 힘에 대해서 깊게 생각하고 있지 않은 것이 현실이다.</p>\n<p>하지만 그렇다고 개개인이 아무 것도 할 수 없는 것은 아니다. 조직원 개개인의 작은 행동들이 모여서 자연스럽게 암묵적인 조직의 분위기를 만들 수 있기 때문이다. 게다가 아무리 조직이 조직원들의 행복에 관심을 가지고 탑다운(Top-down)식으로 행복한 조직문화를 만들었다고 해도 결국 조직이 만든 명시적인 조직문화와 개개인들이 만든 암묵적인 조직문화가 일치하지 않는다면 겉으로는 그럴싸해보일지 몰라도 실제로는 안에서부터 곪아 터질 수 있다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/3e8fa4ae119dd3650a916a2e187e0916/4b190/download.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIEAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB9jpkk3pGSCKC/wD/xAAcEAABBAMBAAAAAAAAAAAAAAABAAIDEQQSITL/2gAIAQEAAQUCkOqvl2sgd2oNcHCXyQEDS//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABkQAAIDAQAAAAAAAAAAAAAAAAEQACExYf/aAAgBAQAGPwKtYg4gqn//xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhMVFh/9oACAEBAAE/IVNvTxYECvYAWM0/kK9VKJLyM97rEBhGNYJ//9oADAMBAAIAAwAAABBHD8D/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAVEQEBAAAAAAAAAAAAAAAAAAAQAf/aAAgBAgEBPxAp/8QAHRABAAICAgMAAAAAAAAAAAAAAQARIVExQXGR4f/aAAgBAQABPxA0BrFMrtzqJ3TK6xKgkjaqj0/YAUm+PZ4nBMNZKlrVLbtgA6sY4l7snU//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"download\" title=\"\" src=\"/static/3e8fa4ae119dd3650a916a2e187e0916/c08c5/download.jpg\" srcset=\"/static/3e8fa4ae119dd3650a916a2e187e0916/0913d/download.jpg 160w,\n/static/3e8fa4ae119dd3650a916a2e187e0916/cb69c/download.jpg 320w,\n/static/3e8fa4ae119dd3650a916a2e187e0916/c08c5/download.jpg 640w,\n/static/3e8fa4ae119dd3650a916a2e187e0916/4b190/download.jpg 800w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>마치 이런 느낌이랄까</small>\n</center>\n<p>그렇기 때문에 조직이 만들어가는 명시적인 조직문화와 동시에 조직원들이 암묵적인 조직문화를 만들어 나가는 것이 중요하다. 그럼 좀 더 구체적으로 우리가 암묵적인 조직문화를 만들어나가기 위해 어떤 행동과 마음가짐을 가져야 할 지 살펴보자.</p>\n<h3 id=\"동료를-존중하자\" style=\"position:relative;\">동료를 존중하자<a href=\"#%EB%8F%99%EB%A3%8C%EB%A5%BC-%EC%A1%B4%EC%A4%91%ED%95%98%EC%9E%90\" aria-label=\"동료를 존중하자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>필자는 중학교 1학년이었던 2004년부터, 군대에 입대하는 해인 2011년까지 비보이로 활동했었다. 그냥 학교 동아리가 아니라 나름 CYON BBOY CHAMPION SHIP에서 서울 3위를 했던 프로 비보이 크루의 일원이었던 적도 있었다. 한 7-8년 정도 힙합씬에 있었다는 소리다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 580px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/28e9f883518e57d7a3d39c9a2d546811/78d0c/shake.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAAFBv/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAAByXGZmu25yD//xAAcEAACAQUBAAAAAAAAAAAAAAABAwIABBEiJDH/2gAIAQEAAQUCiSJePjcLwwdL9WV//8QAFxEAAwEAAAAAAAAAAAAAAAAAAAECEf/aAAgBAwEBPwGWaj//xAAYEQACAwAAAAAAAAAAAAAAAAAAAQITIf/aAAgBAgEBPwGT1FCP/8QAHhAAAgEDBQAAAAAAAAAAAAAAAAECEBESIUFhYpH/2gAIAQEABj8CI5LQ38GuwpcWp//EABoQAQEBAAMBAAAAAAAAAAAAAAERADFRYSH/2gAIAQEAAT8hJ04eNT70FSZfAdTGmYedIYdGq+b/2gAMAwEAAgADAAAAED/v/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARQf/aAAgBAwEBPxDQRtuX/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAERQWH/2gAIAQIBAT8QQ4LRof/EABwQAQEAAgIDAAAAAAAAAAAAAAERACExUUFhgf/aAAgBAQABPxBJJYaN3lmumCoPT4yxSLRUnzJmwAGhd8es5xzU93eWMUDIZ//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"shake\" title=\"\" src=\"/static/28e9f883518e57d7a3d39c9a2d546811/78d0c/shake.jpg\" srcset=\"/static/28e9f883518e57d7a3d39c9a2d546811/0913d/shake.jpg 160w,\n/static/28e9f883518e57d7a3d39c9a2d546811/cb69c/shake.jpg 320w,\n/static/28e9f883518e57d7a3d39c9a2d546811/78d0c/shake.jpg 580w\" sizes=\"(max-width: 580px) 100vw, 580px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>오른쪽에 브이하고 있는 게 필자. 거의 10년 전이니 확실히 어려보인다. 부럽...</small>\n</center>\n<p>힙합은 Respect라는 정신을 굉장히 강조하는 데 이는 말 그대로 서로를 존중하는 것을 의미한다. 비보이들이 배틀에서 각종 제스쳐와 춤으로 상대를 서로 도발하고 싸우긴 하지만 그 이면에는 상대방을 나와 같은 비보이로 생각한다는 정신이 깔려있는 것이다.</p>\n<p>필자가 고등학생 때에는 찔랭이 동네 비보이부터 날고 기는 프로 팀까지 모두 연습을 하러 오는 유명한 연습실인 문래YMCA란 곳이 있었는데, 필자도 주말마다 여기서 비보잉 연습을 하면서 많은 형들의 조언을 들을 수 있었다. 이 당시 필자는 세계적으로 유명했던 한 비보이로부터 우연히 조언을 들은 적이 있었는데, 정확한 문맥은 기억안나지만 그 분의 말 한마디는 아직도 똑똑히 기억난다.</p>\n<blockquote>\n<p>누군가 비보잉을 하고 있다면, 그 사람이 춤을 시작한지 하루가 되었든 10년이 되었든 우리는 다 같은 비보이다. 그러니까 상대방을 Respect하는 습관을 들여라.</p>\n</blockquote>\n<p>이 말은 사실 필자의 가치관 형성에도 굉장히 많은 영향을 줬다. 그리고 필자는 이 Respect 정신을 비보잉을 하던 음악을 하던 프로그래밍을 하던 항상 똑같이 적용해왔다. 어떤 분이 프로그래밍을 하는 직업을 가지거나 지금 프로그래밍을 공부하고 있는 분이라고 하면 그 자체만으로도 그 분을 개발자로써 존중해야 한다는 것이다.</p>\n<p>이 정신을 마음 속에 품고 다른 개발자와 이야기를 나눈다면 더 이상 그 사람의 경력은 중요하지 않다. 어제 처음 입사한 신입 개발자든 이 바닥에서 10년 넘게 구른 시니어 개발자든 “우리는 개발자”라는 사실 앞에서 평등하다. 물론 시니어는 그 동안 겪어온 짬이 있기 때문에 주니어보다 더 프로그래밍을 잘할 수 있다. 하지만 순수하게 기술력만을 놓고 본다면 시니어보다 잘하는 주니어도 많다는 사실을 잊지 말자. 단순히 상대방이 나보다 경력이 적다는 이유로, 어리다는 이유로 무시하면 안된다는 것이다.</p>\n<p>뭐 가끔은 얘기하다보면 상대방이 논리적으로 틀린 말을 할 수도 있지만 그렇다고 “이런 것도 몰라?”라고 면박주는 것이 아니라 잘못된 것에 대해서 제대로 피드백을 줄 수 있는 성숙한 마음을 가지자. 또 누군가 나에게 피드백을 준다면 그 사람이 초등학교 갓 졸업한 14살짜리 개발자일지라도 그 피드백에 대해서 고민 해볼 수 있는 마인드를 가져야한다.</p>\n<p>프로그래밍을 업으로써 본인이 먹고 살수 있다면 신입이든 시니어든 개발자는 개발자다. 그러니까 항상 같이 일하는 동료를 존중하는 마음을 가지자. 동료들이 팀 내에서 자기 능력을 존중받는다고 느낀다면 결국 여러분에게도 그 존중은 돌아오게 되어있다. 서로 존중받지 못하는 팀에 개인의 행복은 있을 수 없다.</p>\n<h3 id=\"조직-안에서-나의-행복을-찾아보자\" style=\"position:relative;\">조직 안에서 나의 행복을 찾아보자<a href=\"#%EC%A1%B0%EC%A7%81-%EC%95%88%EC%97%90%EC%84%9C-%EB%82%98%EC%9D%98-%ED%96%89%EB%B3%B5%EC%9D%84-%EC%B0%BE%EC%95%84%EB%B3%B4%EC%9E%90\" aria-label=\"조직 안에서 나의 행복을 찾아보자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>요즘 출판되고 있는 자기계발서에서 흔하게 하는 뻔한 이야기라고 생각할 수 있지만, 위에서 한번 설명했듯 이게 틀린 말은 또 아니기 때문에 대충 넘겨서도 곤란하다. 그리고 필자가 말하고 싶은 행복이라는 것은 생각보다 거창한 개념이 아니다.</p>\n<p>사실 필자는 “아 행복해~“라는 감정과는 굉장히 거리가 먼 사람이다. 그렇다고 불행하다는 것은 아니고 “내가 지금 행복한 상태인가?”와 같은 질문을 스스로에게 해본 적이 별로 없기 때문에 “난 지금 행복해!”라는 생각도 안하는 것이다.</p>\n<p>그래서 필자가 말하는 행복은 단지 불행하지 않은 상태라고 봐도 무방하다. 개발자다운 이분법적인 생각일수도 있지만, 행복이란 것은 자기 마음먹기 나름이기 때문에 필자는 결국 행복한 게 맞는 것 같다.</p>\n<p>하지만 우리가 일반적으로 생각하는 행복은 뭐랄까… 연봉이 20% 인상되었을 때와 같은 행복인 경우가 많은 것 같다. <small>(정확하게 뭐라 말로 표현 못하겠다)</small> 하지만 이런 류의 행복은 쳇바퀴와도 같아서 내가 연봉이 20% 올랐어도 결국 금방 또 다음 단계의 행복을 찾아나서게 된다.</p>\n<blockquote>\n<p>오 연봉이 4천이 됐다! 근데 세금을 너무 많이 떼가네…? 한 달에 400만원만 벌어봤으면 좋겠는데…</p>\n</blockquote>\n<p>물론 연봉이 올라서 느끼는 감정도 행복일 수 있지만 필자가 말하는 행복은 이런 행복이 아니다. 그것보다는 좀 더 소박한, 필자가 방금 얘기한 것 같이 “난 딱히 불행한 상태가 아니잖아? 그럼 나름 행복한 것 같은데?”과 같은 작은 행복이다.</p>\n<p>그리고 이 행복의 기준은 사람마다 너무 다르기 때문에 콕 찝어서 뭐라 말하기는 힘들다. 어떤 사람은 행복의 기준이 무조건 돈일 수도 있고 어떤 사람은 그냥 아침에 출근할 때 상쾌한 바람 냄새만 맡아도 행복할 수 있기 때문이다.</p>\n<p>그렇기 때문에 한번 필자의 기준을 토대로 이야기해보겠다. 필자의 기준도 어떤 이에게는 이해가 안될 수도 있겠지만 그냥 “이런 사람도 있구나” 정도로 받아들이도록 하자.</p>\n<p>일단 필자는 굉장히 직선적인 성격이다. 아니다 싶으면 아니라고 말하고 맞다 싶으면 맞다고 말하는 그런 사람이다. 직장에서는 50명 가까운 사람들이 모여있는 자리에서 지금 우리가 하고 있는 데이터 기반 의사결정이 진짜로 우리 유저들을 위한 것이 아니라 순전히 우리의 지표를 위한 결정이라고 비판하며 우리 회사가 잘못하고 있는 점을 거의 한시간 동안 하나하나 지적한 적도 있었다.</p>\n<p>필자의 이런 행동들을 보고 어떤 사람들은 자신의 마음을 대변해줘서 고맙다고 하는 사람도 있었지만 반면에 너무 직선적이라 걱정된다고 해주시는 분도 있었다. <small>(다른 회사는 더 하면 더 하다는 말과 함께…)</small></p>\n<p>물론 필자도 이런 성격이 사회 통념 상 안좋게 보일 수도 있다는 사실은 당연히 알고 있고, 또 그냥 있는 듯 없는 듯 살며 사회에 맞출 수도 있다. 군대에서는 필자의 직선적인 성격을 다 숨기고 그냥 까라면 까는 충실한 군인이기도 했기 때문에 뭐 지금도 그렇게 다시 하라고 한다면 못할 것도 없지 않은가.</p>\n<p>그리고 CEO를 포함한 전직원이 있는 자리에서 회사 전체를 비판하며 나 혼자만 외롭게 얘기한다는 것은 솔직히 쉬운 일은 아니다. 이런 상황에서 왠만한 사람은 다 긴장할 수 밖에 없고, 혹시 내가 틀렸으면 어떡하나라는 생각도 들기 마련이다. 그래서 이 얘기를 하기로 마음먹은 후에는 거의 매일 새벽 2-3시까지 논문부터 학술자료나 사례까지 닥치는 대로 찾아봤었다.</p>\n<p>하지만 이런 장애물을 다 넘어서 결국 필자가 이렇게 행동할 수 있었던 이유는 필자가 어떤 조직의 조직원으로써 느끼는 행복의 기준이 바로 내가 만드는 것이 사람들을 도울 수 있는 무언가가 되는 것이기 때문이다. 그렇기 때문에 데이터 기반 의사결정을 비판할 때도 많은 사람들 앞에서</p>\n<blockquote>\n<p>난 전환율이나 매출같은 지표를 올리기 위한 프로덕트를 만드는 것이 아니라, 진짜로 사람들이 우리 서비스를 통해 좋은 경험을 얻어갈 수 있는 그런 프로덕트를 만들고 싶다.</p>\n</blockquote>\n<p>라고 자신의 의견을 이야기할 수 있었던 것이다. 그리고 저렇게 한바탕 이야기하고 난 뒤 많은 분들이 공감을 해주셔서 결국 회사가 좋은 방향으로 바뀌긴 했다. 이게 진짜 잘한건지 아닌건지는 아직도 고민 중이긴 하지만…</p>\n<p>어쨌든 이런 과정을 통해 결국 필자는 “내가 이 프로덕트를 만들면 유저에게 어떤 도움이 되는지”를 공감하면서 프로덕트를 개발할 수 있었고 결과적으로 만족했다. 조직 내에서 자기만의 행복을 찾는 방법은 이렇게 적극적인 방법부터 조심스러운 방법까지 아주 다양한 방법이 있으니 한번 퇴근 후 집에서 “내 행복의 기준은 무엇일까”라는 고민을 한번쯤은 다들 해보았으면 좋겠다.</p>\n<h3 id=\"내가-컨트롤할-수-없는-것에-집착하지-말자\" style=\"position:relative;\">내가 컨트롤할 수 없는 것에 집착하지 말자<a href=\"#%EB%82%B4%EA%B0%80-%EC%BB%A8%ED%8A%B8%EB%A1%A4%ED%95%A0-%EC%88%98-%EC%97%86%EB%8A%94-%EA%B2%83%EC%97%90-%EC%A7%91%EC%B0%A9%ED%95%98%EC%A7%80-%EB%A7%90%EC%9E%90\" aria-label=\"내가 컨트롤할 수 없는 것에 집착하지 말자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이건 조금은 스님같은 이야기라 공감 못하시는 분들도 있을 수 있는데, 필자의 경험상 이 내용과 가장 알맞는 예시는 바로 돈이다.</p>\n<p>필자는 재작년인 2017년까지만 해도 돈에 굉장히 민감했었다. 이게 어느 정도였냐면, 한달에 30만원으로 살던 시절이었다. 교통비, 담배값, 밥값 다 합쳐서 30만원이다. 대학생 때 그렇게 살던게 직장인이 되어서도 계속 습관처럼 굳어진 것인데, 이 내면에는 “돈을 빨리 모아서 집이라도 하나 사놔야지”라는 욕구가 있었던 것 같다. 뭐 이런 생각은 필자 나이 또래의 모두가 하는 생각이니 그렇게 특별한 생각은 아니다.</p>\n<p>근데 필자는 조금 도가 지나쳤던 것이, 한달에 30만원으로만 살면 옷을 사거나 머리를 하거나 친구들이랑 술 한잔하는 그런 건 솔직히 힘들다. 그리고 결정적으로 돈은 내가 모으고 싶다고해서 그렇게 팍팍 모이는 것이 아니다. 필자가 한달에 30만원씩 쓰면서 돈을 모으고 모아도 필자의 목표에는 거의 다가가지 못하고 있었다.</p>\n<p>그래서 어느 날 갑자기 이렇게 돈만 모으면서 사는 것에 대해서 회의감도 들고 조금 지쳐서 무기력한 상태가 지속되었던 적이 있었는데, 그 당시 필자가 다녔던 직장의 CTO와 티타임을 가지며 “내가 이렇게 사는 게 맞는 지 모르겠다”는 느낌의 얘기를 나눴었던 적이 있다.</p>\n<p>근데 사실 필자의 마음은 이미 답정너였다. 그냥 “엄살부리지말고 더 열심히 모아!”라는 소리가 듣고 싶었던 것이다. 하지만 그 형님에게서는 의외의 대답이 돌아왔다.</p>\n<blockquote>\n<p>어차피 마티즈 탈 운명인 놈이 아무리 열심히 해봤자 소나타정도 타겠지. 벤츠는 절대 못타.<br />\n마찬가지로 에반이 돈을 아무리 열심히 모아도 운좋게 뭐라도 되지 않는 이상 방 2개인 집이 방 3개인 집이 되는 그 정도 차이야.</p>\n</blockquote>\n<p>이 말은 어떻게 보면 굉장히 냉정하게 들릴 수 있는 말이었지만 필자는 이때 많은 것을 느꼈던 것 같다. “방 두칸이 세칸이 되면 내가 행복해질까?” 하는 그런 고민을 그때부터 했던 것 같다. 오랜 기간 고민을 해봤지만 꼴랑 방 한칸이 필자 인생에서 그렇게 큰 비중을 차지할 수는 없을 것 같았기에 “그냥 생긴대로 살자”라는 결론을 내리게 되었다. <small>(그리고 본격적으로 주식을 시작했다…)</small></p>\n<p>물론 위에서 한번 얘기했던 연봉도 마찬가지다. 연봉이 오르면 기분이 좋을 수는 있다. 하지만 그 좋은 기분은 잠깐이다. 사람 마음이라는 것이 워낙 간사하기 때문에 내가 연봉이 20%가 올라도 한 6개월 정도 지나면 또 20%를 올리고 싶어질 것이다. 하지만 좋은 기회로 이직이라도 하지 않는 이상 그건 불가능하다.</p>\n<p>게다가 연봉이 2천만원에서 3천만원이 될 때는 상승폭이 크게 느껴지지만 3천에서 4천, 4천에서 5천이 되면 세금을 점점 많이 떼어가기 때문에 실질적으로 들어오는 실수령액은 그렇게 큰 차이가 나지 않는다.</p>\n<p>필자가 이런 이야기를 하는 이유는 바로 돈이라는 것이 내 뜻대로 되는 것이 아니기 때문이다. 만약 돈을 많이 벌고 싶어하는 사람들이 전부 돈을 많이 벌 수 있었다면 세상에는 부자들 밖에 없을 것이다. 연봉이 오르는 것, 책 집필 같이 새로운 수입이 생기는 것 등은 어느 정도 운빨도 필요하다. 100% 실력으로 승부할 수 있는 것이 아니라는 것이다.</p>\n<p>그래서 필자는 이런 생각 끝에 “그냥 열심히 코딩이나 하자. 돈은 언젠가 따라오겠지.”라는 마음으로 나름 행복하게 지내고 있다. 마음대로 컨트롤할 수 없는 돈에 집착하는 것은 뭔가 짝사랑과 비슷한 느낌이라 굉장히 힘든 것 같다. 그냥 남는 돈은 구글이나 엔비디아같은 대형주에 부어놓고 하늘에 맡기도록 하자.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>필자가 여러 번 이야기 했듯이 사실 좋은 조직문화의 형성에는 반드시 조직의 리더인 CEO의 관심이 수반되어야한다. 하지만 아직까지는 CEO가 조직문화까지 관심을 가지는 경우가 많지 않고, 또 관심이 있다고 해도 우선순위에서 밀리는 경우가 많기 때문에 현실적으로 “회사에서 알아서 좋은 조직문화를 만들어주겠지”라고 기대하기에는 조금 무리가 있다고 생각한다.</p>\n<p>하지만 위에서 설명했듯이 당장 우리도 팀을 위해, 조직을 위해 할 수 있는 일들이 있다. 나부터 행복해지자는 말은 언뜻 보면 나만 행복해지자는 말 같지만 처음에 이야기 했듯이 결국 나 개인의 행복은 우리 팀의 행복이 될 수도 있고, 더 나아가서 암묵적으로 행복한 조직문화를 형성할 수도 있다.</p>\n<p>사실 필자가 이야기한 내용들은 필자의 경험을 기반으로 한 주관적인 내용들이기 때문에 공감하지 못할 수도 있다. 하지만 필자가 이 글을 통해 하고 싶었던 말은 “나처럼 행복해져라”가 아니라 지금 당장 여러분이 조직문화를 위해 할 수 있는 작은 일들이 있다는 것이다.</p>\n<p>우리는 비록 월급받고 일하는 월급쟁이 개발자이지만 결국 어떤 조직의 일원이고, 또 그 조직을 위해서 우리가 할 수 있는 일은 프로그래밍말고도 많이 있다고 생각한다. 그리고 우리가 그렇게 조직문화에 대해서 관심과 개선하고 싶다는 의지를 가지고 조금씩 노력하다보면 어쩌면 10년 후에 새로 입사한 개발자들은 우리보다 더 재밌고 행복하고 건설적인 환경에서 일할 수도 있지 않을까?</p>\n<p>이상으로 개발자가 조직문화에 대해 관심을 가져야 하는 이유 포스팅을 마친다.</p>","fields":{"slug":"20190806-developer-with-organizational-culture","path":"/2019/08/06/developer-with-organizational-culture/","lang":"ko"},"frontmatter":{"title":"개발자가 조직문화에 대해 관심을 가져야 하는 이유","subTitle":"좋은 팀은 그냥 만들어지지 않는다","date":"Aug 06, 2019","categories":["소프트스킬","에세이"],"tags":["조직문화","개발자","좋은 팀"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/752dc4e8a5dc734e5669a2c0129f9b9b/3a812/thumbnail.jpg","srcSet":"/static/752dc4e8a5dc734e5669a2c0129f9b9b/3a812/thumbnail.jpg 320w,\n/static/752dc4e8a5dc734e5669a2c0129f9b9b/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/752dc4e8a5dc734e5669a2c0129f9b9b/fc5c5/thumbnail.webp 320w,\n/static/752dc4e8a5dc734e5669a2c0129f9b9b/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/752dc4e8a5dc734e5669a2c0129f9b9b/2d839/thumbnail.jpg","srcSet":"/static/752dc4e8a5dc734e5669a2c0129f9b9b/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/752dc4e8a5dc734e5669a2c0129f9b9b/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"45bf3acc-2f61-5e79-8f26-ad6b03a3bd29","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%99%9C-%EC%9D%B4-%ED%8F%AC%EC%8A%A4%ED%8C%85%EC%9D%84-%EC%9E%91%EC%84%B1%ED%95%98%EA%B2%8C-%EB%90%98%EC%97%88%EB%82%98\">왜 이 포스팅을 작성하게 되었나?</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%8C%80%ED%91%9C%EC%A0%81%EC%9D%B8-%EC%9E%98%EB%AA%BB%EB%90%9C-%EA%B0%9C%EB%85%90%EB%93%A4\">대표적인 잘못된 개념들</a></p>\n<ul>\n<li><a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%EB%8A%94-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%97%94%EC%A7%84-%EB%82%B4%EB%B6%80%EC%97%90-%EC%9E%88%EB%8B%A4\">이벤트 루프는 자바스크립트 엔진 내부에 있다</a></li>\n<li><a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%EB%8A%94-%ED%95%98%EB%82%98%EC%9D%98-%EC%8A%A4%ED%83%9D-%EB%98%90%EB%8A%94-%ED%95%98%EB%82%98%EC%9D%98-%ED%81%90%EB%A1%9C%EB%A7%8C-%EC%9E%91%EB%8F%99%ED%95%9C%EB%8B%A4\">이벤트 루프는 하나의 스택 또는 하나의 큐로만 작동한다</a></li>\n<li><a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%EB%8A%94-%EC%97%AC%EB%9F%AC-%EA%B0%9C%EC%9D%98-%EC%8A%A4%EB%A0%88%EB%93%9C%EC%97%90%EC%84%9C-%EC%8B%A4%ED%96%89%EB%90%9C%EB%8B%A4\">이벤트 루프는 여러 개의 스레드에서 실행된다</a></li>\n<li><a href=\"#settimeout%EC%9D%80-%EC%9D%BC%EB%B6%80-%EB%B9%84%EB%8F%99%EA%B8%B0-os-api%EC%99%80-%EA%B4%80%EB%A0%A8%EC%9E%88%EB%8B%A4\">setTimeout은 일부 비동기 OS API와 관련있다.</a></li>\n<li><a href=\"#setimmediate%EC%9D%98-%EC%BD%9C%EB%B0%B1%EC%9D%80-%EC%9E%91%EC%97%85-%ED%81%90%EC%9D%98-%EA%B0%80%EC%9E%A5-%EC%B2%AB%EB%B2%88%EC%A7%B8%EC%97%90-%EC%9C%84%EC%B9%98%ED%95%9C%EB%8B%A4\">setImmediate의 콜백은 작업 큐의 가장 첫번째에 위치한다</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%EC%9D%98-%EA%B5%AC%EC%A1%B0\">이벤트 루프의 구조</a></p>\n<ul>\n<li><a href=\"#timer-phase\">Timer phase</a></li>\n<li><a href=\"#pending-io-callback-phase\">Pending i/o callback phase</a></li>\n<li><a href=\"#idle-prepare-phase\">Idle, Prepare phase</a></li>\n<li><a href=\"#poll-phase\">Poll phase</a></li>\n<li><a href=\"#check-phase\">Check phase</a></li>\n<li><a href=\"#close-callbacks\">Close callbacks</a></li>\n<li><a href=\"#nexttickqueue%EC%99%80-microtaskqueue\">nextTickQueue와 microTaskQueue</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%EC%9D%98-%EC%9E%91%EC%97%85-%ED%9D%90%EB%A6%84\">이벤트 루프의 작업 흐름</a></p>\n<ul>\n<li><a href=\"#timer-phase-1\">Timer phase</a></li>\n<li><a href=\"#pending-io-phase\">Pending i/o phase</a></li>\n<li><a href=\"#poll-phase-1\">Poll phase</a></li>\n<li><a href=\"#check-phase-1\">Check phase</a></li>\n<li><a href=\"#close-callback\">Close callback</a></li>\n<li><a href=\"#nexttickqueue--microtaskqueue\">nextTickQueue &#x26; microTaskQueue</a></li>\n<li><a href=\"#thread-pool\">Thread-pool</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#workflow-with-examples\">Workflow with examples</a></p>\n<ul>\n<li><a href=\"#snippet-1--%EA%B8%B0%EC%B4%88-%EC%9D%B4%ED%95%B4\">Snippet 1 – 기초 이해</a></li>\n<li><a href=\"#snippet-2--%ED%83%80%EC%9D%B4%EB%A8%B8%EB%93%A4%EC%9D%84-%EB%8D%94-%EC%9E%98-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0\">Snippet 2 – 타이머들을 더 잘 이해하기</a></li>\n<li><a href=\"#snippet-3--nexttick%EA%B3%BC-%ED%83%80%EC%9D%B4%EB%A8%B8-%EC%8B%A4%ED%96%89%EC%97%90-%EB%8C%80%ED%95%B4-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0\">Snippet 3 – nextTick()과 타이머 실행에 대해 이해하기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%AA%87-%EA%B0%80%EC%A7%80-%EC%9D%BC%EB%B0%98%EC%A0%81%EC%9D%B8-%EC%A7%88%EB%AC%B8%EB%93%A4\">몇 가지 일반적인 질문들</a></p>\n<ul>\n<li><a href=\"#%EA%B7%B8%EB%9F%BC-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%8A%94-%EC%A0%95%ED%99%95%ED%9E%88-%EC%96%B4%EB%94%94%EC%97%90%EC%84%9C-%EC%8B%A4%ED%96%89%EB%90%98%EB%8A%94%EA%B1%B4%EA%B0%80%EC%9A%94\">그럼 자바스크립트는 정확히 어디에서 실행되는건가요?</a></li>\n<li><a href=\"#%EC%99%9C-%EC%9A%B0%EB%A6%AC%EB%8A%94-settimeoutfn-0%EA%B0%80-%EC%9E%88%EB%8A%94%EB%8D%B0%EB%8F%84-setimmediate%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4%EC%95%BC-%ED%95%98%EB%82%98%EC%9A%94\">왜 우리는 setTimeout(fn, 0)가 있는데도 setImmediate를 사용해야 하나요?</a></li>\n<li><a href=\"#%EC%99%9C-setimmediate%EB%8A%94-immediate%EC%A6%89%EC%8B%9C%EB%9D%BC%EA%B3%A0-%EB%B6%80%EB%A5%B4%EB%8A%94-%EA%B1%B4%EA%B0%80%EC%9A%94\">왜 setImmediate는 Immediate(즉시)라고 부르는 건가요?</a></li>\n<li><a href=\"#%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%8A%94-block-%EB%90%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EA%B1%B4%EA%B0%80%EC%9A%94\">자바스크립트는 Block 될 수 있는 건가요?</a></li>\n<li><a href=\"#%EB%A7%8C%EC%95%BD-exit-callback-phase%EC%97%90%EC%84%9C-settimeout%EC%9D%84-%ED%98%B8%EC%B6%9C%ED%95%98%EB%A9%B4-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%90%98%EB%82%98%EC%9A%94\">만약 Exit callback phase에서 setTimeout을 호출하면 어떻게 되나요?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A7%A7%EC%9D%80-%EC%A0%95%EB%A6%AC%EB%93%A4\">짧은 정리들</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"1년 전, 필자는 setImmediate & process.nextTick의 차이점에 대해 설명하면서 Node.js의 이벤트 루프 구조에 대해 살짝 언급한 적이 있었다. 놀랍게도 독자 분들은 원래 설명하려고 했던 부분보다 이벤트 루프 부분에 대해서 더 많이 관심을 주었고, 필자는 그 부분에 대해서 많은 질문을 받았었다. 그래서 이번에는 Node.js의 이벤트 루프를 구성하는 로우 레벨의 동작을 자세하게 설명해보려고 한다.","html":"<p>1년 전, 필자는 <a href=\"http://voidcanvas.com/setimmediate-vs-nexttick-vs-settimeout/\" target=\"_blank\" rel=\"nofollow\">setImmediate &#x26; process.nextTick</a>의 차이점에 대해 설명하면서 Node.js의 이벤트 루프 구조에 대해 살짝 언급한 적이 있었다. 놀랍게도 독자 분들은 원래 설명하려고 했던 부분보다 이벤트 루프 부분에 대해서 더 많이 관심을 주었고, 필자는 그 부분에 대해서 많은 질문을 받았었다. 그래서 이번에는 Node.js의 이벤트 루프를 구성하는 로우 레벨의 동작을 자세하게 설명해보려고 한다.</p>\n<!-- more -->\n<blockquote>\n<p>이 포스팅은 2018년 2월 19일에 Paul Shan이 작성한 <a href=\"http://voidcanvas.com/nodejs-event-loop/\" target=\"_blank\" rel=\"nofollow\">Node.js event loop workflow &#x26; lifecycle in low level</a>를 번역한 글입니다. 의역이 있을 수 있습니다.</p>\n</blockquote>\n<h2 id=\"왜-이-포스팅을-작성하게-되었나\" style=\"position:relative;\">왜 이 포스팅을 작성하게 되었나?<a href=\"#%EC%99%9C-%EC%9D%B4-%ED%8F%AC%EC%8A%A4%ED%8C%85%EC%9D%84-%EC%9E%91%EC%84%B1%ED%95%98%EA%B2%8C-%EB%90%98%EC%97%88%EB%82%98\" aria-label=\"왜 이 포스팅을 작성하게 되었나 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>만약에 여러분이 구글에서 <code class=\"language-text\">node.js event loop</code>를 검색하면 나오는 대부분의 아티클들은 자세한 내용을 설명해주지 않는다. <small>(그들은 매우 거시적으로만 이 과정을 묘사하려고 한다.)</small></p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/a076c3e84ee1aecf176f5e15c621a291/c2d13/node-js-wrong-event-loop_wdvpem.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAACr0lEQVR42mWQS0wTQRiA9+jJgxegUGhLt7vdPrbbF+3S3ZZuty0tBTXgwWjiAyNG40WOJoTE4MEYjQmXmpBCvHgxECO+wiOGo3IxejAxGpQSSF+77Xa7bLH+XaMXv+zO/DPz/zPfDFKt1mRZLpfLtar466h5pNFstgOYF8TqodpUFOXwH6rakOXizx+7+TwCpbV6vSyUdwvibkkSpWqlVq3LdUiTJEkQBLnRUFUVhrKGJNVhsnCwXxEEZOL1sxubrybXX0yur15YW72y+fLc2+c7otBqteB0BQ5SFPhApPUfyMe9/a/Fwue9nWJTzT59kjw7NjF1/uat61NXL33Y3oaMeqUiVyoQLC8vZ7PZ3OLSYi43Pz+/sbGBFEWlIDYqtRIsP3p432A6EY54PAEr5uhdW3ujtlrVxmG+XJMa6mgmo+/qsKH9dn1Hz/Fj09PTCFysUAL/tufCwuMQ4zs1nj55OhUfZre23inN1kFJfP/p25fv+aWl3J3ZmXt35x7Mzc7N3F5ZWUFibTj4eZ7nOC4ChLWGDUejXDzOc1oGz8dSqdRIJpNIJpPDqczYWDqdRrr+0tnZCa1Oo1vjz6Suq6tXr+/r6zMYDH9a6Lp1OshGzGYzrkFYrS6AJCm322634zhGEITFYjEajRRF+f1+F0Vp6yQMId9kMiFWHAdJLjqUSCRAjGFZNjQY56L+IM0wDEm64CSbzQbbwV52LYAyowaCW1CWYaKRcJT28+xgmA5yboL3kcMDrthQxO32gCrpcnm8PtxqxTAMXFDUDOVOpxPBcJymB+F5RsJ0MhqJhYIjA2Qs6B0N+RiGheKenu4z4+PXLl+M0EE64HV7KRCByzocDgRFUVCBiHTYvR5PMBCIeEmGcvicBEU6MQwHPYsZBUHcAq9jxnALQeCm/rb5b5x2aX5rJxm3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"node js wrong event loop wdvpem\" title=\"\" src=\"/static/a076c3e84ee1aecf176f5e15c621a291/6af66/node-js-wrong-event-loop_wdvpem.png\" srcset=\"/static/a076c3e84ee1aecf176f5e15c621a291/69538/node-js-wrong-event-loop_wdvpem.png 160w,\n/static/a076c3e84ee1aecf176f5e15c621a291/72799/node-js-wrong-event-loop_wdvpem.png 320w,\n/static/a076c3e84ee1aecf176f5e15c621a291/6af66/node-js-wrong-event-loop_wdvpem.png 640w,\n/static/a076c3e84ee1aecf176f5e15c621a291/d9199/node-js-wrong-event-loop_wdvpem.png 960w,\n/static/a076c3e84ee1aecf176f5e15c621a291/21b4d/node-js-wrong-event-loop_wdvpem.png 1280w,\n/static/a076c3e84ee1aecf176f5e15c621a291/c2d13/node-js-wrong-event-loop_wdvpem.png 2560w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>위 그림은 구글에서 <code class=\"language-text\">nodejs event loop</code>를 검색했을 때 나오는 이미지들을 캡쳐한 것이다. 그리고 대다수의 이미지 결과들은 잘못 되었거나 실제 이벤트 루프가 어떻게 작동하는지에 대해서 거시적으로만 설명하고 있다. 이런 방식의 설명들 때문에 개발자들은 종종 이벤트 루프에 대한 잘못된 이해를 하게 된다. 아래 설명할 몇가지 개념은 개발자들이 잘못 알고 있는 몇가지 개념들이다.</p>\n<h2 id=\"대표적인-잘못된-개념들\" style=\"position:relative;\">대표적인 잘못된 개념들<a href=\"#%EB%8C%80%ED%91%9C%EC%A0%81%EC%9D%B8-%EC%9E%98%EB%AA%BB%EB%90%9C-%EA%B0%9C%EB%85%90%EB%93%A4\" aria-label=\"대표적인 잘못된 개념들 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"이벤트-루프는-자바스크립트-엔진-내부에-있다\" style=\"position:relative;\">이벤트 루프는 자바스크립트 엔진 내부에 있다<a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%EB%8A%94-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%97%94%EC%A7%84-%EB%82%B4%EB%B6%80%EC%97%90-%EC%9E%88%EB%8B%A4\" aria-label=\"이벤트 루프는 자바스크립트 엔진 내부에 있다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>대표적인 잘못된 개념들 중 하나는 바로 이벤트 루프가 자바스크립트 엔진<small>(V8, Spider Monkey 등)</small>의 일부라는 것이다. 하지만 이벤트 루프는 단지 자바스크립트 코드를 실행하기위해 자바스크립트 엔진을 이용하기만 할 뿐이다. <small>(역주: 실제로 V8 엔진에는 이벤트 루프를 관리하는 코드가 없다. Node.js나 브라우저가 이벤트 루프를 담당하는 것)</small></p>\n<h3 id=\"이벤트-루프는-하나의-스택-또는-하나의-큐로만-작동한다\" style=\"position:relative;\">이벤트 루프는 하나의 스택 또는 하나의 큐로만 작동한다<a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%EB%8A%94-%ED%95%98%EB%82%98%EC%9D%98-%EC%8A%A4%ED%83%9D-%EB%98%90%EB%8A%94-%ED%95%98%EB%82%98%EC%9D%98-%ED%81%90%EB%A1%9C%EB%A7%8C-%EC%9E%91%EB%8F%99%ED%95%9C%EB%8B%A4\" aria-label=\"이벤트 루프는 하나의 스택 또는 하나의 큐로만 작동한다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>먼저, 이벤트 루프에 작업을 담아놓는 스택 같은 것은 존재하지 않는다. 그리고 이벤트 루프가 작동하는 과정은 여러 개의 큐<small>(자료구조에서의 그 큐 맞다.)</small>를 사용하는 복잡한 과정이다. 그러나 대부분의 개발자들은 자바스크립트의 모든 콜백이 단 하나의 큐만 사용하여 수행된다고 알고 있는데, 이것은 완전히 잘못된 생각이다.</p>\n<h3 id=\"이벤트-루프는-여러-개의-스레드에서-실행된다\" style=\"position:relative;\">이벤트 루프는 여러 개의 스레드에서 실행된다<a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%EB%8A%94-%EC%97%AC%EB%9F%AC-%EA%B0%9C%EC%9D%98-%EC%8A%A4%EB%A0%88%EB%93%9C%EC%97%90%EC%84%9C-%EC%8B%A4%ED%96%89%EB%90%9C%EB%8B%A4\" aria-label=\"이벤트 루프는 여러 개의 스레드에서 실행된다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Node.js 이벤트 루프의 잘못된 다이어그램들 때문에 우리는 한 개의 스레드가 자바스크립트의 실행을 담당하고 다른 한 개는 이벤트 루프를 담당하는, 총 두 개의 스레드가 있다고 생각하게 되었다. <small>(필자도 자바스크립트 뉴비 시절에 그렇게 생각했다.)</small></p>\n<p>그러나 실제로는 단일 스레드로 이 모든 것을 처리한다.</p>\n<h3 id=\"settimeout은-일부-비동기-os-api와-관련있다\" style=\"position:relative;\">setTimeout은 일부 비동기 OS API와 관련있다.<a href=\"#settimeout%EC%9D%80-%EC%9D%BC%EB%B6%80-%EB%B9%84%EB%8F%99%EA%B8%B0-os-api%EC%99%80-%EA%B4%80%EB%A0%A8%EC%9E%88%EB%8B%A4\" aria-label=\"settimeout은 일부 비동기 os api와 관련있다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>또 다른 큰 오해는 <code class=\"language-text\">setTimeout</code>의 딜레이가 끝났을 때 콜백이 외부의 요인으로 인해<small>(OS나 커널 같은)</small> 의해 어떤 작업 큐에 들어가게 된다고 생각하는 것이다. 하지만 이벤트 루프에 이런 외부의 요인 같은 건 없다. 우리는 밑에서 이 메커니즘에 대해서 좀 더 자세히 알아볼 것이다.</p>\n<h3 id=\"setimmediate의-콜백은-작업-큐의-가장-첫번째에-위치한다\" style=\"position:relative;\">setImmediate의 콜백은 작업 큐의 가장 첫번째에 위치한다<a href=\"#setimmediate%EC%9D%98-%EC%BD%9C%EB%B0%B1%EC%9D%80-%EC%9E%91%EC%97%85-%ED%81%90%EC%9D%98-%EA%B0%80%EC%9E%A5-%EC%B2%AB%EB%B2%88%EC%A7%B8%EC%97%90-%EC%9C%84%EC%B9%98%ED%95%9C%EB%8B%A4\" aria-label=\"setimmediate의 콜백은 작업 큐의 가장 첫번째에 위치한다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>보통 일반적인 이벤트 루프에 대한 설명들은 하나의 큐만 가지고 설명을 진행하기 때문에, 몇몇 개발자들은 <code class=\"language-text\">setImmediate()</code>가 콜백을 작업 큐의 가장 앞쪽에 배치하는 API라고 생각하게 된다. 하지만 이것은 완전히 틀린 생각이며, 모든 작업 큐들은 FIFO(First In First Out)로만 작동한다. <small>(역주: 큐에 들어있는 작업의 포지션을 절대 변경하지 않는다는 것이다. 무조건 큐에 먼저 들어간 작업이 먼저 실행된다.)</small></p>\n<h2 id=\"이벤트-루프의-구조\" style=\"position:relative;\">이벤트 루프의 구조<a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%EC%9D%98-%EA%B5%AC%EC%A1%B0\" aria-label=\"이벤트 루프의 구조 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>일단 이벤트 루프의 구조를 이해하기 위해서는 이벤트 루프의 흐름에 대해서 알고 있어야 한다. 이미 한번 언급했듯이, 거시적인 하나의 큐만 보는 것은 이벤트 루프를 이해하는 데 별로 도움이 되지 않는다. 아래 그림이 이벤트 루프를 제대로 설명한 그림이다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/dfece5e35b7d9e50b6eac8adb1a348b8/949b7/nodejs-event-loop-phase.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 90.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAABeklEQVR42p2Ua8uCQBCF+/8/zA+BBmVYlBSBVHbX7lkTz7wMqNmbtbDsbfbMmTmz25Ca7Xa7yeVyqTy73+86jkYjadQFBOx4POr88Xj8DmjGp9NJ9vv9C9jXgDDbbrfS6XRkNpvp+iuGGNuF6/Uqm81G1uu1AiVJonMDMNuPDBEgTVMFyLKscIYTGFs+KxnihYscYAiL8/msa2ORZ84++YQ9DgwwDMM/QPMaBIG0221ptVoyn88VtJwvHCPQeDwWz/Ok1+tJt9uV4XCodwsMydNisVAgwqbvdjuJokj7arXSMwMlmuVyqWzZGwwGrznk0EIAENbNZlMcxxHXdTWSfCPP/4qCGHnAOI6V3WQy0RGHHwHZgLKFyMi6rHA+j9YREA0KopA7cnI4HDQsmGDMuqyy7eO03++rgL7vKwbpeVs25Ro0tRmtTq28jCFKv316GBI+zKv2cZyvy1pPj4aqFDB9Op0Wnp7Zf/05wAow0lD1J/70H9b54gB8AlFufC5VPBD4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"nodejs event loop phase\" title=\"\" src=\"/static/dfece5e35b7d9e50b6eac8adb1a348b8/6af66/nodejs-event-loop-phase.png\" srcset=\"/static/dfece5e35b7d9e50b6eac8adb1a348b8/69538/nodejs-event-loop-phase.png 160w,\n/static/dfece5e35b7d9e50b6eac8adb1a348b8/72799/nodejs-event-loop-phase.png 320w,\n/static/dfece5e35b7d9e50b6eac8adb1a348b8/6af66/nodejs-event-loop-phase.png 640w,\n/static/dfece5e35b7d9e50b6eac8adb1a348b8/d9199/nodejs-event-loop-phase.png 960w,\n/static/dfece5e35b7d9e50b6eac8adb1a348b8/21b4d/nodejs-event-loop-phase.png 1280w,\n/static/dfece5e35b7d9e50b6eac8adb1a348b8/949b7/nodejs-event-loop-phase.png 1583w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>이 그림에 표기된 각각의 박스는 특정 작업을 수행하기 위한 페이즈들을 의미한다. 각 페이즈는 각자 하나의 큐를 가지고 있으며, 자바스크립트의 실행은 이 페이즈들 중 <code class=\"language-text\">Idle, prepare</code> 페이즈를 제외한 어느 단계에서나 할 수 있다. <small>(이해를 돕기 위해 큐라고 설명했지만 사실 실제 자료구조는 큐가 아닐 수도 있다.)</small></p>\n<p>그리고 이 그림에서 <code class=\"language-text\">nextTickQueue</code>와 <code class=\"language-text\">microTaskQueue</code>를 볼 수 있는데, 이 큐들은 이벤트 루프의 일부가 아니며, 이 큐들에 들어있는 작업 또한 어떤 페이즈에서든 실행될 수 있다. 또한 이 큐들에 들어있는 작업은 가장 높은 실행 우선 순위를 가지고 있다.</p>\n<p>이제 우리는 이벤트 루프가 각자 다른 여러 개의 페이즈들과 큐들의 조합으로 이루어져 있다는 것을 알게 되었다. 이제 각각의 페이즈가 어떤 작업을 수행하는 지 알아보자.</p>\n<h3 id=\"timer-phase\" style=\"position:relative;\">Timer phase<a href=\"#timer-phase\" aria-label=\"timer phase permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><code class=\"language-text\">Timer phase</code>는 이벤트 루프의 시작을 알리는 페이즈이다. 이 페이즈가 가지고 있는 큐에는 <code class=\"language-text\">setTimeout</code>이나 <code class=\"language-text\">setInterval</code> 같은 타이머들의 콜백을 저장하게 된다. 이 페이즈에서 바로 타이머들의 콜백이 큐에 들어가는 것은 아니지만 타이머들을 <code class=\"language-text\">min-heap</code>으로 유지하고 있다가 실행할 때가 된 타이머들의 콜백을 큐에 넣고 실행하는 것이다.</p>\n<blockquote>\n<p><strong>역주</strong>: 힙(Heap)은 완전 이진트리의 일종으로 어느 정도의 느슨한 정렬을 사용하여 값들의 집합에서 최대 값이나 최소 값을 찾아내는 작업에 특화되어 있다. min-heap은 상위 레벨의 노드가 하위 레벨의 노드들보다 작거나 같은 구조이므로 타이머가 실행되어야하는 순서대로 저장하기에 알맞는 자료 구조라고 할 수 있다.</p>\n<p>그리고 큐에 콜백을 넣는다는 것은, 이 콜백들을 실행하겠다는 것을 의미하므로 타이머가 생성되지마자 큐에 콜백을 넣는 것이 아니라 별도의 힙에 타이머를 저장하고나서 매 Timer phase 때 어떤 타이머가 실행할 때가 되었는지를 검사한 후, 실행되어야 하는 콜백만 큐에 넣는다는 것이다. 이 과정에 대한 자세한 내용은 밑에서 다시 설명하겠다.</p>\n</blockquote>\n<h3 id=\"pending-io-callback-phase\" style=\"position:relative;\">Pending i/o callback phase<a href=\"#pending-io-callback-phase\" aria-label=\"pending io callback phase permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이 페이즈에서는 이벤트 루프의 <code class=\"language-text\">pending_queue</code>에 들어있는 콜백들을 실행한다. 이 큐에 들어와있는 콜백들은 현재 돌고 있는 루프 이전에 한 작업에서 이미 큐에 들어와있던 콜백들이다. 예를 들어 여러분이 TCP 핸들러 콜백 함수에서 파일에 뭔가를 썼다면 TCP 통신이 끝나고 파일 쓰기도 끝나고 나서 파일 쓰기의 콜백이 이 큐에 들어오는 것이다.<small>(파일 쓰기는 보통 비동기로 이루어진다.)</small> 또한 에러 핸들러 콜백도 <code class=\"language-text\">pending_queue</code>로 들어오게 된다.</p>\n<h3 id=\"idle-prepare-phase\" style=\"position:relative;\">Idle, Prepare phase<a href=\"#idle-prepare-phase\" aria-label=\"idle prepare phase permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이름은 <code class=\"language-text\">Idle phase</code>이지만 이 페이즈는 매 Tick마다 실행된다. <code class=\"language-text\">Prepare phase</code> 또한 매 폴링(Polling)때마다 실행된다. 어쨌든 이 두개의 페이즈는 이벤트 루프와 직접적인 관련이 있다기보다는 Node.js의 내부적인 관리를 위한 것이기 때문에 이 포스팅에서는 설명하지 않는다.</p>\n<h3 id=\"poll-phase\" style=\"position:relative;\">Poll phase<a href=\"#poll-phase\" aria-label=\"poll phase permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>필자가 생각하기에 전체 이벤트 루프 중 가장 중요한 페이즈는 바로 이 <code class=\"language-text\">Poll phase</code>라고 생각한다. 이 페이즈에서는 새로운 수신 커넥션<small>(새로운 소켓 설정 등)</small>과 데이터<small>(파일 읽기 등)</small>를 허용한다. 우리는 여기서 일어나는 일을 크게 두 가지로 나눠볼 수 있다.</p>\n<hr>\n<ul>\n<li>만약 <code class=\"language-text\">watch_queue</code><small>(Poll phase가 가지고 있는 큐)</small>가 비어있지 않다면, 큐가 비거나 시스템 최대 실행 한도에 다다를 때까지 동기적으로 모든 콜백을 실행한다.</li>\n<li>일단 <code class=\"language-text\">watch_queue</code>가 비어있다면, Node.js는 곧바로 다음 페이즈로 넘어가는 것이 아니라 약간 대기시간을 가지게 된다. Node.js가 기다리는 시간은 여러 가지 요인에 따라 계산되는데, 이 부분은 밑에서 따로 설명하도록 하겠다.</li>\n</ul>\n<hr>\n<h3 id=\"check-phase\" style=\"position:relative;\">Check phase<a href=\"#check-phase\" aria-label=\"check phase permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><code class=\"language-text\">Poll phase</code>의 다음 페이즈는 바로 <code class=\"language-text\">setImmediate</code>의 콜백만을 위한 페이즈인 <code class=\"language-text\">Check phase</code>이다. 이렇게 얘기하면 보통 하시는 질문은, “왜 setImmediate의 콜백만을 위한 큐인가요?”이다. 음, 그건 밑에서 필자가 워크 플로우 섹션에서 다시 얘기할 <code class=\"language-text\">Poll phase</code>에서 수행하는 행동들 때문이기도 하다. 일단 지금은 <code class=\"language-text\">Check phase</code>가 <code class=\"language-text\">setImmediate</code>의 콜백 전용 단계라는 사실만 기억하고 있자.</p>\n<h3 id=\"close-callbacks\" style=\"position:relative;\">Close callbacks<a href=\"#close-callbacks\" aria-label=\"close callbacks permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><code class=\"language-text\">socket.on('close', () => {})</code>과 같은 <code class=\"language-text\">close</code> 이벤트 타입의 핸들러들은 여기서 처리된다.</p>\n<h3 id=\"nexttickqueue와-microtaskqueue\" style=\"position:relative;\">nextTickQueue와 microTaskQueue<a href=\"#nexttickqueue%EC%99%80-microtaskqueue\" aria-label=\"nexttickqueue와 microtaskqueue permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><code class=\"language-text\">nextTickQueue</code>는 <code class=\"language-text\">process.nextTick()</code> API의 콜백들을 가지고 있으며, <code class=\"language-text\">microTaskQueue</code>는 Resolve된 프로미스의 콜백을 가지고 있다.</p>\n<p>이 두개의 큐는 기술적으로 이벤트 루프의 일부가 아니다. 즉, <code class=\"language-text\">libUV</code> 라이브러리에 포함된 것이 아니라 <code class=\"language-text\">Node.js</code>에 포함된 기술이라는 것이다. 이 친구들이 가지고 있는 작업들은 현재 실행되고 있는 작업이 끝나자마자 호출되어야한다.</p>\n<blockquote>\n<p><strong>역주</strong>: <a href=\"https://github.com/libuv/libuv\" target=\"_blank\" rel=\"nofollow\">libUV</a>는 Node.js에서 사용하는 비동기 I/O 라이브러리이다. 이 라이브러리는 C로 작성되었고 윈도우나 리눅스 커널을 추상화해서 Wrapping하고 있는 구조이다. 즉, 커널에서 어떤 비동기 작업들을 지원해주는 지 알고 있기 때문에 커널을 사용하여 처리할 수 있는 비동기 작업을 발견하면 바로 커널로 작업을 넘겨버린다.</p>\n<p>이후 이 작업들이 종료되어 OS 커널로부터 시스템 콜을 받으면 이벤트 루프에 콜백을 등록하는 것이다. 만약 OS 커널이 지원하지 않는 작업일 경우 별도의 스레드에 작업을 던져서 처리한다. 이 스레드에 관한 내용은 원작자가 밑에서 추가적으로 설명하고있다.</p>\n</blockquote>\n<h2 id=\"이벤트-루프의-작업-흐름\" style=\"position:relative;\">이벤트 루프의 작업 흐름<a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%EC%9D%98-%EC%9E%91%EC%97%85-%ED%9D%90%EB%A6%84\" aria-label=\"이벤트 루프의 작업 흐름 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>우리가 <code class=\"language-text\">node my-script.js</code>를 콘솔에서 실행시켰을 때, Node.js는 이벤트 루프를 생성한 다음 <strong>이벤트 루프 바깥</strong>에서 메인 모듈인 <code class=\"language-text\">my-script.js</code>를 실행한다. 한번 메인 모듈이 실행되고나면 Node.js는 이벤트 루프가 활성 상태인지, 즉 이벤트 루프 안에서 해야할 작업이 있는지를 확인한다. 만약 이벤트 루프를 돌릴 필요가 없다면 Node.js는 <code class=\"language-text\">process.on('exit, () => {})</code>를 실행하고 이벤트 루프를 종료하려고 할 것이다.</p>\n<p>그러나 만약 이벤트 루프를 돌려야할 상황이라면 Node.js는 이벤트 루프의 첫 번째 페이즈인 <code class=\"language-text\">Timer phase</code>를 실행한다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f9c11eeefdd25b07850636e84007db11/a4f52/nodejs-event-loop-workflow.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 78.75000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAABeUlEQVR42o2U666CMBCE+/7vp6ISwR+KUUTEG15wT75NxjQeb00ase3Mzs5uGywat9vNzuezf9/vdzudTr6mva7r7NsI+rhcLrZarSzLMmuaxrbbrY1GIyvL0tq2teVyaev12vcU5CMh0aUAdYAAo1h7rB+PRw/+lhDg9Xp9gPQN0Ww2cxKlDBGKd7vde0KA8/nckiSxwWBgVVXZ4XCwzWbzABIEtayTOhMblBlBNYMAHGCqGPv93gGQolRAncdjArCOeoSQQYjlCoCauq79gII8dwNrBKVQZMk51sMrH9iAcDKZPJRCIJXyE6uGw6F3Rpqmrjq8M5e0i6LwqpLidDq1Xq9n4/HYgfIMYlKXn+FTk3JQoDzPvWgoiu0gUL/f9yL+8zDuSXkk0+Nq6r/aKz73kpAUSZdWYj7fDnkIOWrpTWXyklAFwEcAKIgrrQuAJYvFwj1VkGA/DLyKr6Ean0BqIVnwE6GaXa3EL9X/+Dh8G/EDET8kz4R/bwLkMJcqSxIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"nodejs event loop workflow\" title=\"\" src=\"/static/f9c11eeefdd25b07850636e84007db11/6af66/nodejs-event-loop-workflow.png\" srcset=\"/static/f9c11eeefdd25b07850636e84007db11/69538/nodejs-event-loop-workflow.png 160w,\n/static/f9c11eeefdd25b07850636e84007db11/72799/nodejs-event-loop-workflow.png 320w,\n/static/f9c11eeefdd25b07850636e84007db11/6af66/nodejs-event-loop-workflow.png 640w,\n/static/f9c11eeefdd25b07850636e84007db11/d9199/nodejs-event-loop-workflow.png 960w,\n/static/f9c11eeefdd25b07850636e84007db11/21b4d/nodejs-event-loop-workflow.png 1280w,\n/static/f9c11eeefdd25b07850636e84007db11/a4f52/nodejs-event-loop-workflow.png 2024w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h3 id=\"timer-phase-1\" style=\"position:relative;\">Timer phase<a href=\"#timer-phase-1\" aria-label=\"timer phase 1 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이벤트 루프가 <code class=\"language-text\">Timer phase</code>에 들어가게 되면 실행할 타이머 콜백 큐에 뭐가 있는 지 확인부터 시작한다. 그냥 확인이라고 하면 간단해보이지만 사실 이벤트 루프는 적절한 콜백들을 찾기 위해 몇 가지 단계를 수행하게된다.\n위에서 설명했듯이 타이머 스크립트는 오름차순으로 힙에 저장된다. 그래서 제일 먼저 저장된 타이머들을 하나씩 까서 <code class=\"language-text\">now - registeredTime === delta</code> 같은 조건을 통해 타이머의 콜백을 실행할 시간이 되었는 지 검사하게 된다.<small>(역주: <code class=\"language-text\">delta</code>는 <code class=\"language-text\">setTimeout(() => {}, 10)</code>에서의 <code class=\"language-text\">10</code>)</small></p>\n<p>만약 조건에 해당된다면 이 타이머의 콜백을 실행하고 다음 타이머를 확인한다. 만약 조건에 해당하지 않는 타이머를 만난다면, 탐색을 바로 종료하고 다음 페이즈로 이동한다. 타이머는 힙 내부에 오름차순으로 정렬되어있기 때문에 그 이후로는 탐색을 해도 의미가 없기 때문이다.</p>\n<p>자, 예를 들어 딜레이 값이 <code class=\"language-text\">100</code>, <code class=\"language-text\">200</code>, <code class=\"language-text\">300</code>, <code class=\"language-text\">400</code>인 4개의 타이머(A, B, C, D)를 어떤 특정 시간 <code class=\"language-text\">t</code>에 힙에 등록했다고 가정해보자.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/87819ce16bd25b0803be9a4ebab03834/3534c/Screen-Shot-2018-02-18-at-12.50.48-PM.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 19.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAiUlEQVR42m2OSw7DIAxEc/87ElgA4ZeEwAEcPUtUldrFyPLzeDRb712u61Ld9y3P88g/xlyM+xjjh6HtPE+x1qpqrcKec5Z931Ww1tqHOefUA08piTFGGeEaiDnGKMdxSClFxXMIQRlP7Ex2vPysnYl3tdRAAEbC5pzaAIZ5MRrBvPfaBrZCvwNfylArWSyIdCMAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Screen Shot 2018 02 18 at 12 50 48 PM\" title=\"\" src=\"/static/87819ce16bd25b0803be9a4ebab03834/6af66/Screen-Shot-2018-02-18-at-12.50.48-PM.png\" srcset=\"/static/87819ce16bd25b0803be9a4ebab03834/69538/Screen-Shot-2018-02-18-at-12.50.48-PM.png 160w,\n/static/87819ce16bd25b0803be9a4ebab03834/72799/Screen-Shot-2018-02-18-at-12.50.48-PM.png 320w,\n/static/87819ce16bd25b0803be9a4ebab03834/6af66/Screen-Shot-2018-02-18-at-12.50.48-PM.png 640w,\n/static/87819ce16bd25b0803be9a4ebab03834/3534c/Screen-Shot-2018-02-18-at-12.50.48-PM.png 808w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>이제 이벤트 루프가 <code class=\"language-text\">t+250</code>에 Timer phase에 진입했다고 생각해보자.</p>\n<p>가장 먼저 타이머 A를 찾아낸 후 만료 기간이 <code class=\"language-text\">t+100</code>이라는 것을 알게 될 것이다. 그러나 지금은 이미 <code class=\"language-text\">t+250</code>이기 때문에 타이머 A의 콜백은 실행될 것이다. 그리고 타이머 B를 찾아내어 만료 기간이 <code class=\"language-text\">t+200</code>임을 체크하게되고, 타이머 B의 콜백 역시 실행된다.</p>\n<p>이제 타이머 C를 체크하게 되는데 이 타이머의 딜레이는 <code class=\"language-text\">t+300</code>이기 때문에 바로 페이즈가 종료된다. 이벤트 루프는 타이머 D는 체크하지 않는데, 위에서 설명했듯이 타이머들은 만료 기간 순으로 오름차순 정렬되어있기 때문에 타이머 C의 뒤쪽에는 어차피 타이머 C보다 만료 기간이 긴 타이머들만 있기 때문이다.</p>\n<p>참고로 페이즈는 시스템의 실행 한도에도 영향을 받고 있으므로, 실행 되어야하는 타이머가 아직 남아 있다고 하더라도 시스템 실행 한도에 도달한다면 바로 다음 페이즈로 넘어가게된다.</p>\n<h3 id=\"pending-io-phase\" style=\"position:relative;\">Pending i/o phase<a href=\"#pending-io-phase\" aria-label=\"pending io phase permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>타임 페이즈가 종료된 후 이벤트 루프는 Pending i/o 페이즈에 진입하고, 가장 먼저 이전 작업들의 콜백이 실행 대기 중인지, 즉 <code class=\"language-text\">pending_queue</code>에 들어와 있는지를 체크하게 된다. 만약 실행 대기 중이라면 <code class=\"language-text\">pending_queue</code>가 비거나 시스템의 실행 한도 초과에 도달할 때까지 대기하고 있던 콜백들을 실행한다. 이 과정이 종료되면 이벤트 루프는 <code class=\"language-text\">Idle Handler Phase</code>로 이동하게 된 후 내부 처리를 위한 <code class=\"language-text\">Prepare phase</code>를 거쳐 최종적으로 가장 중요한 단계인 <code class=\"language-text\">Poll Phase</code>에 도달하게 된다.</p>\n<h3 id=\"poll-phase-1\" style=\"position:relative;\">Poll phase<a href=\"#poll-phase-1\" aria-label=\"poll phase 1 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이름에서 알 수 있듯이 이 페이즈는 폴링하는 단계이다. 이벤트 루프가 <code class=\"language-text\">Poll phase</code>에 들어왔을 때 <code class=\"language-text\">watcher_queue</code> 내부에 파일 읽기의 응답 콜백, HTTP 응답 콜백 같이 수행해야 할 작업들이 있다면 이 작업들을 실행하게 된다. 이 과정 또한 <code class=\"language-text\">watcher_queue</code>가 비거나 시스템의 실행 한도 초과에 다다를 때까지 계속 된다.</p>\n<p>만약 더 이상 콜백들을 실행할 수 없는 상태가 된다면 만약 <code class=\"language-text\">check_queue</code>, <code class=\"language-text\">pending_queue</code>, <code class=\"language-text\">closing_callbacks_queue</code>에 해야할 작업이 있는지를 검사하고, 만약 해야할 작업이 있다면 바로 <code class=\"language-text\">Poll phase</code>가 종료되고 다음 페이즈로 넘어가게 된다. 하지만 특별히 해야할 작업이 더 이상 없는 경우 <code class=\"language-text\">Poll phase</code>는 다음 페이즈로 넘어가지 않고 계속 대기하게 된다.</p>\n<p>이때도 마냥 무한 대기를 하는 것은 아니고, 타이머 힙에서 첫번째 타이머를 꺼내본 다음에 만약 해당 타이머가 실행 가능한 상태라면 그 타이머의 딜레이 시간만큼만 대기 시간을 결정한다.</p>\n<blockquote>\n<p><strong>역주</strong>: 결국 Poll phase에서 더 이상 수행할 작업이 없는 경우 다음 페이즈로 넘어가는 조건은 다음과 같다.</p>\n<ol>\n<li><code class=\"language-text\">Check phase</code>에 실행할 콜백이 있냐? 바로 다음 페이즈로 고고</li>\n<li><code class=\"language-text\">Check phase</code>에도 실행할 콜백이 없어? 그럼 타이머는 있어? 있다면 그 타이머를 실행 할 수 있는 시간이 될 때까지만 대기하고 바로 Timer phase로 고고</li>\n<li>없어? 그럼 일 생길 때까지 대기…</li>\n</ol>\n<p>2번 조건에서 타이머가 있다고 바로 Timer phase로 넘어가지 않고 대기하는 이유는, 대기하지않고 바로 Timer phase로 넘어갈 경우 어차피 첫번째 타이머를 실행할 수 있는 시간이 안되었기 때문에 Timer phase에서도 아무것도 수행하지 않고 Timer phase가 끝나버리기 때문이다. 그렇게 되면 굳이 이벤트 루프를 한번 더 돌아야지 해당 타이머를 실행할 수 있게되므로 그냥 Poll phase에서 대기하는 게 더 이득인 것이다.</p>\n</blockquote>\n<h3 id=\"check-phase-1\" style=\"position:relative;\">Check phase<a href=\"#check-phase-1\" aria-label=\"check phase 1 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><code class=\"language-text\">Poll phase</code>가 지나면 이벤트 루프는 바로 <code class=\"language-text\">setImmediate()</code> API의 콜백과 관련이 있는 <code class=\"language-text\">Check phase</code>에 들어서게 된다. 이 페이즈에서는 다른 페이즈와 마찬가지로 큐가 비거나 시스템 실행 한도 초과에 도달할 때까지 계속 해서 <code class=\"language-text\">setImmediate</code>의 콜백들을 실행한다.</p>\n<h3 id=\"close-callback\" style=\"position:relative;\">Close callback<a href=\"#close-callback\" aria-label=\"close callback permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><code class=\"language-text\">Check Phase</code>가 종료된 후에, 이벤트 루프의 다음 목적지는 <code class=\"language-text\">close</code>나 <code class=\"language-text\">destory</code> 콜백 타입들을 관리하는 <code class=\"language-text\">Close callback</code>이다.</p>\n<p>이벤트 루프가 <code class=\"language-text\">Close callback</code>들과 함께 종료되고나면 이벤트 루프는 다음에 돌아야할 루프가 있는지 다시 체크 하게 된다. 만약 아니라면 그대로 이벤트 루프는 종료된다. 하지만 만약 더 수행해야할 작업들이 남아 있다면 이벤트 루프는 다음 순회를 돌기 시작하고 다시 <code class=\"language-text\">Timer Phase</code>부터 시작하게 된다.</p>\n<p>아까 위에서 설명했던 <code class=\"language-text\">Timer Phase</code>에서의 예시를 다시 가져오자면, 이제 다음 루프의 <code class=\"language-text\">Timer Phase</code>에서는 타이머 C의 만료 시간이 경과했는지부터 확인을 시작할 것이다.</p>\n<h3 id=\"nexttickqueue--microtaskqueue\" style=\"position:relative;\">nextTickQueue &#x26; microTaskQueue<a href=\"#nexttickqueue--microtaskqueue\" aria-label=\"nexttickqueue  microtaskqueue permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>근데 이벤트 루프의 일부가 아닌 이 두 큐에 들어있는 콜백들은 언제 실행되는 걸까? 이 두 큐의 콜백들은 어떤 페이즈에서 다음 페이즈로 넘어가기 전에 자신이 가지고 있는 콜백들을 최대한 빨리 실행해야하는 역할을 맡고 있다.<small>(역주: 페이즈에서 다른 페이즈로 넘어가는 과정을 Tick이라고 부른다.)</small></p>\n<p>다른 페이즈들과는 다르게 이 두 큐는 시스템 실행 한도 초과에 영향을 받지 않기 때문에 Node.js는 이 큐가 완전히 비워질 때까지 콜백들을 실행한다. 그리고 <code class=\"language-text\">nextTickQueue</code>는 <code class=\"language-text\">microTaskQueue</code>보다는 높은 우선 순위를 가지고 있다.</p>\n<h3 id=\"thread-pool\" style=\"position:relative;\">Thread-pool<a href=\"#thread-pool\" aria-label=\"thread pool permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>필자가 자바스크립트 개발자에게 가장 많이 들은 단어는 바로 스레드풀(ThreadPoll)이다. 그리고 이와 관련된 가장 큰 오해는 바로 Node.js가 모든 비동기 명령을 관리하는 별도의 스레드풀을 가지고 있다는 것이다. 그러나 이 스레드풀은 Node.js가 아니라 Node.js가 비동기 작업을 처리하기 위해 사용하는 라이브러리인 <code class=\"language-text\">libUV</code>에 포함된 기능이라는 것이다.</p>\n<p>필자가 이벤트 루프의 다이어그램에 스레드풀을 별도로 표시하지 않은 이유는 스레드풀 자체가 이벤트 루프 매커니즘의 일부가 아니기 때문이다. <code class=\"language-text\">libUV</code>는 OS커널의 비동기 API만을 사용하여 이벤트 드리븐을 유도할 수 있을 만큼 충분히 훌륭하다. 그러나 파일 읽기, DNS Lookup 등 OS 커널이 비동기 API를 지원하지않는 작업들의 경우에는 별도의 스레드풀을 사용하게 되는데, 이때 기본 값으로 4개의 스레드를 사용하도록 설정되어있다. <code class=\"language-text\">uv_threadpool</code> 환경 변수를 사용하면 최대 128개까지 스레드 개수를 늘릴 수도 있다.</p>\n<h2 id=\"workflow-with-examples\" style=\"position:relative;\">Workflow with examples<a href=\"#workflow-with-examples\" aria-label=\"workflow with examples permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>이제 이 동기식 무한 루프가 자바스크립트를 비동기식으로 작동하게 하기 위해 얼마나 큰 역할을 하고 있는 지 이해했기 바란다. 이 구조는 한번에 단 한개의 작업만 실행하고 있지만 그 어떤 것도 블로킹하지 않는다. 어쨌든 백문이불여일견이니, 코드 스니펫으로 이 구조를 다시 이해해보는 시간을 가져보도록 하자.</p>\n<h3 id=\"snippet-1--기초-이해\" style=\"position:relative;\">Snippet 1 – 기초 이해<a href=\"#snippet-1--%EA%B8%B0%EC%B4%88-%EC%9D%B4%ED%95%B4\" aria-label=\"snippet 1  기초 이해 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'setTimeout'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">setImmediate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'setImmediate'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>위 결과를 예측할 수 있겠는가? 아마도 여러분은 <code class=\"language-text\">setTimeout</code>이 먼저 출력된다고 생각하겠지만, 사실 장담할 수 없다.</p>\n<p>왜냐? 메인 모듈이 실행되고나서 이벤트 루프가 <code class=\"language-text\">Timer phase</code>에 진입할 때 여러분의 타이머를 찾을 수도 있고 못 찾을 수도 있기 때문이다. 왜냐면 타이머는 시스템의 시간과 사용자가 제공한 시간을 사용하여 등록되기 때문이다. <code class=\"language-text\">setTimeout</code>이 호출된 순간, 타이머는 메모리에 이 타이머를 저장하게되는데, 그 순간 컴퓨터의 성능이나 Node.js가 아닌 외부 작업 때문에 약간의 딜레이가 발생할 수 있기 때문이다.</p>\n<p>또 다른 포인트는 Node.js가 <code class=\"language-text\">Timer phase</code>에 진입하기 전에 변수 <code class=\"language-text\">now</code>를 선언하고 그 변수 <code class=\"language-text\">now</code>를 현재 시간으로 간주한다는 점이다. 그러므로 정확한 계산이라고 하기에는 약간의 노이즈가 껴있다는 것이고, 이게 바로 <code class=\"language-text\">setTimeout</code>이 반드시 먼저 실행될 것이라고 확신할 수 없는 불확실성의 이유가 된다.</p>\n<p>그러나 만약 여러분이 이 코드를 I/O 사이클의 내부로 옮긴다면, 반드시 <code class=\"language-text\">setTimeout</code>보다 <code class=\"language-text\">setImmediate</code>가 먼저 실행되는 것을 보장할 수 있게된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my-file-path.txt'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'setTimeout'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setImmediate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'setImmediate'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p><strong>역주</strong>: 위 스니펫은 다음과 같은 순서로 실행된다.</p>\n<ol>\n<li><code class=\"language-text\">fs.readFile</code>을 만나면 이벤트 루프는 libUV에게 해당 작업을 던짐.</li>\n<li>파일 읽기는 OS 커널에서 비동기 API를 제공하지 않기 때문에 libUV는 별도의 스레드에 해당 작업을 던짐</li>\n<li>작업이 완료되면 이벤트 루프는 <code class=\"language-text\">Pending i/o callback phase</code>의 <code class=\"language-text\">pending_queue</code>에 작업의 콜백을 등록</li>\n<li>이벤트 루프가 <code class=\"language-text\">Pending i/o callback phase</code>를 지날 때 해당 콜백을 실행</li>\n<li><code class=\"language-text\">setTimeout</code>이 <code class=\"language-text\">Timer phase</code>의 큐에 등록됨. 해당 콜백은 다음 <code class=\"language-text\">Timer phase</code> 때 실행될 것이다.</li>\n<li><code class=\"language-text\">setImmediate</code>의 콜백이 <code class=\"language-text\">Check phase</code>의 <code class=\"language-text\">check_queue</code>에 등록됨.</li>\n<li><code class=\"language-text\">Poll phase</code>에서는 딱히 할 일이 없지만, <code class=\"language-text\">Check phase</code>의 큐에 작업이 있으므로 바로 <code class=\"language-text\">Check phase</code>로 이동</li>\n<li>setImmediate 콘솔 출력. <code class=\"language-text\">Timer phase</code>에는 타이머가 등록되어 있으므로 다시 이벤트 루프가 시작된다.</li>\n<li><code class=\"language-text\">Timer phase</code>에서 타이머를 검사, 딜레이가 0이므로 <code class=\"language-text\">setTimeout</code>의 콜백을 바로 실행한다.</li>\n<li>setTimeout 콘솔 출력</li>\n</ol>\n<p>즉, 이런 과정을 거치기 때문에 <code class=\"language-text\">setImmediate</code>의 콜백이 반드시 <code class=\"language-text\">setTimeout</code>보다 먼저 실행되는 것을 보장할 수 있는 것이다.</p>\n</blockquote>\n<h3 id=\"snippet-2--타이머들을-더-잘-이해하기\" style=\"position:relative;\">Snippet 2 – 타이머들을 더 잘 이해하기<a href=\"#snippet-2--%ED%83%80%EC%9D%B4%EB%A8%B8%EB%93%A4%EC%9D%84-%EB%8D%94-%EC%9E%98-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0\" aria-label=\"snippet 2  타이머들을 더 잘 이해하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> start <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">foo</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    i<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">&lt;</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setImmediate</span><span class=\"token punctuation\">(</span>foo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> end <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Execution time: \"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>end <span class=\"token operator\">-</span> start<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>위의 예시는 굉장히 간단하다. 함수 <code class=\"language-text\">foo</code>는 <code class=\"language-text\">setImmediate()</code>에 의해서 1000번 재귀호출되고 있다. 이 코드를 필자의 맥북 프로에서 Node.js 8.9.1을 사용하여 실행하면 함수가 종료되기까지 <code class=\"language-text\">6-8ms</code>정도가 걸린다. 이제 위의 스니펫을 <code class=\"language-text\">setImmediate(foo)</code>에서 <code class=\"language-text\">setTimeout(foo, 0)</code>으로 변경해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> start <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">foo</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    i<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">&lt;</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>foo<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> end <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Execution time: \"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>end <span class=\"token operator\">-</span> start<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이제 필자의 컴퓨터에서 이 코드가 실행되는데 걸리는 시간은 대략 <code class=\"language-text\">1400+ ms</code>정도이다.</p>\n<p>왜 이렇게 되는걸까? 이 두 경우 모두 폴링에 걸리는 시간은 <code class=\"language-text\">0</code>이기 때문에 동일하게 작동해야한다. 근데 왜 이렇게 실행 시간이 많이 차이가 나게 된 걸까?</p>\n<p>그 이유는 바로 시간을 비교하고 편차를 알아내는 작업이 CPU를 집중적으로 사용하는 작업이기 때문에 시간이 더 오래 걸리기 때문이다. 그리고 타이머 스크립트를 등록하는 것 자체도 시간을 소모한다. 위에서 설명했듯이 Timer phase에서는 타이머를 실행할 시간이 되었는지, 콜백을 실행해야 하는지를 검사하기 위해 몇가지 작업을 거쳐야 하는데 이 과정을 매 이터레이션마다 하고 있으니 느려질 수 밖에 없다. 그러나 <code class=\"language-text\">setImmediate</code>의 경우 이런 과정이 필요없기 때문에 <code class=\"language-text\">setTimeout</code>보다 실행 속도가 빠른 것이다.</p>\n<h3 id=\"snippet-3--nexttick과-타이머-실행에-대해-이해하기\" style=\"position:relative;\">Snippet 3 – nextTick()과 타이머 실행에 대해 이해하기<a href=\"#snippet-3--nexttick%EA%B3%BC-%ED%83%80%EC%9D%B4%EB%A8%B8-%EC%8B%A4%ED%96%89%EC%97%90-%EB%8C%80%ED%95%B4-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0\" aria-label=\"snippet 3  nexttick과 타이머 실행에 대해 이해하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  i<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">></span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"foo\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"setTimeout\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  process<span class=\"token punctuation\">.</span><span class=\"token function\">nextTick</span><span class=\"token punctuation\">(</span>foo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>   \n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>foo<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>위 코드의 로그는 어떻게 출력될까? 첫번째 출력은 <code class=\"language-text\">foo</code>들이 될 것이고 기 후 <code class=\"language-text\">setTimeout</code>들이 출력된다. 제일 처음 코드를 실행하면 2ms 후에 첫 번째 <code class=\"language-text\">foo</code>가 출력되고 다음 <code class=\"language-text\">nextTickQueue</code>에 다시 <code class=\"language-text\">foo()</code>를 넣게된다.</p>\n<p>그리고 <code class=\"language-text\">nextTickQueue</code>에 들어간 콜백들은 한 페이즈에서 다음 페이즈로 넘어갈 때마다 무조건 콜백들을 동기적으로 실행해야한다. 그렇기 때문에 재귀호출로 <code class=\"language-text\">nextTickQueue</code>에 들어간 모든 콜백들을 실행하고 나서야 Timer Phase에서 <code class=\"language-text\">setTimeout</code> 콜백을 처리할 수 있게 되는 것이다.</p>\n<p>코드를 약간 수정하고 다시 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  i<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">></span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"foo\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"setTimeout\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  process<span class=\"token punctuation\">.</span><span class=\"token function\">nextTick</span><span class=\"token punctuation\">(</span>foo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>foo<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Other setTimeout\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>필자는 기존의 <code class=\"language-text\">setTimeout</code>과 같은 딜레이 시간을 가진 <code class=\"language-text\">setTimeout</code>을 추가했고, 이 타이머의 콜백은 단지 <code class=\"language-text\">Other setTimeout</code>을 출력하기만 한다. 뭐, 확실하다고 말할 수는 없지만 한 개의 <code class=\"language-text\">foo</code>가 먼저 출력된 후 <code class=\"language-text\">Other setTimeout</code>이 출력될 찬스가 존재하긴 한다. 타이머들이 들어있는 힙 내부에 동일한 딜레이를 가진 타이머들은 어떻게든 그룹화되어있고, <code class=\"language-text\">nextTickQueue</code>의 체크는 진행 중인 콜백 그룹의 실행이 끝난 후에야 진행되기 때문이다.</p>\n<blockquote>\n<p><strong>역주</strong>: 첫 번째 setTimeout의 콜백과 두 번쨰 setTimeout의 콜백이 실행될 시간이 동일하기 때문에 Timer phase에서 두 타이머의 콜백이 모두 큐에 들어갔고, 일단 큐에 들어갔으면 시스템 실행 한도에 걸리지 않는 이상 무조건 해당 페이즈가 끝나기 전에 실행된다.</p>\n<p>이런 경우, <code class=\"language-text\">foo()</code> 내부의 <code class=\"language-text\">process.nextTick</code>의 콜백은 Timer phase에서 다음 페이즈로 넘어갈 때 실행될 것이기 때문에 <code class=\"language-text\">foo</code>가 먼저 한 개 출력되고 <code class=\"language-text\">Other setTimeout</code>이 출력되는 것이다.</p>\n</blockquote>\n<h2 id=\"몇-가지-일반적인-질문들\" style=\"position:relative;\">몇 가지 일반적인 질문들<a href=\"#%EB%AA%87-%EA%B0%80%EC%A7%80-%EC%9D%BC%EB%B0%98%EC%A0%81%EC%9D%B8-%EC%A7%88%EB%AC%B8%EB%93%A4\" aria-label=\"몇 가지 일반적인 질문들 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"그럼-자바스크립트는-정확히-어디에서-실행되는건가요\" style=\"position:relative;\">그럼 자바스크립트는 정확히 어디에서 실행되는건가요?<a href=\"#%EA%B7%B8%EB%9F%BC-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%8A%94-%EC%A0%95%ED%99%95%ED%9E%88-%EC%96%B4%EB%94%94%EC%97%90%EC%84%9C-%EC%8B%A4%ED%96%89%EB%90%98%EB%8A%94%EA%B1%B4%EA%B0%80%EC%9A%94\" aria-label=\"그럼 자바스크립트는 정확히 어디에서 실행되는건가요 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이 포스트를 처음 읽을 때는 자바스크립트가 정확히 어디서 실행되는지 헷갈릴 수 있다.</p>\n<p>앞서 말했듯이 이벤트 루프 자체에서 V8 또는 다른 엔진을 사용하여 자바스크립트를 실행하는 것이고 이때, 단 하나의 스레드를 사용하여 자바스크립트가 실행되는 것이다. 실행 자체는 동기적이고, 현재 실행시킨 자바스크립트의 실행이 완료되지 않는다면 이벤트 루프 또한 진행되지 않는다.</p>\n<h3 id=\"왜-우리는-settimeoutfn-0가-있는데도-setimmediate를-사용해야-하나요\" style=\"position:relative;\">왜 우리는 setTimeout(fn, 0)가 있는데도 setImmediate를 사용해야 하나요?<a href=\"#%EC%99%9C-%EC%9A%B0%EB%A6%AC%EB%8A%94-settimeoutfn-0%EA%B0%80-%EC%9E%88%EB%8A%94%EB%8D%B0%EB%8F%84-setimmediate%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4%EC%95%BC-%ED%95%98%EB%82%98%EC%9A%94\" aria-label=\"왜 우리는 settimeoutfn 0가 있는데도 setimmediate를 사용해야 하나요 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>일단, <code class=\"language-text\">setTimeout(fn, 0)</code>은 실질적으로 0이 아니다. 이건 사실 1이다. 여러분이 타이머의 딜레이를 <code class=\"language-text\">1ms</code>보다 작거나 <code class=\"language-text\">2147483647ms</code>보다 크게 설정하면 딜레이는 자동으로 <code class=\"language-text\">1</code>로 세팅된다. 그렇기 때문에 <code class=\"language-text\">setTimeout</code>의 딜레이를 <code class=\"language-text\">0</code>으로 설정하려고 한다면 이 딜레이는 자동으로 <code class=\"language-text\">1</code>이 되는 것이다.</p>\n<p>이미 설명했던 대로 <code class=\"language-text\">setImmediate</code>을 사용하면 타이머를 사용할 때처럼 딜레이의 시간이 지났지 뭐니 하는 추가적인 체크 로직이 필요없어진다. 그래서 <code class=\"language-text\">setImmediate</code>은 빠른 것이다. 또한 <code class=\"language-text\">setImmediate</code>의 체크 작업은 Poll phase 직후에 수행되기 때문에 HTTP 요청 콜백과 같은 곳에서 사용된 <code class=\"language-text\">setImmediate</code>의 콜백 함수는 바로 실행된다고 할 수 있다.</p>\n<h3 id=\"왜-setimmediate는-immediate즉시라고-부르는-건가요\" style=\"position:relative;\">왜 setImmediate는 Immediate(즉시)라고 부르는 건가요?<a href=\"#%EC%99%9C-setimmediate%EB%8A%94-immediate%EC%A6%89%EC%8B%9C%EB%9D%BC%EA%B3%A0-%EB%B6%80%EB%A5%B4%EB%8A%94-%EA%B1%B4%EA%B0%80%EC%9A%94\" aria-label=\"왜 setimmediate는 immediate즉시라고 부르는 건가요 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><code class=\"language-text\">setImmediate</code>와 <code class=\"language-text\">process.nextTick</code> 모두 이름이 잘못 되었다고 생각한다. 사실 <code class=\"language-text\">setImmediate</code>은 한번의 Tick 또는 루프가 돌 때마다 관리되고, <code class=\"language-text\">nextTick</code>은 한 페이즈에서 다음 페이즈로 넘어가는 매 Tick마다 최대한 빨리 호출되도록 작동하고 있다. 그래서 기능적으로는 <code class=\"language-text\">setImmediate</code>이 <code class=\"language-text\">nextTick</code>이라는 이름이 더 잘 어울리고 <code class=\"language-text\">nextTick</code>이 진짜로 즉시(Immediately) 호출되는 친구다. 😛</p>\n<h3 id=\"자바스크립트는-block-될-수-있는-건가요\" style=\"position:relative;\">자바스크립트는 Block 될 수 있는 건가요?<a href=\"#%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%8A%94-block-%EB%90%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EA%B1%B4%EA%B0%80%EC%9A%94\" aria-label=\"자바스크립트는 block 될 수 있는 건가요 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이미 위에서 설명했듯이 <code class=\"language-text\">nextTickQueue</code>는 콜백 실행에 있어서 어떤 제한도 가지고 있지 않다. 그렇기 때문에 만약 <code class=\"language-text\">process.nextTick()</code>이 재귀 호출된다면, 여러분의 프로그램은 다른 페이즈들의 큐가 어떤 콜백을 가지고 있든간에 절대 그 작업에서 빠져나오지 못할 것이다.</p>\n<h3 id=\"만약-exit-callback-phase에서-settimeout을-호출하면-어떻게-되나요\" style=\"position:relative;\">만약 Exit callback phase에서 setTimeout을 호출하면 어떻게 되나요?<a href=\"#%EB%A7%8C%EC%95%BD-exit-callback-phase%EC%97%90%EC%84%9C-settimeout%EC%9D%84-%ED%98%B8%EC%B6%9C%ED%95%98%EB%A9%B4-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%90%98%EB%82%98%EC%9A%94\" aria-label=\"만약 exit callback phase에서 settimeout을 호출하면 어떻게 되나요 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>뭐, 타이머 자체는 시작될 수 있겠지만 <code class=\"language-text\">setTimeout</code>의 콜백은 절대 호출되지 않을 것이다. 이미 Node.js가 Exit callbacks에 들어와 있다는 것은 이미 이벤트 루프에서 빠져나왔다는 것을 의미한다.</p>\n<h2 id=\"짧은-정리들\" style=\"position:relative;\">짧은 정리들<a href=\"#%EC%A7%A7%EC%9D%80-%EC%A0%95%EB%A6%AC%EB%93%A4\" aria-label=\"짧은 정리들 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<hr>\n<ul>\n<li>이벤트 루프는 작업 스택을 가지고 있지 않다.</li>\n<li>이벤트 루프가 별도의 스레드에서 실행되고 자바스크립트 실행은 어떤 큐에서 하나씩 꺼내와서 다른 곳에서 하는 것이 아니라 자바스크립트의 실행 자체가 이벤트 루프 안에서 수행되는 것이다.</li>\n<li><code class=\"language-text\">setImmediate</code>는 콜백을 작업 큐의 앞 쪽에 밀어넣는 것이 아니라 <code class=\"language-text\">setImmediate</code> 만을 처리하기 위한 전용 페이즈와 큐가 존재한다.</li>\n<li><code class=\"language-text\">setImmediate</code>은 실질적으로 다음 페이즈 혹은 다음 이벤트 루프의 순회에서 실행되고, <code class=\"language-text\">nextTick</code>이 오히려 실질적으로 더 빠르게 실행된다.</li>\n<li><code class=\"language-text\">nextTickQueue</code>에 담긴 작업이 재귀 호출을 수행하는 경우 Node.js의 작업 프로세스를 블록킹할 수 있다. 주의하도록 하자.</li>\n</ul>\n<hr>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>필자는 Node.js 코어 개발 팀이 아니다. 이 포스팅에 관한 필자의 모든 지식은 실험과 다른 포스팅들을 통해 얻은 것이다. 필자가 이 지식들을 얻기 위해 가장 큰 도움을 준 <a href=\"https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/\" target=\"_blank\" rel=\"nofollow\">Node.js 공식 문서</a>에 감사한다.\n두 번째로 도움이 많이 된 포스트는 Saúl Ibarra Corretgé의 <a href=\"https://www.youtube.com/watch?v=sGTRmPiXD4Y\" target=\"_blank\" rel=\"nofollow\">talk on libUV</a> 포스팅이다.\n그리고 세 번째로 VoidCanvas 독자 분들 덕분에 이런 건강한 토론과 실험, 관찰을 할 수 있도록 된 것에 감사한다. 🙂</p>","fields":{"slug":"20190801-nodejs-event-loop-workflow","path":"/2019/08/01/nodejs-event-loop-workflow/","lang":"ko"},"frontmatter":{"title":"[번역] 로우 레벨로 살펴보는 Node.js 이벤트 루프","subTitle":null,"date":"Aug 01, 2019","categories":["프로그래밍","자바스크립트"],"tags":["JavaScript","자바스크립트","NodeJS","Event Loop","이벤트 루프","자바스크립트 기초"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/a66907e81a18b740cc994295cd1668d5/3a812/thumbnail.jpg","srcSet":"/static/a66907e81a18b740cc994295cd1668d5/3a812/thumbnail.jpg 320w,\n/static/a66907e81a18b740cc994295cd1668d5/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/a66907e81a18b740cc994295cd1668d5/fc5c5/thumbnail.webp 320w,\n/static/a66907e81a18b740cc994295cd1668d5/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/a66907e81a18b740cc994295cd1668d5/2d839/thumbnail.jpg","srcSet":"/static/a66907e81a18b740cc994295cd1668d5/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/a66907e81a18b740cc994295cd1668d5/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"e3624062-42a7-55d1-9b63-092fe3cba25c","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%9A%A9%EC%96%B4%EC%99%80-%EA%B0%9C%EB%85%90-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0\">용어와 개념 알아보기</a></p>\n<ul>\n<li><a href=\"#merge-conflict\">Merge Conflict</a></li>\n<li><a href=\"#%EC%97%AC%EB%9F%AC-%EA%B0%9C%EC%9D%98-branch%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0\">여러 개의 Branch를 사용하는 이유</a></li>\n<li><a href=\"#%EC%A0%84%EB%9E%B5%EC%A0%81%EC%9D%B8-%EB%B8%8C%EB%9E%9C%EC%B9%98-%EA%B4%80%EB%A6%AC-git-flow\">전략적인 브랜치 관리, Git flow</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%91%90-%EA%B0%9C%EC%9D%98-%EB%B8%8C%EB%9E%9C%EC%B9%98%EB%A5%BC-%ED%95%A9%EC%B3%90%EB%B3%B4%EC%9E%90\">두 개의 브랜치를 합쳐보자</a></p>\n<ul>\n<li><a href=\"#merge\">Merge</a></li>\n<li><a href=\"#merge-squash\">Merge squash</a></li>\n<li><a href=\"#rebase\">Rebase</a></li>\n<li><a href=\"#cherry-pick\">Cherry Pick</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9E%91%EC%97%85%ED%95%98%EB%8D%98-%EC%82%AC%ED%95%AD%EC%9D%84-%EC%9E%84%EC%8B%9C%EB%A1%9C-%EC%A0%80%EC%9E%A5%ED%95%B4%EB%B3%B4%EC%9E%90\">작업하던 사항을 임시로 저장해보자</a></p>\n<ul>\n<li><a href=\"#stash\">Stash</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B4%EB%AF%B8-%EC%BB%A4%EB%B0%8B%ED%95%9C-%EB%82%B4%EC%9A%A9-%EB%90%98%EB%8F%8C%EB%A6%AC%EA%B8%B0\">이미 커밋한 내용 되돌리기</a></p>\n<ul>\n<li><a href=\"#reset\">Reset</a></li>\n<li><a href=\"#revert\">Revert</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 저번 포스팅인 Git 뉴비를 위한 기초 사용법 - 시작하기에서 설명했던 기본적인 명령어보다 좀 더 나아가서 몇 가지 개념과 명령어를 더 공부해보려고 한다. 저번 포스팅에서는 리모트 서버에서 소스를 클론하고 수정한 후 다시 리모트 서버에 업데이트하는 과정에 대해 집중해서 설명했다면 이번 포스팅에서는 Git의 메인 주제인 버전 관리에 대해 더 다뤄볼 예정이다.","html":"<p>이번 포스팅에서는 저번 포스팅인 <a href=\"/2019/07/25/git-tutorial\">Git 뉴비를 위한 기초 사용법 - 시작하기</a>에서 설명했던 기본적인 명령어보다 좀 더 나아가서 몇 가지 개념과 명령어를 더 공부해보려고 한다.</p>\n<p>저번 포스팅에서는 리모트 서버에서 소스를 클론하고 수정한 후 다시 리모트 서버에 업데이트하는 과정에 대해 집중해서 설명했다면 이번 포스팅에서는 Git의 메인 주제인 버전 관리에 대해 더 다뤄볼 예정이다.</p>\n<!-- more -->\n<p>그럼 저번 포스팅과 마찬가지로 간단한 용어와 개념에 대한 설명한 후, 그 개념들을 사용하기 위한 명령어를 설명하도록 하겠다.</p>\n<h2 id=\"용어와-개념-알아보기\" style=\"position:relative;\">용어와 개념 알아보기<a href=\"#%EC%9A%A9%EC%96%B4%EC%99%80-%EA%B0%9C%EB%85%90-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0\" aria-label=\"용어와 개념 알아보기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Git은 버전을 효율적으로 관리하기 위해 몇 가지 개념을 제시하고 있다. 현재 나의 버전 상태를 의미하는 HEAD, 작업 공간인 브랜치(Branch), 브랜치를 합치는 머지(Merge)와 리베이스(Rebase)등이 그렇다.</p>\n<p>그리고 이런 기능들을 사용하다보면 가끔 Git의 에러와 마주하게 되는데, 필자같은 경우는 처음 개발자로 일을 시작했을 때 코딩하다가 발생하는 에러보다 Git에서 발생하는 에러가 더 무서웠던 기억이 있다.</p>\n<p>솔직히 코딩하다가 나는 에러는 고치는 과정이 쉽든 어렵든간에 그냥 필자가 고치면 해결되지만, Git에서 나는 에러는 고친답시고 이것 저것 건드리다가 잘못 건드리면 왠지 소스가 가루가 되어 날아갈 것 같아서 무서웠다.</p>\n<p>하지만 Git을 사용한 지 6년쯤 지난 지금 다시 그때를 생각해보면 Git에 대해서 잘 몰랐기 때문에 더 무서웠던 것 같다. 내가 어떤 기능을 사용했을 때 소스가 어떻게 되는 지 정확히 알고 있지 않은 상태였기 때문에 그런 걱정도 들었던 것이다. 혹시 이 글을 읽는 독자 분들 중에서도 필자와 같은 경험이나 생각을 하신 분들이 있을 것이기 때문에 필자가 알고 있는 Git의 개념들을 최대한 알기 쉽게 풀어보려고 한다.</p>\n<h3 id=\"merge-conflict\" style=\"position:relative;\">Merge Conflict<a href=\"#merge-conflict\" aria-label=\"merge conflict permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>필자 생각에 Git을 사용하다가 가장 많이 마주치는 에러는 아무래도 머지 컨플릭트(Merge Conflict)인 것 같다. 한국어로 직역하면 병합 충돌이지만, 다들 “머지 컨플릭트 났다” 또는 그냥 “컨플릭트 났다”라고 한다.</p>\n<p>머지 컨플릭트는 에러라고 하기에는 조금 애매하긴 하지만 어쨌든 정상은 아닌 상황이기 때문에 처음 마주하면 굉장히 당황스럽고 뭐가 뭔지 헷갈린다. 컨플릭트는 말 그대로 소스의 충돌이 발생한 상황이기 때문에 주니어든 시니어든 가리지 않고 평등하게 발생하고, 또한 평등하게 당황하게 된다.</p>\n<p>왜냐면 컨플릭트는 논리적인 에러가 아니라 내 작업물과 다른 사람의 작업물이 충돌한 상황이기 때문에 스스로 혼자 해결하기 힘든 경우가 많기 때문이다. 그럼 컨플릭트, 즉 충돌이 정확히 어떤 상황을 말하는지 알기 위해 실제 협업 상황에서 발생할 수 있는 예시를 함께 살펴보자.</p>\n<blockquote>\n<p>철수와 영희는 사장님으로부터 지각한 사람의 명단을 만들어서 관리해 달라는 부탁을 받았다. 그래서 철수와 영희는 다음과 같은 텍스트 파일을 만들어서 지각자를 관리하기 시작했다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">7월 25일 지각자 명단\n\n나연\n채영\n사나\n쯔위</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>자, 이제 철수와 영희는 사장님으로부터 지각자를 관리할 수 있는 권력을 부여받았고, 매일 이 파일에 지각자를 입력해야한다. 하지만 철수와 영희는 별로 사이가 안 좋기 때문에 이 둘은 서로 커뮤니케이션을 하지 않고 각자 맘대로 파일을 수정하는 방식으로 지각자 입력 작업을 진행하게 된다.</p>\n<p>그러던 중 철수와 영희는 사무실에 심어놓은 자신들의 정보원으로부터 7월 25일의 세번째 지각자인 “사나”가 사실 지각이 아니였다는 정보를 입수했다. 근데 문제는 이 정보원들이 가져온 정보가 서로 달랐던 것이다.</p>\n<p><strong>철수의 정보원:</strong> 야 7월 25일에 지각한 사람 있잖아, 사나가 아니고 미나래!<br />\n<strong>영희의 정보원:</strong> 영희야, 7월 25일에 사나가 지각한게 아니고 지효가 지각한거라는데?</p>\n<p>…</p>\n<p>이 둘은 자신의 정보원을 100% 신뢰하기 때문에 바로 각자 지각자 명단 파일을 수정하기 시작했다.</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>시간</th>\n<th>철수</th>\n<th>영희</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td><code class=\"language-text\">지각자.txt</code>의 <code class=\"language-text\">사나</code>를 <code class=\"language-text\">미나</code>로 변경</td>\n<td><code class=\"language-text\">지각자.txt</code>의 <code class=\"language-text\">사나</code>를 <code class=\"language-text\">지효</code>로 변경</td>\n</tr>\n<tr>\n<td>2</td>\n<td>리모트 저장소에 변경 사항 커밋 후 푸쉬</td>\n<td>계속 작업 중</td>\n</tr>\n<tr>\n<td>3</td>\n<td>철수 퇴근 >_&#x3C;</td>\n<td>작업을 마치고 리모트 저장소에 푸쉬 시도</td>\n</tr>\n<tr>\n<td>4</td>\n<td></td>\n<td>리모트 저장소의 상태가 갱신되었으니 Pull부터 하라는 에러 발생. 엥?</td>\n</tr>\n<tr>\n<td>5</td>\n<td></td>\n<td>리모트 저장소의 변경 사항을 로컬로 Pull함</td>\n</tr>\n<tr>\n<td>6</td>\n<td></td>\n<td>철수가 수정한 부분과 영희가 수정한 부분이 충돌!</td>\n</tr>\n</tbody>\n</table>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">From https://github.com/evan-moon/conflict-test\n * branch            test       -> FETCH_HEAD\nAuto-merging 지각자.txt\nCONFLICT (content): Merge conflict in 지각자.txt\nAutomatic merge failed; fix conflicts and then commit the result.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이렇게 다른 사람과 내가 같은 부분을 수정하게 되면, Git은 어떤 것이 맞는 소스인지 알 방법이 없다. 이런 상황에서 Git은 어떤 부분이 충돌났는지 표시하여 사용자에게 알려주기만 하고 나머지는 사용자가 알아서 수정하라고 맡겨버리는데, 이런 상황이 바로 머지 컨플릭트이다.</p>\n<p>철수와 영희 처럼 같은 브랜치에서 작업한다는 것은 소스의 변경 사항을 계속 히스토리를 공유한다는 것이다. 즉, 주기적으로 리모트 저장소로부터 상대방이 작업한 것을 Pull로 가져와서 내 로컬 브랜치에 병합해야한다는 것인데, 이 과정에서 충돌이 발생할 가능성이 높다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">7월 25일 지각자 명단\n\n나연\n채영\n&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\n지효\n=======\n미나\n>>>>>>> 35058b46325bb61112efd52f4019f907c561328d\n쯔위</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이때 <code class=\"language-text\">&lt;&lt;&lt; HEAD</code>와 <code class=\"language-text\">===</code>사이에 들어있는 상단 부분이 현재 브랜치에서 내가 수정한 내용이다. 영희는 <code class=\"language-text\">사나</code>를 <code class=\"language-text\">지효</code>로 수정했기 때문에 해당 부분에 <code class=\"language-text\">지효</code>라는 이름이 들어가 있다.</p>\n<p>그리고 <code class=\"language-text\">===</code>부터 <code class=\"language-text\">>>> 커밋 해쉬</code>사이의 내용은 어떤 커밋에서 수정된 내용과 충돌이 발생했는지 알려준다. 이 예시에서는 철수가 <code class=\"language-text\">사나</code>를 <code class=\"language-text\">미나</code>로 수정한 부분이 될 것이다.</p>\n<p>Git은 그냥 버전 관리만 해주는 친구이기 때문에 이런 상황에서 “사나는 사실 지각자가 아니였기 때문에 다른 사람으로 변경해야했다”와 같은 비즈니스 히스토리는 모른다. 그렇기 때문에 Git은 둘 중에 어떤 것이 맞는 소스인지도 당연히 모를 수 밖에 없다. 그래서 사용자에게 선택을 맡기는 것이다. 이 상황에서 영희는 다음 세가지 선택지를 가질 수 있다.</p>\n<blockquote>\n<ol>\n<li>철수의 변경 사항을 무시<br /></li>\n<li>자신의 변경 사항을 무시<br /></li>\n<li>두 변경 사항 모두 반영</li>\n</ol>\n</blockquote>\n<p>보통 이런 상황에서는 철수를 불러서 <code class=\"language-text\">사나</code> 대신 <code class=\"language-text\">미나</code>를 추가한 이유가 무엇인지 물어본 다음 결정해야하지만 영희는 철수와 사이가 좋지 않으니 그냥 철수의 커밋을 날려버릴 수도 있겠다.</p>\n<h3 id=\"여러-개의-branch를-사용하는-이유\" style=\"position:relative;\">여러 개의 Branch를 사용하는 이유<a href=\"#%EC%97%AC%EB%9F%AC-%EA%B0%9C%EC%9D%98-branch%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0\" aria-label=\"여러 개의 branch를 사용하는 이유 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>브랜치(Branch)는 <a href=\"/2019/07/25/git-tutorial\">저번 포스팅</a>에서 한번 간단하게 설명했다. 이미 저번 포스팅에서 기초적인 브랜치의 개념에 대해서 한번 언급하고 넘어갔기 때문에 이번에는 “왜 여러 개의 브랜치를 사용해야 하는가?”에 대한 이야기를 해보려고 한다.</p>\n<p>기본적으로 Git은 혼자 만의 작업이 아닌 여러 명이 함께 작업하는 협업 상황을 상정하고 만들어졌다. 아무리 Git이 리모트 레파지토리와 로컬 레파지토리로 소스를 분산해서 관리하는 분산 버전 관리 시스템이지만 여러 사람이 한번에 같은 어플리케이션의 코드를 수정하고 있는 상황에서는 방금 위에서 설명한 머지 컨플릭트가 자주 발생하게된다. 그래서 보통 사용자들은 브랜치로 주제에 맞는 작업 공간을 따로 나누어서 히스토리를 관리하는 것이다.</p>\n<p>이렇게 브랜치를 나누어도 결국 언젠가 소스를 병합해야 하기 때문에 컨플릭트가 발생할 확률은 있지만 적어도 작업 중간중간에 계속 해서 컨플릭트를 수정해야하는 일은 많이 줄일 수 있다.</p>\n<p>그래서 개발자들은 “어떻게 해야 효율적으로 여러 개의 브랜치를 관리할 수 있을까?”라는 고민을 하게 되는데, 이때 나온 것이 바로 브랜치 전략이다. 브랜치 전략 중 대표적인 것은 Git flow가 있는데, 이건 그냥 유명한 전략 중 하나일 뿐이기 때문에 어떤 브랜치 전략을 가져갈 것인지는 그 조직이 결정하면 된다.</p>\n<p>그럼 브랜치 전략이 어떤 것인지 알아보기 위해 대표적인 브랜치 전략인 Git flow를 한번 간략하게 살펴보도록 하자.</p>\n<h3 id=\"전략적인-브랜치-관리-git-flow\" style=\"position:relative;\">전략적인 브랜치 관리, Git flow<a href=\"#%EC%A0%84%EB%9E%B5%EC%A0%81%EC%9D%B8-%EB%B8%8C%EB%9E%9C%EC%B9%98-%EA%B4%80%EB%A6%AC-git-flow\" aria-label=\"전략적인 브랜치 관리 git flow permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Git flow는 기본적으로 <code class=\"language-text\">master</code>와 <code class=\"language-text\">develop</code> 브랜치를 가지고 시작하게 된다. 이때 <code class=\"language-text\">master</code>는 항상 운영되고 있는 소스의 상태를 가지고 있어야하며, 절대 <code class=\"language-text\">master</code> 브랜치에는 바로 커밋을 할 수 없다. 그리고 <code class=\"language-text\">develop</code> 브랜치는 팀이 현재 개발을 진행하고 있는 브랜치이다. 그리고 <code class=\"language-text\">develop</code> 브랜치에서 각자 개발을 맡고 있는 기능 별로 <code class=\"language-text\">feature</code> 브랜치를 생성해서 실제 개발을 진행하게 된다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/36200b7d3489370e101d9715d3b4da42/d3deb/git-flow1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 78.75000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACFUlEQVR42oWUW2/bMAyF8///04BhwLCH7mndBVixFp1jx5f4Eju2LEvW2aGpNEPXdiq+kGaNI4qkvIOsL7eA8ZsLOwP5HmgqoC6Vtr4+iz21wJF+VyviHwtg6LHbRO7ugXRlkP4aKLoAzivGKXPECpe419hCvOBVMGS/RYnCNNwMTAB5tBfOkZGcSEOYHHri8LQ0w4efCOBunbxM4dkAEzE8/hKxJvpWrYvWRry/CtY375j5qLu13K6VWvH8HdNoScNU6qP6l5jUUWxdaY0liYvgmNzhW/UdgRn6fsUQJgwLcRPmdWGp7MYUkZhd3eYb+i6s1yMH+T2kuEk/w9b8Z++QmxxZnyE/52hMi2qsUI4lqdBMDVrG6rFGMRQozyUGOzyrYZbg8fSIdc+deAKwJBhiA6Zox9gAiVu8uqLgXgWLdetecAHBEEuW6I+RKcae/f0r2FMwWbdxCS1faUhHejIEjQl10DGa38yQR+4oWAUdHVleR/OJy7OLfnhFcIvnKT4mn2APbMrgkI0HFCz2YdCm1GyENCXtUxS0xpm3a9j9+IqH2/tt8qUeC0fCBb9ZzyvlVr+NxiUe8J+mmA/v4c2iEbkJ8gH4m77VgZYhPub6QfDuZcE5yVjkSnflTwjy7sqbxYx4+a1YK8/MeOazUbv6l/PcJb+MqsRlmWAhN49JNY1y4seg5wy2bFgpX7FGr/lLgn8Al0LhVInUpw0AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"git flow1\" title=\"\" src=\"/static/36200b7d3489370e101d9715d3b4da42/6af66/git-flow1.png\" srcset=\"/static/36200b7d3489370e101d9715d3b4da42/69538/git-flow1.png 160w,\n/static/36200b7d3489370e101d9715d3b4da42/72799/git-flow1.png 320w,\n/static/36200b7d3489370e101d9715d3b4da42/6af66/git-flow1.png 640w,\n/static/36200b7d3489370e101d9715d3b4da42/d9199/git-flow1.png 960w,\n/static/36200b7d3489370e101d9715d3b4da42/21b4d/git-flow1.png 1280w,\n/static/36200b7d3489370e101d9715d3b4da42/d3deb/git-flow1.png 1758w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>모바일에서는 이 그래프의 내용이 잘 안보일 수 있으니 브랜치 이름에 색을 입혀서 설명하도록 하겠다.</p>\n<p>이 그래프를 보면 <strong><font color=\"blue\">master</font></strong> 브랜치에 프로젝트의 시작을 의미하는 커밋이 찍힌 후 <strong><font color=\"red\">develop</font></strong> 브랜치가 생성되었고, <strong><font color=\"red\">develop</font></strong> 브랜치에서부터 기능 개발을 담당하는 브랜치들이 분기하고 있는 모습을 볼 수 있다.</p>\n<p>에반은 <strong><font color=\"green\">feature/add-typescript</font></strong> 브랜치를 생성한 후 어플리케이션에 타입스크립트를 붙히는 작업을 하고, 다니엘은 <strong><font color=\"magenta\">feature/social-login</font></strong> 브랜치를 생성한 후 소셜 로그인 연동 작업을 하고 있다. 그 후 개발이 끝나는 대로 <strong><font color=\"red\">develop</font></strong> 브랜치에 해당 브랜치들을 차례로 머지하고 있는 모습을 볼 수 있다.</p>\n<p>다니엘이 에반보다 <strong><font color=\"red\">develop</font></strong> 브랜치에 머지한 시점이 늦기 때문에 만약 에반과 다니엘이 같은 부분을 변경했다면 이때 컨플릭트가 발생하게 된다. 하지만 적어도 에반과 다니엘이 각자 기능을 개발하고 있을때는 컨플릭트가 발생하지 않기 때문에 좀 더 기능 개발에 집중할 수 있게 되는 것이다.</p>\n<p>이렇게 개발을 쭉쭉 진행하다가 배포를 해야할 시점이 오면 <strong><font color=\"blue\">master</font></strong> 브랜치로부터 <code class=\"language-text\">release</code>브랜치를 생성한다. 필자의 직장같은 경우는 <code class=\"language-text\">release/release-1.0.0</code>과 같이 배포 버전을 브랜치 이름에 표기하는 네이밍 컨벤션을 따르고 있다. 이 <code class=\"language-text\">release</code> 브랜치는 온전히 배포 만을 위한 브랜치이기 때문에 해당 버전의 배포가 끝나면 버려진다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/fcb2177c59a4abcc0f9eabce70541126/24def/git-flow2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 83.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAACX0lEQVR42n2U607cMBCF9/0fpD/6LlURohRVhRYW2JBs7hfnZp9+tgN01bKRjmYyjs/cs9vf1dLayS2j5Kyck9pO+nIhffrsVHGcHaWijPB6ja1upLxQOPf2I/YG2y4/ztKcy01YTSINR1nI3dhg63FmcDYgxw1TsAW71xd/DizBCMISHomXlsv774RwTaRcGDM+xuUMphxZR3jbG7ytirCzJ4IwxevVpVzjPyZXw+W2JSc+KtEr8mrQ6zLqbR3fA9B9RB7zK+EzJA8HOWqgitQmlJ7DFkdmibrHAMwm32xLJFqAL34kJNU2k4NXt0OopwhQOR8QQND9GUcym+5Rb9Lq5NmVjxT/+VbOR5xtERpkR0o9Z6aVG5B9jd5FfcA2Rl09Htf1nbAiwuz3V/U+/IzuQugM3eu7ADcQ1oCDnkxede/wzdafEjbJpDr9qevDHWnOgfA41nrqDnoZMuWmRB6Vjjn2UsVYqeQ8xZaZQqMfnb9Trg9GY/6gl5xOPU2B0NIPO6yyxqJbrehrH2ENsOgb3NaMU8Jir7SgZvuYciy+e29EvzWn2ZpzyvG/CCHMadtDjDBcrl2U/dbNdutstTn5kDDxhPdKCsYliYTr7Bh80llIeaHgq2MK7Ab3z6icELbJqDL5oZvbX2z5LDtlKueOotMEGlLPLY2oQwNStqj3e33m2VWHTsXFpYYctxO5mBRQy87PXxfGwo1DlMFGDezHIe6Km3tqd8XfggJ1ezYlzl/Y1a4Jwx1mzQ+w32NvO0f4+O3ALlbxf6i4kgX3cvgq7jZwl8gsj7Z5OZux/gDdKC3oLuGzeQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"git flow2\" title=\"\" src=\"/static/fcb2177c59a4abcc0f9eabce70541126/6af66/git-flow2.png\" srcset=\"/static/fcb2177c59a4abcc0f9eabce70541126/69538/git-flow2.png 160w,\n/static/fcb2177c59a4abcc0f9eabce70541126/72799/git-flow2.png 320w,\n/static/fcb2177c59a4abcc0f9eabce70541126/6af66/git-flow2.png 640w,\n/static/fcb2177c59a4abcc0f9eabce70541126/d9199/git-flow2.png 960w,\n/static/fcb2177c59a4abcc0f9eabce70541126/21b4d/git-flow2.png 1280w,\n/static/fcb2177c59a4abcc0f9eabce70541126/24def/git-flow2.png 1812w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>개발이 종료되고 <code class=\"language-text\">1.0.0</code> 버전을 배포하기 위해 <strong><font color=\"blue\">master</font></strong> 브랜치로부터 <strong><font color=\"orange\">release/release-1.0.0</font></strong> 브랜치를 하나 생성했다.</p>\n<p>그 후 다음 버전에 배포될 기능들을 가지고 있는 <strong><font color=\"red\">develop</font></strong> 브랜치를 <strong><font color=\"orange\">release/release-1.0.0</font></strong> 브랜치에 머지하고 스테이징 서버에 배포하는 등 최종 테스트를 한 다음, 조직원 모두가 해당 버전의 배포에 동의한다면 <strong><font color=\"blue\">master</font></strong> 브랜치에 해당 브랜치를 머지하고 버전명으로 태그를 단다.</p>\n<p>이때 이런 궁금증이 생기는 분이 있을 것이다.</p>\n<blockquote>\n<p>그럼 핫픽스는 어떻게 하나요? develop 브랜치에서 브랜치를 분기하면 현재 버전의 기능 개발이 끝날 때까지 기다려야하는데…</p>\n</blockquote>\n<p>이런 경우 <code class=\"language-text\">develop</code> 브랜치에서 <code class=\"language-text\">hotfix</code> 브랜치를 분기하여 <code class=\"language-text\">master</code>로 머지 후 긴급 배포를 하게되면 <code class=\"language-text\">develop</code> 브랜치에 들어있는 아직 배포되지 말아야할 기능들까지 배포되기 때문에, 핫픽스는 예외적으로 <code class=\"language-text\">master</code>에서 분기해서 다시 <code class=\"language-text\">master</code>로 머지할 수 있다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/6ce98c7e9ed5003464a381a69b640a7e/52ab5/git-flow3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 101.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC30lEQVR42n1V23LTMBTM//8QD7wz8MRQoGHapmmTJnEcy7ZkW5Z80bLHctoUCJk5cy6SVqujtbLYrGuEJgW6imaA0GMYgMYCnz4Dt78A2wKlBuoa0JxS1bFmGNcNPZdqjluuWaTECmMfwTrOzB644gXoGfcKGOk9fVcw56rezDbHXTkTIQsI4IlxxUJOZJUTkGCG5huMlSJ7g9AKJdKgD20z+WgSxzrGGfB48Ajf78iZLEMABp7FZgTlpIZWV9Eklo3ryzq90bE+nAE3Fv1qxSYxY50UCEjahgVNxpU0T4BkYRm9KaKfWV3+Fve3LfTTnv0gViIlAjYZRp4m1B2C5UAjt9RzL8bMpY5a8sD+C4kLwGTrENSOk3j0NRl4gvtqwoXmTJ4KTdzn1SSvZj/+wXD5NYV9uuFENl/ZabuWO3/4CLwQu+RpdRVNYmmtppXV7HnysnxtIRarXwrJ3RLHQ4HDMkHr7XSMx8eW/XYE97wDB9vQrJiPMa2p22ms799oLtKdw6iOCGxLdp9itV5NA4VWyHJFVoYsNAVtKOCKoq4nL1aUsT4MwwXg1sKvl+TMU+8tTvlpGgiFijctkhA7y6Oec5HNWQEXt73I9j2Omx/IOej3DqlKpwFPsXoKt3MtHL1jLt47i8639LE2dD7q9wyoCGgOazycNugT/wp4pBYPTQLlcmQtzSnkrkDpNQxVkNsCiuYH//6Ws11HHW+h2I9uRcAiAgYToizE5PLrWfgil7/1/B6wJWCmS3TPPHIeAcdmjMJ1s0lsZ+tpl2r+N0OD7sG9MTyLur5gKOz0nF9jOPXwyB4en9Ht/estS++kZ9ob1HzWpHeKueG7eY1dZHjokS2XKBIDTyGnp8jQ8bly7nyrjj7edscc43gdMHnSaG++UVoNdocdPyMdj1ye4usiL4vorTExLvkCcYOrgD+/7LDfbqYvoOW7HqgpISDfbdVEk78D+ZYL1lqP//5+A7ivEsXg5u07AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"git flow3\" title=\"\" src=\"/static/6ce98c7e9ed5003464a381a69b640a7e/6af66/git-flow3.png\" srcset=\"/static/6ce98c7e9ed5003464a381a69b640a7e/69538/git-flow3.png 160w,\n/static/6ce98c7e9ed5003464a381a69b640a7e/72799/git-flow3.png 320w,\n/static/6ce98c7e9ed5003464a381a69b640a7e/6af66/git-flow3.png 640w,\n/static/6ce98c7e9ed5003464a381a69b640a7e/d9199/git-flow3.png 960w,\n/static/6ce98c7e9ed5003464a381a69b640a7e/21b4d/git-flow3.png 1280w,\n/static/6ce98c7e9ed5003464a381a69b640a7e/52ab5/git-flow3.png 1420w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>그래프가 조금 복잡해졌지만 검정색 라인인 <strong>hotfix/fix-main-page</strong>에만 집중해보자. <strong><font color=\"blue\">master</font></strong> 브랜치로부터 갈라져나와서 한 개의 커밋이 찍히고 다시 <strong><font color=\"blue\">master</font></strong> 브랜치로 머지되는 것을 볼 수 있다. 이때는 정식 릴리즈가 아닌 핫픽스 릴리즈이므로 <a href=\"https://semver.org/lang/ko/\" target=\"_blank\" rel=\"nofollow\">Sementic Version</a> 룰에 따라 <code class=\"language-text\">0.0.1</code> 버전의 태그를 달아주었다.</p>\n<p><strong>hotfix/fix-main-page</strong> 브랜치가 머지되고 배포가 되었다는 것은 현재 운영 환경에서 돌아가고 있는 소스가 변경되었다는 것이므로 <strong><font color=\"red\">develop</font></strong> 브랜치에도 해당 변경 사항을 반영해줘야한다.</p>\n<p>그렇기 때문에 핫픽스 담당자는 배포를 하고 나면 <code class=\"language-text\">develop</code> 브랜치를 직접 최신화하는 것이 좋다. 그리고 동료들에게 “지금 핫픽스 배포가 끝났으니 각자 작업하시는 브랜치에서 develop 브랜치를 Pull하여 최신화 해주세요~“라고 알려주면 더더욱 좋을 것이다.</p>\n<p>물론 이런 복잡한 브랜치 전략 없이도 그냥 잘 돌아가는 조직도 있다. 하지만 같은 소스를 만지는 개발자가 많아지면 많아질수록 어느 정도의 룰조차 없다면 원활한 협업이 진행되기는 힘들 수도 있기 때문에 대부분의 규모있는 조직에서는 각자의 상황에 맞는 브랜치 전략을 세워서 버전 관리를 진행하고 있다.</p>\n<p>브랜치를 왜 하나로만 운영하지 않는지 이해가 되었다면, 이제 이 브랜치와 버전 히스토리들을 가지고 놀 수 있는 몇 가지 유용한 기능들을 더 살펴보도록 하자.</p>\n<h2 id=\"두-개의-브랜치를-합쳐보자\" style=\"position:relative;\">두 개의 브랜치를 합쳐보자<a href=\"#%EB%91%90-%EA%B0%9C%EC%9D%98-%EB%B8%8C%EB%9E%9C%EC%B9%98%EB%A5%BC-%ED%95%A9%EC%B3%90%EB%B3%B4%EC%9E%90\" aria-label=\"두 개의 브랜치를 합쳐보자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>각자의 브랜치에서 작업을 계속 진행하다보면 언젠가 두 브랜치를 합쳐야 하는 날이 다가온다. 이때 두 개의 브랜치를 합치는 행위를 브랜치 병합(Branch Merge)이라고 한다.</p>\n<p>Git은 Merge, Merge and Squash, Rebase 각각 특색있는 3개의 브랜치 병합 기능을 제공한다. 결국 이 3개의 명령어 모두 두 개의 브랜치를 합친다는 행위는 같지만, 합치는 방법도 다르고 버전 히스토리도 다르게 남기 때문에 적재적소에 이 기능들을 잘 이용한다면 팀원들에게 이쁨받는 깃쟁이가 될 수 있을 것이다.</p>\n<h3 id=\"merge\" style=\"position:relative;\">Merge<a href=\"#merge\" aria-label=\"merge permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/3d89813d37e675e64e3f97f8b98c8e28/63ea1/merge_icon.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd6AsD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAADAAAAAAAAAAAAAAAAAAAAEEH/2gAIAQEABj8CKv/EABkQAQACAwAAAAAAAAAAAAAAAAEAUREhcf/aAAgBAQABPyFWmbqDmJ//2gAMAwEAAgADAAAAEHAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBAAAgICAwAAAAAAAAAAAAAAAREAIUFRYYHw/9oACAEBAAE/EGFUDhXH2NjyhEiyLmf/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"merge icon\" title=\"\" src=\"/static/3d89813d37e675e64e3f97f8b98c8e28/c08c5/merge_icon.jpg\" srcset=\"/static/3d89813d37e675e64e3f97f8b98c8e28/0913d/merge_icon.jpg 160w,\n/static/3d89813d37e675e64e3f97f8b98c8e28/cb69c/merge_icon.jpg 320w,\n/static/3d89813d37e675e64e3f97f8b98c8e28/c08c5/merge_icon.jpg 640w,\n/static/3d89813d37e675e64e3f97f8b98c8e28/63ea1/merge_icon.jpg 696w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>머지(Merge)는 제일 기본적인 브랜치 병합 기능으로, 합치려고 하는 대상 브랜치의 변경 사항을 타겟 브랜치에 모두 반영하면서 머지 커밋(Merge commit)을 남긴다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> checkout master\n$ <span class=\"token function\">git</span> merge feature</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>일반적인 머지는 이미 많은 분들이 알고 있을테니 깊게 설명하지 않고 빠르게 넘어가겠다.</p>\n<h3 id=\"merge-squash\" style=\"position:relative;\">Merge squash<a href=\"#merge-squash\" aria-label=\"merge squash permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/bc6a1dfaa1d43203ee77b5f4f1b442e1/00597/merge_squash_icon.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd6AsD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAYEAEAAwEAAAAAAAAAAAAAAAABABFRYf/aAAgBAQABPyFvGW4w6VP/2gAMAwEAAgADAAAAEHAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAQACAwAAAAAAAAAAAAAAAREAkSExQf/aAAgBAQABPxBVxK+Jm3nZvGo0V3n/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"merge squash icon\" title=\"\" src=\"/static/bc6a1dfaa1d43203ee77b5f4f1b442e1/c08c5/merge_squash_icon.jpg\" srcset=\"/static/bc6a1dfaa1d43203ee77b5f4f1b442e1/0913d/merge_squash_icon.jpg 160w,\n/static/bc6a1dfaa1d43203ee77b5f4f1b442e1/cb69c/merge_squash_icon.jpg 320w,\n/static/bc6a1dfaa1d43203ee77b5f4f1b442e1/c08c5/merge_squash_icon.jpg 640w,\n/static/bc6a1dfaa1d43203ee77b5f4f1b442e1/00597/merge_squash_icon.jpg 678w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>이번에는 두 개의 브랜치를 병합할 때 사용하는 머지 명령어의 <code class=\"language-text\">--squash</code> 옵션을 한번 알아보자. <code class=\"language-text\">--squash</code> 옵션은 해당 브랜치의 커밋 전체를 통합한 커밋을 타겟 브랜치에 머지하는 옵션이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> checkout master\n$ <span class=\"token function\">git</span> merge <span class=\"token parameter variable\">--squash</span> feature</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>일반 머지는 머지가 되는 대상 브랜치의 모든 커밋이 남아있는 상태에서 타겟 브랜치로 합쳐지지만 머지 스쿼시는 대상 브랜치의 모든 커밋을 모아서 하나의 커밋으로 합치고 타겟 브랜치에 머지하는 방식이다.</p>\n<p>사실 이 기능의 정확한 이름은 Merge “and” Squash이다. 즉, 스쿼시도 머지와 같이 독립된 하나의 개념이라는 것이다. 스쿼시는 커밋을 여러 개 합친다는 개념이기 때문에 하단에 후술할 <code class=\"language-text\">rebase</code> 명령어와 함께 사용하여 현재 브랜치의 커밋을 합칠 때도 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> rebase <span class=\"token parameter variable\">-i</span> HEAD~~</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>위 명령어는 <code class=\"language-text\">HEAD</code>부터 <code class=\"language-text\">HEAD</code>의 <code class=\"language-text\">~~(전전)</code> 커밋까지의 히스토리를 변경하겠다는 의미이다. 이 명령어를 입력하면 <code class=\"language-text\">vim</code>이 실행되고 아래와 같은 내용이 표시된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">pick 9a54fd4 commit의 설명 추가\npick 0d4a808 pull의 설명을 추가\n\n<span class=\"token comment\"># Rebase 326fc9f..0d4a808 onto d286baa</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># Commands:</span>\n<span class=\"token comment\">#  p, pick = use commit</span>\n<span class=\"token comment\">#  r, reword = use commit, but edit the commit message</span>\n<span class=\"token comment\">#  e, edit = use commit, but stop for amending</span>\n<span class=\"token comment\">#  s, squash = use commit, but meld into previous commit</span>\n<span class=\"token comment\">#  f, fixup = like \"squash\", but discard this commit's log message</span>\n<span class=\"token comment\">#  x, exec = run command (the rest of the line) using shell</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># If you remove a line here THAT COMMIT WILL BE LOST.</span>\n<span class=\"token comment\"># However, if you remove everything, the rebase will be aborted.</span>\n<span class=\"token comment\">#</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>위의 텍스트에 표시된 커밋들의 맨 앞에 있는 <code class=\"language-text\">pick</code> 문자를 <code class=\"language-text\">s</code>또는 <code class=\"language-text\">squash</code>로 변경하면 두 개의 커밋이 합쳐진다.</p>\n<h3 id=\"rebase\" style=\"position:relative;\">Rebase<a href=\"#rebase\" aria-label=\"rebase permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/40de34e1abf0e6be14897f662e2dfb2f/15ec7/rebase_icon.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 38.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAG8AD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAYEAADAQEAAAAAAAAAAAAAAAAAEWEBMf/aAAgBAQABPyHsFdHD/9oADAMBAAIAAwAAABDz7//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAHBABAAICAwEAAAAAAAAAAAAAAQARITFBUZGh/9oACAEBAAE/EC97A+z7L3BZFY57n//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"rebase icon\" title=\"\" src=\"/static/40de34e1abf0e6be14897f662e2dfb2f/c08c5/rebase_icon.jpg\" srcset=\"/static/40de34e1abf0e6be14897f662e2dfb2f/0913d/rebase_icon.jpg 160w,\n/static/40de34e1abf0e6be14897f662e2dfb2f/cb69c/rebase_icon.jpg 320w,\n/static/40de34e1abf0e6be14897f662e2dfb2f/c08c5/rebase_icon.jpg 640w,\n/static/40de34e1abf0e6be14897f662e2dfb2f/15ec7/rebase_icon.jpg 690w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>리베이스(Rebase)도 머지(Merge)와 마찬가지로 브랜치를 다른 브랜치로 합칠 수 있는 기능이다. 단 머지와 차이가 있다면 바로 합치는 방식이다. 머지는 말 그대로 두 개의 브랜치를 하나로 합치는 기능이기 때문에 A 브랜치의 변경 사항 전부를 B 브랜치에 푸쉬하는 것과 동일하다. 그렇기 때문에 머지를 사용하여 브랜치를 합치게 되면 반드시 머지 커밋(Merge commit)이 남게 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> checkout feature\n$ <span class=\"token function\">git</span> merge master</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<center>\n  <img src=\"/ffb4536f7728ae28594958aaca9659e3/merge.svg\">\n  <small>[출처] https://dzone.com/articles/merging-vs-rebasing</small>\n</center>\n<p>그렇기 때문에 머지는 어느 시점에 어떤 브랜치가 머지 되었는 지 커밋을 통해 알기 쉽다는 장점이 있다. 그러나 단점은 불필요한 커밋이 생성된다는 것이다. 이 단점은 작업 중인 브랜치가 별로 많지 않을 때는 나타나지 않지만 브랜치가 많아지면 나중엔 커밋 로그가 머지 커밋으로 뒤덮혀있는 광경을 볼 수도 있게 된다.</p>\n<p>반면 리베이스는 단순히 합치는 것이 아니라 말 그대로 브랜치의 베이스를 변경하는 것이다. 방금 전 예시의 <code class=\"language-text\">feature</code> 브랜치를 <code class=\"language-text\">master</code>로 리베이스하게 되면 마치 <code class=\"language-text\">feature</code> 브랜치의 변경 사항들이 <code class=\"language-text\">master</code>의 변경 사항이었던 것처럼 히스토리가 기록된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> checkout feature\n$ <span class=\"token function\">git</span> rebase master</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<center>\n  <img src=\"/6480d07dcea3d4a3947bd5bb43c05f49/rebase.svg\">\n  <small>[출처] https://dzone.com/articles/merging-vs-rebasing</small>\n</center>\n<p>리베이스의 장점은 바로 깔끔한 커밋 히스토리를 만들어 준다는 것이다. 머지 커밋이 남지 않고 애초에 <code class=\"language-text\">master</code>에서 수정한 것 마냥 히스토리가 남기 때문에 깔끔하게 일자로 쭉 떨어지는 이쁜 히스토리를 볼 수 있다. 하지만 리베이스의 단점은 바로 이 커밋 끼워넣기 때문에 발생하는 문제이다.</p>\n<center>\n  <img src=\"/34e0fc3447edc79347d93a96fec5ecd9/rebase-problem.svg\">\n  <small>[출처] https://dzone.com/articles/merging-vs-rebasing</small>\n</center>\n<p>필자가 만약 <code class=\"language-text\">feature</code> 브랜치를 <code class=\"language-text\">master</code>로 리베이스했다고 가정해보자.</p>\n<p>이때 필자가 <code class=\"language-text\">feature</code> 브랜치를 생성한 이후에 <code class=\"language-text\">master</code>에 반영된 커밋들은 모두 맨 끝으로 이동하고 중간에 <code class=\"language-text\">feature</code> 브랜치의 커밋들을 끼워넣게 된다. 즉, 필자가 보고 있는 <code class=\"language-text\">master</code>의 상태는 <code class=\"language-text\">feature</code>의 변경 사항들이 반영되어 있는 히스토리를 가지고 있지만 다른 사람의 <code class=\"language-text\">master</code>는 아직 예전 <code class=\"language-text\">master</code>의 히스토리와 함께 일하고 있다는 것이다.</p>\n<p>그럼 두 개의 <code class=\"language-text\">master</code>를 강제로 병합해줘야하는데 병합 자체는 푸쉬할때 <code class=\"language-text\">--force</code> 옵션을 주면 되지만 문제는 이게 굉장히 혼란스러운 상황이라는 것이다. 쉽게 말해서 커밋 히스토리가 꼬이게 되고 사무실의 여기저기서 “어? 이거 왜 이래? 왜 푸시 안돼?”라는 소리가 들려오기 딱 좋은 상황이다.</p>\n<p>그래서 <code class=\"language-text\">master</code>로의 병합은 머지 스쿼시를 사용하고 <code class=\"language-text\">develop</code>으로의 병합 때 리베이스를 사용하거나 하는 경우도 있다. 머지는 머지 커밋을 발생시키며 히스토리가 미래로 나아가기 때문에 이런 문제가 발생할 확률이 적지만, 리베이스는 과거를 변경하는 것이기 때문에 문제가 생기기 쉬운 것이다.</p>\n<p>뭐 여러모로 둘 다 장단점이 있으니 잘 골라서 사용하도록 하자.</p>\n<h3 id=\"cherry-pick\" style=\"position:relative;\">Cherry Pick<a href=\"#cherry-pick\" aria-label=\"cherry pick permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>체리픽(Cherry Pick)은 다른 브랜치에서 어떤 하나의 커밋만 내 브랜치로 가져오는 기능이다. 체리픽이 하는 일을 보면 대상 브랜치의 커밋 하나를 가져와서 현재 브랜치에 병합하는 행위라고 느껴지지만 히스토리를 보면 병합되는 그림이 아니라 그냥 해당 커밋을 그대로 복사해와서 내 브랜치에 커밋되는 형태로 기록된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> checkout master\n$ <span class=\"token function\">git</span> cherry-pick 35058b4 <span class=\"token comment\"># 가져올 커밋 해쉬</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>물론 체리픽을 사용할 때도 현재 브랜치의 소스와 충돌이 날 가능성은 있기 때문에 가져오기 전에 충돌을 수정할 수도 있다는 마음의 준비는 필요하다. 체리픽은 잘 쓰면 은근히 꿀 기능인데, 바로 이런 상황 때문이다.</p>\n<blockquote>\n<ol>\n<li>A 브랜치에서 철수가 기능 개발 중</li>\n<li>B 브랜치에서 영희가 기능 개발 중</li>\n<li>디자이너가 영희에게 리뷰 별점 아이콘과 디자인을 변경해달라고 요청</li>\n<li>영희가 B 브랜치에서 디자이너의 요구 사항을 반영</li>\n<li>근데 B 브랜치보다 A 브랜치가 먼저 배포되야 함</li>\n<li>디자이너가 철수에게 A 브랜치에 왜 리뷰 별점 디자인 반영안됐냐고 물어봄</li>\n</ol>\n</blockquote>\n<p>제일 좋은 상황은 철수가 디자이너의 요구 사항을 반영하는 것이겠지만, 막 정신없이 일을 하다보면 그렇게 술술 풀리는 경우만 있는 게 아니기 때문에 이런 문제가 발생하긴 한다.</p>\n<p>이때 철수는 영희가 작업하고 있는 B 브랜치에서 리뷰 별점 아이콘이 수정된 커밋을 A 브랜치로 체리픽함으로써 이 상황을 쉽게 해결할 수 있게 된다. 이렇게 사람 애매해지게 만드는 상황은 생각보다 자주 발생하기 때문에 체리픽에 익숙해지는 것을 추천한다.</p>\n<p>사실 이 상황은 필자가 얼마 전에 겪은 상황인데 철수가 필자이고 영희가 동료 프론트엔드 개발자였다. 그래서 동료 개발자분과 B 브랜치의 커밋 로그를 봤는데, 리뷰 별점 아이콘만 수정된 커밋이 아니라 다른 변경 사항도 함께 묻어있는 커밋 밖에 없어서 디자이너와 딜을 할 수 밖에 없었고, “그럼 B 브랜치가 배포될 때 한꺼번에 같이 반영해주세요~“라는 결론으로 무사히 넘어갈 수 있었다. <small>(디자이너님 감사감사…)</small></p>\n<h2 id=\"작업하던-사항을-임시로-저장해보자\" style=\"position:relative;\">작업하던 사항을 임시로 저장해보자<a href=\"#%EC%9E%91%EC%97%85%ED%95%98%EB%8D%98-%EC%82%AC%ED%95%AD%EC%9D%84-%EC%9E%84%EC%8B%9C%EB%A1%9C-%EC%A0%80%EC%9E%A5%ED%95%B4%EB%B3%B4%EC%9E%90\" aria-label=\"작업하던 사항을 임시로 저장해보자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"stash\" style=\"position:relative;\">Stash<a href=\"#stash\" aria-label=\"stash permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>스태쉬(Stash)는 현재 작업 중인 변경 사항들을 잠시 스택에 저장할 수 있는 명령어이다. 이 명령어는 아직 마무리되지 않은 작업이 있는데 다른 브랜치로 체크아웃 해야하는 경우에 유용하게 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> stash <span class=\"token comment\"># 현재 변경 사항들을 스택에 저장</span>\n$ <span class=\"token function\">git</span> stash list <span class=\"token comment\"># 스태쉬 목록을 확인</span>\n$ <span class=\"token function\">git</span> stash apply <span class=\"token comment\"># 가장 최근의 스태쉬를 다시 불러온다</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>또는 직접 스태쉬 이름을 지정할 수도 있다. 스태쉬의 이름을 지정하지 않으면 스택에 들어간 순서(First In Last out)대로만 스태쉬를 가져올 수 있으므로 왠만하면 이름을 지정하는 것을 추천한다. 필자는 주로 스태쉬 이름을 브랜치 이름과 동일하게 지정하는 편이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> stash branch-name <span class=\"token comment\"># 스태쉬 이름을 branch-name으로 지정하고 스택에 저장</span>\n$ <span class=\"token function\">git</span> stash apply branch-name <span class=\"token comment\"># branch-name 이름을 가진 스태쉬를 불러온다</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>실제로 회사에서 개발을 하다보면 갑자기 긴급한 버그 픽스 건이 들어온다거나 아니면 PO들이 이슈의 우선 순위를 다시 정리하면서 기존에 작업을 하고 있던 브랜치에서 다른 브랜치로 건너가야하는 경우는 꽤나 빈번하게 발생한다. <small>(특히 버그 픽스…)</small> 이때 다른 브랜치로 넘어가기위해 작업하던 것을 그대로 커밋하게 되면 해당 브랜치에서 함께 개발하고 있는 다른 팀원들에게 피해가 갈 수 있으니 반드시 변경 사항을 스태쉬하도록 하자.</p>\n<h2 id=\"이미-커밋한-내용-되돌리기\" style=\"position:relative;\">이미 커밋한 내용 되돌리기<a href=\"#%EC%9D%B4%EB%AF%B8-%EC%BB%A4%EB%B0%8B%ED%95%9C-%EB%82%B4%EC%9A%A9-%EB%90%98%EB%8F%8C%EB%A6%AC%EA%B8%B0\" aria-label=\"이미 커밋한 내용 되돌리기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>개발을 진행하다보면 가끔 커밋을 다시 되돌려야 하는 경우도 생긴다. 보통 실수로 인해서 이런 상황이 발생하는 것을 많이 봤는데, 배포되지 말아야 할 기능이 <code class=\"language-text\">release</code> 브랜치에 껴서 들어간 경우를 제일 많이 본 것같다. 이런 상황에서 그 기능의 코드를 일일히 찾아 손으로 지우는 것은 너무 위험하기 때문에 Git을 사용하여 커밋을 되돌리게 된다. 이때 사용하는 기능이 바로 Reset과 Revert이다.</p>\n<h3 id=\"reset\" style=\"position:relative;\">Reset<a href=\"#reset\" aria-label=\"reset permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>리셋(Reset)은 지정한 커밋 당시로 돌아가는 것이다. 아예 시간을 되돌린다고 생각하면 된다. 즉, 리셋을 사용하게되면 지정한 커밋 이후의 히스토리는 모두 사라지게 된다. 예를 들어 이런 히스토리가 있다고 생각해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">* 19061e7 - 맛없는 식당을 찾은 죄로 여자친구한테 이별 통보를 받았다.\n<span class=\"token operator\">|</span>\n* e50aff9 - 여자친구가 맛이 없다고 한다.\n<span class=\"token operator\">|</span>\n* 2d57c29 - 알리오 올리오를 주문했다.\n<span class=\"token operator\">|</span>\n* c04f8f6 - 찾아본 식당에 방문했다.\n<span class=\"token operator\">|</span>\n* 7d9d953 - 여자친구와 함께 갈 좋은 식당을 찾았다<span class=\"token operator\">!</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>필자는 여친과 함께 방문할 좋은 식당을 찾아서 기대감을 안고 알리오 올리오를 주문했지만 너무 느끼하고 맛이 없어서 결과적으로 여친한테 차이고 말았다.</p>\n<p>그래서 필자는 너무 슬픈 나머지 기억을 지우고 싶어서 알리오 올리오를 주문하기 전으로 돌아가려고 한다. 이때 사용할 수 있는 명령어가 <code class=\"language-text\">reset</code>이다. 돌아가고 싶은 커밋을 지정하면 해당 커밋 이후의 히스토리는 모두 삭제하고 과거로 돌아갈 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> reset <span class=\"token parameter variable\">--hard</span> c04f8f6\n\n<span class=\"token comment\"># 식당을 방문했을 때로 돌아갔다!</span>\n* c04f8f6 - 찾아본 식당에 방문했다.\n<span class=\"token operator\">|</span>\n* 7d9d953 - 여자친구와 함께 갈 좋은 식당을 찾았다<span class=\"token operator\">!</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>우리는 <code class=\"language-text\">reset</code> 명령어를 사용할 때 3개의 옵션을 사용할 수 있는데, 바로 <code class=\"language-text\">hard</code>, <code class=\"language-text\">soft</code>, <code class=\"language-text\">mixed</code>이다. 이 옵션들은 히스토리를 삭제한다는 것은 전부 동일하지만 삭제된 내용을 처리하는 방식이 조금씩 다르다.</p>\n<hr>\n<ul>\n<li><strong>hard</strong>: 지정한 커밋 이후의 히스토리가 삭제되고 <strong>삭제된 내용들은 그대로 사라진다.</strong></li>\n<li><strong>soft</strong>: 지정한 커밋 이후의 히스토리가 삭제되고 <strong>삭제된 내용들은 스테이지로 이동한다.</strong> <small>(add한 상태로 변경)</small></li>\n<li><strong>mixed</strong>: 지정한 커밋 이후의 히스토리가 삭제되고 <strong>삭제된 내용들은 스테이지에 올라가지 않은 상태가 된다.</strong> <small>(다시 add 해줘야 함)</small></li>\n</ul>\n<hr>\n<p>필자는 방금 위에서 <code class=\"language-text\">hard</code> 옵션을 사용했기 때문에 식당을 방문했던 커밋 이후의 잊고 싶었던 기억을 모두 깔끔하게 삭제할 수 있었다. 만약 옵션을 지정하지 않고 <code class=\"language-text\">reset</code> 명령어를 사용하면 <code class=\"language-text\">mixed</code> 옵션으로 작동한다. 그리고 만약 이미 되돌리고자 하는 히스토리가 리모트 저장소에 푸쉬까지 된 상태라면 리셋 후 히스토리를 푸쉬할 때 <code class=\"language-text\">--force</code> 옵션을 사용해야한다.</p>\n<h3 id=\"revert\" style=\"position:relative;\">Revert<a href=\"#revert\" aria-label=\"revert permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>리벗(revert) 또한 리셋처럼 히스토리를 다시 되돌리고 싶을 때 사용하는 명령어이다. 리셋이 지정한 커밋 이후의 모든 히스토리를 없애버렸다면 리벗은 특정 커밋의 변경 사항을 되돌리는 기능이다. 이때 해당 커밋을 되돌린다고 해서 히스토리에서 그 커밋을 삭제하는 것이 아니라, 되돌리고자 하는 커밋의 내용을 반전시키는 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> revert 35058b4 <span class=\"token comment\"># 특정 커밋을 되돌린다</span>\n$ <span class=\"token function\">git</span> revert 35058b4<span class=\"token punctuation\">..</span>c04f8f6 <span class=\"token comment\"># 커밋의 범위를 지정하여 되돌린다</span>\n$ <span class=\"token function\">git</span> revert HEAD <span class=\"token comment\"># 현재 헤드가 위치한 커밋을 되돌린다</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>만약 <code class=\"language-text\">35058b4</code> 커밋에서 <code class=\"language-text\">A.js</code>의 2번 라인에 <code class=\"language-text\">a</code>라는 글자가 추가되었다고 하면 <code class=\"language-text\">git revert 35058b4</code>를 사용했을때 <code class=\"language-text\">A.js</code>의 2번 라인에서 <code class=\"language-text\">a</code>를 다시 삭제하는 커밋을 추가하는 것이다. 즉, 추가된 사항은 제거하고 제거된 사항은 다시 추가한다. 그렇기 때문에 리벗은 리셋과 다르게 히스토리를 삭제하지 않고 하나의 커밋이 추가되는 형태로 히스토리가 남는다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">* 35058b4 - Revert 맛없는 식당을 찾은 죄로 여자친구한테 이별 통보를 받았다. <span class=\"token comment\"># 여친한테 차인 히스토리만 리벗하자</span>\n<span class=\"token operator\">|</span>\n* 19061e7 - 맛없는 식당을 찾은 죄로 여자친구한테 이별 통보를 받았다.\n<span class=\"token operator\">|</span>\n* e50aff9 - 여자친구가 맛이 없다고 한다.\n<span class=\"token operator\">|</span>\n* 2d57c29 - 알리오 올리오를 주문했다.\n<span class=\"token operator\">|</span>\n* c04f8f6 - 찾아본 식당에 방문했다.\n<span class=\"token operator\">|</span>\n* 7d9d953 - 여자친구와 함께 갈 좋은 식당을 찾았다<span class=\"token operator\">!</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>위의 예시에서 필자는 여친한테 차인 커밋을 다시 리벗했지만 히스토리 상에는 필자의 흑역사가 고스란히 남아있다.</p>\n<p>보통 필자는 리벗을 자주 사용하지는 않지만 가끔 테스트용으로 넣었던 <code class=\"language-text\">console.log</code>가 껴서 들어가거나 할 때 해당 커밋을 리벗 해본 적은 있다. 리셋과 리벗 둘 다 변경 사항을 되돌리는 기능이지만, 되돌리는 방법은 완전 다르니 적재적소에 잘 사용해보도록 하자.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>지금 Git에 대한 포스팅을 두 편 연속으로 작성했는데도 아직 Git에 대해서 전부 설명하지 못했다. 그 만큼 Git은 정말 다양한 기능들로 사용자가 효과적으로 버전 관리를 할 수 있도록 도와주는 도구라고 할 수 있다. 위에서 한번 언급했듯이 어플리케이션의 버전을 관리한다는 특성 때문에 Git이 어떻게 작동하는 지, 내가 이 기능을 사용하면 버전이 어떻게 되는 지 알지 못한다면 사실 두려울 수 밖에 없다.</p>\n<p>“내가 손가락 하나 잘못 놀려서 다른 사람들이 작성한 코드가 날아가면 어떡하지…?”라는 생각은 필자도 해봤고 지금 Git을 겁나 잘쓰시는 많은 개발자 분들도 한번씩은 다 해본 생각일 것이다. <small>(사실 맘 먹고 리셋하고 강제로 푸쉬하지않는 이상 그럴 일이 별로 없다)</small></p>\n<p>하지만 Git에서 말하는 개념이나 기능의 이름들이 생소해서 그렇지 알고보면 Git의 기능들이 작동하는 방법 자체는 그렇게 복잡하지 않다. 그리고 이 복잡성은 제대로 관리되지 않았던 버전 히스토리 그래프도 한 몫 한다고 생각한다. 솔직히 이리저리 꼬여있는 그래프를 보면 “오 이거 해볼만 한데?”라는 생각은 별로 안드는 것 같다.</p>\n<p>포스팅을 작성하면서 최대한 쉽게 써보려고 했는데 독자분들이 이해가 잘 가셨는 지 모르겠다. 사실 Git은 필자 또래의 개발자 분들보다 나이가 조금 있으신 선배들이 더 어려워하시는 것 같다.</p>\n<p>지금까지 SVN을 주로 사용해서 버전을 관리하다가 갑자기 처음보는 개념들이 우수수 떨어지는 Git이 대세라고 하니 공부하기도 쉽지 않을 것 같다고 하시는 선배들의 이야기를 몇 번 들어본 적 있다.</p>\n<p>사실 모든 프로그래밍이 그렇듯, Git도 글로 읽는 것보다는 직접 몇번 해본 다음에 히스토리 그래프가 어떻게 변했는 지도 보고 소스가 어떻게 변했는 지 보는 게 제일 이해가 잘 된다. <a href=\"https://github.com/\" target=\"_blank\" rel=\"nofollow\">Github</a>처럼 무료 저장소를 제공해주는 서비스도 많으니, 연습용 레파지토리를 하나 만든 다음 그 안에서 간단한 코드나 텍스트 파일을 변경해보면서 직접 연습해보시는 걸 추천한다.</p>\n<p>이상으로 Git 뉴비를 위한 기초 사용법 - 버전 관리 포스팅을 마친다.</p>","fields":{"slug":"20190728-git-tutorial-advanced","path":"/2019/07/28/git-tutorial-advanced/","lang":"ko"},"frontmatter":{"title":"Git 뉴비를 위한 기초 사용법 - 버전 관리","subTitle":"브랜치, 머지, 리베이스로 버전 관리하기","date":"Jul 28, 2019","categories":["프로그래밍","튜토리얼"],"tags":["튜토리얼","Git","Git 기초","Tutorial","Versioning","협업","버전관리","VCS","Version Control System"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/99213a89a950fbd4dc194cf9b6cfc530/d803c/thumbnail.png","srcSet":"/static/99213a89a950fbd4dc194cf9b6cfc530/d803c/thumbnail.png 320w,\n/static/99213a89a950fbd4dc194cf9b6cfc530/2a1fd/thumbnail.png 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/99213a89a950fbd4dc194cf9b6cfc530/fc5c5/thumbnail.webp 320w,\n/static/99213a89a950fbd4dc194cf9b6cfc530/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/99213a89a950fbd4dc194cf9b6cfc530/01fb2/thumbnail.png","srcSet":"/static/99213a89a950fbd4dc194cf9b6cfc530/01fb2/thumbnail.png 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/99213a89a950fbd4dc194cf9b6cfc530/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"eaac9e03-ea99-57fc-8137-e41c6193f9e4","tableOfContents":"<ul>\n<li>\n<p><a href=\"#git%EC%9D%80-%EB%88%84%EA%B0%80-%EC%99%9C-%EB%A7%8C%EB%93%A4%EC%97%88%EB%82%98%EC%9A%94\">Git은 누가, 왜 만들었나요?</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B8%B0%EC%B4%88%EC%A0%81%EC%9D%B8-%EA%B0%9C%EB%85%90-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0\">기초적인 개념 알아보기</a></p>\n<ul>\n<li><a href=\"#remote--origin\">Remote / Origin</a></li>\n<li><a href=\"#repository\">Repository</a></li>\n<li><a href=\"#branch\">Branch</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%ED%95%84%EC%88%98-%EB%AA%85%EB%A0%B9%EC%96%B4%EB%93%A4%EC%9D%84-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90\">필수 명령어들을 알아보자</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%A6%AC%EB%AA%A8%ED%8A%B8-%EC%84%9C%EB%B2%84%EC%99%80-%EC%97%B0%EB%8F%99%ED%95%98%EA%B8%B0\">리모트 서버와 연동하기</a></p>\n<ul>\n<li><a href=\"#clone\">clone</a></li>\n<li><a href=\"#pull\">pull</a></li>\n<li><a href=\"#fetch\">fetch</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%B3%80%EA%B2%BD-%EC%82%AC%ED%95%AD%EC%9D%84-%EB%A6%AC%EB%AA%A8%ED%8A%B8-%EC%84%9C%EB%B2%84%EC%97%90-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8%ED%95%98%EA%B8%B0\">변경 사항을 리모트 서버에 업데이트하기</a></p>\n<ul>\n<li><a href=\"#add\">add</a></li>\n<li><a href=\"#commit\">commit</a></li>\n<li><a href=\"#push\">push</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 너도 쓰고 나도 쓰고 우리 모두 쓰고 있는 Git의 기초에 대해서 포스팅 하려고한다. 필자는 Git을 대학교 때 처음 접했는데 처음에는 “왠 이상한 클라우드에 소스코드를 올려놓는다” 정도로만 이해하고 사용했던 기억이 난다. 하지만 Git의 기능은 단순히 코드 공유에서 끝나지 않는 버전 관리 도구이므로 Git을 잘 쓰면 실무에서 펼쳐지는 다이나믹한 상황에 유연하게 대처할수도 있다.","html":"<p>이번 포스팅에서는 너도 쓰고 나도 쓰고 우리 모두 쓰고 있는 Git의 기초에 대해서 포스팅 하려고한다. 필자는 Git을 대학교 때 처음 접했는데 처음에는 “왠 이상한 클라우드에 소스코드를 올려놓는다” 정도로만 이해하고 사용했던 기억이 난다. 하지만 Git의 기능은 단순히 코드 공유에서 끝나지 않는 버전 관리 도구이므로 Git을 잘 쓰면 실무에서 펼쳐지는 다이나믹한 상황에 유연하게 대처할수도 있다.</p>\n<!-- more -->\n<p>하지만 Git의 모든 기능을 이 포스팅에서 전부 다루기에는 지면이 부족하니, 이번에는 Git을 사용하기 위한 기본적인 명령어인 <code class=\"language-text\">add</code>, <code class=\"language-text\">commit</code>, <code class=\"language-text\">push</code>, <code class=\"language-text\">pull</code>, <code class=\"language-text\">fetch</code>에 대한 설명만 진행하도록 하겠다.</p>\n<h2 id=\"git은-누가-왜-만들었나요\" style=\"position:relative;\">Git은 누가, 왜 만들었나요?<a href=\"#git%EC%9D%80-%EB%88%84%EA%B0%80-%EC%99%9C-%EB%A7%8C%EB%93%A4%EC%97%88%EB%82%98%EC%9A%94\" aria-label=\"git은 누가 왜 만들었나요 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Git은 2005년 리누스 토르발즈가 자기가 쓰려고 만든 분산 버전 관리 시스템이다. 일단 이 리누스 토르발즈라는 핀란드 형부터가 개발자라면 대부분 알고 있을 정도로 유명하다.</p>\n<p>아실 만한 분들은 다 아시겠지만 이 형은 오픈소스 커널인 리눅스(Linux)를 만든 사람이다. 리눅스 커널로 만든 유명한 운영체제는 데비안 계열의 Ubuntu, 레드햇 계열의 CentOS 등이 있다. 이 운영체제들은 서버에서도 많이 사용되고, 터미널의 기본 기능도 튼실해서 개발 친화적이기 때문에 개발자라면 대부분 알고 있는 운영체제이다. 참고로 안드로이드 OS도 리눅스 커널을 기반으로 만든 운영체제다.</p>\n<p>뭐 어쨌든 이 형은 이 쪽 업계에서는 상당히 유명한데, 뭐 프로그래밍을 잘하거나 리눅스 커널 만든 걸로도 유명하지만 이런 걸로 더 유명하다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 471px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/5b8885b286b244deea3c3312a549a221/91c37/linus.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 65.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHlUjFQ/8QAHBAAAQMFAAAAAAAAAAAAAAAAAQIDEQAQEiIy/9oACAEBAAEFAm+1mbaQrEsmK//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EAB0QAAECBwAAAAAAAAAAAAAAAAEAEQIQEiIxUZH/2gAIAQEABj8CmHhPU9ODtWhl/8QAHRAAAgEEAwAAAAAAAAAAAAAAAREAITFBURBxsf/aAAgBAQABPyGgOj5KAlapxlI53hOCsQ1MBWJc/9oADAMBAAIAAwAAABDP7//EABURAQEAAAAAAAAAAAAAAAAAABBB/9oACAEDAQE/EIf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAdEAEAAgICAwAAAAAAAAAAAAABABEhcRBRMUFh/9oACAEBAAE/EEIUr37Q6Ao5AB64soKqwwWqihZrZ5++N4iB0t2e5//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"linus\" title=\"\" src=\"/static/5b8885b286b244deea3c3312a549a221/91c37/linus.jpg\" srcset=\"/static/5b8885b286b244deea3c3312a549a221/0913d/linus.jpg 160w,\n/static/5b8885b286b244deea3c3312a549a221/cb69c/linus.jpg 320w,\n/static/5b8885b286b244deea3c3312a549a221/91c37/linus.jpg 471w\" sizes=\"(max-width: 471px) 100vw, 471px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>세계 그래픽 카드 점유율 1위 기업한테 엿을 먹이는 패기</small>\n</center>\n<p>이게 대략 2012년 쯤인데, 어떤 포럼 연설에서 실제로 이렇게 엔비디아 엿먹으라고 했다. 당시에 엔비디아 옵티머스 칩을 사용하는 컴퓨터에서 리눅스로 만든 OS가 제대로 안굴러가는 이슈가 있었는데, 엔비디아가 지적재산권을 이유로 오픈소스 드라이버를 공개를 안했었기 때문에 리눅스의 설치가 힘들었던 것이다. 당시의 대화는 대략 이랬다.</p>\n<blockquote>\n<p><strong>[청중]</strong><br />\n아 님… 엔비디아 옵티머스 칩 쓰는 노트북에 리눅스 까는게 너무 힘들어요ㅜㅜ 좋은 방법 없을까요?</p>\n<p><strong>[리누스]</strong><br />\n…<br />\n난 우리가 하드웨어 제조업체들과 겪었던 최악의 문제 중 하나가 엔비디아라는 것을 이렇게 공개적으로 지적할 수 있어서 기쁘네요! 이건 조금 슬픈 일인데, 엔비디아는 안드로이드 시장에 많은 칩을 팔고 있지만 이 회사는 우리가 경험한 회사 중 진짜 최악입니다.</p>\n<p>그러니까 엔비디아… <strong>엿이나 먹어라</strong></p>\n</blockquote>\n<p>리누스는 이런 형이다. 참고로 리눅스 커널이 오픈소스라고 함부로 커밋했다가는 이 형한테 욕먹고 현타가 올 수도 있으니 마음 단단히 먹자. 이 형이 바로 이 업계의 <strong>고든 램지</strong>다.</p>\n<p>근데 왜 이 형이 Git을 만들게 되었냐?</p>\n<p>리누스는 리눅스 커널을 만들 당시에 <a href=\"https://www.bitkeeper.org/\" target=\"_blank\" rel=\"nofollow\">BitKeeper</a>라는 분산 버전 관리 시스템을 사용했는데, 이 Bitkeeper라는 서비스는 원래 유료였지만 리눅스 커뮤니티에는 무료로 제공해주고 있었다. 근데 이 커뮤니티의 개발자 한명이 BitKeeper의 통신 프로토콜을 리버스 엔지니어링해서 해킹하는 사건이 발생했고, Bitkeeper는 무료로 리눅스 커뮤니티에 서비스를 제공하던 것을 철회한 것이다.</p>\n<p>근데 이걸 쓰지 말라고 막은 게 아니라 그냥 무료에서 유료로 돌린 거다. 근데 이 형이 돈내기는 싫었는지 그냥 자기가 분산 버전 관리 시스템을 2주 만에 뚝딱! 만들었는데 그게 바로 Git이다. <small>(2달 아니고 2주 맞다…)</small></p>\n<p>리누스가 Git을 처음 커밋했던 내용은 Github의 <a href=\"https://github.com/git/git/commit/e83c5163316f89bfbde7d9ab23ca2e25604af290\" target=\"_blank\" rel=\"nofollow\">Git 미러 저장소</a>에서 확인해볼 수 있는데 여기서도 리누스 형의 성격이 드러난다.</p>\n<blockquote>\n<p>GIT - the stupid content tracker</p>\n<p>“git” can mean anything, depending on your mood.</p>\n<p>- random three-letter combination that is pronounceable, and not<br />\nactually used by any common UNIX command. The fact that it is a mispronounciation of “get” may or may not be relevant.<br />\n- stupid. contemptible and despicable. simple. Take your pick from the<br />\ndictionary of slang.<br />\n- “global information tracker”: you’re in a good mood, and it actually<br />\nworks for you. Angels sing, and a light suddenly fills the room.<br />\n- “goddamn idiotic truckload of sh*t”: when it breaks</p>\n<p><strong>Linus Torvalds</strong> <em><a href=\"https://github.com/git/git/commit/e83c5163316f89bfbde7d9ab23ca2e25604af290\" target=\"_blank\" rel=\"nofollow\">git/git/README.md</a></em></p>\n</blockquote>\n<p>음, 이게 리누스가 한 첫번째 커밋의 <code class=\"language-text\">README.md</code> 파일의 일부를 가져온 것인데, Git은 그냥 아무 의미 없는 세글자 알파벳이라고 한다. 그냥 유닉스 명령어 중에 <code class=\"language-text\">git</code>이라는 명령어가 없어서 정했다고 한다. 기분이 좋으면 “global information tracker”라고 하고 기분이 구리면 “goddamn idiotic truckload of sh*t”이라고 하랜다. <small>(진짜 이 세상 쿨함이 아니다.)</small></p>\n<p>정리하자면 Git은 핀란드의 어떤 천재 형이 쓰던 버전 관리 도구가 갑자기 유료가 되서 2주만에 만들어낸 시스템이고, 지금은 전 세계적으로 널리 사용되고 있는 분산 버전 관리 시스템이다.</p>\n<h2 id=\"기초적인-개념-알아보기\" style=\"position:relative;\">기초적인 개념 알아보기<a href=\"#%EA%B8%B0%EC%B4%88%EC%A0%81%EC%9D%B8-%EA%B0%9C%EB%85%90-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0\" aria-label=\"기초적인 개념 알아보기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Git은 분산 버전 관리 시스템이기 때문에 리모트 서버에 있는 소스를 수정하려면 로컬 환경으로 소스를 클론(Clone)하는 과정이 필요하다. 말 그대로 모든 소스를 복사하여 사용자의 컴퓨터로 받아오는 것이다.</p>\n<p>이후 Git은 로컬 환경의 파일을 추적하고 있다가 사용자가 소스를 수정하면 그 변경 사항을 감지한다. 그 후 사용자는 자신이 리모트 서버에 변경 사항을 반영하고 싶은 파일이나 소스 코드의 라인을 고른 뒤 리모트 서버에 업로드한다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 542px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/e855c0870c0d6a21a168870d4ebbc553/c0388/source-tree.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 48.12500000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACFUlEQVR42oWSW2sTURSF8xcqLYitaWqapEkmt2ZmMjNpJ5O5pJlkkqba4hV8EXwQqddSqGBraW2LCBZ8UZEiPhSLfemDIHj5Z58nI1qESh8W+7DZfGetfU5kfOkmg4/vcnZ7iYHdh5x59ehYuw8YeLFC6tlXUqtHJJ5+Qd76ibL1ndiTQybWvyFt/CC+dkTuzQbZt2tE5IrGuWoXy7SJFSqMFoxQMaGRvEG+rPP+Vo+D+zfYX7we1k/3rnFwZ4Hb8z3c3lUsfxarfQmzNU+kUpIZUgL8mkEmUyA6rhBLyIwlZUbiCsV8nr2VLIc70xxsT/F5R2dvVePdcpr9TZWPz6t8WFe4ctGj5i4I4KTCkBrQsKpkpCLRpEospYQaTSrE0yqW6+P5XexGG6cZYHlt6p6PPm2TKchIxQpJSSMhGcfAmROBMvGMhmYGTNmzTDk9jHoXvRag1TpURS9drDEcL4eXR8X8qcCEpGN6PazGHEq1SSKrCzcG46L2LxubOJ7v63SH6Qr1mYshsFrvhNC+w0nNI5oo/wMLgaoADv53h78jq9MtETEQcTvC7Ry6FYi4XdFrh477s3+cRoxymWHNp2WLV5ZKJzt0Otiu2KHZxLJa4twNZQm4ZrbJyXWGL5TC+YjjaOQaHmVZfJWU/Bc2JnQ+pZJNlXjZLLLZmGTbzfF6zmDZlVl0KjQdH7t1GcNqY7q9UL8AVTReOSvTiSgAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"source tree\" title=\"\" src=\"/static/e855c0870c0d6a21a168870d4ebbc553/c0388/source-tree.png\" srcset=\"/static/e855c0870c0d6a21a168870d4ebbc553/69538/source-tree.png 160w,\n/static/e855c0870c0d6a21a168870d4ebbc553/72799/source-tree.png 320w,\n/static/e855c0870c0d6a21a168870d4ebbc553/c0388/source-tree.png 542w\" sizes=\"(max-width: 542px) 100vw, 542px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>맨 위의 `origin/master`는 리모트 서버의 버전, 맨 밑의 `master`는 필자 컴퓨터의 버전을 의미한다.</small>\n</center>\n<p>자 일단 Git에 대한 기본적인 개념은 이게 끝이다. 리모트 서버에 있는 파일을 내 컴퓨터로 복붙한 다음 수정해서 다시 리모트 서버로 업데이트한다는 것. 이때 사용자가 자신이 변경한 로컬의 소스를 서버의 소스에 업로드하는, 즉 서버로 밀어올리는 행위를 Push라고 부르고 사용자가 서버의 소스를 자신의 클라이언트로 가져오는 행위를 Pull 또는 Fetch라고 하는 것이다. 쉽지 않은가?</p>\n<p>하지만 처음 Git을 접하면 평소에 접해보지 못했던 <code class=\"language-text\">remote</code>, <code class=\"language-text\">origin</code>, <code class=\"language-text\">repository</code>와 같은 용어들이 튀어 나오기 때문에 당황할 수 있다. 그럼 이 용어들이 무엇을 뜻하는지부터 간단하게 알아보자.</p>\n<h3 id=\"remote--origin\" style=\"position:relative;\">Remote / Origin<a href=\"#remote--origin\" aria-label=\"remote  origin permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>우선 Remote는 말 그대로 리모트 서버 자체를 의미한다. 이 리모트 서버라는 개념이 잘 이해가 안되시는 분은 우리가 자주 사용하는 구글 드라이브나 N드라이브와 같은 클라우드 스토리지를 사용하는 것을 떠올리시면 된다. 전 세계 어딘가에 있는 서버에 우리의 소스를 저장하는 것이다.</p>\n<p>이때 이 서버를 제공해주는 대표적인 업체가 <a href=\"https://github.com/\" target=\"_blank\" rel=\"nofollow\">Github</a>, <a href=\"https://bitbucket.org/product/\" target=\"_blank\" rel=\"nofollow\">Bitbucket</a>, <a href=\"https://about.gitlab.com/\" target=\"_blank\" rel=\"nofollow\">GitLab</a>과 같은 회사들이다. 이 회사들이 Git을 만든 게 아니라 Git이라는 시스템에 필요한 리모트 서버와 Git을 좀 더 편리하게 사용할 수 있는 기능들을 제공하는 것이다.</p>\n<p>Git을 사용할 때는 내가 어떤 리모트 서버에 변경 사항을 업로드 할 것인지 정해야하는데, 반드시 하나의 리모트 서버만 사용할 수 있는 것이 아니기 때문에 내가 사용하는 리모트 서버의 이름을 정해줘야한다. 이때 주로 사용하는 관례적인 이름이 바로 <code class=\"language-text\">Origin</code>이다.</p>\n<p>보통은 한 개의 리모트 서버만 운용하는 경우가 대다수이기 때문에 많은 사람들이 Remote와 Origin을 혼용해서 부르곤 한다.</p>\n<h3 id=\"repository\" style=\"position:relative;\">Repository<a href=\"#repository\" aria-label=\"repository permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>레파지토리(Repository, Repo)는 저장소라는 뜻으로, 리모트 서버 내에서 구분되는 프로젝트 단위라고 생각하면 된다. 우리가 구글 드라이브를 사용할 때도 하나의 디렉토리에 모든 파일을 다 때려넣지않고 몇 개의 디렉토리를 만들고 용도에 따라 파일을 나눠서 구분하는 것과 동일하다.</p>\n<p>일반적으로 한 개의 레파지토리는 하나의 프로젝트를 의미하지만 경우에 따라서 레파지토리 하나에 여러 개의 프로젝트를 구성하기도 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">https://github.com/user/repository.git\nhttps://user@bitbucket.org/group-name/repository.git</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>레파지토리를 클론받을 때는 해당 레파지토리를 가리키는 URL이 필요한데, 레파지토리의 이름은 URL의 맨 마지막에 <code class=\"language-text\">.git</code> 확장자를 가지는 방식으로 표현된다.</p>\n<h3 id=\"branch\" style=\"position:relative;\">Branch<a href=\"#branch\" aria-label=\"branch permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>브랜치(Branch)는 일종의 독립된 작업을 진행하기 위한 작업 공간의 개념이다. 맨 처음 Git을 초기화했을 때 기본적으로 <code class=\"language-text\">master</code>라는 이름의 브랜치가 하나 생성된다. 그 후 개발하는 기능 또는 버그 픽스에 따라서 브랜치를 새로 생성하고 거기서 작업한 후에 나중에 다시 <code class=\"language-text\">master</code>로 합치는 것이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/3337736752b17e897031f2d2142cd163/5cae2/branches.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 61.24999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABsElEQVR42p2SyW7TUBSG81RseQweA9aINRILdpVYQDdskJodsGFIBVIidaAKOC12VDWT3Ti+8ZCkjuM4tj9sx45sVMYjXd+je/z/5z9DjcSiKE4vOscD9h602H94yt79JucnQ8rxv7Fa+onjLcA0FkjNMZ2Wnt2WWFCOR1HE2vcJ1n7ih78mLFsKNqxrwhKgIOzrJvWvY16dqVyOrW2SuKq+lv5cAHx/xeBK5fULiZnt7gBFXLdmHCo67y80NHNWSVZSuH0Igg1CCAI/oNeeJGVtCn0V4HLuYAv9VrKMsNXVGCfZhGEwTQhdz+NkZOAtXRRtSrun43tLblyXaBMgDSbZ2059nrIgrzXlET1Nx7ZMHMfhWjf4dDHEnArO+2O+XGo4Sey7LDN3bJSRSPrn/GbKcZjS/zSZcFduHEeZZ9k2wcqna6pIkx7hOqDR72DfzBnaBk1VqQ6lcvISyicIN6wXLi+lzzxvN5hNLR616sijKxrdNk9O396+Nn+0KGte7ufb4a2YC+vfCcuK0yVPTRYqB90j6soRH/vSfyjMLcx7u//tkDtvHnP33VPufXjGD8kYl1PaXlxHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"branches\" title=\"\" src=\"/static/3337736752b17e897031f2d2142cd163/6af66/branches.png\" srcset=\"/static/3337736752b17e897031f2d2142cd163/69538/branches.png 160w,\n/static/3337736752b17e897031f2d2142cd163/72799/branches.png 320w,\n/static/3337736752b17e897031f2d2142cd163/6af66/branches.png 640w,\n/static/3337736752b17e897031f2d2142cd163/d9199/branches.png 960w,\n/static/3337736752b17e897031f2d2142cd163/21b4d/branches.png 1280w,\n/static/3337736752b17e897031f2d2142cd163/5cae2/branches.png 2332w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>master 브랜치에서 다른 브랜치를 분리한 모습<small>\n</small></small></center>\n<p>이 브랜치 개념은 Git에 익숙하지 않은 분들에게 잠깐 설명하고 넘어가기에는 직관적으로 이해가 잘 안될 수 있는 개념이기 때문에 추후 다른 포스팅에서 다시 설명하겠다. 일단 지금은 이 3가지 정도만 기억해두자.</p>\n<blockquote>\n<ol>\n<li>Git을 초기화하면 기본적으로 <code class=\"language-text\">master</code> 브랜치가 생긴다. 이 친구가 메인 브랜치 역할을 한다.</li>\n<li>브랜치는 어떤 브랜치에서 분리시키는 것이고, 분리된 브랜치는 분리될 당시의 부모 브랜치 상태를 그대로 가지고 있다.</li>\n<li>개발자는 각각의 브랜치에서 개발을 진행한 뒤 나중에 다시 <code class=\"language-text\">master</code> 브랜치로 변경 사항을 합친다.</li>\n</ol>\n</blockquote>\n<h2 id=\"필수-명령어들을-알아보자\" style=\"position:relative;\">필수 명령어들을 알아보자<a href=\"#%ED%95%84%EC%88%98-%EB%AA%85%EB%A0%B9%EC%96%B4%EB%93%A4%EC%9D%84-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90\" aria-label=\"필수 명령어들을 알아보자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>만약 여러분이 혼자서만 프로젝트의 버전 관리를 한다면 단순히 리모트 서버의 레파지토리에서 소스를 받아와서 변경한 후 다시 리모트 서버로 업로드하는 과정만으로도 프로젝트를 진행하는데는 사실 아무 문제가 없다.</p>\n<p>하지만 Git은 애초에 혼자서 개발하는 상황보다는 여럿이서 함께 소스를 수정하며 개발하는 협업 상황을 상정하고 만들었기 때문에 협업에서 발생할 수 있는 여러가지 곤란한 상황들을 타파하기 위한 많은 기능을 가지고 있다.</p>\n<p>Git은 기본적으로 CLI(Command Line Tools)을 통해 사용하고 <code class=\"language-text\">commit</code>, <code class=\"language-text\">fetch</code>, <code class=\"language-text\">branch</code>와 같은 여러가지 명령어를 사용하여 이 기능들을 사용할 수 있게 해준다.</p>\n<p>그럼 이번에는 Git을 사용하여 버전을 관리하기 위해 기본적으로 알아야 하는 몇 가지 명령어를 한번 살펴보자.</p>\n<h2 id=\"리모트-서버와-연동하기\" style=\"position:relative;\">리모트 서버와 연동하기<a href=\"#%EB%A6%AC%EB%AA%A8%ED%8A%B8-%EC%84%9C%EB%B2%84%EC%99%80-%EC%97%B0%EB%8F%99%ED%95%98%EA%B8%B0\" aria-label=\"리모트 서버와 연동하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"clone\" style=\"position:relative;\">clone<a href=\"#clone\" aria-label=\"clone permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><code class=\"language-text\">clone</code>은 말 그대로 리모트 서버의 레파지토리에서 클라이언트로 파일을 복붙하는 행위를 말한다. 이때 클론을 수행하기 위해서는 어떤 레파지토리에서 파일을 가져올 것인지에 대한 정보가 필요한데, 이 정보는 위에서 설명했듯이 URL로 표현한다. HTTPS 프로토콜이나 SSH 프로토콜을 사용하여 소스를 클론할 수 있는데, 보통 HTTPS를 많이 사용한다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 461px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/3623cc98a57b0f252f1a6ea7e513bf3f/f816d/clone.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 49.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB5UlEQVR42mWSy27TQBSG/ZK8ADvEgg10hcSKB2EHEhWLchFC3bBD0IpWqhq7ae2ksePYju+emy9/z5kkEqgjfZoz/4x/n3NmnGmaUDcN8qJEWVYoCCk1yqpGQRrrQiq75v26a3HineL91Qk+XH3Gx+uvOJ59w7vLY/j5Es5IhsF9iGtvDnd+h5l3i2xb2pg1JisqzP0AM/cWi3WIl6dv8fTLK+IIz7+/xosfb/Dk0zP8DH7BaTQgekCOPE/QxqBpW2itIYSwlGWJtu0wjiMmou97e67vDSqhkFQStTBWd0oJFGLa0Q1UcomLi0vM7yjDmQs/WMD1bgjPtuAwuFU8inbAfW6Q07daGzg9ZXZA9wO6rkMYrbFJUmTZFmEYIUlTWieINxus49juc7xaRYiiEHVVWXOlNBz8MzhlpaiENMM2z7Hd5tYgIfMkyZCSzj+J442N0yyzl+gvVzTXu5I58wPG9BYpJARlKqWg3rWWpmEa1HWDhmCNq1FK0iUWFAv61jw25L8MtgWTxexn27J93/hlsG6GHeO06ylX95+hJkNMA25ihb9LAXetcLYQ+O13dJs9nRnZFUGm8ScQOCfOiKgwJI+PDYdhoEcsbRmaUBSbfczPh8viWVErWJOio/IrVNUOLvkBz6H0fufh3YoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"clone\" title=\"\" src=\"/static/3623cc98a57b0f252f1a6ea7e513bf3f/f816d/clone.png\" srcset=\"/static/3623cc98a57b0f252f1a6ea7e513bf3f/69538/clone.png 160w,\n/static/3623cc98a57b0f252f1a6ea7e513bf3f/72799/clone.png 320w,\n/static/3623cc98a57b0f252f1a6ea7e513bf3f/f816d/clone.png 461w\" sizes=\"(max-width: 461px) 100vw, 461px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>보통 Github과 같은 리모트 서버 제공업체들은 레파지토리를 쉽게 클론할 수 있도록 눈에 잘 띄는 버튼을 만들어 놓고 해당 레파지토리의 URL을 제공하는 경우가 많다. 사용자는 단지 저 URL을 복사한 다음 Git의 <code class=\"language-text\">clone</code> 명령어를 사용해서 레파지토리를 클론하기만 하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> ~/dev/evan <span class=\"token comment\"># 원하는 작업 디렉토리로 이동</span>\n$ <span class=\"token function\">git</span> clone https://github.com/evan-moon/test-repo.git</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>원하는 작업 디렉토리로 이동한 뒤 <code class=\"language-text\">clone</code> 명령어를 사용하여 레파지토리를 클론하게되면 현재 위치에 레파지토리 이름과 동일한 디렉토리가 생성되고 그 내부에 리모트 서버의 소스가 전부 복사된다. 위 예제의 경우 <code class=\"language-text\">~/dev/evan</code> 디렉토리 내부에 <code class=\"language-text\">test-repo</code> 디렉토리가 생성되고 해당 레파지토리의 소스가 복사될 것이다.</p>\n<p>이제 이 복사된 소스를 맘대로 수정하거나 파괴해도 리모트 서버에 업로드만 하지 않는다면, 같은 리모트 서버를 보고 있는 다른 사람이 영향을 받을 일은 절대 없기 때문에 안심하고 맘대로 만지작거려도 된다.</p>\n<h3 id=\"pull\" style=\"position:relative;\">pull<a href=\"#pull\" aria-label=\"pull permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><code class=\"language-text\">pull</code> 명령어는 리모트 서버의 최신 소스를 가져와서 로컬 소스에 병합(Merge)해주는 명령어이다. 만약 우리가 처음 소스를 클론한 후에 다른 사람이 리모트 서버를 상태를 갱신했더라도 리모트 서버가 우리에게 그 변경된 사항을 알려주지는 않기 때문에 우리가 직접 서버에 문의를 날려야 하는 것이다.</p>\n<p>또한 <code class=\"language-text\">pull</code>은 단순히 리모트 서버에서 로컬로 소스를 가져온다의 개념보다는 “가져와서 합친다”의 개념이기 때문에 브랜치끼리도 <code class=\"language-text\">pull</code>을 통해 소스를 합칠 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> pull <span class=\"token comment\"># 현재 내 로컬 브랜치와 같은 이름을 가진 리모트 서버 브랜치가 타겟</span>\n$ <span class=\"token function\">git</span> pull origin master <span class=\"token comment\"># origin 리모트 서버의 master 브랜치가 타겟</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>오픈소스에 관심이 많은 분이라면 Pull Request라는 단어를 들어보았을 것이다. 이 Pull Request는 “내가 작업한 브랜치를 가져가서 합쳐줘~“라는 의미이다.</p>\n<p>필자는 처음에 이게 왜 Merge Request가 아니라 Pull Request인지 이해가 잘 안갔었는데, 나중에 와서 생각해보니 최종적으로 두 브랜치의 소스를 합치는 행위를 하는 주체가 요청을 한 사람이 아니고 요청을 받은 사람이기 때문에 요청을 받은 사람이 브랜치를 가져가서 합친다는 관점에서 보면 적절한 네이밍인 것 같다는 생각을 했었다.</p>\n<h3 id=\"fetch\" style=\"position:relative;\">fetch<a href=\"#fetch\" aria-label=\"fetch permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><code class=\"language-text\">fetch</code>는 리모트 서버의 최신 이력을 내 클라이언트로 가져오되 병합은 하지 않는 명령어이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> fetch</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><code class=\"language-text\">fetch</code> 명령어를 사용하면 다른 사람들이 리모트 서버에 새로 업데이트한 모든 내역을 받아올 수 있다. 이제 그 내역을 보고 내 로컬에 있는 버전이 리모트 서버에 있는 버전보다 이전 버전이라면 <code class=\"language-text\">pull</code> 명령어를 사용하여 내 컴퓨터의 소스 코드를 갱신하면 된다.</p>\n<p>그럼 이 명령어가 <code class=\"language-text\">pull</code>의 하위 호환이 아닌가? 라는 생각이 들 수도 있는데, <code class=\"language-text\">pull</code>과 <code class=\"language-text\">fetch</code>는 조금 용도가 다르긴 하다. <code class=\"language-text\">pull</code> 같은 경우는 일단 묻지도 따지지도 않고 바로 리모트 서버의 최신 소스를 가져와서 내 로컬 소스에 합쳐버리기 때문에 조금 위험하긴 하다. 뭐 예를 들면 지금 리모트 서버의 최신 소스가 버그가 있는 상태일 수도 있지 않은가?</p>\n<p>그래서 필자같은 경우 보통 로컬 소스와 리모트 소스의 변경 사항을 미리 비교해보고 싶을 때 <code class=\"language-text\">fetch</code>를 사용한다. 그리고 <code class=\"language-text\">fetch</code>를 잘 이용하면 이런 얌생이도 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token function\">git</span> fetch <span class=\"token parameter variable\">--all</span> -p<span class=\"token punctuation\">;</span> <span class=\"token function\">git</span> branch <span class=\"token parameter variable\">-vv</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\": gone]\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'{ print $1 }'</span> <span class=\"token operator\">|</span> <span class=\"token function\">xargs</span> <span class=\"token parameter variable\">-n</span> <span class=\"token number\">1</span> <span class=\"token function\">git</span> branch <span class=\"token parameter variable\">-d</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>이 쉘스크립트는 필자가 예전에 만들어 놨던 친구이다. <code class=\"language-text\">fetch</code>를 통해 리모트 서버의 최신 내용을 받아온 뒤, <code class=\"language-text\">branch</code> 명령어를 사용하여 리모트 서버에서는 삭제되었지만 로컬에는 남아있는 브랜치를 찾아서 싹 다 지워주는 스크립트이다. 참고로 로컬에는 있지만 리모트에서 삭제된 브랜치는 브랜치 이름 뒤에 <code class=\"language-text\">: gone</code>이라는 문구가 붙어있기 때문에 구분이 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> branch <span class=\"token parameter variable\">-vv</span>\n* master fa0cec5 <span class=\"token punctuation\">[</span>origin/master<span class=\"token punctuation\">]</span> 마스터 브랜치에욤\n  <span class=\"token builtin class-name\">test</span>   1f3578f <span class=\"token punctuation\">[</span>origin/test: gone<span class=\"token punctuation\">]</span> 리모트에선 죽은 브랜치\n  test2  fa0cec5 로컬에서 만들어지고 리모트에 업데이트는 안된 브랜치</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">fetch</code> 명령어와 <code class=\"language-text\">branch</code> 명령어의 특성을 잘 이용하면 이런 꿀 스크립트를 만들 수도 있다.</p>\n<h2 id=\"변경-사항을-리모트-서버에-업데이트하기\" style=\"position:relative;\">변경 사항을 리모트 서버에 업데이트하기<a href=\"#%EB%B3%80%EA%B2%BD-%EC%82%AC%ED%95%AD%EC%9D%84-%EB%A6%AC%EB%AA%A8%ED%8A%B8-%EC%84%9C%EB%B2%84%EC%97%90-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8%ED%95%98%EA%B8%B0\" aria-label=\"변경 사항을 리모트 서버에 업데이트하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>자, 지금까지는 리모트 서버의 내용을 로컬과 연동하는 명령어를 살펴봤다면 이제는 내 로컬에서 변경한 소스를 리모트 서버로 업로드하는 명령어들을 살펴볼 차례이다. 필자는 이 과정을 설명할 때 보통 택배로 예를 주로 드는 편이기 때문에 이 포스팅에서도 택배를 포장하고 배송하는 과정에 빗대어서 설명을 진행하겠다.</p>\n<h3 id=\"add\" style=\"position:relative;\">add<a href=\"#add\" aria-label=\"add permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<center>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/67e9fbfe9c838c78850347beaaa2bf25/0f98f/add.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQCAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB3l2YS2AUf//EABkQAAIDAQAAAAAAAAAAAAAAAAECAxASIf/aAAgBAQABBQJuLHLtqCqK/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFxEAAwEAAAAAAAAAAAAAAAAAARARIf/aAAgBAgEBPwE24v/EABgQAAIDAAAAAAAAAAAAAAAAAAEQABEh/9oACAEBAAY/AjKeBf/EABkQAQEAAwEAAAAAAAAAAAAAAAERABAxUf/aAAgBAQABPyFUeGIEHK6Skcdojr//2gAMAwEAAgADAAAAEDAP/8QAFxEBAAMAAAAAAAAAAAAAAAAAARARIf/aAAgBAwEBPxAStj//xAAWEQEBAQAAAAAAAAAAAAAAAAABECH/2gAIAQIBAT8QDCsn/8QAGhABAQEAAwEAAAAAAAAAAAAAAREhABBBgf/aAAgBAQABPxBQdUT4caAahc0nQIFEiPvMXtKHX//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"add\" title=\"\" src=\"/static/67e9fbfe9c838c78850347beaaa2bf25/c08c5/add.jpg\" srcset=\"/static/67e9fbfe9c838c78850347beaaa2bf25/0913d/add.jpg 160w,\n/static/67e9fbfe9c838c78850347beaaa2bf25/cb69c/add.jpg 320w,\n/static/67e9fbfe9c838c78850347beaaa2bf25/c08c5/add.jpg 640w,\n/static/67e9fbfe9c838c78850347beaaa2bf25/6a068/add.jpg 960w,\n/static/67e9fbfe9c838c78850347beaaa2bf25/eea4a/add.jpg 1280w,\n/static/67e9fbfe9c838c78850347beaaa2bf25/0f98f/add.jpg 1920w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<small>원하는 변경사항만 골라 담는 add 명령어</small>\n</center>\n<p>자, 평화로운 중고나라에서 중고 거래를 했다고 생각해보자. 물론 집에 있는 모든 물건을 보내는 혜자같은 분도 계시겠지만 일반인이라면 그러지 않기 때문에 우리는 상대방한테 물건을 보내기 전에 어떤 물건을 보낼 것인지 부터 정해야한다. 이때 <code class=\"language-text\">add</code> 명령어가 어떤 물건들을 포장할 것인지 고르는 과정을 담당한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token comment\"># 현재 디렉토리의 모든 변경사항을 스테이지에 올린다</span>\n$ <span class=\"token function\">git</span> <span class=\"token function\">add</span> ./src/components <span class=\"token comment\"># components 디렉토리의 모든 변경사항을 스테이지에 올린다</span>\n$ <span class=\"token function\">git</span> <span class=\"token function\">add</span> ./src/components/Test.vue <span class=\"token comment\"># 특정 파일의 변경사항만 스테이지에 올린다</span>\n$ <span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token parameter variable\">-p</span> <span class=\"token comment\"># 변경된 사항을 하나하나 살펴보면서 스테이지에 올린다</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이때 선택된 변경 사항들은 스테이지(Stage)라고 불리는 임시 공간으로 이동하게 된다. 이때 <code class=\"language-text\">git add &lt;경로></code> 명령어는 해당 경로 안에 있는 변경 사항을 전부 스테이지에 올리게 되는데, 이게 영 불안하다 싶은 사람은 <code class=\"language-text\">-p</code> 옵션을 줌으로써 변경 사항을 하나하나 확인하면서 스테이지에 올릴 수도 있다.</p>\n<p>이렇게 스테이지에 담긴 변경 사항들은 <code class=\"language-text\">git status</code> 명령어를 사용하여 확인해볼 수 있고, <code class=\"language-text\">status</code> 명령어에 추가적으로 <code class=\"language-text\">-v</code> 옵션을 사용하면 어떤 파일의 어떤 부분이 변경되었는지도 함께 볼 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> <span class=\"token function\">add</span> ./soruce\n$ <span class=\"token function\">git</span> status\n\nOn branch master\nYour branch is up to <span class=\"token function\">date</span> with <span class=\"token string\">'origin/master'</span><span class=\"token builtin class-name\">.</span>\n\nChanges to be committed:\n  <span class=\"token punctuation\">(</span>use <span class=\"token string\">\"git reset HEAD &lt;file>...\"</span> to unstage<span class=\"token punctuation\">)</span>\n\n\tmodified:   source/_drafts/git-tutorial.md</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"commit\" style=\"position:relative;\">commit<a href=\"#commit\" aria-label=\"commit permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/fd06caf7ac6bf4a5b01786357ca96bc8/0f98f/commit.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAABA//aAAwDAQACEAMQAAAB3FnIm2Aof//EABgQAAIDAAAAAAAAAAAAAAAAAAECAxAR/9oACAEBAAEFAnOLHKWasFf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAXEQADAQAAAAAAAAAAAAAAAAABAhEQ/9oACAECAQE/ASptuf/EABgQAAIDAAAAAAAAAAAAAAAAAAEQABEx/9oACAEBAAY/AiZTxf/EABsQAQACAgMAAAAAAAAAAAAAAAEAEBEhQVGB/9oACAEBAAE/IVM4JmbqkybgToHlf//aAAwDAQACAAMAAAAQzA//xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8QEDEn/8QAFxEBAAMAAAAAAAAAAAAAAAAAARARUf/aAAgBAgEBPxBpFDI//8QAGRABAQADAQAAAAAAAAAAAAAAAREAEDFR/9oACAEBAAE/EOz1jC85ToEAI9HLZr0Br//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"commit\" title=\"\" src=\"/static/fd06caf7ac6bf4a5b01786357ca96bc8/c08c5/commit.jpg\" srcset=\"/static/fd06caf7ac6bf4a5b01786357ca96bc8/0913d/commit.jpg 160w,\n/static/fd06caf7ac6bf4a5b01786357ca96bc8/cb69c/commit.jpg 320w,\n/static/fd06caf7ac6bf4a5b01786357ca96bc8/c08c5/commit.jpg 640w,\n/static/fd06caf7ac6bf4a5b01786357ca96bc8/6a068/commit.jpg 960w,\n/static/fd06caf7ac6bf4a5b01786357ca96bc8/eea4a/commit.jpg 1280w,\n/static/fd06caf7ac6bf4a5b01786357ca96bc8/0f98f/commit.jpg 1920w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>변경 사항들을 포장하는 commit 명령어</small>\n</center>\n<p><code class=\"language-text\">add</code>를 사용하여 원하는 변경사항을 스테이지에 올렸다면 이제 스테이지에 있는 변경 사항들을 포장할 차례이다. 이때 이 포장하는 행위를 <code class=\"language-text\">commit</code>이라고 한다. 커밋은 Git에서 상당히 중요한 부분을 차지하는 행위인데, 바로 Git이 하나의 커밋을 하나의 버전으로 정의하기 때문이다. 그렇기 때문에 특정 버전으로 어플리케이션을 변경이라는 기준도 당연히 바로 이 커밋이 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> log <span class=\"token parameter variable\">--graph</span>\n\n* commit 20f1ea9 <span class=\"token punctuation\">(</span>HEAD -<span class=\"token operator\">></span> master, origin/master, origin/HEAD<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span> Author: Evan Moon <span class=\"token operator\">&lt;</span>bboydart91@gmail.com<span class=\"token operator\">></span>\n<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>     회원가입 기능 개발 끝<span class=\"token operator\">!</span>\n<span class=\"token operator\">|</span>\n* commit ca693fd\n<span class=\"token operator\">|</span> Author: Evan Moon <span class=\"token operator\">&lt;</span>bboydart91@gmail.com<span class=\"token operator\">></span>\n<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>     회원가입 비밀번호 입력 폼 추가\n<span class=\"token operator\">|</span>\n* commit f9b6e2d\n<span class=\"token operator\">|</span> Author: Evan Moon <span class=\"token operator\">&lt;</span>bboydart91@gmail.com<span class=\"token operator\">></span>\n<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>     회원가입 이메일 입력 폼 추가\n<span class=\"token operator\">|</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>위의 그래프 상에서 필자의 어플리케이션의 현재 상태는 어떤 커밋일까?</p>\n<p>그래프 상에서 <code class=\"language-text\">HEAD</code>가 <code class=\"language-text\">20f1ea9 회원가입 기능 개발 끝!</code> 커밋에 위치해 있으므로 현재 필자의 어플리케이션은 회원가입 기능까지 개발이 완료된 상태라는 것을 알 수 있다.</p>\n<p>그리고 그래프를 자세히 보면 각각의 커밋들은 <code class=\"language-text\">20f1ea9</code>과 같은 고유한 해쉬 값을 가지고 있는데, 이 해쉬 값을 사용하여 어떠한 커밋으로든 자유자재로 이동할 수 있다. 예를 들면 <code class=\"language-text\">회원가입 비밀번호 입력 폼 추가</code> 커밋의 해쉬 값을 사용하여 <code class=\"language-text\">git checkout ca693fd</code> 명령어로 회원가입 비밀번호 입력 폼이 추가된 시점으로 이동할 수 있다는 것이다. 즉, 시간여행이 가능하다!</p>\n<p>이러한 커밋의 기능을 제대로 활용하기 위해서 커밋은 반드시 실행 가능한 단위로 해야한다. 더 쉽게 말하자면 특정 커밋으로 버전을 변경했을 때 어플리케이션이 제대로 실행되지 않고 에러가 발생하면 안된다는 것이다.</p>\n<p>그리고 위의 예제에서 볼 수 있듯이 커밋에는 메세지를 담을 수 있다. 이 메세지는 이 커밋으로 인한 변경 사항이 무엇인지 직접적으로 표현해주는 유일한 수단이므로 좋은 커밋 메세지를 작성하기 위한 고민은 필수다. 다행히도 이미 많은 개발자 분들이 좋은 커밋 메세지를 어떻게 작성해야 하는지에 대해 포스팅을 해주셨기 때문에 구글에서 한번 검색해보면 수두룩하게 나온다.</p>\n<p>참고로 커밋 메세지는 꼭 영어여야 할 필요는 없다. 조직에 따라서 커밋 메세지를 영어로만 작성하도록 강제하는 룰이 있을 수는 있지만, 사실 커밋 메세지는 결국 커뮤니케이션 수단이므로 언제 누가 보더라도 알아보기 쉽게만 작성하면 장땡이다. 그러니까 영어가 익숙하지 않은데도 불구하고 굳이 영어를 고집할 필요는 없다. 오히려 같이 협업하는 팀원들이 영어에 익숙하지 않다면 그 또한 불필요한 커뮤니케이션 비용이 될 수 있다.</p>\n<p>또한 커밋은 아직 리모트 서버에 파일을 전송하는 것이 아니라 사용자의 클라이언트 내에서 수행되는 과정이므로 인터넷에 연결이 되어 있지 않아도 변경 사항을 커밋하는 것은 아무런 지장이 없다.<small>(비행기에서 코딩할 때도 커밋까지는 가능하다!)</small></p>\n<p>사실 필자는 Git 뉴비일 때 이 커밋이라는 단어가 조금 헷갈렸었는데, 많은 개발자 분들이 <code class=\"language-text\">commit</code>과 <code class=\"language-text\">push</code>를 같은 의미로 사용하기 때문이었다. 하지만 이 두 명령어는 엄연히 다른 역할을 하기 때문에 되도록이면 구분해서 사용하도록 하자.</p>\n<h3 id=\"push\" style=\"position:relative;\">push<a href=\"#push\" aria-label=\"push permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/8fb4fd3977a800aa1b5e49daad8abee0/0f98f/push.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAEDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB71Ggkhf/xAAYEAEBAAMAAAAAAAAAAAAAAAABAwIgIf/aAAgBAQABBQJ4To5On//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAARAQIg/9oACAEBAAY/AhTVZ//EABkQAQEAAwEAAAAAAAAAAAAAAAERACAhQf/aAAgBAQABPyFqoVPMqhXRmv8A/9oADAMBAAIAAwAAABA0D//EABcRAAMBAAAAAAAAAAAAAAAAAAEQESH/2gAIAQMBAT8QI21f/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAICFRgf/aAAgBAQABPxBZ+MbTEVC0RHRX/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"push\" title=\"\" src=\"/static/8fb4fd3977a800aa1b5e49daad8abee0/c08c5/push.jpg\" srcset=\"/static/8fb4fd3977a800aa1b5e49daad8abee0/0913d/push.jpg 160w,\n/static/8fb4fd3977a800aa1b5e49daad8abee0/cb69c/push.jpg 320w,\n/static/8fb4fd3977a800aa1b5e49daad8abee0/c08c5/push.jpg 640w,\n/static/8fb4fd3977a800aa1b5e49daad8abee0/6a068/push.jpg 960w,\n/static/8fb4fd3977a800aa1b5e49daad8abee0/eea4a/push.jpg 1280w,\n/static/8fb4fd3977a800aa1b5e49daad8abee0/0f98f/push.jpg 1920w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>변경 사항들을 리모트 서버로 배송하는 push 명령어</small>\n</center>\n<p>커밋을 통해 포장된 변경 사항들은 <code class=\"language-text\">push</code> 명령어를 사용하여 리모트 서버로 업로드 된다. 이때는 커밋된 변경 사항들을 실제 리모트 서버에 전송하는 것이기 때문에 반드시 네트워크에 연결이 되어있어야 한다. 반대로 말하면 커밋까지는 굳이 네트워크에 연결되어있지 않아도 되는 것이기 때문에, 인터넷이 제한된 비행기 내부와 같은 환경에서는 커밋까지만 진행하고 목적지에 도착한 후 리모트 서버에 푸쉬하는 등의 행위도 가능하다.</p>\n<p>그리고 푸쉬할 때 반드시 A 로컬 브랜치는 A 리모트 브랜치에만 푸쉬해야 한다는 룰 따윈 없기 때문에 커밋들을 리모트 서버로 푸쉬할 때는 Git에게 “어떤 리모트 서버의 어떤 브랜치로 푸쉬할 것인지”도 함께 알려줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> push origin master <span class=\"token comment\"># origin 리모트 서버의 master 브랜치로 푸쉬해줘!</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>근데 이게 브랜치 이름이 <code class=\"language-text\">master</code> 정도면 그래도 브랜치 이름을 매번 입력해줄만 하지만 <code class=\"language-text\">feature/SD-0000-request-api-refactoring</code> 정도 되면 브랜치 이름을 매번 입력한다는 것이 귀찮을 수도 있다.</p>\n<p>그래서 Git은 브랜치를 자동으로 추적할 수 있는 기능 또한 제공해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> push --set-upstream origin master</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><code class=\"language-text\">--set-upstream</code> 옵션을 사용하고 처음 한번만 브랜치 이름을 입력해주면 그 이후로는 <code class=\"language-text\">git push</code> 명령어만 입력해도 자동으로 처음 입력했던 브랜치로 변경 사항을 푸쉬할 수 있다.</p>\n<p>이렇게 해서 리모트 서버의 레파지토리에서 소스를 내 컴퓨터에 받아온 뒤 파일을 변경하고, 그 변경 사항을 리모트 서버에 다시 업데이트하는 <code class=\"language-text\">clone</code>, <code class=\"language-text\">add</code>, <code class=\"language-text\">commit</code>, <code class=\"language-text\">push</code>의 모든 과정을 한번 살펴보았다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>사실 블로그 포스팅 한개로 Git에 대한 것들을 모두 설명한다는 것은 힘들기 때문에 다음 포스팅에서는 <code class=\"language-text\">branch</code>, <code class=\"language-text\">checkout</code>, <code class=\"language-text\">merge</code>, <code class=\"language-text\">revert</code>와 같이 버전을 실제로 관리하기 위해 사용하는 명령어와 그 개념에 대한 내용을 포스팅하려고 한다.</p>\n<p>Git은 현업에서 굉장히 많이 사용되고 있지만 정작 대학이나 학원같은 교육 기관에서는 약간 쩌리 취급 받는 것 같기도 하다. 뭐 사실 대학에서는 좀 더 원론적인 공학을 배우는 거지 코딩을 알려주는 곳은 아니기도 하고, 학원 같은 경우는 버전 관리 시스템을 가르칠 시간에 코딩을 알려주는 게 더 취업에 유리하니 그럴 수도 있을 것 같다. <small>(요즘에는 대학에 강사 분들이 오셔서 Git에 대해 강의하는 경우도 있다고 한다.)</small></p>\n<p>어쨌든 Git을 잘쓰면 다른 개발자가 개발한 모듈 중에 하나만 내 브랜치로 가져와야 한다거나, 커밋이 꼬여서 소스가 지워졌다거나하는 등 프로젝트를 진행할 때 발생하는 슬픈 상황들을 잘 헤결할 수도 있기 때문에 팀원들에게 이쁨받는 개발자가 될 수 있다.</p>\n<p>이상으로 Git 뉴비를 위한 기초 사용법 - 시작하기 포스팅을 마친다.</p>","fields":{"slug":"20190725-git-tutorial","path":"/2019/07/25/git-tutorial/","lang":"ko"},"frontmatter":{"title":"Git 뉴비를 위한 기초 사용법 - 시작하기","subTitle":"Git이 어려운 당신을 위한, 가장 쉬운 첫걸음","date":"Jul 25, 2019","categories":["프로그래밍","튜토리얼"],"tags":["튜토리얼","Git","Git 기초","Tutorial","Versioning","협업","버전관리","VCS","Version Control System"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/99213a89a950fbd4dc194cf9b6cfc530/d803c/thumbnail.png","srcSet":"/static/99213a89a950fbd4dc194cf9b6cfc530/d803c/thumbnail.png 320w,\n/static/99213a89a950fbd4dc194cf9b6cfc530/2a1fd/thumbnail.png 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/99213a89a950fbd4dc194cf9b6cfc530/fc5c5/thumbnail.webp 320w,\n/static/99213a89a950fbd4dc194cf9b6cfc530/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/99213a89a950fbd4dc194cf9b6cfc530/01fb2/thumbnail.png","srcSet":"/static/99213a89a950fbd4dc194cf9b6cfc530/01fb2/thumbnail.png 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/99213a89a950fbd4dc194cf9b6cfc530/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"1a39e8a2-cd36-519b-a474-9181c4206e69","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%B1%85%EC%9D%80-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%93%B0%EA%B2%8C-%EB%90%98%EC%97%88%EB%82%98\">책은 어떻게 쓰게 되었나?</a></p>\n<ul>\n<li><a href=\"#%EC%86%90%EC%97%90-%EC%9E%A1%ED%9E%88%EB%8A%94-%EC%9E%91%ED%92%88%EC%9D%84-%EB%A7%8C%EB%93%A4%EC%96%B4-%EB%B3%B4%EA%B3%A0-%EC%8B%B6%EB%8B%A4\">손에 잡히는 작품을 만들어 보고 싶다.</a></li>\n<li><a href=\"#%EC%B1%85%EC%9D%84-%EC%93%B0%EB%A9%B4%EC%84%9C-%EB%82%B4-%EC%A7%80%EC%8B%9D%EB%8F%84-%EC%A0%95%EB%A6%AC%ED%95%98%EC%9E%90\">책을 쓰면서 내 지식도 정리하자.</a></li>\n<li><a href=\"#%EC%83%9D%EA%B0%81%EB%B3%B4%EB%8B%A4-%EC%BD%94%EB%94%A9%EC%9D%84-%EB%B0%B0%EC%9A%B0%EA%B8%B0-%EC%9C%84%ED%95%B4%EC%84%9C-%EC%B1%85%EC%9C%BC%EB%A1%9C-%EC%9E%85%EB%AC%B8%ED%95%98%EB%8A%94-%EC%82%AC%EB%9E%8C%EC%9D%B4-%EB%A7%8E%EC%95%98%EB%8B%A4\">생각보다 코딩을 배우기 위해서 책으로 입문하는 사람이 많았다.</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%B1%85%EC%9D%84-%EC%93%B0%EA%B8%B0-%EC%A0%84%EC%97%90\">책을 쓰기 전에</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B0%9C%EB%B0%9C%EC%9E%90%EC%B2%98%EB%9F%BC-%EC%A7%91%ED%95%84%ED%95%98%EC%9E%90\">개발자처럼 집필하자!</a></p>\n<ul>\n<li><a href=\"#markdown%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EC%B1%85-%EC%A7%91%ED%95%84%ED%95%98%EA%B8%B0\">Markdown을 사용하여 책 집필하기</a></li>\n<li><a href=\"#git%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AC%B8%EC%84%9C%EC%9D%98-%EB%B2%84%EC%A0%84%EA%B4%80%EB%A6%AC\">Git을 이용한 문서의 버전관리</a></li>\n<li><a href=\"#%EB%AC%B8%EC%84%9C-%EC%BB%A8%EB%B2%84%ED%8C%85-%ED%95%98%EA%B8%B0\">문서 컨버팅 하기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EB%8F%99-%EC%A7%91%ED%95%84-%EA%B3%BC%EC%A0%95%EC%97%90%EC%84%9C%EC%9D%98-%EC%B6%A9%EB%8F%8C\">공동 집필 과정에서의 충돌</a></p>\n<ul>\n<li><a href=\"#%EC%84%A4%EA%B3%84%EC%97%90-%EB%8C%80%ED%95%9C-%EA%B4%80%EC%A0%90%EC%9D%98-%EC%B0%A8%EC%9D%B4\">설계에 대한 관점의 차이</a></li>\n<li><a href=\"#%EC%9D%BC%ED%95%98%EB%8A%94-%EC%8A%A4%ED%83%80%EC%9D%BC%EC%9D%98-%EC%B0%A8%EC%9D%B4\">일하는 스타일의 차이</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%B1%85-%EB%A6%AC%EB%B7%B0%ED%95%98%EA%B8%B0\">책 리뷰하기</a></p>\n<ul>\n<li><a href=\"#%EC%8A%A4%ED%84%B0%EB%94%94%EC%9B%90%EB%93%A4%EC%9D%98-%EB%A6%AC%EB%B7%B0\">스터디원들의 리뷰</a></li>\n<li><a href=\"#%ED%98%84%EC%97%85-%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%B6%84%EB%93%A4%EC%9D%98-%EB%A6%AC%EB%B7%B0\">현업 개발자분들의 리뷰</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"필자는 최근 커피 한잔 마시며 끝내는 VueJS라는 책을 집필했다. 필자는 책처럼 긴 글을 적는 게 사실 처음이라, 책을 쓰는 과정이나 책을 출판하는 과정에 대해서 무지한 상태로 집필을 시작했고 그래서 중간에 우여곡절도 꽤 많았다. 그래서 이번 포스팅에서는 필자와 같이 책을 집필하고 싶어하는 분들을 위해서 2018년 8월부터 2019년 7월까지 책을 집필했던 과정과 어려움에 대해서 이야기 해보려고 한다.","html":"<p>필자는 최근 <a href=\"https://m.yes24.com/Goods/Detail/76639545\" target=\"_blank\" rel=\"nofollow\">커피 한잔 마시며 끝내는 VueJS</a>라는 책을 집필했다. 필자는 책처럼 긴 글을 적는 게 사실 처음이라, 책을 쓰는 과정이나 책을 출판하는 과정에 대해서 무지한 상태로 집필을 시작했고 그래서 중간에 우여곡절도 꽤 많았다.</p>\n<p>그래서 이번 포스팅에서는 필자와 같이 책을 집필하고 싶어하는 분들을 위해서 2018년 8월부터 2019년 7월까지 책을 집필했던 과정과 어려움에 대해서 이야기 해보려고 한다.</p>\n<!-- more -->\n<h2 id=\"책은-어떻게-쓰게-되었나\" style=\"position:relative;\">책은 어떻게 쓰게 되었나?<a href=\"#%EC%B1%85%EC%9D%80-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%93%B0%EA%B2%8C-%EB%90%98%EC%97%88%EB%82%98\" aria-label=\"책은 어떻게 쓰게 되었나 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>먼저 책을 집필하게 된 계기는 친구인 김영훈 개발자로부터 함께 책을 공동집필해보자는 제의를 받았기 때문이었다. 사실 필자는 대학 교양 레포트 이후로 몇 개의 블로그 포스팅와 회사의 기술 문서 작성을 제외하면 글을 써본 적이 없었다. 지금 이 블로그의 포스트 아카이브를 봐도 한눈에 알 수 있는데, 본격적으로 블로그 뽕에 취하기 전인 2019년 6월 이전에는 지금처럼 일주일에 한두번씩 글을 쏟아내는 정도가 아닌 그냥 생각날 때 간간히 쓰는 수준이었다.</p>\n<p>게다가 저 친구의 제의를 처음 받았을 때 이걸 쓸지 말지 두 가지 이유 때문에 고민을 조금 했었는데, 그 중 첫 번째 이유는 “내가 책을 쓸 실력이 되나?”였다. 그리고 두 번째 이유가 조금 치명적인데…</p>\n<blockquote>\n<p>사실 필자는 대학 교재 이후로 기술 서적을 읽어본 적이 없는 사람이다.</p>\n</blockquote>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 549px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/a077827ec7796d1721f846e67ab4cd58/588f6/what.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBP/EABcBAAMBAAAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAczKF2JDx//EABsQAAEEAwAAAAAAAAAAAAAAAAABAhIhAxEx/9oACAEBAAEFAk21cjiZUaE5/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQACIf/aAAgBAwEBPwHGRZe3/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8Bqv/EAB0QAAIABwEAAAAAAAAAAAAAAAABAhARISIxMkH/2gAIAQEABj8CpCzF+mky6OZf/8QAGxABAAMAAwEAAAAAAAAAAAAAAQARITFBkdH/2gAIAQEAAT8hxBvawLvmslZAh7WKgWbLr9QiWp//2gAMAwEAAgADAAAAEMQv/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAh/9oACAEDAQE/EFA7MIL/xAAYEQACAwAAAAAAAAAAAAAAAAAAAREhMf/aAAgBAgEBPxCWCof/xAAaEAEBAAMBAQAAAAAAAAAAAAABEQAhMZFB/9oACAEBAAE/ECpFJpUnzbikoDVHHfb7hgBw175gESXbG7m+4361INawjRTlz//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"what\" title=\"\" src=\"/static/a077827ec7796d1721f846e67ab4cd58/588f6/what.jpg\" srcset=\"/static/a077827ec7796d1721f846e67ab4cd58/0913d/what.jpg 160w,\n/static/a077827ec7796d1721f846e67ab4cd58/cb69c/what.jpg 320w,\n/static/a077827ec7796d1721f846e67ab4cd58/588f6/what.jpg 549w\" sizes=\"(max-width: 549px) 100vw, 549px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>이렇게 또 책밍아웃을 합니다...</small>\n</center>\n<p>필자는 독서를 좋아하긴 하지만, 공부에 있어서는 “인터넷이 더 편한데?”라고 생각하는 쪽이라서 기술 서적보다는 소설이나 에세이, 조직 문화나 철학 같이 기술과는 관련 없는 책을 주로 읽는 편이다.</p>\n<p>게다가 필자의 포스팅을 몇번 보신 분들은 아실지도 모르겠지만 필자의 공부 스타일이 책을 하나 하나 읽어보면서 기초부터 하는 스타일은 아니다. 일단 뭘 만들지부터 정해놓고 그때그때 필요한 정보를 찾고 습득한 후에 바로 사용하고 넘어가는 스타일이다. <small>(물론 그래서 지식의 깊이는 넓고 얕은 편이다.)</small></p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/6b892b18c7b5396515cda321b3f504ea/9568a/books.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIDBAX/xAAYAQACAwAAAAAAAAAAAAAAAAACBAABA//aAAwDAQACEAMQAAABwVdrPKgvC1VENaAzZ//EABwQAAICAgMAAAAAAAAAAAAAAAECAAMEERITIv/aAAgBAQABBQJcZmhpOxQqynZlgjn3jueTseqxtv8A/8QAGREAAgMBAAAAAAAAAAAAAAAAAAECITEy/9oACAEDAQE/AVolRHpEcP/EABURAQEAAAAAAAAAAAAAAAAAABAB/9oACAECAQE/ASn/xAAdEAADAAAHAAAAAAAAAAAAAAAAAQIDEBEhQXKB/9oACAEBAAY/AuMtK3ZhCrwZCJ7DP//EABoQAQADAQEBAAAAAAAAAAAAAAEAETEhQWH/2gAIAQEAAT8hzGy0DAMvPYckA6RWN1ZSWcXiDj7MqqmK+aiL5s//2gAMAwEAAgADAAAAEF/PP//EABoRAAICAwAAAAAAAAAAAAAAAAABITERcZH/2gAIAQMBAT8QZQdZIkCdCnR//8QAGBEBAQADAAAAAAAAAAAAAAAAAQARMUH/2gAIAQIBAT8QSUzdTu//xAAcEAEAAwEAAwEAAAAAAAAAAAABABEhMUFRcZH/2gAIAQEAAT8QLA1wKfPfXJQtTrCDzfmxwehyGEoq2LtCxTzaybK24Ky/3FcAZnuXNXF+EfIF4DJ//9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"books\" title=\"\" src=\"/static/6b892b18c7b5396515cda321b3f504ea/c08c5/books.jpg\" srcset=\"/static/6b892b18c7b5396515cda321b3f504ea/0913d/books.jpg 160w,\n/static/6b892b18c7b5396515cda321b3f504ea/cb69c/books.jpg 320w,\n/static/6b892b18c7b5396515cda321b3f504ea/c08c5/books.jpg 640w,\n/static/6b892b18c7b5396515cda321b3f504ea/6a068/books.jpg 960w,\n/static/6b892b18c7b5396515cda321b3f504ea/eea4a/books.jpg 1280w,\n/static/6b892b18c7b5396515cda321b3f504ea/9568a/books.jpg 3024w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>필자의 독서 취향은 이 쪽에 가깝다.(왠지 스파이가 하나 껴있는 것 같지만 신경쓰지말자.)</small>\n</center>\n<p>그럼 왜 책을 쓰게 되었냐? 뭐 여러가지 이유가 있겠지만 몇가지로 추려보자면 대충 이렇다.</p>\n<blockquote>\n<ol>\n<li>코드 같은 무형의 작품이 아니라 내 손에 잡히고 내 눈에 보이는 유형의 작품을 만들어 내보고 싶다.</li>\n<li>책을 쓰면서 내가 두루뭉술하게 알고 있던 지식을 정리할 수 있지 않을까?</li>\n<li>생각보다 코딩을 배우기 위해서 책으로 입문하시는 분들이 많았다.</li>\n</ol>\n</blockquote>\n<p>필자가 책 쓴다고 하니까 몇몇 분들께서 “와, 에반! 이제 책으로도 돈벌겠네요?”라는 드립을 간간히 쳐주셨는데 애초에 책을 팔아서 벌 수 있는 돈은 생각보다 많지 않다고 생각했기 때문에 별로 기대를 안했다.</p>\n<p>오히려 필자에게는 책이 돈을 벌 수 있는 부수입이라기보다 책을 집필했다는 나 자신의 만족과 내가 알고 있는 무엇인가를 다른 사람들에게 알릴 수 있는 점에서 매력으로 다가왔기 때문에 집필 제의를 받아들일 수 있었던 것 같다.</p>\n<p>그건 이 블로그도 마찬가지인데, 이 블로그로 돈을 벌어봤자 솔직히 얼마나 벌겠는가? 애초에 필자의 포스팅들은 대중적으로 소비할 수 있는 컨텐츠가 아니다. 그렇기 때문에 블로그가 진짜 흥해서 많이 벌어봤자 한달에 한 100만원 벌면 많이 버는 거다.</p>\n<p>물론 100만원이 작은 돈은 아니지만 그렇다고 내 인생이 바뀌는 돈도 아니니 별 의미는 없다고 생각한다. 그래서 필자는 그냥 필자의 생각과 지식을 다른 사람과 공유하고 싶은 마음으로 블로그를 운영하고 있다.</p>\n<h3 id=\"손에-잡히는-작품을-만들어-보고-싶다\" style=\"position:relative;\">손에 잡히는 작품을 만들어 보고 싶다.<a href=\"#%EC%86%90%EC%97%90-%EC%9E%A1%ED%9E%88%EB%8A%94-%EC%9E%91%ED%92%88%EC%9D%84-%EB%A7%8C%EB%93%A4%EC%96%B4-%EB%B3%B4%EA%B3%A0-%EC%8B%B6%EB%8B%A4\" aria-label=\"손에 잡히는 작품을 만들어 보고 싶다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>필자는 개발자다 보니까 매일 프로그램을 만들어 낸다. 하지만 프로그램은 현실에 존재하는 물건이라는 느낌이라기 보다는 좀 더 추상적인 느낌으로 다가온다. 손으로 만질 수도 없고 냄새를 맡아볼 수도 없는 그런 무형의 개념체 같은 느낌이다.</p>\n<p>하지만 필자에게 책이라고 하면 딱 떠오르는 이미지는 새 책을 펼쳤을 때 풍기는 종이 냄새, 책꽂이에서 책을 꺼내올 때 느껴지는 감촉, 책장을 하나하나 넘길 때 들리는 소리와 같이 여러가지 감각이 함께 하는 공감각적인 이미지이기 때문에 프로그램을 만드는 것과는 매우 다르게 다가왔던 것 같다. 결과물이 기계적인 무언가가 아니라 어떤 형태를 지닌 물건으로 나온다는 것이 굉장히 새로운 느낌이었다.</p>\n<p>그리고 결정적으로 필자는 5살 때부터 할아버지 손 붙잡고 광화문 교보문고를 굉장히 자주 다닌 교보문고 빠돌이다. 그런 추억이 있는 광화문 교보문고에 내가 쓴 책이 진열될수도 있다는 것을 상상하니 뭔가 기분이 뭉클하면서도 묘했던 것 같다.</p>\n<h3 id=\"책을-쓰면서-내-지식도-정리하자\" style=\"position:relative;\">책을 쓰면서 내 지식도 정리하자.<a href=\"#%EC%B1%85%EC%9D%84-%EC%93%B0%EB%A9%B4%EC%84%9C-%EB%82%B4-%EC%A7%80%EC%8B%9D%EB%8F%84-%EC%A0%95%EB%A6%AC%ED%95%98%EC%9E%90\" aria-label=\"책을 쓰면서 내 지식도 정리하자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>필자가 Vue에 관한 책을 쓰긴 했지만, 당연히 Vue에 대한 모든 것을 완벽하게 알고 있는 상태로 책의 집필을 시작한 건 아니다. 물론 2년 동안 Vue를 사용했던 짬이 있으니 익숙하긴 하지만, 무언가에 익숙하다는 사실이 잘한다는 사실로 이어질 수는 없다.</p>\n<p>그래서 필자도 다시 기초부터 Vue를 쭉 공부한다는 생각으로 공식 문서부터 다시 읽어봤다. 가만보면 이런 점이 블로그 포스팅과 비슷한데, 예를 들어서 Vue의 라이프 사이클에 대한 글을 작성한다고 하면 당연히 대부분의 사람들은 리서치를 한다. 왜냐면 내가 알고 있는 것이 정답이라고 확신하지 못하기 때문이다. 이런 점에서 보면 책이든 블로그든 불특정 다수의 사람들이 내 글을 읽는다는 점에서 느껴지는 부담감은 비슷한 것 같다.</p>\n<p>게다가 필자는 사실 Vue를 따로 공부했던 적이 없다. 그냥 회사에 입사했는데 그 회사에서 Vue를 이미 도입한 상태였기 때문에 필자도 Vue를 사용한 게 시작이었고, 그 이후로는 그냥 비즈니스를 개발하면서 필요한 건 그때그때 찾아보면서 사용했었다. <small>(그래서 입사 초반에 작성한 컴포넌트를 보면 완전 개판 오분전이다.)</small></p>\n<p>이런 이유로 필자는 “기왕 이렇게 된 김에 VueJS에 대한 내 지식을 제대로 한번 다져보자”라고 생각하게 되었던 것이다.</p>\n<h3 id=\"생각보다-코딩을-배우기-위해서-책으로-입문하는-사람이-많았다\" style=\"position:relative;\">생각보다 코딩을 배우기 위해서 책으로 입문하는 사람이 많았다.<a href=\"#%EC%83%9D%EA%B0%81%EB%B3%B4%EB%8B%A4-%EC%BD%94%EB%94%A9%EC%9D%84-%EB%B0%B0%EC%9A%B0%EA%B8%B0-%EC%9C%84%ED%95%B4%EC%84%9C-%EC%B1%85%EC%9C%BC%EB%A1%9C-%EC%9E%85%EB%AC%B8%ED%95%98%EB%8A%94-%EC%82%AC%EB%9E%8C%EC%9D%B4-%EB%A7%8E%EC%95%98%EB%8B%A4\" aria-label=\"생각보다 코딩을 배우기 위해서 책으로 입문하는 사람이 많았다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>앞서 얘기했듯이 필자는 “공부는 책보다는 인터넷이 편하지!”라고 생각하는 사람이라서 기술 서적에 대한 시각이 회의적인 편이었다. 그래서 처음 친구가 공동 집필 제의를 해줬을 때도 책을 쓴다는 것 자체가 조금은 의미 없는 일로 느껴졌고 “요즘 시대에 누가 책보고 공부하냐? 다 인터넷으로 검색해서 하지.”라는 말도 했었는데, 그 친구 말이 딱 이랬다.</p>\n<blockquote>\n<p>야, 처음 공부하시는 분들은 인터넷에서 어떤 키워드로 뭘 찾아봐야 하는지도 알기 힘들수도 있어.</p>\n</blockquote>\n<p>이 얘기를 듣고 필자가 생각이 많이 짧았다는 것을 바로 깨달을 수 있었다. 어디선가 “인간은 무의식적으로 타인에게 자신의 모습을 투영하려고 한다”라는 글을 본 적이 있는데, 필자가 딱 그 모양이었던 것이다.</p>\n<p>필자가 늘 인터넷으로 공부하는 것이 익숙했기 때문에 당연히 다른 분들도 그럴 것이라 생각했던 것인데, 기본적으로 인터넷으로 공부를 한다는 것은 어떤 키워드로 구글링을 해야 내가 원하는 정보가 나오는 지 알고 있다는 전제가 필요하다는 사실을 잊고 있었다.</p>\n<p>당연히 처음 개발을 접하거나 혹은 구글링이 익숙하지 않은 분들은 이런 점에서 진입 장벽을 느낄 수 있는데, 필자는 그 부분을 생각 안하고 있던 것이다. 그래서 친구의 저 말을 듣고 필자는 이런 마음이 들었다.</p>\n<blockquote>\n<p>상대적으로 진입 장벽이 낮은 책을 통해 공부한 후에 혼자 구글링을 할 수 있는 역량을 만드는 게 더 나을 수 있겠다.</p>\n</blockquote>\n<p>물론 당연히 책 한권 읽었다고 갑자기 Vue의 절대 고수가 되거나 그런건 아니겠지만, 적어도 책을 읽고 전반적인 내용을 이해한 후에 더 알아보고 싶은 것은 혼자서 키워드를 찾아내서 구글링 및 공부를 할 수 있는 능력을 독자 분들이 가질 수 있도록 도와주고 싶었다.</p>\n<p>이 이외에도 이력서에 뭐라도 한줄 더 쓸 수 있다거나 “작가라니 조금 근사한 걸…?”처럼 좀 깨는 이유도 있고 “개발랭이들의 생태계에 조금이라도 도움이 될 수 있겠다”라는 이타적인 이유도 있었지만 필자의 동기 부여에 큰 영향을 끼친 대표적인 이유는 저 위의 3가지였다. 결국 고민 끝에 2018년 8월 말, 필자는 친구 손을 잡고 고난의 길로 들어서게 되었다.</p>\n<h2 id=\"책을-쓰기-전에\" style=\"position:relative;\">책을 쓰기 전에<a href=\"#%EC%B1%85%EC%9D%84-%EC%93%B0%EA%B8%B0-%EC%A0%84%EC%97%90\" aria-label=\"책을 쓰기 전에 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>친구와 공동 집필이 결정된 후 제일 먼저 출판사 직원분과 역삼역 근처 카페에서 간단한 미팅을 가졌다. 내용은 뭐 대략 집필 계획서를 보내달라, 인세는 어떻게 나온다, 계약은 어떻게 진행될 것이다와 같은 간단한 내용들이었다.</p>\n<p>이때까지만 해도 필자와 친구는 대략 “이러이러한 내용을 써야겠다” 정도로만 얘기가 된 상태였지만 이제 출판사에 보낼 집필 계획서를 작성하기 위해 상세한 논의를 해야했다. 이때 협의되었던 몇가지 내용들 중 핵심 포인트는 “이 책을 읽고 회사에 입사했을 때 최소한 어플리케이션 개발 자체는 할 수 있어야 한다”였다.</p>\n<p>이 얘기는 지금 시중에 나와있는 다른 Vue 책을 몇개 읽어보고 나서 나오게 된 것이다. 시중에 판매되고 있는 책들은 대부분 해당 기술에 대한 API나 기술의 원리 등을 중점으로 설명하고 있었고, 예제 또한 간단한 To Do 리스트 또는 그와 비슷한 아키텍처를 가지는 작은 어플리케이션을 만들어 보는 편이었다.</p>\n<p>이런 책들을 읽어보며 필자와 친구가 느꼈던 아쉬운 점은 “이걸 읽고 바로 실무에 투입되면 일을 할 수 있나?”라는 점이었다.</p>\n<p>아무리 책을 통해 Vue의 API가 어떤 것이 있는지, 라이프 사이클은 어떤 순서로 실행 되는 지와 같은 지식을 익혔다고 해도 회사에 입사한 후에 신입 개발자가 마주하는 문제들은 “어떤 라이프 사이클에 이 로직을 넣을까?”같은 단순한 문제가 아니라 “컴포넌트는 어떤 단위로 나누어야 하나?”, “API 통신 로직은 컴포넌트에 있어야 할까? 아니면 Vuex 스토어에 있어야 할까?”, “유저가 로그인한 상태는 어떻게 관리해야하지?”와 같이 한 수준 더 높은 문제들이다.</p>\n<p>그래서 필자는 독자 분들이 이 책의 예제를 한번 작성해보고 회사에 갔을 때, 그 문제를 해결하는 건 둘째치고 “어, 이거랑 비슷한거 언제 한번 해봤는데?”라는 생각이 들게 하는 것만 해도 성공이라고 생각했고 친구도 필자와 동일하게 생각하고 있었기 때문에 책의 큰 방향을 정하는 건 어렵지 않았다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 484px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/b3c3597b655396c4c38d530c43a47da5/ff42b/plans.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 97.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAACdElEQVR42q1VS4/TMBDO/78hxAEJiRsHThwQEkIIcYATatG2tLtd+kjSNG2Tps37aX/M2A3bpj30sI5Gntieycw3nycGaNQNnm0Yfizx6kuBgS3otcFofI/ZbAbLttHv/4azWsG0LPR7PYxGY8RJgiDYUxANJFl0xYhziQ+/asw9veR5Hna+jzSJSd+omWWzduF7W1RliSxNIIW4HmGcCxSVQFoIRJlAVkmkpURSPM1Kr7Tw+YSCiLIGIQnbRP9nASMhR1mpRetSCTtj51kFvVZL5OpdqL2c1vNan9Mf1vZGkEi8+VZi7HDKQuFn2xYcZ4nh4E6l6ixJHw4w/TvBkvYYEsucY/JwjyzLEIUH1FWlU44o/Hc/KjyuhcJw6bjYbDaIohjueo0wDEmP6CMOXNfFfr9HQoXxyema9itylCQp6iNVDKHAFZBSgnWebxEeXZ3tDb1wefB0dNe7Dk8DMfaE4dvvJR7cFsM5loTZivg3HA6x3W5VavzuOI6SNE1V6kVRXNLmkEq8/lpi5GgMbXsJl4wZOzYOgkAZe+SYOcofyPNcFaM6FuLM4ROGQoWOK2l0sWv3eO6KIfggPTxr/Ry7a0WQR6fKuZRnYoTE7vc/I8y3tYrUNC1YdHdN01Sy2+2ISo7SGUfGkylT0hWM4/iigETsBi8+BfhjlwrDBRkuFgtVGHbM+LE+nU4VD3mNseWC8N6FQw6zacRZyvKEGqJLo/ZMu99NuVuUa4VoAW+oZXHbak7koijcvj72apj+sX0RPowRU4RTZQwZL6bKTQ2Wm8PLzyXurPYurxT4NjXYyWSieMdEPhwOtzlsfwHymX4B/wCJuw6H/YhU0QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"plans\" title=\"\" src=\"/static/b3c3597b655396c4c38d530c43a47da5/ff42b/plans.png\" srcset=\"/static/b3c3597b655396c4c38d530c43a47da5/69538/plans.png 160w,\n/static/b3c3597b655396c4c38d530c43a47da5/72799/plans.png 320w,\n/static/b3c3597b655396c4c38d530c43a47da5/ff42b/plans.png 484w\" sizes=\"(max-width: 484px) 100vw, 484px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>어디선가 많이 본 짤이 떠오르는 장면</small>\n</center>\n<p>책의 큰 방향이 정해진 후 필자와 친구는 퇴근 후에 일주일에 한두번은 꼭 만나서 근처 카페로 간 뒤에 집필 계획서를 함께 작성하기 시작했다. 집필 계획서에는 대략 이런 정보가 포함된다.</p>\n<blockquote>\n<ol>\n<li>제목(가제)</li>\n<li>작성자</li>\n<li>작성일</li>\n<li>책의 핵심 컨셉</li>\n<li>내용 요약 및 특징</li>\n<li>이 책과 관련된 기술의 동향</li>\n<li>예상되는 탈고 날짜</li>\n</ol>\n</blockquote>\n<p>이외에도 몇가지 정보가 더 있지만 큰 틀은 대충 이렇다. 이때 작성한 집필 계획서는 향후 출판사가 책을 홍보할 때 사용하는 자료이기도 한 만큼 되도록이면 자세하게 작성하는 것이 좋다.</p>\n<p>어쨌든 출판사에서 요구한 대로 집필 계획서를 작성해서 제출한 뒤 본격적인 집필을 시작했다.</p>\n<h2 id=\"개발자처럼-집필하자\" style=\"position:relative;\">개발자처럼 집필하자!<a href=\"#%EA%B0%9C%EB%B0%9C%EC%9E%90%EC%B2%98%EB%9F%BC-%EC%A7%91%ED%95%84%ED%95%98%EC%9E%90\" aria-label=\"개발자처럼 집필하자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>처음에는 구글 독스(Google Docs)를 사용하여 집필을 시작했다. 구글 독스는 H1, H2과 같은 글꼴 스타일 기능을 제공해주기 때문에 미리 합의한 스타일을 정해놓고 문서를 작성할 수 있었다. 하지만 구글 독스로 챕터 3개 정도를 작성했을 때, 필자는 구글 독스가 굉장히 비생산적이라는 생각이 들기 시작했다.</p>\n<p>글꼴을 변경하거나 이미지를 첨부하는 등의 행위를 할 때 변경하고자 하는 부분에 커서를 위치시킨 뒤 마우스로 메뉴를 클릭해서 진행해야하는 방식이 너무 번거로웠고, 그때마다 집중의 흐름이 끊겨서 불편했다. 게다가 각 챕터 별로 문서를 새로 만들때마다 글꼴 스타일을 출판사 규격에 맞게 매번 설정해줘야 한다는 점 또한 생산성을 저하시켰다.</p>\n<p>그리고 필자와 친구는 서로 놓치고 간 부분을 잡아주거나 문체의 통일을 위해 구글 독스 문서에 코멘트를 남기는 방식으로 서로 작성한 부분을 리뷰했다. 그러나 이 방식은 필자가 생각하기에 조금 비생산적이었는데, 리뷰를 하는 입장에서는 이번에 추가된 내용이 무엇인지, 삭제된 내용이 무엇인지 알기 힘들었고, 리뷰를 받는 입장에서는 댓글이 문서의 어느 부분에 달렸는지도 한 눈에 알아보기가 힘들었다.</p>\n<p>그래서 필자는 “어떻게 하면 글쓰기 외의 다른 행동에 시간을 쓰지 않고 글쓰기에만 집중할 수 있을까?” 라는 고민을 하기 시작했다.</p>\n<h3 id=\"markdown을-사용하여-책-집필하기\" style=\"position:relative;\">Markdown을 사용하여 책 집필하기<a href=\"#markdown%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EC%B1%85-%EC%A7%91%ED%95%84%ED%95%98%EA%B8%B0\" aria-label=\"markdown을 사용하여 책 집필하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>필자가 고민한 결과로 선택한 것은 바로 마크다운(Markdown) 포맷이었다. 필자와 친구 둘 다 개발자이기 때문에 일단 마크다운 포맷은 우리에게 굉장히 익숙한 포맷이었고, 문서의 전체적인 스타일도 이미 정해져있기 때문에 스타일에 관한 걱정이나 별다른 작업 없이 계속 글쓰기에만 집중할 수 있을 것 같았다.</p>\n<p>하지만 출판사는 MS Word를 사용하여 원고를 관리하니 결국 출판사에 원고를 보낼 때는 docx 파일로 보내야 하며, 다른 리뷰어 분들에게 책에 대한 리뷰를 받을 때에는 pdf 파일로 보내드려야 했다. 그래서 마크다운 파일을 docx나 pdf 파일로 컨버팅할 수 있는 방법을 찾아야 했다.</p>\n<p>그래서 찾아낸 게 <a href=\"https://pandoc.org/\" target=\"_blank\" rel=\"nofollow\">pandoc</a>과 <a href=\"https://github.com/alanshaw/markdown-pdf\" target=\"_blank\" rel=\"nofollow\">markdown-pdf</a>라는 라이브러리였다. <code class=\"language-text\">pandoc</code>은 홈페이지에 Universal Document Converter라고 홍보하고 있을 만큼 다양한 포맷의 문서 변환을 지원해준다. 물론 마크다운을 docx로 컨버팅하는 기능도 지원한다. 하지만 마크다운을 pdf로 컨버팅하는 기능은 지원하지 않기 때문에 해당 기능을 구현하기 위해 다른 라이브러리를 찾아야했는데, 그 과정에서 <code class=\"language-text\">markdown-pdf</code>라는 라이브러리를 찾았다.</p>\n<p>여기까지 리서치를 마친 필자는 친구에게 구글 독스에서 마크다운으로 갈아타자는 제안을 했고, 친구도 고민 끝에 수락하여 이후 책의 집필은 모두 마크다운과 깃(Git)을 사용하여 진행했다.</p>\n<h3 id=\"git을-이용한-문서의-버전관리\" style=\"position:relative;\">Git을 이용한 문서의 버전관리<a href=\"#git%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AC%B8%EC%84%9C%EC%9D%98-%EB%B2%84%EC%A0%84%EA%B4%80%EB%A6%AC\" aria-label=\"git을 이용한 문서의 버전관리 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>구글 독스를 사용할 때 겪었던 또 다른 문제점 중 하나가 바로 문서의 버전관리가 힘들다는 것이다. 물론 구글 독스도 <code class=\"language-text\">파일 > 버전기록</code> 메뉴에 들어가면 각 버전에서 추가된 내용이나 삭제된 내용을 확인할 수 있지만, 그 버전이 정확히 어떤 단위로 묶인 단위인지 명확하지않다는 것이 단점이다.</p>\n<p>하지만 깃을 사용하면 커밋을 할 때 의미있는 단위로 나누고 정확한 커밋 메세지를 작성함으로써 정확히 문서의 어떤 부분을 수정했는지 상대방에게 알릴 수 있다. 또한 일정 단위의 문서를 작성하고나면 풀 리퀘스트(Pull Request)를 통해 상대방에게 리뷰를 받는 식으로 서로 작성한 부분에 대해서 최소 1번 이상은 리뷰를 하도록 할 수 있다.</p>\n<p>그래서 필자와 친구는 깃허브(Github)에 레파지토리를 하나 생성하고 챕터 단위로 하나씩 맡아서 집필을 진행하되, 내용을 마스터 브랜치에 머지하고 싶을 땐 반드시 풀 리퀘스트를 보내고 머지하도록 협의하였고 그 결과 서로 작성한 부분이 아니더라도 내용을 파악하는데 큰 어려움이 없이 집필을 진행할 수 있었다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/4ab6fb78bbb128bf0fd837c9b548a5ae/6569d/review.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 69.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB9klEQVR42pWUDY+cIBCG/f9/rW2aXu9y7tb1E79FRF1PQPbtwDbpJU3bPZMnw4CMA/OOgVxWdANHz0e0/YCm6yFlA9F/xrpkOCxgjoOwf3DQvDYG6h3BVlRYLxlUXuHadhiyDqKoMeQnjCyFqBrIusXcdJAOGk805xjLGlpI2HnFIRcYssF2jrC/hMAlhXabsxIiLjDQR8Y4Q3v+gSnNyE/QRzFxAaexzAvotoel04ELz22cELSmQ6lKFNccfOfIuwKMMyR1irTNEdcJ4ipBVMaI2AUXsm4t63IUfYFiYBBqgjQSUs0I4ijEKXxCwwewukJHdhAC132HPoy/v8Na2NvtF7/HxtIa+ZrsdX/zfrCMA2TfYqCijOOIjorCOcc8L+QLLFS0R54bfcARvIYnfPry1QdjZQXGSm85+ZOcIWeC7L8eSyfY6UTOBkmS4HQ6+wkx0V1I6YO0HVVbTJThAqXU4xlGVLVv35/95rpuUDctGmIkf12v2LYNy7q6HY9leCbZPPmAAjlJoW4aJGmKljSptPbiNSTY/2Xn3vMZcipI31TYlfEBjLmr33G4brB37t3yd9y7SlOnJOcQcfiMeX2D1vdM3KL2gT/GrjQCF51Rh5QEq2rEWYGJJPP+oh/FaTNwxxReHivcj2Kintx2V9XbxwNai5/EnTY9Y+pYrwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"review\" title=\"\" src=\"/static/4ab6fb78bbb128bf0fd837c9b548a5ae/6af66/review.png\" srcset=\"/static/4ab6fb78bbb128bf0fd837c9b548a5ae/69538/review.png 160w,\n/static/4ab6fb78bbb128bf0fd837c9b548a5ae/72799/review.png 320w,\n/static/4ab6fb78bbb128bf0fd837c9b548a5ae/6af66/review.png 640w,\n/static/4ab6fb78bbb128bf0fd837c9b548a5ae/d9199/review.png 960w,\n/static/4ab6fb78bbb128bf0fd837c9b548a5ae/21b4d/review.png 1280w,\n/static/4ab6fb78bbb128bf0fd837c9b548a5ae/6569d/review.png 1328w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>리뷰를 하면 좋은 점.jpg</small>\n</center>\n<p>물론 나중에 전체 리뷰를 할 때 한번에 고쳐야 될 부분이 많아지는 경우가 있어서 충돌(Merge Conflict) 때문에 조금 고생하기는 했지만, 구글 독스로 진행했다면 두 명이 동시에 수정한 부분이 어딘지도 모르고 넘어갔을 가능성이 컸을 것이다.</p>\n<h3 id=\"문서-컨버팅-하기\" style=\"position:relative;\">문서 컨버팅 하기<a href=\"#%EB%AC%B8%EC%84%9C-%EC%BB%A8%EB%B2%84%ED%8C%85-%ED%95%98%EA%B8%B0\" aria-label=\"문서 컨버팅 하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이렇게 작성된 문서는 중간중간 PDF로 변경되어 부분 출판되었다. 밑에서 다시 설명하겠지만, 집필 초기에 친구가 제안했던 “책의 타겟 독자층을 모집해서 우리 책으로 스터디를 진행해보자”라는 아이디어를 냈었다. 그래서 매주 토요일마다 집필된 책을 참고 자료로 사용하여 스터디를 진행하고 있었기 때문에 지속적으로 md 파일을 pdf로 변경해야했었다.</p>\n<p>그래서 <code class=\"language-text\">markdown-pdf</code> 라이브러리를 사용하여 간단한 출판 스크립트를 작성했고 챕터 하나의 집필이 끝날 때 지속적으로 부분 출판하여 스터디에 참여하신 분들이 끊기지 않고 진도를 나갈 수 있도록 했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// vuejs-book/scripts/publish.js</span>\n<span class=\"token function\">glob</span><span class=\"token punctuation\">(</span><span class=\"token string\">'book/**/*.md'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> mdFiles</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> pdfFilePaths <span class=\"token operator\">=</span> mdFiles<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Ready </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>path<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> newPath <span class=\"token operator\">=</span> path\n      <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'book/'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>destDir<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.md'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.pdf'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> newPath<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n  <span class=\"token function\">mdpdf</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">preProcessHtml</span><span class=\"token operator\">:</span> <span class=\"token function\">preProcessHtml</span><span class=\"token punctuation\">(</span>basePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">cssPath</span><span class=\"token operator\">:</span> <span class=\"token string\">'./custom.css'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">remarkable</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">html</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>mdFiles<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>pdfFilePaths<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    pdfFilePaths<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">pdf</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Created </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pdf<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">preProcessHtml</code>는 컨버팅을 진행한 후 책에 들어간 이미지의 경로가 맞지 않아 pdf 파일에서 이미지가 출력되지 않는 이슈 때문에 작성한 함수인데, 마크다운을 우선 HTML로 파싱한 후 <code class=\"language-text\">img</code> 엘리먼트를 찾아서 <code class=\"language-text\">file://</code> 프로토콜을 사용한 링크로 바꿔주는 역할을 한다. 이 과정을 거치고 난 후 HTML을 pdf로 컨버팅했더니 이미지가 정상적으로 첨부되는 것을 확인할 수 있었다.</p>\n<p>이렇게 출판한 pdf 파일들을 구글 드라이브에 업로드해서 스터디원이나 리뷰어 분들이 부분 출판된 내용을 바로바로 확인할 수 있도록 진행하였다. 그리고 출판사에 보낼 docx 파일은 <code class=\"language-text\">pandoc</code>을 이용하여 컨버팅하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// vuejs-book/scripts/deploy.js</span>\n<span class=\"token function\">glob</span><span class=\"token punctuation\">(</span><span class=\"token string\">'book/**/*.md'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> mdFiles</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  mdFiles<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> chapter <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Ready for </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chapter<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> newPath <span class=\"token operator\">=</span> path\n      <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'book/'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>destDir<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chapter<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/README.md</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chapter<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.docx</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> args <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">-f markdown -t docx -o </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>newPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// https://pandoc.org/MANUAL.html#syntax-highlighting 코드 하이라이팅 볼것</span>\n    <span class=\"token keyword\">const</span> originSource <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>path<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> source <span class=\"token operator\">=</span> originSource<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\(\\/assets</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>basePath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/assets</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">nodePandoc</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Finish </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chapter<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이렇게 작성된 문서 컨버팅 스크립트들은 npm script로 등록하여 언제든 간편하게 md 포맷을 pdf와 docx 포맷으로 뽑아낼 수 있도록 했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token comment\">// package.json</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"publish\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node scripts/publish.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"deploy\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node scripts/deploy.js\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>사실 처음에 md 포맷을 pdf로만 변경할 때는 별 문제가 없었는데 나중에 <code class=\"language-text\">pandoc</code>을 통해 docx 포맷으로 변경할 때 글꼴 스타일에 관련된 이슈가 발생했다.</p>\n<p><code class=\"language-text\">pandoc</code>을 사용하여 docx 포맷으로 컨버팅할 때 일명 레퍼런스 문서라는 것을 설정할 수 있는데, 이 문서에 커스텀 글꼴 스타일을 설정해놓으면 컨버팅 되는 문서에서 이 문서의 글꼴 스타일을 참고하여 동일한 글꼴 스타일을 사용한 문서로 만들어준다.</p>\n<p>그래서 처음에는 이 기능만 믿고 “출판사 포맷대로 글꼴 스타일을 설정해놓은 레퍼런스 문서를 하나 만들어놓으면 되겠구나”했었는데 막상 레퍼런스 문서 옵션을 사용하여 스크립트를 돌려보니 문서에 첨부한 코드 블록의 스타일이 와장창나는 사태가 발생했다.</p>\n<p>그래서 결국은 마지막에 출판사에 원고를 보낼 때에는 <code class=\"language-text\">pandoc</code>을 사용하여 md 포맷을 docx 포맷의 기본 글꼴 스타일로 컨버팅 한 후에 그 문서의 글꼴 스타일을 직접 수작업으로 변경하는 방법을 사용했다.</p>\n<p>뭐 마지막에는 꽤 삽질을 하긴 했지만 그래도 md 포맷을 택함으로써 집필 과정에서 시간을 많이 줄일 수 있었고, 게다가 Git을 사용한 버전관리도 할 수 있엇으므로 결과적으로는 좋은 선택이었다고 생각한다.</p>\n<h2 id=\"공동-집필-과정에서의-충돌\" style=\"position:relative;\">공동 집필 과정에서의 충돌<a href=\"#%EA%B3%B5%EB%8F%99-%EC%A7%91%ED%95%84-%EA%B3%BC%EC%A0%95%EC%97%90%EC%84%9C%EC%9D%98-%EC%B6%A9%EB%8F%8C\" aria-label=\"공동 집필 과정에서의 충돌 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>필자는 혼자 책을 집필한 것이 아니라 친구와 함께 공동 집필을 한 것이기 때문에 서로의 의견을 일치시키고 합의점을 도출해내는 커뮤니케이션도 굉장히 중요한 일 중 하나였다.</p>\n<p>사실 필자와 이 친구는 함께 사이드 프로젝트를 진행해본 경험도 있고 평소에도 성격이 꽤 잘맞는 편이라서 같이 해외여행도 다녀온 막역한 사이이다. 하지만 책이라는 매체의 특성 상 코드와 다르게 배포 후 수정이 불가능해서 “최대한 완벽하게 끝내고 싶다”라는 마음 때문에 서로 의견의 일치를 보는 것이 평소보다 더 어려웠던 것 같다.</p>\n<h3 id=\"설계에-대한-관점의-차이\" style=\"position:relative;\">설계에 대한 관점의 차이<a href=\"#%EC%84%A4%EA%B3%84%EC%97%90-%EB%8C%80%ED%95%9C-%EA%B4%80%EC%A0%90%EC%9D%98-%EC%B0%A8%EC%9D%B4\" aria-label=\"설계에 대한 관점의 차이 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>처음에 의견 충돌이 많이 났던 것은 예제 어플리케이션의 설계였다. 책에 들어가는 예제는 불특정 다수에게 노출되는 정보이기 때문에 최대한 주관성을 배제하고 널리 통용될 수 있는 지식을 사용하여 작성되어야한다. 그래서 필자와 친구는 “예제 어플리케이션의 설계를 어떻게 가져갈 것인가?”로 엄청 많은 이야기를 나누었다.</p>\n<p>간단하게는 컴포넌트의 네이밍과 프로젝트의 디렉토리 구조에서부터 스토어의 상태의 변경을 위한 액션은 어떤 컴포넌트가 Dispatch하는 것이 맞는 것이냐와 같이 심도있는 주제까지 다양한 이야기를 나누었다. 결국 이런 끊임없는 커뮤니케이션을 거쳐서 합의점을 도출해내고 나서야 예제 어플리케이션 개발에 들어갈 수 있었다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/b0843883f37a5a8955d1b73bfc9d2333/077b7/meeting.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 79.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAADD0lEQVR42oWUa08iSRSG/f+bmNkPO2pgBFQIgtLNTRp0hnvb3G+iwAADCA6O1wG8jIjPVrf7YbMZ3Ure1Knq1JNzTnW9S/f394yGQ4anp1xfXzEajTgVca/f5+LykrOz74aGxv7QmMfn5/TF916vx3g8Ns4MBWMwGLD0NH+iUq1RKFVotdo0ThpUKiV63Q73d1Nmk1smP2/5eXPNzdWV0CV3syl3d3foyTw+Php6eHgw9pZeXhb0OwJSzlGvFvl6XKJeztA5zjM4KdKtZWiXNVpFlXw6SkzxMug00cfLywv/HQbwdtzh/FuNq+EJP/p1jisazeohp80CXysq9VycqhZFjYZRfDt0mvV3gIsFN9/bJJJx1MM0bZFZQ8BymRjlfJJyNkYmuU8uGSYvlAx76Lcb7wMvR01RrkY8lUA7TJJRoyhhBY8vgC/gZ8OxzV5QQovvcRBw0f2/DAfdiujdId2G6N1JRpScolaMk05ECIf8RPf9fIl4iR/IhGQ77cbR+8BOI0cpd0C1EDNA1XyUZFxB9kkEgn58fpmg3yOgEv6dTVrHtbeBCwFsHomeqXsUM6JXqoKWVkR2IZSQF4+0gyy7kSUniih31/GJo3LxH+Did8Bn6qUE6ZiXVNRH7MBD7LNMMiZKjci4XA6CXidhv5OgZMdhXaFUyL0CF28Ay9kvxPd3RI8k9hUXkZCLoG+bLfsG1g0rm1tWbLZ1tjbWWfv4gXIhaxxe/Bb4/ExOlBgJ2IkEnYR8DsIBJ9KunVWTmTWTCavFzMeVFUymVZaX/6CYz7wNfJ7PiUc8+Nxm/B6boaC8hSyaL7ltSC4bnm0Lu85PuB1mLKvL5LPqK1Ako1/Mv7U0F29Z8YreWP7EbV8VWhMAM163FdllMWAepwXXpklojfW/RIa59NsZ6g+8kNfQVPFSUuJVHKaMtV5WVlONWVOT4iKy4vbFj68mhIHUhQOdGS6ju47uTrrbXFxc6BnO6Xa/0Wy2aDSaIu7SbncM93h1kl/ci/hBxLPZjF9PT4bLTKdTYz2ZTIxYl77/N/+2Z+cT2oKYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"meeting\" title=\"\" src=\"/static/b0843883f37a5a8955d1b73bfc9d2333/6af66/meeting.png\" srcset=\"/static/b0843883f37a5a8955d1b73bfc9d2333/69538/meeting.png 160w,\n/static/b0843883f37a5a8955d1b73bfc9d2333/72799/meeting.png 320w,\n/static/b0843883f37a5a8955d1b73bfc9d2333/6af66/meeting.png 640w,\n/static/b0843883f37a5a8955d1b73bfc9d2333/d9199/meeting.png 960w,\n/static/b0843883f37a5a8955d1b73bfc9d2333/077b7/meeting.png 1166w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Form 컴포넌트의 정의부터 시작해서 어떤 라이브러리를 사용할 것인지까지 일일히 다 정했었다.</small>\n</center>\n<h3 id=\"일하는-스타일의-차이\" style=\"position:relative;\">일하는 스타일의 차이<a href=\"#%EC%9D%BC%ED%95%98%EB%8A%94-%EC%8A%A4%ED%83%80%EC%9D%BC%EC%9D%98-%EC%B0%A8%EC%9D%B4\" aria-label=\"일하는 스타일의 차이 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>두 번째는 바로 일하는 스타일이었다. 사실 이게 정말 의외인 부분이었는데, 이미 필자는 이 친구와 사이드 프로젝트를 진행한 경험이 있었고, 도중에 의견 충돌이 나더라도 굉장히 서로 만족할 만한 결론을 도출해내면서 진행해왔기 때문에 이번에도 마찬가지일 것이라고 생각했다. 근데 이게 돈받고 하는 일이라서 그런지, 아니면 마감 기한이 정해져 있는 일이라서 그런지는 몰라도 사이드 프로젝트 때와는 굉장히 다른 상황이 펼쳐졌다.</p>\n<p>일단 필자는 어떤 일을 하든 마감 기한에 쫓기면서 하는 스타일이 아니다. 이렇게 할 수 있는 이유는 필자가 일하는 중간에 생기는 변수를 최소화하고 리스크가 생길 것 같은 일을 아예 차단해버리는 스타일이기 때문이다. 그리고 결정적으로 성격 자체가 좀 느긋하다. 좋게 말하면 느긋한거고 나쁘게 말하면 게으른거긴 한데, 뭐 어쨌든 그런 성격이다.</p>\n<p>하지만 이 친구는 뭘 하든 열정이 장난아니다. 하기 싫은 일이든 하고 싶은 일이든 항상 최선을 다하는 스타일이다. 이 친구가 이렇게 할 수 있는 이유는 기본적으로 책임감이 큰 성격이라서 그렇다고 생각한다. <small>(뭐 아닐 수도 있다. 아무리 친구라도 모르는 부분은 있으니)</small></p>\n<p>이 친구의 바로 이런 부분들이 필자에게 굉장히 자극을 주는 부분이고 친구라는 부분을 제외하고 개발자 대 개발자로 생각해도 굉장히 좋은 개발자라고 생각한다.</p>\n<p>하지만 같이 마감기한이 있는 일을 하다보니 이 친구 입장에서는 필자가 적극적으로 참여하지 않는다는 마음이 있었던 것 같고, 필자는 필자대로 “이게 이렇게까지 스트레스를 받으면서 할 일은 아닌데…”라는 생각이 있었던 것 같다. 그리고 이게 사람인 이상 마감기한이 다가올수록 “출판사와의 약속을 지키지 못하면 어떡하나”라는 불안감도 들기 마련이고, 둘 다 직장을 다니고 있기 때문에 회사 일은 또 회사 일대로 해야하는 상황이었다. 그래서 육체적인 피로감과 정신적인 피로감이 점점 쌓여서 그랬던 것 같기도 하다.</p>\n<p>그래도 다행히 이 친구와 필자의 가장 큰 공통점은 커뮤니케이션과 같은 소프트 스킬의 중요성을 알고 있다는 점이었다. 그래서 서로 마감기한에 쫓겨 스트레스를 받고 있는 상황에서도 최대한 서로를 배려하고 서로의 의견을 많이 듣고 교환하는 과정을 통해 큰 갈등 없이 책 집필을 마칠 수 있었다.</p>\n<h2 id=\"책-리뷰하기\" style=\"position:relative;\">책 리뷰하기<a href=\"#%EC%B1%85-%EB%A6%AC%EB%B7%B0%ED%95%98%EA%B8%B0\" aria-label=\"책 리뷰하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>책을 집필하는 동안 필자와 친구가 풀 리퀘스트를 사용한 리뷰를 계속 하긴 했지만 작가 시점의 리뷰는 주로 오탈자 수정, 문체의 통일 등의 기계적인 리뷰라면 다른 리뷰어 분들이 해주시는 리뷰는 “이 내용이 정말 도움이 되는가?”, “이런 내용이 있으면 더 좋을 것 같다.”와 같이 작가의 시점에서는 알아차리기 힘든 정성적인 리뷰들이다. 그래서 책을 집필하는 중이나 책을 집필한 후에 리뷰어 분들의 피드백을 최대한 많이 수집하고자 했다.</p>\n<p>사실 필자는 개발자 인맥도 별로 없고 사람 만나는 걸 좋아하는 편도 아니라서 직장 동료 외에는 리뷰를 부탁할 수 있는 사람이 많지 않았다. 하지만 친구는 필자보다 인맥도 풍부하고 사회성도 좋아서 리뷰를 부탁할 수 있는 사람도 많았다. <small>(대단쓰…)</small> 그런 이유로 책 리뷰는 필자 혼자서는 진행하지 못했을 일이고 진짜 친구 덕이 크다. 그리고 필자도 이 경험을 바탕으로 “아 나도 네트워킹 좀 해야하나…?”라는 생각이 싹트기 시작했다.</p>\n<h3 id=\"스터디원들의-리뷰\" style=\"position:relative;\">스터디원들의 리뷰<a href=\"#%EC%8A%A4%ED%84%B0%EB%94%94%EC%9B%90%EB%93%A4%EC%9D%98-%EB%A6%AC%EB%B7%B0\" aria-label=\"스터디원들의 리뷰 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>위에서 한번 설명했듯이, 책을 처음 집필할 때 이런 리뷰의 중요성을 알았던 친구가 먼저 책의 타겟 독자층을 모집해서 우리 책으로 스터디를 진행해보자는 아이디어를 제안해주었고 필자는 처음에는 고민했지만 다른 리뷰어분들이 해주시는 리뷰가 중요하다는 말에 설득당해서 스터디를 진행하게 되었다.</p>\n<p>필자는 낯을 가리는 성격이라 처음 보는 사람들과 스터디를 한다는 것에 대해서 익숙하지가 않다. 그래서 처음에는 “내가 스터디원들에게 뭘 해드려야하지…?”라는 고민을 굉장히 많이 했는데 막상 스터디가 시작되고 나니 그런 걱정은 필자의 기우였다는 것을 알 수 있었다.</p>\n<p>스터디를 지원해주신 모든 분들이 굉장히 열정적으로 질문도 먼저 건네주시고, 더 알고 싶은 부분에 있어서도 확실하게 의사 표현을 해주셔서 필자도 편한 마음으로 스터디를 진행할 수 있었다. 그리고 모두 성격이 좋으셔서 낯가림이 심한 필자도 잘 어울릴 수 있었다.</p>\n<p>책을 집필하는 동안 실제 타겟 독자층이었던 스터디원들로부터 피드백을 받으며 책을 수정하다보니까 뭔가 책에 대한 자신감도 생겼고, 필자가 작성한 책으로 스터디하시면서 막힘없이 학습해나가시는 모습들을 보고 약간 뿌듯함도 느꼈던 것 같다.</p>\n<p>실제로 필자는 내가 먼저 나서서 타인에게 지식을 공유하고 싶다는 욕구는 없는 편이었는데, 이번에 책도 집필하고 스터디를 진행하면서 필자는 별 거 아니라고 생각했던 지식들이 다른 분들에게는 큰 도움이 되는 것을 보고 교육에도 조금 관심이 생기기도 했고 낯가림도 조금은 나아진 것 같다. <small>(그래도 역시 인싸의 길은 멀고도 험하다…)</small></p>\n<h3 id=\"현업-개발자분들의-리뷰\" style=\"position:relative;\">현업 개발자분들의 리뷰<a href=\"#%ED%98%84%EC%97%85-%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%B6%84%EB%93%A4%EC%9D%98-%EB%A6%AC%EB%B7%B0\" aria-label=\"현업 개발자분들의 리뷰 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>책을 모두 집필하고 난 후에 주위의 현업 개발자 분들께도 리뷰를 부탁했는데, 이런 분들을 베타 리더라고 부른다고 한다. 필자도 이번에 처음 알았다.</p>\n<p>베타 리더 분들은 각자의 여유 시간에 따라서 전체 리뷰와 챕터 리뷰로 나눠서 진행해주셨는데, 필자가 집필하면서 놓쳤던 부분을 되짚어 주시기도 하고 이해가 어려울 것 같은 설명에 대해서도 지적해주시는 등 정말 꼼꼼하게 피드백을 해주셔서 굉장히 든든했다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>사실 처음 필자는 “책? 그냥 조금 긴 포스팅 느낌일 것 같은데”라는 안일한 마음으로 시작했는데, 얼마 지나지 않아서 그게 아니라는 것을 깨달았다. 이 포스팅에는 작성하지 않았지만 예제 어플리케이션을 만드는 일도 만만치 않았는데, 문제는 예제 어플리케이션을 수정하면 같은 부분을 책에서 찾아서 코드 블록을 수정하고 코드에 대한 설명도 그에 맞춰서 바꿔줘야하는 것이었다. <small>(게다가 클라이언트 어플리케이션 2개와 API 서버까지 만들어야했다.)</small></p>\n<p>예제 어플리케이션과 책의 내용이 조금만 싱크가 어긋나도 독자는 상당한 혼란을 느낄 수 있기 때문에 이런 부분을 꼼꼼히 체크해야했는데, 이게 제일 힘들었던 것 같다.</p>\n<p>그리고 포스팅과 다르게 책은 한 주제의 호흡을 굉장히 길게 가져가야 하는 매체이다보니까 앞 쪽의 내용과 뒤 쪽이 내용의 컨셉이 달라지면 안되는데, 필자는 이렇게 긴 글을 써본 적이 없기 때문에 주기적으로 앞 쪽의 내용과 문체를 확인해가면서 집필을 해야했다.</p>\n<p>그래도 이렇게 책을 한번 집필하고 나니까 뿌듯하기도 하고 글을 적는 행위에도 많이 익숙해져서 한 주에 한두번 포스팅 올리는 것 정도는 크게 어렵지 않아서 전체적으로는 좋은 느낌이다. 이 책을 보시는 많은 예비 독자들이 유익했다고 느낄 수 있었으면 좋겠다. 특히 프론트엔드 개발을 처음 시작하시려는 분들이 이 책을 읽고 “어 뭐야 생각보다 별 거 없네?”라고 생각했으면 진짜 좋을 것 같다.</p>\n<p>그리고 마지막으로 바쁜 개인 시간 쪼개서 책을 리뷰해주신 베타 리더분들과 기술 서적 집필이라는 좋은 기회를 제안해준 김영훈 개발자에게 <strong>압도적인 감사</strong>를 올리고 싶다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/4ac69e39a60e61a01bddd4634b5d04ee/4b190/thanks.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 86.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAGAABAQADAAAAAAAAAAAAAAAAAAQBAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAFtswTKxRyQpB//xAAeEAACAgAHAAAAAAAAAAAAAAABAgADBBESEzEyM//aAAgBAQABBQIVFpUldj6QGXhSFbZGZmI9E6//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAeEAACAgICAwAAAAAAAAAAAAABAgAxESEDECKBof/aAAgBAQAGPwJnY4UGeNCwYwrcbjKnA+zQ2YTmzDE99f/EAB0QAAMAAgIDAAAAAAAAAAAAAAABESExEHFRgbH/2gAIAQEAAT8hyA5S4ZvuPgSOeGnpF7nHWhKs6BUT2h8OG1n/2gAMAwEAAgADAAAAEBMPAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB0QAQEAAwACAwAAAAAAAAAAAAERACExYfAQceH/2gAIAQEAAT8QNdEUtY7mbrYqXbUJ5xNgnKwwIEwQz1dAt/MCsCFCQliW4ZAU7NWa74zj278B7PrP/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"thanks\" title=\"\" src=\"/static/4ac69e39a60e61a01bddd4634b5d04ee/c08c5/thanks.jpg\" srcset=\"/static/4ac69e39a60e61a01bddd4634b5d04ee/0913d/thanks.jpg 160w,\n/static/4ac69e39a60e61a01bddd4634b5d04ee/cb69c/thanks.jpg 320w,\n/static/4ac69e39a60e61a01bddd4634b5d04ee/c08c5/thanks.jpg 640w,\n/static/4ac69e39a60e61a01bddd4634b5d04ee/4b190/thanks.jpg 800w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>참고로 필자의 책은 <a href=\"http://www.yes24.com/Product/Goods/76639545\" target=\"_blank\" rel=\"nofollow\">Yes24</a>에서 구경해볼 수 있지만, 아직 초판 인쇄가 끝나지 않았기 때문에 배송은 다음 달부터 가능하다.</p>\n<p>하지만 필자는 인터넷에서 책을 구매하는 것보다 나중에 교보문고 같은 오프라인 서점에 책이 입고되면 가서 직접 한번 읽어보고 사는 것을 추천하고싶다. 이 글을 읽는 미래의 독자님들께서 교보문고에 갔을 때 민트색 표지에 커피 일러스트를 보고나서 필자를 떠올리고 한번 책을 펼쳐보게 만드는 것만으로도 필자는 행복해질 것 같다.</p>\n<p>이상으로 흔한 개발랭이의 작가 입문기 포스팅을 마친다.</p>","fields":{"slug":"20190721-vuejs-book-retrospective","path":"/2019/07/21/vuejs-book-retrospective/","lang":"ko"},"frontmatter":{"title":"흔한 개발랭이의 작가 입문기","subTitle":"한번도 기술 서적을 읽어본 적 없는 개발자가 책을 썼다고?","date":"Jul 21, 2019","categories":["에세이"],"tags":["Vue","회고","개발 책","프로그래밍 책","공동집필","커피 한잔 마시며 끝내는 VueJS","책 집필","개발자"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/36bf9d7dadae859391a4aa978c7ae097/3a812/thumbnail.jpg","srcSet":"/static/36bf9d7dadae859391a4aa978c7ae097/3a812/thumbnail.jpg 320w,\n/static/36bf9d7dadae859391a4aa978c7ae097/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/36bf9d7dadae859391a4aa978c7ae097/fc5c5/thumbnail.webp 320w,\n/static/36bf9d7dadae859391a4aa978c7ae097/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/36bf9d7dadae859391a4aa978c7ae097/2d839/thumbnail.jpg","srcSet":"/static/36bf9d7dadae859391a4aa978c7ae097/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/36bf9d7dadae859391a4aa978c7ae097/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"5d271804-0558-56d2-a68f-bb8daf257830","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EC%9D%80-%EC%88%98%ED%95%99%EC%9D%B4%EB%8B%A4\">프로그래밍은 수학이다</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%88%98%ED%95%99%EC%97%90-%EC%AB%84%EC%A7%80-%EB%A7%90%EC%9E%90\">수학에 쫄지 말자!</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%95%8C%EB%A9%B4-%EB%8F%84%EC%9B%80%EC%9D%B4-%EB%90%98%EB%8A%94-%EC%88%98%ED%95%99-%EA%B0%9C%EB%85%90-3%EA%B0%80%EC%A7%80\">알면 도움이 되는 수학 개념 3가지</a></p>\n<ul>\n<li><a href=\"#%EB%AA%85%EC%A0%9Cproposition\">명제(Proposition)</a></li>\n<li><a href=\"#%EC%A7%91%ED%95%A9set\">집합(Set)</a></li>\n<li><a href=\"#%EC%88%98%ED%95%99%EC%A0%81-%EA%B7%80%EB%82%A9%EB%B2%95mathematical-induction\">수학적 귀납법(Mathematical Induction)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 필자가 많이 받은 질문 중 하나인 “개발자는 수학을 잘해야할까?”라는 질문에 대해서 한번 이야기 해볼까 한다. 물론 이 주제는 전 세계의 많은 개발자들 간에도 의견이 갈리는 내용이기 때문에 그냥 지나가는 개발자 한명의 생각일 뿐이라고 생각해줬으면 좋겠다.","html":"<p>이번 포스팅에서는 필자가 많이 받은 질문 중 하나인 “개발자는 수학을 잘해야할까?”라는 질문에 대해서 한번 이야기 해볼까 한다. 물론 이 주제는 전 세계의 많은 개발자들 간에도 의견이 갈리는 내용이기 때문에 그냥 지나가는 개발자 한명의 생각일 뿐이라고 생각해줬으면 좋겠다.</p>\n<!-- more -->\n<p>사실 필자도 수학을 잘하는 편이 아니라 그냥 컴퓨터 공부하신 다른 분들처럼 학교에서 배우긴 했는데 졸업하고 나서는 잘 기억안나는 그냥 그 정도의 수준이다. 게다가 필자는 손으로 푸는 계산이 굉장히 약하기 때문에 수학 성적이 좋았던 편도 아니다. <small>(사칙연산을 잘 틀린다.)</small></p>\n<p>그래도 인터넷에서 많은 분들이 이 주제에 대해서 이야기 해주시기도 했고, 실제로 개발자가 아닌 분들에게 이런 질문을 받은 적도 있어서 필자도 한번 이 주제에 대한 필자의 생각을 끄적여볼까한다.</p>\n<h2 id=\"프로그래밍은-수학이다\" style=\"position:relative;\">프로그래밍은 수학이다<a href=\"#%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EC%9D%80-%EC%88%98%ED%95%99%EC%9D%B4%EB%8B%A4\" aria-label=\"프로그래밍은 수학이다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>일단 근본적으로 우리가 사용하고 있는 이 컴퓨터는 사실 <code class=\"language-text\">0</code>과 <code class=\"language-text\">1</code>을 사용하는 계산기다. 그렇기 때문에 컴퓨터에는 아무래도 수학적인 내용이 많이 들어갈 수 밖에 없고, 프로그래밍을 할 때도 알게 모르게 많이 녹아있는 수학적인 개념들이 많다.</p>\n<p>그래서 사실 필자는 개발자라면 수학을 조금은 할 줄 알아야한다고 생각하는 편이다. 이 얘기를 들은 여러분은 “어? 난 수학을 잘 못하는데 지금 개발을 하고 있는데?”라고 생각하실 수도 있겠다.</p>\n<p>그러나 여기서 필자가 말하는 수학은 무슨 선형대수학이나 미적분같은 고등수학을 말하는 것이 아니다. 필자가 얘기하는 수학은 대부분 명제나 집합, n진법과 같이 이미 우리가 중고등학교에서 배웠던 정도의 수준을 이야기하는 것이다.</p>\n<p>물론 이 개념들도 결국 파고들면 파고들수록 점점 추상적이고 어려운 개념들이 나오지만 솔직히 그렇게까지 알 필요는 없다고 생각한다. 우리가 무슨 수학을 연구하는 사람도 아니고, 우리는 그냥 개발자로써 프로그래밍에 필요한 정도만 알고 있으면 된다. 중요한 것은 수학이라는 키워드에 쫄지 않는 것이다.</p>\n<p>그래서 이번 포스팅에서는 필자가 생각했을 때 프로그래밍에 도움이 되는 수학 개념 3가지에 대해서 가볍게 한번 이야기 해보려고 한다.</p>\n<h2 id=\"수학에-쫄지-말자\" style=\"position:relative;\">수학에 쫄지 말자!<a href=\"#%EC%88%98%ED%95%99%EC%97%90-%EC%AB%84%EC%A7%80-%EB%A7%90%EC%9E%90\" aria-label=\"수학에 쫄지 말자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>요즘 핫한 주제인 머신러닝이나 인공 신경망 같은 경우 호기심을 자극하는 키워드지만, 구글링을 해보면 나오는 검색 결과는 우리의 공부 의욕을 꺾어놓는다.</p>\n<blockquote>\n<p>…</p>\n<p>해답이 어떤 데이터에 의존적인 경우, 비용은 관측값에 대한 함수가 되어야 하며, 그렇지 않을 경우에는 데이터와 관련된 어떤 것도 모델링할 수 없게 된다. 많은 경우 비용은 근사될수만 있는 통계로 주어진다.</p>\n<p>간단한 예로, 어떤 분포 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal {D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">D</span></span></span></span></span>에서 뽑아낸 데이터 쌍 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x, y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span></span>에 대해 비용 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo>=</mo><mi>E</mi><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>y</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C = E[(f(x) - y)^{2}]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span></span>을 최소화하는 모델 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span></span>를 찾는 문제를 생각해보자. 실용적으로는 분포 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal {D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">D</span></span></span></span></span>에서 유한한 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span>개의 샘플만을 뽑아낼 수 있으므로, 이 예의 경우 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>C</mi><mo>^</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\hat{C} = \\frac{1}{N}\\sum_{i=1}^{N}(f(x_i) - y_i)^{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9468em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9468em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3262em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9812em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></span>, 즉 전체 데이터 집합이 아니라 데이터의 샘플에 대한 비용만 최소화될 수 있을 것이다.</p>\n<p>…</p>\n<p><strong><a href=\"https://ko.wikipedia.org/wiki/%EC%9D%B8%EA%B3%B5_%EC%8B%A0%EA%B2%BD%EB%A7%9D\" target=\"_blank\" rel=\"nofollow\">인공 신경망 - 학습, 위키 백과</a></strong></p>\n</blockquote>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 250px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/921606ba067387cd7d78b791d22a41de/0479a/luckyjjang.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 128.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEBQL/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGjHe4gEBvr7zQIw//EAB0QAAMAAgIDAAAAAAAAAAAAAAECAwARBBMUITH/2gAIAQEAAQUC7Za5Dp2VZwePEnNCqWULQehoAXnMUb4pPj5//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAIBAAAQQCAQUAAAAAAAAAAAAAAAECESEDMUEQIiNxwf/aAAgBAQAGPwKsmOPR4qT6JOSVVJNcSQ5NENK2Wlcna8UdfT//xAAeEAEAAwEAAgMBAAAAAAAAAAABABEhMUFRYZGhwf/aAAgBAQABPyHlHbnp9SwboGhQ+xFZi1TVTCCppR5hqJVZ/I35HzL7K4yZ1m2zUqAcLo8z8EVYnPcOT//aAAwDAQACAAMAAAAQM84M/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHRABAAMAAgMBAAAAAAAAAAAAAQARITFBUXGxof/aAAgBAQABPxBsWqRgroVAylpUS8fX5HPWaWPWd0EVecIHwq+eJQ0s0Vp34XClQjm21EcUDWIOWqstl7U+S3iXbDG8Yepj3vky2mFprSYHqf/Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"luckyjjang\" title=\"\" src=\"/static/921606ba067387cd7d78b791d22a41de/0479a/luckyjjang.jpg\" srcset=\"/static/921606ba067387cd7d78b791d22a41de/0913d/luckyjjang.jpg 160w,\n/static/921606ba067387cd7d78b791d22a41de/0479a/luckyjjang.jpg 250w\" sizes=\"(max-width: 250px) 100vw, 250px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>난 분명 수식을 보고 있는데 숫자보다 영어가 더 많이 보이고...</small>\n</center>\n<p>솔직히 저런 수식을 처음 보면 무슨 외계어 같기도 하고 무슨 말을 하는 지 도통 알 수가 없다. 게다가 간단한 예랍시고 설명하고 있는 것은 전혀 간단하지 않게 생겼다.</p>\n<p>이런 것들이 바로 우리의 공부 의욕을 깎아먹는 수학의 모습이다. 하지만 저 수식이 진짜 어렵고 복잡한 의미일까?</p>\n<p>저 기호와 알파벳이 어떤 의미인지만 알면 우리는 이 수식을 코드로 포팅할 수 있는데, 막상 짜놓고 보면 굉장히 간단하다. 그럼 딱 봤을 때 제일 복잡해보이는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>C</mi><mo>^</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\hat{C} = \\frac{1}{N}\\sum_{i=1}^{N}(f(x_i) - y_i)^{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9468em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9468em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3262em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9812em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></span>를 값 <code class=\"language-text\">C</code>를 구하는 코드로 한번 작성해보겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> inputs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> outputs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span> <span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">N</span> <span class=\"token operator\">=</span> inputs<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">exampleFunction</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">x</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getC</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token punctuation\">,</span> y</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> result <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token constant\">N</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    result <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span><span class=\"token function\">exampleFunction</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> y<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">**</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> result <span class=\"token operator\">/</span> <span class=\"token constant\">N</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">C</span> <span class=\"token operator\">=</span> <span class=\"token function\">getC</span><span class=\"token punctuation\">(</span>inputs<span class=\"token punctuation\">,</span> outputs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>쨘, 이제 아까 저 수식이 어떤 내용인지 조금 더 이해가 잘될 것이라고 생각한다. 혹시 저 수식이 어떤 내용인지 이해하지 못했더라도 코드는 이해할 수 있으니 말이다.</p>\n<p>그럼 먼저 이상한 기호가 있어서 어려워 보이는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\sum_{i=1}^{N}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2809em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9812em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span></span></span></span></span>를 한번 살펴보자.</p>\n<p><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∑</mo></mrow><annotation encoding=\"application/x-tex\">\\sum</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span></span></span></span></span><small>(Sum이라고 읽는다)</small> 기호는 그냥 뒤에 붙어 있는 값을 반복문 돌리면서 더하라는 뜻이다. 즉, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\sum_{i=1}^{N}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2809em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9812em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span></span></span></span></span>은 ”<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span></span>를 1로 초기화하고 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span>까지 반복하면서 값을 더해라”라는 의미인 것이다. 우리가 <code class=\"language-text\">for</code>문을 사용할 때 관습적으로 사용하는 변수 <code class=\"language-text\">i</code>도 여기서 파생된 것이다.</p>\n<p>그러면 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∑</mo></mrow><annotation encoding=\"application/x-tex\">\\sum</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span></span></span></span></span>의 뒤쪽으로 오는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">(f(x_i) - y_i)^{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></span>에 포함된 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>나 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>의 의미도 자연스럽게 이해가 될 것이다. 그냥 어떤 집합의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span></span>번째 원소를 말하는 것이다.</p>\n<p>그리고 마지막에 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{N}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>을 곱해주는데, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span>번 반복하면서 모두 더한 값을 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span>으로 나누면 뭘까?</p>\n<blockquote>\n<p>네, <strong>평균</strong>입니다.</p>\n</blockquote>\n<p>여기까지 보고나면 이제 더 이상 저 수식이 낯설게만 느껴지지는 않을 것이다. 그리고 위에서도 한번 얘기했지만 필자가 말하고 싶은 것은 저 수식을 코드로 작성할 수 있냐 없냐가 아니다. 저런 수식도 코드로 바꿔보면 그렇게 어려운 수식이 아니라는 것을 말하고 싶은 것이다. 쫄 필요가 없다!</p>\n<p>그냥 우리에게 <code class=\"language-text\">for</code>문은 익숙하지만 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∑</mo></mrow><annotation encoding=\"application/x-tex\">\\sum</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span></span></span></span></span> 기호가 익숙하지 않을 뿐이다. 만약 어떤 수식을 보고 모르는 기호가 나오면 한번 의미를 찾아보자. 물론 그 중에는 의미 자체가 어려운 기호도 있다. <small>(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∫</mo></mrow><annotation encoding=\"application/x-tex\">\\int</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1111em;vertical-align:-0.3061em;\"></span><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span></span></span></span></span>같은 적분 기호…?)</small> 하지만 대부분의 경우 그냥 알파벳은 변수, 기호는 규칙(프로그래밍에서의 명령문)이나 특별한 함수를 의미하기 때문에 하나하나 뜯어보고 코드로 작성해보면 생각보다 단순한 경우가 많다.</p>\n<p>이제 더 이상 수학이 별 거 없다는 걸 알았으니 수학이라는 단어 자체에 쫄지 말고 한번 씹고 뜯고 맛보고 즐겨보자.</p>\n<h2 id=\"알면-도움이-되는-수학-개념-3가지\" style=\"position:relative;\">알면 도움이 되는 수학 개념 3가지<a href=\"#%EC%95%8C%EB%A9%B4-%EB%8F%84%EC%9B%80%EC%9D%B4-%EB%90%98%EB%8A%94-%EC%88%98%ED%95%99-%EA%B0%9C%EB%85%90-3%EA%B0%80%EC%A7%80\" aria-label=\"알면 도움이 되는 수학 개념 3가지 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>자 그럼 이제 본론으로 들어가서, 우리가 프로그래밍을 할 때 도움이 될만한 수학의 3가지 개념들을 살펴보자.</p>\n<p>사실 필자가 이야기하고 싶은 것은 개념이기 때문에 위에서 예로 들었던 것처럼 수식이 나오는 대수학 같은 건 아니다. 그리고 이 포스팅에서 설명하는 개념들은 사실 수학보다 논리학에 가까운 느낌이기 때문에 반드시 숫자와 연관지어서 생각할 필요는 없다.</p>\n<p>이 개념들은 우리가 중학교, 고등학교에서 이미 배웠던 개념들이다. 다만 수능을 보고 나면 딱히 쓸 일이 없기 때문에 까먹었을 뿐이다. 물론 이과 계열의 전공을 택하신 분이나 문과 중에서도 경제학처럼 수학과 연관이 깊은 전공을 택하신 분은 계속 수학을 공부하기 때문에 까먹지 않았을 수 있지만 그 외의 경우는 사실 까먹을 수 밖에 없다.</p>\n<p>뭐 어쨌든 필자가 설명할 개념들은 전부 어릴 때 한번 정도는 들어봤던 논리에 대한 개념들이니까 조금은 가벼운 마음으로 한번 즐겨보도록 하자.</p>\n<h3 id=\"명제proposition\" style=\"position:relative;\">명제(Proposition)<a href=\"#%EB%AA%85%EC%A0%9Cproposition\" aria-label=\"명제proposition permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>자 처음으로 이야기하고 싶은 개념은 중학교 1학년인 때 배웠던 명제이다. 사실 명제는 굳이 프로그래밍을 위해서가 아니더라도 그냥 논리적인 사고를 하기 위해서 기본적으로 알고 있어야 하는 개념이다.</p>\n<p>명제는 참, 거짓과 같은 논리적인 진릿값을 가지는 것을 말한다. 즉, 참과 거짓을 구분할 수 없는 문장은 명제로 치지 않는다. 즉, “길동이는 키가 크다”와 같은 문장은 명제로 성립될 수 없다는 것이다. 다른 사람이 필자를 봤을 때 키가 크다고 생각할 수도 있고 작다고 생각할 수도 있는 주관성이 들어가는 문장이기 때문이다.</p>\n<p>그렇다면 명제는 우리가 프로그래밍을 할 때 어디에 사용된다는 걸까?</p>\n<p>명제가 말하는 참과 거짓은 우리가 프로그래밍할 때 사용하는 <code class=\"language-text\">True</code>, <code class=\"language-text\">False</code>나 <code class=\"language-text\">1</code>, <code class=\"language-text\">0</code>과 동일한 개념이다. 즉, 우리가 중학생 때 수학 교과서로 배웠던 명제는 조건식과 동일하다고 할 수 있다. 간단한 코드를 한번 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> array <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'array 변수에는 a가 들어있다.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'array 변수에는 a가 들어있지 않다.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이 코드에서 필자가 제시한 명제는 ”<code class=\"language-text\">array</code> 변수에 담긴 배열에는 <code class=\"language-text\">a</code>라는 원소가 포함되어있다”이고 이 명제가 참일 경우 <code class=\"language-text\">if</code>문 내부의 코드가, 거짓일 경우에는 <code class=\"language-text\">else</code>문 내부의 코드가 실행된다. 이처럼 조건문에 사용되는 조건은 반드시 명제여야하므로 명제에 익숙한 개발자는 어떤 요구사항을 들었을 때, 그 요구사항을 충족할 수 있는 명제를 빠르게 제시해나갈 수 있다.</p>\n<p>이 명제라는 개념은 필자가 앞으로 설명할 다른 개념들이나 다른 수학의 개념에서도 가장 기초가 되는 개념이기 때문에 우리가 중학교에 입학하자마자 배우는 것이다. 수학은 긴가민가한 학문이 아니라 정확한 질문과 정확한 답을 제시할 수 있어야하는 능력이 필요한 학문이기 때문에 명제가 가장 기초가 된다.</p>\n<h3 id=\"집합set\" style=\"position:relative;\">집합(Set)<a href=\"#%EC%A7%91%ED%95%A9set\" aria-label=\"집합set permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>다음으로 이야기 할 것은 명제와 마찬가지로 우리가 중학교 1학년 때 배웠던 집합이다. 집합도 명제와 마찬가지로 알게 모르게 많이 사용되는 개념이기 때문에 집합에 대한 확실한 개념을 알고 있다면 프로그래밍할 때 많은 도움을 준다.</p>\n<p>동글동글 귀여운 벤다이어그램과 프로그래밍은 왠지 거리가 멀어보이지만 사실 우리는 저 개념을 매일매일 프로그래밍할 때 사용하고 있다. 바로 논리식을 작성할 때 말이다. 논리식은 위에서 말한 명제처럼 <code class=\"language-text\">True</code>, <code class=\"language-text\">False</code> 둘 중에 하나로 평가받을 수 있는 식을 이야기한다. 보통 우리는 명제 여러 개를 논리 연산자로 묶은 식을 많이 사용한다. 이 논리식과 집합이 무슨 관계가 있다는 걸까?</p>\n<p>사실 우리가 사용하는 논리연산자는 <code class=\"language-text\">&amp;&amp;(AND) = 교집합</code>, <code class=\"language-text\">||(OR) = 합집합</code>으로 대응되기 때문에 복잡한 논리식을 마주쳤을 때 그 논리식을 벤다이어그램으로 그려보는 것도 가능하다. 그리고 우리가 어릴 때 외웠던 <a href=\"https://ko.wikipedia.org/wiki/%EB%93%9C_%EB%AA%A8%EB%A5%B4%EA%B0%84%EC%9D%98_%EB%B2%95%EC%B9%99\" target=\"_blank\" rel=\"nofollow\">드 모르간의 법칙</a>도 논리식에 그대로 적용된다. <small>(사실 드 모르간의 법칙은 집합에 대한 법칙이라기보다 좀 더 포괄적인 논리학의 법칙이다.)</small></p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c36c7088ac8fe07531617bca4bcd1f35/e17e5/dmorgan.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 133.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAElklEQVR42o1VW0xcVRQd44OPKsLwnPsCYqMmxho/TLT+qImNXyYkjZoYv/SjX6b9MCZQkEYxbaXlNXMHJAzc1ogvJKFaWiKFmsaEQKxKQB4DDAwzd+7wiBTsDL2Y5d7nzkQKQ+PHmrtm77X3OWfv83A90Rp7/TnDrJX1SIWiR0+moelLhEXxvZeNoXKsN/yJ6osccb3akzBqJgApkLC1ziQYpcZtKJ13UBQAPB3/oMRICDBnG/tYk9ZrHQm75MIdqIFbjS7VHwuUdt6GrMcSih6zVT1q5zWt26o/aj9vjNiH2idsd/O6wKH2cWFjn9CQlmMU3Uqo7Rug73mXpJuGamzRH5MFyG9exxvfdWNo/GVMzT2Jsdmn0XD9hADzSbKx703SsJZjOKnWmeAcDS76MTRKqOkRHhXl3/TCXPJgOVKA8KKKyJKMrYmHBJizjX2sYS3HaP7I3oQ8/ULvGr4efQtrUTeCoYNYCJciPKNifSRbIBxUEVosQXD+MaFhLcdw7F0JS4wkPD7LPtgaouW8BCtSjOCshrFxFda0B5ujB7A5cgDxoAc3/1AxPa0hHi0WWo6RfHG7hPqwY4ZJ+hO1i70r6P71KFaj+ZgLldFsNESDEjZGHxZgzjb2sYa1HMP1z1jD3KYNvP19F9ZMN2JLxVgMawiHVSTHswSYs419a9E80n4FjslYw3SXC5rXcOyHNtyceRYLPJuFMlz85R0B5mxj37FLbUK7b5c5ITlIYFLnbuHxz2dxpOsaDl8cRZG+jkLfX4KzjX2sYS3H3DMhQyOhpC+joHEF+bV/Qj47BuX8NPJPz6CgYVn4tP+S7Uroi3XQ0WFjkvj2TqjepW25bmpb+mxyWzo3Q3xS2BSfdZeOTkhSa9+E4jPrXXTkjkt6bFDWzR7ivbuh+OO9SutKCvHeTBpZt3oUvzWg6PH3XK90xY3KEaBYt2y1JQ6F4bccCB6H6jehtsQE3+N3/ts0oLPkshbTeKprC7IvXUMKJrHKwb4oFZ4a5V92wH62iUEsoU3F2Frgbyeh5DUNuSPdFFOIpcYQ8mqHkVszhJxTNyDV/S7AnG3sk5pCzqBO0r1dFjOkUT0kzKn+CdmVl5FT1YcHPxyEb+CoAHO2CR9pWMsxcqaT4iSMI+/TYRGQW92PrIrrONzYRjeLLPAC8ayKIeFjDWs5JmNCcVFSfXJP/YxHq67CXfUj7jvej3e/rKaj5kEs4iH+EVzv98FdeYk0/ULLMZk3dqop7o9vIPvkFbirr+CBDwZR3n6WkkkCzO8nm5uXzRrS7ntSeMlc5KK68VSNruKRqgEU1PRheOIZAeZsy0ktmbUcw7H7zpDeGBSc+U0sKafqMjXiGl7UvxBgzjb2sYa1/+ssO1tnHkXnJuk7K27lQu8q8WDKNp/aMhkS0mYNaB182zqvHoO7JnY/calu2lbqp2y1ad6W6+dsxdkNjial51dPnGV+9ei2Nkq7we+rLS7aNC4QApuQmxahNIe5JOKrBjYc306tkbRLvwXUzkSjS2mOlMve6BlqfzUVt2Y31NbVGnknfNYeDcfSE3Ja8Vqv/QtPwlWPwwPdQwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"dmorgan\" title=\"\" src=\"/static/c36c7088ac8fe07531617bca4bcd1f35/e17e5/dmorgan.png\" srcset=\"/static/c36c7088ac8fe07531617bca4bcd1f35/69538/dmorgan.png 160w,\n/static/c36c7088ac8fe07531617bca4bcd1f35/72799/dmorgan.png 320w,\n/static/c36c7088ac8fe07531617bca4bcd1f35/e17e5/dmorgan.png 400w\" sizes=\"(max-width: 400px) 100vw, 400px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c36c7088ac8fe07531617bca4bcd1f35/e17e5/dmorgan2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 133.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAElklEQVR42o1VW0xcVRQd44OPKsLwnPsCYqMmxho/TLT+qImNXyYkjZoYv/SjX6b9MCZQkEYxbaXlNXMHJAzc1ogvJKFaWiKFmsaEQKxKQB4DDAwzd+7wiBTsDL2Y5d7nzkQKQ+PHmrtm77X3OWfv83A90Rp7/TnDrJX1SIWiR0+moelLhEXxvZeNoXKsN/yJ6osccb3akzBqJgApkLC1ziQYpcZtKJ13UBQAPB3/oMRICDBnG/tYk9ZrHQm75MIdqIFbjS7VHwuUdt6GrMcSih6zVT1q5zWt26o/aj9vjNiH2idsd/O6wKH2cWFjn9CQlmMU3Uqo7Rug73mXpJuGamzRH5MFyG9exxvfdWNo/GVMzT2Jsdmn0XD9hADzSbKx703SsJZjOKnWmeAcDS76MTRKqOkRHhXl3/TCXPJgOVKA8KKKyJKMrYmHBJizjX2sYS3HaP7I3oQ8/ULvGr4efQtrUTeCoYNYCJciPKNifSRbIBxUEVosQXD+MaFhLcdw7F0JS4wkPD7LPtgaouW8BCtSjOCshrFxFda0B5ujB7A5cgDxoAc3/1AxPa0hHi0WWo6RfHG7hPqwY4ZJ+hO1i70r6P71KFaj+ZgLldFsNESDEjZGHxZgzjb2sYa1HMP1z1jD3KYNvP19F9ZMN2JLxVgMawiHVSTHswSYs419a9E80n4FjslYw3SXC5rXcOyHNtyceRYLPJuFMlz85R0B5mxj37FLbUK7b5c5ITlIYFLnbuHxz2dxpOsaDl8cRZG+jkLfX4KzjX2sYS3H3DMhQyOhpC+joHEF+bV/Qj47BuX8NPJPz6CgYVn4tP+S7Uroi3XQ0WFjkvj2TqjepW25bmpb+mxyWzo3Q3xS2BSfdZeOTkhSa9+E4jPrXXTkjkt6bFDWzR7ivbuh+OO9SutKCvHeTBpZt3oUvzWg6PH3XK90xY3KEaBYt2y1JQ6F4bccCB6H6jehtsQE3+N3/ts0oLPkshbTeKprC7IvXUMKJrHKwb4oFZ4a5V92wH62iUEsoU3F2Frgbyeh5DUNuSPdFFOIpcYQ8mqHkVszhJxTNyDV/S7AnG3sk5pCzqBO0r1dFjOkUT0kzKn+CdmVl5FT1YcHPxyEb+CoAHO2CR9pWMsxcqaT4iSMI+/TYRGQW92PrIrrONzYRjeLLPAC8ayKIeFjDWs5JmNCcVFSfXJP/YxHq67CXfUj7jvej3e/rKaj5kEs4iH+EVzv98FdeYk0/ULLMZk3dqop7o9vIPvkFbirr+CBDwZR3n6WkkkCzO8nm5uXzRrS7ntSeMlc5KK68VSNruKRqgEU1PRheOIZAeZsy0ktmbUcw7H7zpDeGBSc+U0sKafqMjXiGl7UvxBgzjb2sYa1/+ssO1tnHkXnJuk7K27lQu8q8WDKNp/aMhkS0mYNaB182zqvHoO7JnY/calu2lbqp2y1ad6W6+dsxdkNjial51dPnGV+9ei2Nkq7we+rLS7aNC4QApuQmxahNIe5JOKrBjYc306tkbRLvwXUzkSjS2mOlMve6BlqfzUVt2Y31NbVGnknfNYeDcfSE3Ja8Vqv/QtPwlWPwwPdQwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"dmorgan2\" title=\"\" src=\"/static/c36c7088ac8fe07531617bca4bcd1f35/e17e5/dmorgan2.png\" srcset=\"/static/c36c7088ac8fe07531617bca4bcd1f35/69538/dmorgan2.png 160w,\n/static/c36c7088ac8fe07531617bca4bcd1f35/72799/dmorgan2.png 320w,\n/static/c36c7088ac8fe07531617bca4bcd1f35/e17e5/dmorgan2.png 400w\" sizes=\"(max-width: 400px) 100vw, 400px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>드 모르간의 법칙을 벤다이어그램으로 나타낸 모습</small>\n</center>\n<p>필자는 드 모르간 법칙이 빛을 발하는 순간이 바로 자연어를 논리식으로 변환할 때라고 생각한다. 보통 회사에서 비즈니스 로직을 짜다보면 PO들이 어떤 기능의 작동 여부에 조건을 추가하는 경우가 많은데 문제는 조건을 추가할 때 기존에 있던 조건들까지 모두 생각하면서 말해주지 않는다는 것이다.</p>\n<p>필자가 지금까지 일을 하면서 겪은 조건 중에 가장 복잡했던 경우를 예로 들어보겠다. 필자는 예전에 멤버십 결제 기능을 개발한 적이 있었는데 문제는 결제 수단을 입력할 수 있는 폼의 렌더 조건이 굉장히 복잡하다는 것이었다. 물론 처음부터 이렇게 복잡한 건 아니였고, 기능이 추가됨에 따라 점점 조건이 복잡해진 케이스이다.</p>\n<p>당시 조건이었던 논리식을 자연어로 그대로 써보겠다.</p>\n<blockquote>\n<p>조건 1. 사용자의 멤버십이 해지 상태가 아니고 결제 수단도 가지고 있지 않다.<br />\n조건 2. 사용자가 결제수단을 가지고 있고 결제 수단을 핸드폰으로 가지고 있으며, 현재 사용자가 고른 상품이 현재 사용자가 가지고 있는 상품이 아니고 현재 멤버십이 해지 예약상태가 아니다.</p>\n<p><code class=\"language-text\">(조건 1 || 조건 2)</code>이면 결제 수단 등록 폼이 활성화 된다.</p>\n<p><strong>조건 version 1</strong></p>\n</blockquote>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c5eea607509f7340ae036675fc5d5a47/066f9/what-are-you-saying.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 67.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAwAF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3AYRY4//xAAZEAADAQEBAAAAAAAAAAAAAAAAARECEiL/2gAIAQEAAQUCqHv1o5Eq6f/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABkQAAMAAwAAAAAAAAAAAAAAAAABEBESMf/aAAgBAQAGPwIxrOIU/8QAGhABAQEBAAMAAAAAAAAAAAAAAREAIUFRkf/aAAgBAQABPyHrKZRwgfcC4UnDVAw9YHk3/9oADAMBAAIAAwAAABDQD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQEAAgIDAQAAAAAAAAAAAAERACExQVFhgeH/2gAIAQEAAT8QRtXomBSkRZwZz+ZD0ceMAvVWrMpYirXRsxAGwDYS0p93n//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"what are you saying\" title=\"\" src=\"/static/c5eea607509f7340ae036675fc5d5a47/066f9/what-are-you-saying.jpg\" srcset=\"/static/c5eea607509f7340ae036675fc5d5a47/0913d/what-are-you-saying.jpg 160w,\n/static/c5eea607509f7340ae036675fc5d5a47/cb69c/what-are-you-saying.jpg 320w,\n/static/c5eea607509f7340ae036675fc5d5a47/066f9/what-are-you-saying.jpg 400w\" sizes=\"(max-width: 400px) 100vw, 400px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>뭐 사실 저 사단이 난건 1차적으로 개발자인 필자의 잘못이긴 하지만 굳이 핑계를 대자면 시간에 쫓겨서 맨날 야근하면서 개발하다보니 저런 괴물같은 논리식이 탄생해버렸다…</p>\n<p>저렇게 개판쳐놓고나서도 다른 할 것도 너무 많았기 때문에 일단 묻어놓고 다른 프로젝트를 또 개발하던 중에 PO가 필자에게 이야기 했다.</p>\n<blockquote>\n<p>에반, 저희 결제 수단 등록 폼에 조건 하나만 더 추가할 수 있을까요?</p>\n</blockquote>\n<p>저 얘기를 듣고 다시 저 코드를 보고 PO 얼굴을 한번 본 뒤, 저걸 어떻게든 뜯어고쳐야겠다는 결론에 다다른 필자는 조용히 노트북을 들고 화이트 보드 앞으로 간 후, 저 복잡한 조건들을 어떻게든 이해할 수 있는 수준으로 만들기 위해서 발버둥쳤는데 그 결과가 이것이다.</p>\n<blockquote>\n<p>조건 1. 사용자가 멤버십 가입 상태가 아니고, 사용자가 등록한 결제 수단이 카드가 아니다.<br />\n조건 2. 사용자가 멤버십 가입 상태이고 사용자가 등록한 결제 수단이 휴대폰이며, 현재 구매하려고 선택한 멤버십이 나의 멤버십과 다른 상품이다.<br />\n조건 3. 사용자의 결제 수단 정보가 없다.</p>\n<p><code class=\"language-text\">(조건 1 || 조건 2 || 조건3)</code>이고 사용자가 선택한 결제 수단이 카드라면 결제 수단 등록 폼이 활성화 된다.</p>\n<p><strong>조건 version 2</strong></p>\n</blockquote>\n<p>사실 이것도 간단한 논리식은 아니지만 그래도 조건 1, 조건 2, 조건 3만 읽어 보았을 때 이전의 조건에 비해서 어떤 상태인지 좀 더 알아보기 쉬워졌다. <small>(라고 자기합리화를 해봅니다.)</small> 이 당시 필자가 논리식을 정리할 때 사용했던 방법이 벤다이어그램과 드 모르간 법칙이었다.</p>\n<p>벤다이어그램으로 논리식을 펼쳐놓음으로써 여러 개의 논리식 중 사실 같은 명제이지만 역의 꼴을 취하고 있는 친구들을 쉽게 찾을 수 있었고 겹치는 명제들을 골라서 합치고 좀 더 알아보기 쉬운 단위로 조건을 나누고해서 저렇게라도 만들어 놓은 것이다.</p>\n<p>물론 이 코드는 언젠가 개선을 해야한다… <small>(언젠가…)</small></p>\n<p>그리고 추가적으로 이런 논리식 외에도 데이터베이스에 질의를 던질 때 사용하는 SQL의 JOIN 개념도 보통 벤다이어그램으로 표현한다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/6a3a0aaa506a8ad2f6693bcadfe974cf/68e9c/sqljoin.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 72.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAACM0lEQVR42n1Tv2/TQBTOH0SltogWiQWxsLIwwoIEA1IXBoTExtARFbEwIhbE0iKqqDFSg2PSEDsyduw4duK4+eFSO8GOfXYcO/Y5XOzUiTrwLf7u+b577333LjdPEMfxkqzxa8ii2YZc+gnD2VF78I6V+d5gAuyxZUEIs60AANuyhsPhJ+H8A6fowEnjuSg55rPY28L4rTz9EKtN/GA69YDjpGLP8ywAENmv8htH1e1T6UWlOY+iReZU/JaRb3wXdvP0PYzRgQvD0LbtVOw4DnBcRPaI+sZXcgdvP8L5MAgW4rQB3XZe0crjM+kLK81hZI7HQfI76ShcVBHHbE99Xmk+pZTKQENxGF/1HIVhS2wSBNFpiTiOg6TOOAEiOEHkTwpCg2dZpvKrCpOaV4ZFEHb7/XanM9R1SZJ831/32dQvOYo0dE2/UC963czLpRjtRr0hY5p91Z9OLctC1V5dT1xSR6+Z7kdOfs/Kb2hZHplLt1OxYY7RkvwzeoDR1sSbBb6dVI7QNe27GLP7o3XzsHzrmNostp6VODibrTL/NQwk/jnQ7xdow50gMzOxbFh3CsxtvLV9eLbzjdo8lZ7gSBysxFMEzwOuy5z3A99Hhs2Ss+OkvuOOukfKB2Rjn26/rMmNy9HS7dRP13GKxSJJkpIoYhimqur6GDa5erVcFrl6pYT/pqjMyGw8Q03T0AAahomI67rrbqNlR1FOChhVqxmmCa/N9n+Q5keNCIKAbmH9YfwD30n28wXkqg0AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sqljoin\" title=\"\" src=\"/static/6a3a0aaa506a8ad2f6693bcadfe974cf/6af66/sqljoin.png\" srcset=\"/static/6a3a0aaa506a8ad2f6693bcadfe974cf/69538/sqljoin.png 160w,\n/static/6a3a0aaa506a8ad2f6693bcadfe974cf/72799/sqljoin.png 320w,\n/static/6a3a0aaa506a8ad2f6693bcadfe974cf/6af66/sqljoin.png 640w,\n/static/6a3a0aaa506a8ad2f6693bcadfe974cf/68e9c/sqljoin.png 654w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>이런 경우 복잡한 논리식이나 SQL의 JOIN문을 보고 벤다이어그램이 바로 머리 속에 떠오른다면 그냥 코드나 자연어로 이해하는 것 보다는 좀 더 직관적이고 빠르게 이해할 수 있지 않을까? 라는 생각을 해본다.</p>\n<h3 id=\"수학적-귀납법mathematical-induction\" style=\"position:relative;\">수학적 귀납법(Mathematical Induction)<a href=\"#%EC%88%98%ED%95%99%EC%A0%81-%EA%B7%80%EB%82%A9%EB%B2%95mathematical-induction\" aria-label=\"수학적 귀납법mathematical induction permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>수학적 귀납법(Mathematical Induction)은 수학에서 사용하는 증명 방법 중 하나이다. 주로 어떤 명제가 모든 자연수에 대하여 성립함을 보이기 위해 사용한다. 수학적 귀납법이 무엇인가를 자세히 알아보기 전에 먼저 우리는 논리학의 논증법 투톱인 귀납논증과 연역논증에 대해서 알아야한다.</p>\n<p>간단하게 이야기해보자면 귀납논증은 “지금까지 그래왔으니까 앞으로도 그럴 것이다”라는 느낌이고 연역논증은 “전제가 맞다면 결론도 반드시 맞다”라는 느낌이다. 이걸 너무 자세히 설명하면 글이 길어지기 때문에 간단한 예시로 간만 보겠다.</p>\n<p>먼저 귀납논증은 이런 느낌이다.</p>\n<blockquote>\n<p>2000년 여름은 더웠다, 2001년 여름도 더웠다…2019년 여름도 더웠다. <strong>그러므로 여름에는 반드시 덥다.</strong></p>\n</blockquote>\n<p>귀납적인 이런 논증 방식은 모든 전제가 참이라고 해도 반드시 결론도 참이라는 법이 없다. 당장 위의 예시만 봐도 2020년 여름에는 기상이변으로 인해서 눈이 올 수도 있지 않을까? <small>(투모로우…?)</small></p>\n<p>즉, 귀납논증은 언제나 오류가 존재할 확률이 있다. 여기까지만 보면 왠지 허점투성이 논증법인 것 같지만 그래도 현대 과학은 귀납논증을 통해 끊임없는 가설을 제시하고 그걸 증명함으로써 발전해왔으므로 상당한 가치가 있는 논증법이라고 할 수 있다.</p>\n<p>반면 연역논증은 이런 느낌이다.</p>\n<blockquote>\n<p>맥북은 애플이 만든다. 내 컴퓨터는 맥북이다. <strong>그러므로 내 컴퓨터는 애플이 만들었다.</strong></p>\n</blockquote>\n<p>위 예시는 연역논증 중에서 가장 대표적인 사례인 삼단논법이다. 이게 바로 위에서 얘기한 “어떤 부분적인 전제가 맞다면 결론도 반드시 맞다”라는 의미이다. 만약 결론이 거짓이라면 전제 중 하나도 무조건 거짓이다. 즉, 연역논증은 이미 전제에 담겨있던 것을 증명하는 데는 탁월하지만 귀납논증처럼 새로운 지식을 탐구하기에는 부적절하다.</p>\n<p>하지만 우리가 프로그래밍을 할때는 새로운 지식을 탐구하는 것이 아니라 그냥 내 코드가 오류없이 완벽한가를 증명하기 위한 논증법을 사용해야하므로 귀납논증보다는 연역논증이 더 알맞다.</p>\n<p>필자가 이 두 논증법을 전부 설명한 이유는 바로 “수학적 귀납법이 귀납논증이 아니라 연역논증”이기 때문이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/092534ee3a31b64fae8d24f559633f54/97d16/ah.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 59.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAGZkU6a44j/xAAbEAEBAAEFAAAAAAAAAAAAAAACAQMEESIjRP/aAAgBAQABBQLO42eSesRXmlu4vX//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAdEAABBAIDAAAAAAAAAAAAAAABAAIRIQNBEFFx/9oACAEBAAY/Amk2I2jdjSg449TT0eGzdL//xAAcEAACAgMBAQAAAAAAAAAAAAABEQAhMUFRcaH/2gAIAQEAAT8hafhJ9l6j0Oh7CwAh1De6kQpna1Dk6EciJ//aAAwDAQACAAMAAAAQcy//xAAZEQABBQAAAAAAAAAAAAAAAAAAAREhMVH/2gAIAQMBAT8QuB0w/8QAFhEAAwAAAAAAAAAAAAAAAAAAEBFB/9oACAECAQE/EFR//8QAGhABAAIDAQAAAAAAAAAAAAAAAQARITFBYf/aAAgBAQABPxDVYBJx3aoatjoao0+sTl3BbhKTOTxmYYNlVypQKiWf/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"ah\" title=\"\" src=\"/static/092534ee3a31b64fae8d24f559633f54/97d16/ah.jpg\" srcset=\"/static/092534ee3a31b64fae8d24f559633f54/0913d/ah.jpg 160w,\n/static/092534ee3a31b64fae8d24f559633f54/cb69c/ah.jpg 320w,\n/static/092534ee3a31b64fae8d24f559633f54/97d16/ah.jpg 547w\" sizes=\"(max-width: 547px) 100vw, 547px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>아니...귀납법이라며...?</small>\n</center>\n<p>수학적 귀납법은 어떤 명제 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span>가 있을 때 다음 2가지만 충족시키면 모든 자연수에 대해서 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span>가 성립한다는 것을 의미한다.</p>\n<blockquote>\n<ol>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span>은 참이다<br /></li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span>이 참이면 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(n + 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span>도 참이다.</li>\n</ol>\n<p>그러므로 명제 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span>는 모든 자연수에 대해서 참이다.</p>\n</blockquote>\n<p>이렇게만 얘기하면 또 머리가 아파지니까 예시를 살펴보자. 수학적 귀납법은 보통 도미노로 예시를 많이 들기 때문에 필자도 도미노를 예로 설명하겠다.</p>\n<blockquote>\n<ol>\n<li>맨 처음에 있는 도미노가 쓰러진다. <small>(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span>이 참)</small><br /></li>\n<li>무작위로 고른 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>번째 도미노가 쓰러질 때 항상 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>번째에 세워진 도미노도 쓰러진다. <small>(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span>이 참이면 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(n + 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span>도 참)</small><br /></li>\n</ol>\n<p>그러므로 맨 처음에 있는 도미노를 쓰러트리면 반드시 모든 도미노가 순서대로 쭉쭉 쓰러진다.</p>\n</blockquote>\n<p>이것이 수학적 귀납법의 논리 전개 방식이다. 간단하게 얘기하자면 전제가 참이라는 것을 먼저 보인 후에 그 전제에서 보편적인 결론을 이끌어 내는 것이다.</p>\n<p>이런 수학적 귀납법은 알고리즘의 정당성을 검증할 때 아주 유용하게 쓰일 수 있다. 왜냐면 알고리즘이란 것은 굉장히 보편적인 규칙이고, 어떤 형태로든 반드시 반복적인 요소를 가지고 있기 때문이다.</p>\n<p>그럼 한번 유명한 알고리즘인 팩토리얼을 구하는 알고리즘을 한번 수학적 귀납법으로 풀어보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">factorial</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">&lt;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> n <span class=\"token operator\">*</span> <span class=\"token function\">factorial</span><span class=\"token punctuation\">(</span>n <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<ol>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">n = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>인 경우 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo stretchy=\"false\">!</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n! = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">!</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>이다.<br /></li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo stretchy=\"false\">!</mo><mo>=</mo><mi>n</mi><mo>×</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mn>.3</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n! = n \\times (n - 1) \\times (n - 2) \\times ... 3 \\times 2 \\times 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">!</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">...3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span> 이다.<br /></li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mi>n</mi><mo stretchy=\"false\">!</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mi>n</mi><mo>×</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mn>.3</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">(n + 1) \\times n! = (n + 1) \\times n \\times (n - 1) \\times ... 3 \\times 2 \\times 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">!</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">...3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span> 이다.</li>\n</ol>\n<p>그러므로 이 논리는 참이다.</p>\n</blockquote>\n<p>이런 식의 논리적인 사고방식은 당장 코딩할때 직접적인 도움이 되지는 않겠지만, 복잡한 문제를 만났을 때 일반화된 해결법을 찾아낼 수 있는 능력을 키워준다. 사실 이런 논증법을 적용할 수 있는 문제는 일상에서도 얼마든지 찾아볼 수 있으므로 평소에도 한번 이렇게 생각하는 습관을 들여보는 것도 나쁘지 않다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>사실 이 포스팅에서 설명한 저런 것들 다 몰라도 느낌적인 느낌으로 프로그래밍을 잘 할수는 있다. 하지만 곰곰히 생각해보자. 저런 것들을 모르고 프로그래밍을 하고 있었다고 생각했던 분들도 그냥 이론으로 정리하지 않았을 뿐이지 알게모르게 저 개념들을 전부 사용하고 있었을 것이다.</p>\n<p>그리고 필자가 생각했을 때 수학을 배우면 가장 좋은 점은 내가 만들고 싶은 것을 만들때 적어도 이론에서 막히는 일은 없다는 것이다.</p>\n<p>필자가 예전에 작성했던 포스팅인 <a href=\"/2017/05/03/calculate-orbit-2\">행성 궤도 계산</a>이나 <a href=\"/2018/07/19/deep-learning-backpropagation\">역전파 알고리즘</a>같은 포스팅만 봐도 수식이 많이 나와서 어려워 보일 수 있다. 사실 필자도 저 친구들을 처음 만들 때 학교에서 배운 수학 같은 건 이미 가물가물한 상태였기 때문에 거의 처음부터 다시 공부해서 결국은 저 프로젝트를 완성할 수 있었다.</p>\n<p>물론 선형대수학부터 시작해서 오일러 회전, 쿼터니온 등 이름만 들어도 토할 것 같은 이론들이 처음에는 필자에게도 상당한 두려움으로 다가왔지만 일단 이해가 안되더라도 문서를 계속 보고 조금이라도 이해되는 부분이 있다면 코드로 작성한 후에 하나하나 실행시켜보면서 공식의 매커니즘을 눈으로 직접 보다보니까 어느 순간부터는 그래도 처음보다 많이 익숙해졌던 것 같다.</p>\n<p>수학은 그렇게 무서운 친구가 아니다. 위에서 예시로 나왔던 인공신경망 알고리즘의 수식도 처음 보면 뭔가 어려워보이고 복잡해보이지만 막상 코드로 풀어보니 별 거 아니였던 것처럼 말이다. 여러분은 이미 개발자로써 알게 모르게 수학이나 논리학의 개념이 몸에 배어있는 사람인데 이제 와서 수학을 겁내는 것도 좀 이상하지 않은가? 이제는 그런 마음을 다 털어버리고 한번 수학과 친해져보자.</p>\n<blockquote>\n<p>수학은 그냥 프로그래밍 언어처럼 여러분이 상상하는 것을 실현시켜줄 수 있는 <strong>도구</strong>라고 생각하자.</p>\n</blockquote>\n<p>이상으로 개발자는 수학을 잘해야할까? 포스팅을 마친다.</p>","fields":{"slug":"20190717-programmer-with-math","path":"/2019/07/17/programmer-with-math/","lang":"ko"},"frontmatter":{"title":"개발자는 수학을 잘해야할까?","subTitle":"수학을 잘해야 좋은 개발자가 되는 건 아니지만","date":"Jul 17, 2019","categories":["프로그래밍","에세이","알고리즘"],"tags":["수학","프로그래밍","알고리즘","논리학","잘 하는 개발자","집합","귀납법","연역법","삼단논법"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/7dcd9f83bd0b0992a2a168e5c698d19b/3a812/thumbnail.jpg","srcSet":"/static/7dcd9f83bd0b0992a2a168e5c698d19b/3a812/thumbnail.jpg 320w,\n/static/7dcd9f83bd0b0992a2a168e5c698d19b/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/7dcd9f83bd0b0992a2a168e5c698d19b/fc5c5/thumbnail.webp 320w,\n/static/7dcd9f83bd0b0992a2a168e5c698d19b/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/7dcd9f83bd0b0992a2a168e5c698d19b/2d839/thumbnail.jpg","srcSet":"/static/7dcd9f83bd0b0992a2a168e5c698d19b/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/7dcd9f83bd0b0992a2a168e5c698d19b/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"c2d49381-cd2e-5a7b-9d73-25172cdfc958","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EB%9E%9C%EB%8D%A4random%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%BC%EA%B9%8C\">랜덤(Random)이란 무엇일까?</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%BB%B4%ED%93%A8%ED%84%B0%EC%97%90%EC%84%9C%EC%9D%98-%EB%9E%9C%EB%8D%A4\">컴퓨터에서의 랜덤</a></p>\n<ul>\n<li><a href=\"#%EC%A4%91%EC%95%99%EC%A0%9C%EA%B3%B1%EB%B2%95mid-square-method\">중앙제곱법(Mid Square Method)</a></li>\n<li><a href=\"#%EC%84%A0%ED%98%95%ED%95%A9%EB%8F%99%EB%B2%95linear-congruential-method\">선형합동법(Linear Congruential Method)</a></li>\n<li><a href=\"#%EB%A9%94%EB%A5%B4%EC%84%BC-%ED%8A%B8%EC%9C%84%EC%8A%A4%ED%84%B0mersenne-twister\">메르센 트위스터(Mersenne Twister)</a></li>\n<li><a href=\"#xor-%EC%8B%9C%ED%94%84%ED%8A%B8xor-shift\">XOR 시프트(XOR shift)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 랜덤에 대해서 한번 이야기 해볼까 한다. 랜덤이란 어떤 사건이 발생했을 때 이전 사건과 다음 사건의 규칙성이 보이지 않는, 말 그대로 무작위로 발생하는 패턴을 이야기한다. 우리가 사용하고 있는 컴퓨터도 랜덤한 패턴을 만들어야 할 때가 있고 또 실제로도 만들고 있다.","html":"<p>이번 포스팅에서는 랜덤에 대해서 한번 이야기 해볼까 한다. 랜덤이란 어떤 사건이 발생했을 때 이전 사건과 다음 사건의 규칙성이 보이지 않는, 말 그대로 무작위로 발생하는 패턴을 이야기한다. 우리가 사용하고 있는 컴퓨터도 랜덤한 패턴을 만들어야 할 때가 있고 또 실제로도 만들고 있다.</p>\n<!-- more -->\n<p>하지만 컴퓨터는 사실 그냥 기능이 많은 계산기에 불과하다. 계산기는 입력된 값을 가지고 이리 저리 가지고 놀다가 결과값을 내놓는 물건이다. 근데 이런 계산기가 어떻게 랜덤한 결과를 만들어낼 수 있는 것일까? 우리는 이 질문에 대한 답을 찾기 전에 근본적으로 랜덤이란 것이 무엇인지부터 생각해봐야한다. 진짜 무작위라는 것이 존재하기는 하는 걸까?</p>\n<h2 id=\"랜덤random이란-무엇일까\" style=\"position:relative;\">랜덤(Random)이란 무엇일까?<a href=\"#%EB%9E%9C%EB%8D%A4random%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%BC%EA%B9%8C\" aria-label=\"랜덤random이란 무엇일까 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>랜덤이란 위에서 설명했듯이 무작위로 발생하는 어떠한 패턴이다.</p>\n<p>사람마다 의견이 분분하겠지만 지금 필자 머리 속에 떠오른 대표적인 랜덤은 바로 도박이다. 도박의 가장 위험한 점이 “비록 이번 판에는 잃었지만 다음 판에는 나도 딸 수 있을거야!”라는 희망인데, 이런 희망은 도박할 때 사용하는 게임들이 랜덤에서 기반하는 게임이라는 생각에서 출발하기 때문이다. 즉, 어느 정도 운빨게임이어야 한다는 것이다.</p>\n<p><a href=\"http://www.law.go.kr/precInfoP.do?precSeq=136124\" target=\"_blank\" rel=\"nofollow\">대법원 판례 2006도736</a>에도 도박의 정의를 재물을 걸고 우연에 의하여 재물의 득실을 결정하는 것이라고 이야기하고 있다. 대표적인 도박인 파칭코, 섰다, 포커, <small><strike>주식</strike></small> 등만 살펴봐도 대충 감이 온다.</p>\n<p>필자는 도박에서 사용하는 게임을 잘 모르기 때문에 누구나 해봤을 법한 가벼운 도박을 예로 들어보겠다. 필자가 중고등학생 시절을 보낸 2000년대에 전국의 중, 고등학교에서 널리 행해졌던 놀이인 판치기이다. 판치기는 워낙 전국적으로 유행했기 때문에 필자 또래의 독자분들이면 독자분들이면 한번 쯤은 해봤거나 아니면 친구들이 하는 걸 보기는 했을 거라 믿는다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/78e3e842c34112f01954aee83089586f/2f5f2/pan.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 61.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEA//EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAFLH0icvD//xAAbEAABBAMAAAAAAAAAAAAAAAACAAEDERASE//aAAgBAQABBQLnGBMW4A0lUgFsf//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/Aar/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwFH/8QAGxAAAgEFAAAAAAAAAAAAAAAAAAEDERIgIZH/2gAIAQEABj8CuUfR1NpYf//EABwQAAICAgMAAAAAAAAAAAAAAAERACEQQWGBof/aAAgBAQABPyFUB6UOAA4VKBL2IBS1ALV4/9oADAMBAAIAAwAAABC03//EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8QhZBj/8QAFREBAQAAAAAAAAAAAAAAAAAAERD/2gAIAQIBAT8QGP/EABoQAQEBAQEBAQAAAAAAAAAAAAERADEhYfD/2gAIAQEAAT8QU6CcaV8NLQWAkJ+5udBY+KZ4RUcySfBmCm//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"pan\" title=\"\" src=\"/static/78e3e842c34112f01954aee83089586f/c08c5/pan.jpg\" srcset=\"/static/78e3e842c34112f01954aee83089586f/0913d/pan.jpg 160w,\n/static/78e3e842c34112f01954aee83089586f/cb69c/pan.jpg 320w,\n/static/78e3e842c34112f01954aee83089586f/c08c5/pan.jpg 640w,\n/static/78e3e842c34112f01954aee83089586f/2f5f2/pan.jpg 797w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>판치기하다가 선생님들한테 걸리면 교무실로 끌려가서 바로 빠따행이었다.</small>\n</center>\n<p>그래도 혹시 판치기가 뭔지 모르는 분들이 있을 수 있으니 일단 간단하게 룰을 설명하겠다.</p>\n<blockquote>\n<ol>\n<li>적당히 두꺼운 교과서를 준비한다. 국사책이나 물리책처럼 적당히 두꺼운 책을 사용하자.</li>\n<li>각자 준비한 동전을 교과서에 올린다. 보통 100원을 건다.</li>\n<li>순서대로 교과서를 손으로 때려서 동전을 뒤집는다.</li>\n<li>모든 동전을 뒤집어서 같은 면으로 만든 사람이 판돈을 모두 가져간다.</li>\n</ol>\n</blockquote>\n<p>상식적으로 교과서를 손으로 때렸을 때 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>개의 동전이 뒤집어 질 것이라는 계산을 하기란 쉽지 않다. 즉, 판치기는 어느 정도 랜덤에 기반한 게임이고 그래서 도박의 기본적인 특성인 사행성을 가질 수 있는 것이다.</p>\n<p>참고로 형법 제 246조 1항과 국내 도박법 판례 상 학교에서 하는 판돈이 몇백원 정도인 판치기는 일시 오락으로 판정받아서 무죄이지만, 아무리 판치기라고 해도 몇백만원 수준의 돈이 왔다갔다 하는 수준이면 도박죄로 처벌받을 수 있다는 점 알아두자.<small>(물론 저 정도 돈이 있는 사람들이면 판치기말고 다른 걸 한다…)</small></p>\n<p>그럼 이 쯤에서 처음의 그 질문을 한번 던져보겠다.</p>\n<blockquote>\n<p>이게 정말로 랜덤일까?</p>\n</blockquote>\n<p>예전에 필자의 학창시절을 생각해봐도 학교에 1-2명씩 판치기의 절대 고수들이 있었는데 이 친구들은 자신이 원하는 동전만 정확히 뒤집을 수 있는 능력을 보유하고 있었다. 예전에 TV에서도 판치기의 고수라고 나온 분이 있었는데 이 분은 뭐 거의 닥터 스트레인지 수준이었다.</p>\n<center>\n  <img src=\"/1466f2e049709fb4c86f9b9350d41f00/pan2.gif\" width=\"100%\">\n  <br>\n</center>\n<p>사실 판치기도 결국은 물리 법칙 내에서 돌아가는 판이기 때문에 판돈으로 걸린 동전의 무게, 판을 내려치는 힘, 판으로 사용된 교과서의 탄력성 등 몇가지 변수를 알면 어느 동전이 뒤집어 질지도 계산할 수 있을 것이다. 물론 이렇게 계산하는 것이 쉬운 일은 아니기 때문에 우리는 진정한 의미의 랜덤이 아니더라도 이 정도면 그냥 “랜덤하다고 치는 것”이다.</p>\n<p>즉, 우리 주변에서도 진정한 의미의 랜덤은 그렇게 많지 않다는 것을 알 수 있다. 단지 우리가 랜덤하다고 생각할 뿐이다.</p>\n<h2 id=\"컴퓨터에서의-랜덤\" style=\"position:relative;\">컴퓨터에서의 랜덤<a href=\"#%EC%BB%B4%ED%93%A8%ED%84%B0%EC%97%90%EC%84%9C%EC%9D%98-%EB%9E%9C%EB%8D%A4\" aria-label=\"컴퓨터에서의 랜덤 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>사실 우리가 일상에서 어느 정도 우연성이 있다면 랜덤하다고 하듯이 컴퓨터도 진정한 의미의 랜덤을 만들어 내는 것이 아니라 어느 정도 납득할만한 우연성을 만들어 내고 이를 랜덤하다고 한다. 게다가 컴퓨터로 뭔가를 만드려면 어떠한 규칙을 만들어줘야 하는데, 어떠한 규칙으로 규칙이 없는 랜덤을 생성한다는 말 자체가 모순이다.</p>\n<p>그래서 우리는 랜덤은 아니지만 랜덤에 가까운 유사 랜덤(Pseudo Random)밖에 만들 수 밖에 없는 것이다. 또한 컴퓨터는 기본적으로 숫자를 기반으로 하는 일종의 계산기이기 때문에 랜덤한 사건을 만들기 위해서는 난수, 즉 랜덤한 수를 뽑아 낼 수 있어야 한다.</p>\n<p>그럼 컴퓨터는 어떻게 이런 난수 생성을 하는 걸까?</p>\n<h3 id=\"중앙제곱법mid-square-method\" style=\"position:relative;\">중앙제곱법(Mid Square Method)<a href=\"#%EC%A4%91%EC%95%99%EC%A0%9C%EA%B3%B1%EB%B2%95mid-square-method\" aria-label=\"중앙제곱법mid square method permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>중앙제곱법은 폰 노이만이 1949년에 고안한 유사 난수 생성법으로, 임의의 숫자를 제곱한 다음 이 숫자의 일부분을 가져와서 새로운 난수로 만들어내는 방법이다.</p>\n<p>임의의 4자리 난수를 만든다고 가정해보자. 초기 값은 심플하게 <code class=\"language-text\">1234</code>로 가겠다.</p>\n<table>\n<thead>\n<tr>\n<th>페이즈</th>\n<th>대상값</th>\n<th>제곱값</th>\n<th>난수</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0</td>\n<td>1234</td>\n<td>1522756</td>\n<td>1<strong>5227</strong>56</td>\n</tr>\n<tr>\n<td>1</td>\n<td>5227</td>\n<td>27321529</td>\n<td>27<strong>3215</strong>29</td>\n</tr>\n<tr>\n<td>2</td>\n<td>3215</td>\n<td>10336225</td>\n<td>10<strong>3362</strong>25</td>\n</tr>\n</tbody>\n</table>\n<p>이런 식으로 계속 중앙에 있는 값을 빼와서 제곱하면서 임의의 난수를 생성하는 방법이 바로 중앙제곱법이다. 뭔가 딱봐도 예측하기 쉬워보인다. 아무래도 폰 노이만 형이 활동하던 1950년대에 개발된 알고리즘이고, 그 당시 컴퓨터의 성능은 눈물나기 그지 없었으므로 최대한 간단한 방법을 사용한 것이다. 그래서 이 방법은 요즘에는 거의 사용되지 않는다.</p>\n<h3 id=\"선형합동법linear-congruential-method\" style=\"position:relative;\">선형합동법(Linear Congruential Method)<a href=\"#%EC%84%A0%ED%98%95%ED%95%A9%EB%8F%99%EB%B2%95linear-congruential-method\" aria-label=\"선형합동법linear congruential method permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>선형합동법은 C의 <code class=\"language-text\">rand</code>함수에서 사용하는 알고리즘이며 다음과 같은 재귀 관계식으로 정의되며 난수들의 수열을 반환한다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mi>a</mi><msub><mi>X</mi><mi>n</mi></msub><mo>+</mo><mi>c</mi><mo stretchy=\"false\">)</mo><mspace></mspace><mspace width=\"1em\"></mspace><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">X_{n+1} = (aX_n + c) \\mod m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span></span></div>\n<p>여기서 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span></span>는 난수로 된 수열이고 나머지는 그냥 임의의 정수이다. 참고로 ANSI C 표준은 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator=\"true\">,</mo><mi>a</mi><mo>=</mo><mn>1103515245</mn><mo separator=\"true\">,</mo><mi>c</mi><mo>=</mo><mn>12345</mn></mrow><annotation encoding=\"application/x-tex\">m = 2^{31}, a = 1103515245, c = 12345</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">31</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1103515245</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">12345</span></span></span></span></span>로 정해져있다. 그럼 간단하게 한번 자바스크립트를 사용해서 구현해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">let</span> m <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">31</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token number\">1103515245</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> c <span class=\"token operator\">=</span> <span class=\"token number\">12345</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">rand</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">x</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">*</span> a<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> c<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getRandomNumbers</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">randCount <span class=\"token operator\">=</span> <span class=\"token number\">1</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 현재 시각을 사용하여 초기값을 설정한다.</span>\n  <span class=\"token keyword\">const</span> initial <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> randomNumbers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>initial<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> randCount<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    randomNumbers<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span>randomNumbers<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  randomNumbers<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> randomNumbers<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">getRandomNumbers</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>코드를 브라우저 콘솔에 붙혀넣고 실행시켜보면 인자로 주었던 10만큼의 길이를 가진 난수 배열이 출력된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1163074432</span><span class=\"token punctuation\">,</span> <span class=\"token number\">465823232</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1719475776</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1744670976</span><span class=\"token punctuation\">,</span> <span class=\"token number\">790949120</span><span class=\"token punctuation\">,</span> <span class=\"token number\">552540416</span><span class=\"token punctuation\">,</span> <span class=\"token number\">896259328</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1473241344</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1074855168</span><span class=\"token punctuation\">,</span> <span class=\"token number\">575793408</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>선형합동법의 특징은 이전에 생성된 난수를 활용한다는 것이며 최대 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span></span>만큼 경우의 수를 가지므로 최악의 경우 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span></span> 만큼의 반복 주기를 가진다. 필자가 <code class=\"language-text\">m</code> 변수를 <code class=\"language-text\">let</code> 키워드로 선언한 건 이 이유다. 한번 브라우저에서 <code class=\"language-text\">m</code> 변수에 작은 수를 할당한 다음에 <code class=\"language-text\">getRandomNumbers</code> 함수를 다시 호출해보자. 난수의 경우의 수와 동일한 값이 출현이 눈에 띄게 커진다는 것을 확인해볼 수 있다.</p>\n<p>선형합동법은 계산이 굉장히 간단하고 빠르기 때문에 초창기부터 컴퓨터에 널리 사용되었다. 그러나 선형합동법은 난수에 주기성이 있고 생성되어 나오는 난수들 사이에 상관 관계가 존재하기 때문에 마지막으로 생성된 난수와 그 외 변수들만 알면 그 다음에 생성될 난수를 모두 예측할 수 있다.</p>\n<p>문제는 그 변수들이 ANSI C 표준으로 정해져 있어서 누구든지 다 알 수 있다는 점이다. 즉, 조금 지식이 있는 사람이면 <code class=\"language-text\">rand</code> 함수의 결과를 보고 다음 난수를 미리 예상할 수 있다는 것이다.</p>\n<p>그래서 이 알고리즘은 난수가 예측당해도 상관없는 경우나 임베디드처럼 메모리를 많이 사용하지 못하는 제한된 상황에서 주로 사용한다.</p>\n<h3 id=\"메르센-트위스터mersenne-twister\" style=\"position:relative;\">메르센 트위스터(Mersenne Twister)<a href=\"#%EB%A9%94%EB%A5%B4%EC%84%BC-%ED%8A%B8%EC%9C%84%EC%8A%A4%ED%84%B0mersenne-twister\" aria-label=\"메르센 트위스터mersenne twister permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>메르센 트위스터는 엑셀, MATLAB, PHP, Python, R, C++ 등에서 사용하고 있는 난수 생성 알고리즘이며, 1997년에 마츠모토 마코토와 니시무라 다쿠지가 개발한 알고리즘이다. 메르센 트위스터라는 이름은 이 알고리즘의 난수 반복 주기가 메르센 소수인데서 유래했다.</p>\n<p>메르센 소수라고 하면 뭔가 대단한 수 같은데 사실 별 거 없다. 메르센 수는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>M</mi><mi>n</mi></msub><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">M_n = 2^{n} - 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>으로 나타내며 식 그대로 2의 n제곱에서 1이 모자란 수를 말하는 것이고 메르센 소수는 그냥 이 메르센 수 중에서 소수인 것을 고른 것이다.</p>\n<p>보통 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>19937</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^{19937} - 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">19937</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>의 난수 반복 주기를 가지는 “MT19937” 알고리즘이 많이 사용되는데, C++에서도 이 알고리즘을 채택해서 사용하고 있다. 이 알고리즘의 동작 원리를 간단하게 설명하면 다음과 같다.</p>\n<blockquote>\n<ol>\n<li>seed를 사용하여 624 만큼의 길이를 가진 벡터를 생성. seed는 보통 하드웨어 노이즈나 오늘 날짜를 사용한다.</li>\n<li>이 벡터를 사용하여 624개의 유사 난수를 만든다.</li>\n<li>이 벡터에 노이즈를 준 후 다시 2번을 반복. 이 노이즈를 주는 행위를 Twist한다고 한다.</li>\n</ol>\n</blockquote>\n<p>이때 3번의 Twist하는 과정에서 GFSR(Generalized Feedback Shift Register)이라는 방법을 사용한다. GFSR은 자료가 많지 않고 대부분 논문같은 학술 자료만 있는 상황이라 필자가 자세히 알아보지는 못했으나, 열심히 구글링하고 논문들을 뜯어본 결과 LFSR(Linear Feedback Shift Register)를 약간 변형한 방법이라는 정보를 얻을 수 있었다. <small>(정보가 너무 제한적이라 LFSR 기반이 맞는지는 정확하지 않다.)</small></p>\n<p>LFSR은 이전 상태 값들을 가져와서 선형 함수를 통해 계산한 후 그걸 사용해서 다음 값을 만들어 내는 방법이다. 이때 사용하는 함수는 보통 XOR를 많이 사용하고 맨 처음 값을 시드(Seed)라고 부른다.</p>\n<img src=\"/ad9106cf75abf61d96aea27d0f40cef7/lfsr.gif\" width=\"100%\">\n<p>LFSR를 간단히 설명하자면, 우선 몇개의 메모리 주소를 골라놓고 초기화된 인풋인 시드를 레지스터에 밀어넣는다. 그러면 오른쪽으로 한칸씩 비트가 밀리게(Shifting) 된다. 그러면 우리는 끝에서 삐져나온 한개의 비트를 아웃풋에서 얻게 된다. 그 다음 미리 골라놨던 메모리 주소에 접근해서 값을 빼온 다음에 순서대로 하단에 위치한 3개의 XOR 게이트에 통과시키면 다음 인풋이 나오고 그걸 또 레지스터에 밀어넣는걸 반복하는 것이다.</p>\n<p>메르센 트위스터도 결국은 LFSR가 약간 변형된 GFSR를 사용하여 난수를 생성하기 때문에 초반에 시드를 생성해줘야한다.</p>\n<p>메르센 트위스터의 자세한 알고리즘은 위키피디아의 <a href=\"https://en.wikipedia.org/wiki/Mersenne_Twister#Algorithmic_detail\" target=\"_blank\" rel=\"nofollow\">Mersenne Twister - Algorithmic_detail</a>에서 확인할 수 있다. 필자는 2002년에 마츠모토 마코토와 니시무라 다쿠지가 자신들의 메르센 트위스터 알고리즘을 개선해서 다시 작성한 C의 MT19937 알고리즘 코드를 보고 자바스크립트로 한번 포팅해보았다. 이 코드는 최대 32bit 길이의 난수를 사용하도록 작성되어있다. 64bit용 알고리즘은 MT19937-64라고 또 따로 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token constant\">N</span> <span class=\"token operator\">=</span> <span class=\"token number\">624</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">M</span> <span class=\"token operator\">=</span> <span class=\"token number\">397</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">F</span> <span class=\"token operator\">=</span> <span class=\"token number\">1812433253</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">UPPER_MASK</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 0x80000000</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">LOWER_MASK</span> <span class=\"token operator\">=</span> <span class=\"token constant\">UPPER_MASK</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 0x7fffffff</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">MATRIX_A</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x9908b0df</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MersenneTwister</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> initSeed <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span><span class=\"token constant\">N</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index <span class=\"token operator\">=</span> <span class=\"token constant\">N</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">seedMt</span><span class=\"token punctuation\">(</span>initSeed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">seedMt</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">seed</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> s<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> seed <span class=\"token operator\">>>></span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index <span class=\"token operator\">&lt;</span> <span class=\"token constant\">N</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token constant\">F</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>>></span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;=</span> <span class=\"token number\">0xffffffff</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">int</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> y<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> mag01 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">MATRIX_A</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index <span class=\"token operator\">>=</span> <span class=\"token constant\">N</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> kk<span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index <span class=\"token operator\">===</span> <span class=\"token constant\">N</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">seedMt</span><span class=\"token punctuation\">(</span><span class=\"token number\">5489</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>kk <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> kk <span class=\"token operator\">&lt;</span> <span class=\"token constant\">N</span> <span class=\"token operator\">-</span> <span class=\"token constant\">M</span><span class=\"token punctuation\">;</span> kk<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span>kk<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">UPPER_MASK</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span>kk <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">LOWER_MASK</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span>kk<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span>kk <span class=\"token operator\">+</span> <span class=\"token constant\">M</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">>>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> mag01<span class=\"token punctuation\">[</span>y <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> kk <span class=\"token operator\">&lt;</span> <span class=\"token constant\">N</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> kk<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span>kk<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">UPPER_MASK</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span>kk <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">LOWER_MASK</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span>kk<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span>kk <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">M</span> <span class=\"token operator\">-</span> <span class=\"token constant\">N</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">>>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> mag01<span class=\"token punctuation\">[</span>y <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span><span class=\"token constant\">N</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">UPPER_MASK</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token constant\">LOWER_MASK</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span><span class=\"token constant\">N</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span><span class=\"token constant\">M</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">>>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> mag01<span class=\"token punctuation\">[</span>y <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    y <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mt<span class=\"token punctuation\">[</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>index<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    y <span class=\"token operator\">^=</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">>>></span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    y <span class=\"token operator\">^=</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x9d2c5680</span><span class=\"token punctuation\">;</span>\n    y <span class=\"token operator\">^=</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xefc60000</span><span class=\"token punctuation\">;</span>\n    y <span class=\"token operator\">^=</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">>>></span> <span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> y <span class=\"token operator\">>>></span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>코드 내부에 사용된 상수 <code class=\"language-text\">F = 1812433253</code>, <code class=\"language-text\">MATRIX_A = 0x9908b0df</code>, <code class=\"language-text\">this.seedMt(5489)</code> 등은 필자가 임의로 넣은 수가 아니라 MT19937의 표준 계수로 정해져 있는 수이다.</p>\n<p>사실 알고리즘 자체가 너무 복잡해서 필자도 다 이해하지는 못했다. <small>(대학 때 공부를 열심히 안한 죄…)</small> 그래도 일단 이렇게 코드로 한번 직접 작성해보면 글로만 읽을 때보다는 확실히 조금 더 이해가 되기 때문에 C로 작성된 원래 코드를 자바스크립트로 포팅한 것이다. 필자가 참고한 C 라이브러리 코드는 <a href=\"http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/CODES/mt19937ar.c\" target=\"_blank\" rel=\"nofollow\">여기서</a> 확인할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> rand <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MersenneTwister</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>rand<span class=\"token punctuation\">.</span><span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 2145258025</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>작성한 코드를 직접 실행해보니 랜덤한 난수가 잘 생성이 되는 것 같다. 사실 난수가 잘 생성되는지 정확하게 보려면 결과를 시각화한 후 난수의 분포도를 봐야하지만 귀찮은 관계로 일단 패스하겠다. 참고로 이 알고리즘을 만든 <a href=\"http://www.math.sci.hiroshima-u.ac.jp/~m-mat/eindex.html\" target=\"_blank\" rel=\"nofollow\">마츠모토 마코토의 홈페이지</a>에 들어가면 이 알고리즘이 왜 이런 이름을 가지게 되었는지 나와있다.</p>\n<blockquote>\n<p><strong>마코토</strong>: Knuth 교수님이 이 이름 발음하기 너무 힘들대.<br />\n<strong>다쿠지</strong>: …</p>\n<p>[며칠 후]</p>\n<p><strong>마코토</strong>: 하이 타쿤, 메르센 트위스터는 어때? 메르센 소수를 사용하기도 했고, 원형은 Twisted GFSR(Generalized Feedback Shift Register)니까.<br />\n<strong>다쿠지</strong>: 글쎄…?<br />\n<strong>마코토</strong>: 왠지 제트코스터 같이 들리는 걸? 빨라보이기도 하고 기억하고 쉽고 발음하기 좋고. 그리고 이건 비밀인데 이 이름엔 우리들의 이니셜이 숨어있지!(Makoto, Takuji)<br />\n<strong>다쿠지</strong>: …<br />\n<strong>마코토</strong>: 자자자 MT로 가는거다?<br />\n<strong>다쿠지</strong>: 음…그래</p>\n<p>나중에 우리는 Knuth 교수님으로부터 “좋은 이름인 것 같다”라는 편지를 받았다.</p>\n</blockquote>\n<p>뭔가 깨발랄한 마코토형과 시니컬한 다쿠지형 케미가 돋보인다. 뭔가 이런 대단한 알고리즘을 개발한 사람이지만 사람 냄새나는 네이밍 과정인듯.</p>\n<h3 id=\"xor-시프트xor-shift\" style=\"position:relative;\">XOR 시프트(XOR shift)<a href=\"#xor-%EC%8B%9C%ED%94%84%ED%8A%B8xor-shift\" aria-label=\"xor 시프트xor shift permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>XOR 시프트도 메르센 트위스터와 마찬가지로 LFSR을 기반으로 한 의사 난수 알고리즘이다. 어떻게 보면 메르센 트위스트의 하위호환이라고 볼 수도 있는데, 메르센 트위스트와 원리는 비슷하지만 구현이 훨씬 간단하고 작동이 빠르기 때문에 왕왕 사용된다.</p>\n<p>XOR 시프트 알고리즘은 여러 종류가 있는데, 32bit, 64bit, 128bit의 수를 사용하며 각각 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^{32} -1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">32</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>64</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^{64} - 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">64</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>128</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^{128} - 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">128</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>의 메르센 수 난수 반복 주기를 가진다.</p>\n<p>근데 이게 TestU01이라는 난수 품질 테스트 프레임워크의 테스트를 통과하지 못해서 조금 문제가 있었다. 이걸 통과해야 ANSI C 표준이 될 수 있기 때문이다.</p>\n<p>그래서 몇가지 변종 알고리즘이 나오게 되었는데 그 중 하나가 128bit를 사용하는 XOR 시프트 128을 개량한 XOR 시프트 128 +라는 알고리즘이다. <small>(뭔가 게임 후속작 제목 같다…)</small></p>\n<p>참고로 V8, SpdierMonkey, JavaScriptCore 등 메이저 자바스크립트 엔진들이 채택한 난수 생성 알고리즘이 XOR 시프트 128 +이다. 이 알고리즘은 2016년 11월에 Sebastiano Vigna라는 분에 의해 학회에서 발표되었다. 논문 내용은 <a href=\"http://vigna.di.unimi.it/ftp/papers/xorshiftplus.pdf\" target=\"_blank\" rel=\"nofollow\">여기</a>에서 확인할 수 있다.</p>\n<p>전반적인 원리는 위에서 설명한 LFSR와 비슷하니, V8 엔진에서 <code class=\"language-text\">Math.random</code> 메소드를 어떻게 구현했는지 한번 살펴보자. 원래 코드는 C++로 작성되어있으나 여러분이 브라우저에서 코드를 쉽게 실행시켜볼 수 있도록 동일한 로직을 자바스크립트로 포팅해서 작성하겠다.</p>\n<p>V8의 XOR 시프트 128+ 알고리즘은 <a href=\"https://github.com/v8/v8/blob/main/src/base/utils/random-number-generator.h#L119C71-L120C1\" target=\"_blank\" rel=\"nofollow\">v8/src/base/utils/random-number-generator.h</a>에 작성되어 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// xorshift128plus.js</span>\n<span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1827981275</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1295982171</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">xorshift128plus</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> s1 <span class=\"token operator\">=</span> state<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> s0 <span class=\"token operator\">=</span> state<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  state<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> s0<span class=\"token punctuation\">;</span>\n  s1 <span class=\"token operator\">^=</span> s1 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">23</span><span class=\"token punctuation\">;</span>\n  s1 <span class=\"token operator\">^=</span> s1 <span class=\"token operator\">>></span> <span class=\"token number\">17</span><span class=\"token punctuation\">;</span>\n  s1 <span class=\"token operator\">^=</span> s0<span class=\"token punctuation\">;</span>\n  state<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> s1<span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'레지스터의 현재 상태 -> '</span><span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> state<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'초기 레지스터 상태 -> '</span><span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'난수 -> '</span><span class=\"token punctuation\">,</span> <span class=\"token function\">xorshift128plus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">초기 레지스터 상태 <span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token punctuation\">[</span> <span class=\"token number\">1827981275</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1295982171</span> <span class=\"token punctuation\">]</span>\n레지스터의 현재 상태 <span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token punctuation\">[</span> <span class=\"token number\">1295982171</span><span class=\"token punctuation\">,</span> <span class=\"token number\">867440954</span> <span class=\"token punctuation\">]</span>\n난수 <span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token number\">2163423125</span>\n레지스터의 현재 상태 <span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token punctuation\">[</span> <span class=\"token number\">867440954</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1393243966</span> <span class=\"token punctuation\">]</span>\n난수 <span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token number\">2260684920</span>\n레지스터의 현재 상태 <span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token punctuation\">[</span> <span class=\"token number\">1393243966</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37812574</span> <span class=\"token punctuation\">]</span>\n난수 <span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token number\">1431056540</span>\n레지스터의 현재 상태 <span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token punctuation\">[</span> <span class=\"token number\">37812574</span><span class=\"token punctuation\">,</span> <span class=\"token number\">833890405</span> <span class=\"token punctuation\">]</span>\n난수 <span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token number\">871702979</span>\n레지스터의 현재 상태 <span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token punctuation\">[</span> <span class=\"token number\">833890405</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1661667227</span> <span class=\"token punctuation\">]</span>\n난수 <span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token number\">2495557632</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>출력된 로그를 보면 레지스터의 상태가 어떻게 변하고 있는지 알 수 있다.</p>\n<p><code class=\"language-text\">[1]</code>번 인덱스에 있던 값이 <code class=\"language-text\">[0]</code>번 인덱스로 옮겨지고 <code class=\"language-text\">[1]</code>번 인덱스에 새로운 난수를 꽂아넣은 후 두 원소를 더해서 출력하고 있다는 걸 알 수 있다.</p>\n<p>계산 과정을 보면 <code class=\"language-text\">[1]</code>번 인덱스에 새로운 값을 넣을 때는 시프팅되어 왼쪽으로 삐져나온 값인 <code class=\"language-text\">[0]</code>번 인덱스의 값을 사용하여 XOR 시프팅을 진행하고 그 값을 다시 <code class=\"language-text\">[1]</code>번 인덱스에 넣어준다.</p>\n<p>그리고 시프팅하는 상수인 <code class=\"language-text\">23</code>, <code class=\"language-text\">17</code>은 XOR 시프팅 128+ 알고리즘을 개발할 때 연구를 통해 찾아낸 최적의 상수이기 때문에 사용하는 것이다. 해당 논문을 보면 뭐 이것저것 시도해본 다음에 결과를 일일히 테스트해서 나온 결과를 비교한 도표도 함께 첨부되어있다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>사실 처음에는 가벼운 마음으로 랜덤에 대한 이야기를 해보려고 했는데 예상보다 수학적인 내용이 많이 나와서 왠지 어려운 포스팅이 되어버린 것 같다.</p>\n<p>사실 컴퓨터라는 계산기로 진정한 의미의 난수를 만드는 것은 거의 불가능하다. 최근에 미국에서 양자컴퓨터를 사용해서 진정한 의미의 난수를 생성하는 데 성공했다고 하지만 양자컴퓨터는 아직은 우리와 너무나도 먼 이야기이기 때문에 논외로 치겠다.</p>\n<p>필자도 사실 수학을 그다지 좋아하는 편은 아니다. 하지만 이렇게 수학적인 연구를 통해 생성 규칙이 없는 난수를 만드려는 많은 사람들의 도전을 보면, 편하게 상위 레이어에서 코딩하고 있는 필자로써는 이 분들에게 굉장히 감사함을 느낀다. <small>(난 안될꺼야 아마…)</small></p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/4ac69e39a60e61a01bddd4634b5d04ee/4b190/thanks.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 86.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAGAABAQADAAAAAAAAAAAAAAAAAAQBAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAFtswTKxRyQpB//xAAeEAACAgAHAAAAAAAAAAAAAAABAgADBBESEzEyM//aAAgBAQABBQIVFpUldj6QGXhSFbZGZmI9E6//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAeEAACAgICAwAAAAAAAAAAAAABAgAxESEDECKBof/aAAgBAQAGPwJnY4UGeNCwYwrcbjKnA+zQ2YTmzDE99f/EAB0QAAMAAgIDAAAAAAAAAAAAAAABESExEHFRgbH/2gAIAQEAAT8hyA5S4ZvuPgSOeGnpF7nHWhKs6BUT2h8OG1n/2gAMAwEAAgADAAAAEBMPAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB0QAQEAAwACAwAAAAAAAAAAAAERACExYfAQceH/2gAIAQEAAT8QNdEUtY7mbrYqXbUJ5xNgnKwwIEwQz1dAt/MCsCFCQliW4ZAU7NWa74zj278B7PrP/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"thanks\" title=\"\" src=\"/static/4ac69e39a60e61a01bddd4634b5d04ee/c08c5/thanks.jpg\" srcset=\"/static/4ac69e39a60e61a01bddd4634b5d04ee/0913d/thanks.jpg 160w,\n/static/4ac69e39a60e61a01bddd4634b5d04ee/cb69c/thanks.jpg 320w,\n/static/4ac69e39a60e61a01bddd4634b5d04ee/c08c5/thanks.jpg 640w,\n/static/4ac69e39a60e61a01bddd4634b5d04ee/4b190/thanks.jpg 800w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>연구원 분들이 기반 알고리즘을 만들어주시면 열심히 상용 어플리케이션에 써먹겠습니다...!!!</small>\n</center>\n<p>필자는 이 포스팅을 작성하면서 논문과 위키피디아를 엄청 들여다봤는데 오랜만에 영어와 수식을 너무 많이 봐서 머리에 과부하가 걸린 상태다. 그리고 다른 건 몰라도 메르센 트위스트 같은 경우는… 아니 너무 복잡하다 인간적으로…</p>\n<p>참고로 이거 만든 마츠모토 마코토님은 지금 히로시마 대학교의 수학 대학원에서 조교수로 근무하고 계신데, 이 정도 머리가 되야 강단에 설 수 있는 건가라는 생각도 든다. 완전 어나더레벨…</p>\n<p>이상으로 컴퓨터가 만드는 랜덤은 정말로 랜덤할까? 포스팅을 마친다.</p>\n<hr>\n<p>참고문헌</p>\n<p><a href=\"https://en.wikipedia.org/wiki/Xorshift#xorshift+\" target=\"_blank\" rel=\"nofollow\">XorShift - Wikipedia</a><br />\n<a href=\"https://v8.dev/blog/math-random\" target=\"_blank\" rel=\"nofollow\">There’s Math.random(), and then There’s Math.random() - V8 Dev</a><br />\n<a href=\"http://vigna.di.unimi.it/ftp/papers/xorshiftplus.pdf\" target=\"_blank\" rel=\"nofollow\">Futher scramblings of Marsaglia’s xorshift generators - Sebastiano Vigna</a><br />\n<a href=\"https://lemire.me/blog/2017/09/08/the-xorshift128-random-number-generator-fails-bigcrush/\" target=\"_blank\" rel=\"nofollow\">The Xorshit128+ random number generator fails BigCrush - Daniel Lemire</a></p>","fields":{"slug":"20190714-what-is-random","path":"/2019/07/14/what-is-random/","lang":"ko"},"frontmatter":{"title":"컴퓨터가 만드는 랜덤은 정말로 랜덤할까?","subTitle":"중앙제곱법, 선형합동법, 메르센 트위스터로 보는 난수 생성 알고리즘","date":"Jul 14, 2019","categories":["프로그래밍","알고리즘"],"tags":["Algorithm","알고리즘","난수생성","메르센 트위스터","Real Random","난수","자바스크립트","JavaScript","수학","암호학"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/a801f480d325ee0f4ce6bccd0622d392/3a812/thumbnail.jpg","srcSet":"/static/a801f480d325ee0f4ce6bccd0622d392/3a812/thumbnail.jpg 320w,\n/static/a801f480d325ee0f4ce6bccd0622d392/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/a801f480d325ee0f4ce6bccd0622d392/fc5c5/thumbnail.webp 320w,\n/static/a801f480d325ee0f4ce6bccd0622d392/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/a801f480d325ee0f4ce6bccd0622d392/2d839/thumbnail.jpg","srcSet":"/static/a801f480d325ee0f4ce6bccd0622d392/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/a801f480d325ee0f4ce6bccd0622d392/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"c8fea967-1739-5b9a-b413-e3ad5ce694d0","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%86%8C%EB%A6%AC%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%BC%EA%B9%8C\">소리란 무엇일까?</a></p>\n<ul>\n<li><a href=\"#%EC%86%8C%EB%A6%AC%EB%8A%94-%EC%95%84%EB%82%A0%EB%A1%9C%EA%B7%B8-%EC%8B%A0%ED%98%B8%EB%8B%A4\">소리는 아날로그 신호다</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%BB%B4%ED%93%A8%ED%84%B0%EA%B0%80-%EC%86%8C%EB%A6%AC%EB%A5%BC-%EB%93%A3%EB%8A%94-%EB%B0%A9%EB%B2%95\">컴퓨터가 소리를 듣는 방법</a></p>\n<ul>\n<li><a href=\"#%EC%83%98%ED%94%8C%EB%A7%81sampling\">샘플링(Sampling)</a></li>\n<li><a href=\"#%EC%83%98%ED%94%8C-%EB%A0%88%EC%9D%B4%ED%8A%B8sample-rate%EB%A5%BC-%EC%A2%80-%EB%8D%94-%EC%9E%90%EC%84%B8%ED%9E%88-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90\">샘플 레이트(Sample Rate)를 좀 더 자세히 알아보자</a></li>\n<li><a href=\"#%EB%B9%84%ED%8A%B8-%EB%A0%88%EC%9D%B4%ED%8A%B8bit-rate\">비트 레이트(Bit Rate)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#web-audio-api%EB%A1%9C-%ED%8C%8C%ED%98%95-%EA%B7%B8%EB%A0%A4%EB%B3%B4%EA%B8%B0\">Web Audio API로 파형 그려보기</a></p>\n<ul>\n<li><a href=\"#%EA%B8%B0%EB%B3%B8-%ED%8B%80-%EC%9E%A1%EA%B8%B0\">기본 틀 잡기</a></li>\n<li><a href=\"#audioanalyzer-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%9E%91%EC%84%B1\">AudioAnalyzer 클래스 작성</a></li>\n<li><a href=\"#svg-%EB%B7%B0%EB%B0%95%EC%8A%A4%EB%A5%BC-%EC%84%A4%EC%A0%95%ED%95%98%EC%9E%90\">SVG 뷰박스를 설정하자</a></li>\n<li><a href=\"#%EC%97%85%EB%A1%9C%EB%93%9C%EB%90%9C-audiobuffer-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\">업로드된 AudioBuffer 확인하기</a></li>\n<li><a href=\"#%EC%98%A4%EB%94%94%EC%98%A4-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D%ED%95%98%EA%B3%A0-%EC%A0%95%EC%A0%9C%ED%95%98%EA%B8%B0\">오디오 데이터 분석하고 정제하기</a></li>\n<li><a href=\"#%EC%9D%B4%EC%A0%9C-%EC%A7%84%EC%A7%9C-%EA%B7%B8%EB%A0%A4%EB%B3%B4%EC%9E%90\">이제 진짜 그려보자!</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9D%8C%EC%95%85-%EC%A3%BC%EC%84%B8%EC%9A%94-dj\">음악 주세요 DJ</a></p>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 필자의 예전 직업이었던 사운드 엔지니어의 추억을 살려서 한번 오디오에 대한 이론을 설명해볼까 한다. 하지만 이론 설명만 하면 노잼이니까 오디오 이론을 기초로 자바스크립트의  API를 사용하여 간단한 오디오 파형까지 그려보려고 한다.","html":"<p>이번 포스팅에서는 필자의 예전 직업이었던 사운드 엔지니어의 추억을 살려서 한번 오디오에 대한 이론을 설명해볼까 한다. 하지만 이론 설명만 하면 노잼이니까 오디오 이론을 기초로 자바스크립트의 <code class=\"language-text\">Web Audio</code> API를 사용하여 간단한 오디오 파형까지 그려보려고 한다.</p>\n<!-- more -->\n<p>바로 코딩에 들어가고 싶지만 오디오에 관한 기본적인 지식이 있어야 오디오 파형을 그릴 때의 과정을 이해할 수 있으므로 이론을 최대한 지루하지 않게 설명하려고 한다. 이론이 코딩보다 재미없는 건 맞지만 오디오 파형을 그리려면 최소한 기본적으로 알고 있어야 하는 것들이니까 한번 쓱 흝어보자.</p>\n<h2 id=\"소리란-무엇일까\" style=\"position:relative;\">소리란 무엇일까?<a href=\"#%EC%86%8C%EB%A6%AC%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%BC%EA%B9%8C\" aria-label=\"소리란 무엇일까 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>제일 먼저 소리가 무엇인지부터 알아보자. 소리를 딱 한마디로 표현하자면 바로 “진동”이다. 기본적으로 우리가 소리를 듣는다는 것은 이런 순서로 일어난다.</p>\n<hr>\n<ol>\n<li>어떤 물체가 부르르 진동을 한다. 이때 진동 주파수는 뭐 대충 <code class=\"language-text\">440hz</code>라고 치자.</li>\n<li>그 물체 주변에 있는 매질이 <code class=\"language-text\">440hz</code>의 진동을 전달한다.(일반적인 상황에서는 주로 공기)</li>\n<li>매질이 진동을 전달하면 우리의 고막도 <code class=\"language-text\">440hz</code>로 진동한다.</li>\n<li>그 진동 신호를 달팽이관이 전기 신호로 바꿔서 청신경에 전달한다.</li>\n<li>뇌가 신호를 받아서 해석한다. <code class=\"language-text\">440hz</code> 접수완료!</li>\n</ol>\n<hr>\n<p>이때 1번에서 물체가 1초에 몇 번이나 떨렸는지 표현하기 위해 우리는 헤르츠(herz, hz) 단위를 사용한다. <code class=\"language-text\">10hz</code>는 1초에 10번 진동을 했다는 의미이고 <code class=\"language-text\">1khz</code>는 1초에 1000번 진동을 했다는 것이다.</p>\n<p>참고로 예시의 <code class=\"language-text\">440hz</code>는 도레미파솔라시도할 때 “라”음이다. 결국 우리가 음악을 듣는다는 것은 결국 진동을 느끼는 것이며, 현악기면 현의 진동, 관악기면 입술이나 리드의 진동, 노래라면 성대의 진동을 듣게 되는 것이다. 아무리 감성터지는 음악도 공돌이 손에 걸리면 이렇게 분해될 수 있다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/6e3222c117b2f5be65d4a041d5f0bf99/eea4a/s-oche.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAABA//EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAEW9SxqiZB//8QAGBABAQEBAQAAAAAAAAAAAAAAAQARIkH/2gAIAQEAAQUCtLxXA6b/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwFX/8QAGRAAAwADAAAAAAAAAAAAAAAAARARACJB/9oACAEBAAY/AjahrgHK/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAREhQZH/2gAIAQEAAT8h1PBElJpz6WXttU1HpBAxEr6f/9oADAMBAAIAAwAAABCTz//EABgRAQEAAwAAAAAAAAAAAAAAAAEAETFR/9oACAEDAQE/EBdWHt//xAAYEQEBAAMAAAAAAAAAAAAAAAABABEhUf/aAAgBAgEBPxAw7gcv/8QAHBABAAICAwEAAAAAAAAAAAAAAQARITFBUWGB/9oACAEBAAE/EGkFsbi9+sCRCWR5fnWtzeFiQ9YTYClkWuZiawJVwZgAaFP/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"s oche\" title=\"\" src=\"/static/6e3222c117b2f5be65d4a041d5f0bf99/c08c5/s-oche.jpg\" srcset=\"/static/6e3222c117b2f5be65d4a041d5f0bf99/0913d/s-oche.jpg 160w,\n/static/6e3222c117b2f5be65d4a041d5f0bf99/cb69c/s-oche.jpg 320w,\n/static/6e3222c117b2f5be65d4a041d5f0bf99/c08c5/s-oche.jpg 640w,\n/static/6e3222c117b2f5be65d4a041d5f0bf99/6a068/s-oche.jpg 960w,\n/static/6e3222c117b2f5be65d4a041d5f0bf99/eea4a/s-oche.jpg 1280w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>우리가 듣는 아름다운 선율의 음악도 뜯어보면 그냥 진동 주파수 덩어리다.</small>\n</center>\n<p>이때 이 진동은 자연계에서 발생한 것이기 때문에 아날로그(Analog)의 형태로 나타난다. 사실 자연계에서 발생하는 대부분의 거시적인 신호는 아날로그 형태를 가지는데, 예를 들면 빛의 밝기가 변한다거나 바람의 세기가 변한다거나 소리의 크기가 변하는 등의 신호를 말한다.</p>\n<h3 id=\"소리는-아날로그-신호다\" style=\"position:relative;\">소리는 아날로그 신호다<a href=\"#%EC%86%8C%EB%A6%AC%EB%8A%94-%EC%95%84%EB%82%A0%EB%A1%9C%EA%B7%B8-%EC%8B%A0%ED%98%B8%EB%8B%A4\" aria-label=\"소리는 아날로그 신호다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>아날로그(Analog)는 신호나 자료를 연속적인 물리량으로 나타낸 것이다. 이게 연속적인 물리량이라고 하면 뭔가 전문적이고 어려워보이는데 풀어보면 사실 별 거 없다. 여기서 우리가 집중해야할 단어는 물리량이 아닌 “연속적”이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 605px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/48485ab8c211172e1d85631ac91b57ce/90cbd/analog.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVR42m1S147CQBDb//8seANxQiAhSugCUjahi5rx2Qk6jsutlOxkqseOazabyIIAOJ1QOdcrkCTA41GN7XbAdltxu3G7XTTL4xjGQqPTzMqbzWy/h6Vp+Z3n5X25wLyHZRmMtT81fNyk1So6K4Dj8T3qdnsjYEM8n5/oFL/fKyhdt17Hns38ZoPteIyUUz2fbDaDXy7hWZzO58hkK0ZkosgTfZE3GiFcr7EOQyS8XYsIMyKIlDAYIKZTdtLvI+IQ2fFqhWQ4RKi8xQKeTSI2DklTOp1iSNq+Oh1MGg2uTEexsl5a+3wuReD0MmDvtWUfDgA5/BBOFLxyXK/XY/0DuUiVKBInikrifwsh8uWXUPK9RChiEogrS0BXq9UQkJOzkOlo+n+/kNBJNAnx92gjITfDN0lsZ7dzZK7fAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"analog\" title=\"\" src=\"/static/48485ab8c211172e1d85631ac91b57ce/90cbd/analog.png\" srcset=\"/static/48485ab8c211172e1d85631ac91b57ce/69538/analog.png 160w,\n/static/48485ab8c211172e1d85631ac91b57ce/72799/analog.png 320w,\n/static/48485ab8c211172e1d85631ac91b57ce/90cbd/analog.png 605w\" sizes=\"(max-width: 605px) 100vw, 605px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>가로 축은 시간, 세로 축은 전압이다. 아날로그 신호는 아무리 쪼개도 끝이 없는 연속성을 가진다</small>\n</center>\n<p>그렇다면 연속적이라는 건 무슨 말일까?</p>\n<p>연속성의 대표적인 예는 바로 수이다. 자 우리가 이제 <code class=\"language-text\">1</code>부터 <code class=\"language-text\">2</code>까지 걸어간다고 생각해보자. 우리는 <code class=\"language-text\">1</code>에서 <code class=\"language-text\">2</code>까지 걸어가는 동안 몇 개의 수를 만날 수 있을까?</p>\n<p>우선 <code class=\"language-text\">1</code>과 <code class=\"language-text\">2</code>까지 거리의 절반이 되는 위치에는 <code class=\"language-text\">1.5</code>가 있을 것이다. 그 절반인 <code class=\"language-text\">1.25</code>도 있을 것이며 또 그것의 절반인 <code class=\"language-text\">1.125</code>도 있을 것이다.</p>\n<p>이런 식으로 계속 수를 쪼개다 보면 우리는 결국 이게 의미없는 삽질이라는 것을 깨닫게 된다. 만약 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>10</mn><mrow><mo>−</mo><mn>10000</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">10^{-10000}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">10000</span></span></span></span></span></span></span></span></span></span></span></span></span> 단위까지 쪼갠다 해도 우리는 그 수를 계속 해서 무한히 쪼갤 수 있다. 우리는 이런 성질을 연속이라고 부른다.</p>\n<h2 id=\"컴퓨터가-소리를-듣는-방법\" style=\"position:relative;\">컴퓨터가 소리를 듣는 방법<a href=\"#%EC%BB%B4%ED%93%A8%ED%84%B0%EA%B0%80-%EC%86%8C%EB%A6%AC%EB%A5%BC-%EB%93%A3%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\"컴퓨터가 소리를 듣는 방법 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>근데 여러분도 알다시피 컴퓨터는 <code class=\"language-text\">0</code>과 <code class=\"language-text\">1</code>밖에 이해하지 못하는 바보다. 이 방식을 우리는 디지털(Digital)이라고 부른다. 그래서 <code class=\"language-text\">0</code>과 <code class=\"language-text\">1</code>밖에 모르는 컴퓨터는 연속성을 가진 아날로그 신호를 이해할 수가 없다.</p>\n<p>그렇다면 우리가 자연에서 발생한 아날로그 형태인 소리를 컴퓨터가 듣게 해주려면 어떻게 해야할까?</p>\n<p>간단하다. 아날로그를 디지털로 바꿔주면 된다. 아날로그 신호인 소리를 컴퓨터가 알아 들을 수 있게 변경하는 과정을 알고나면 <code class=\"language-text\">Web Audio</code> API가 우리에게 주는 정보들이 뭘 의미하는 지 알 수 있다. 그럼 지금부터 아날로그를 디지털로 변경하는 과정을 알아보자.</p>\n<p>아날로그를 디지털로 변경하기 위해서는 몇가지 순서를 거쳐야 한다. 이 순서에서 어떤 값들을 사용하냐에 따라서 디지털로 변경된 소리의 해상도, 즉 음질이 결정된다.\n이때 나오는 단어가 바로 샘플 레이트(Sample Rate)와 비트 레이트(Bit Rate)이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 439px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/5c4ef295d012e89f63bcd069e92fb4b5/e3b18/encoder.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 36.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABNElEQVR42lVRSY7CQBDL//+VAxcQEmQlezobWciCYE6ecmUYzRxKlbTdLrvaMqZCHCdI01Sr73uM46jVtB3iJEXg+2jbVnH2aZoUH4ZB+bfbDff7HV3XwTJVhSTNkCS7KAES58cDddPCD0LFeF4UxT/Bh3BYxPlPccsYo0JhGCKKIi1+13WNPM9xPB4FzyRFjCzbOwX8H9fzPOv9QQQ51OKly+UC13XheR6CIFBgXVed2Mil9/sLo7iis23bsCyLCtHV9XrVO6UY4wCLMQ6HA2zbxvl8RiUr0EhSpqpRliVWEVnXTQc4jqMu+37Yncl6CuH00tUho3HK6XTS5aYSa9/NLFMrIRd4vV6Y5OzzADRBDh+BvWka7b87pGXuhTEJMApdksDJ2/OpO6Ibxv3L+XQWX/kbanYF0WWvlT4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"encoder\" title=\"\" src=\"/static/5c4ef295d012e89f63bcd069e92fb4b5/e3b18/encoder.png\" srcset=\"/static/5c4ef295d012e89f63bcd069e92fb4b5/69538/encoder.png 160w,\n/static/5c4ef295d012e89f63bcd069e92fb4b5/72799/encoder.png 320w,\n/static/5c4ef295d012e89f63bcd069e92fb4b5/e3b18/encoder.png 439w\" sizes=\"(max-width: 439px) 100vw, 439px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>인코더 프로그램 쓸 때 뭘 만져야 할지 모르게 만드는 어려운 단어들</small>\n</center>\n<p>단어는 어려워 보이지만 사실 간단하다. 결국 소리는 가로 축은 시간(Time), 세로 축은 진폭(Amplitude)으로 정의된 공간에 그려진 2차원의 진동 주파수 데이터이다. 이때 샘플 레이트는 가로 축의 해상도, 비트 레이트는 세로 축의 해상도를 의미하는 것이다. 이 값들은 아날로그를 디지털로 변경하는 첫번째 단계인 샘플링(Sampling)에서 활용된다.</p>\n<h3 id=\"샘플링sampling\" style=\"position:relative;\">샘플링(Sampling)<a href=\"#%EC%83%98%ED%94%8C%EB%A7%81sampling\" aria-label=\"샘플링sampling permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>샘플링은 아날로그 신호를 디지털 신호로 바꾸기 위한 첫번째 단계이다. 위에서 설명한 것처럼 아날로그 신호인 소리는 연속적인 신호이기 때문에 컴퓨터가 이 신호를 그대로 이해할 수가 없다. 우리가 마이크를 사용하여 소리를 녹음할 때, 이 아날로그 신호는 결국 전기 신호로 변환되어 컴퓨터에게 주어진다. 소리의 진동이 마이크 안에 있는 장치에 전달되면 이 장치가 전압을 올렸다 내렸다 하면서 변환하는 원리이다.</p>\n<p>하지만 우리의 바보 컴퓨터는 이렇게 까지 해줘도 이 전기 신호를 이해할 수 없다.</p>\n<p>그래서 컴퓨터는 연속적인 전기 신호를 측정하기 위해 특정 타이밍을 정해서 “이 타이밍마다 내가 전압을 측정할게!”라는 꼼수를 사용한다. 컴퓨터가 꼼수를 쓰는 이 과정을 그림으로 나타내보면 이런 느낌이다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f62ba441843fe9172b18fc5498bd765d/2c288/sampling.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 48.12500000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABcRAAAXEQHKJvM/AAAB2ElEQVR42mNgYGAQAGI+BghgZMAJ/sPkGP8zMIgBMSeQzQPVyw/ELHClbc6xwruN0/gZ8IDF0bl8S7yy5P8DDa53jRHzjWgVBwoLATGIFgZiJrDCK6te8qxwz3Bf5ZzmkV+/XwCbS0NX/eecG1prv8csyLEreaoeSMy+fj8L1BBmKA3Rszx1qtVNMTmlm3K6Sv1x3XZgz0El6xnqwbZOi+8x3msdpg8UF17oV+GyMKBCGFkdCrjokmIBlBAF4U0uaTa96dOlIYohYVafu5ivP67fDigvAcTiR0xC1SfGT7RAUsPEoOLBnjbzDCvYQGcpTUNtBgZ9QwYGPQdxVXN/26hwJyDbnJXVGKhL19/MP8BP3thRhYFBy4SV1dAASIcb+4W6K+ramgPVGTMwGPmLK/rqazu6AY1TgDmUJRQSFgxzfEost5kH6wFdI/KQn19palijI0P9fyak8GLIrlgnvMopwfUz0MUgl88MbbTP968XgHu7HqgYFh6LYrq55wZVu4C8t84p2awrbaYyzHv/IUkGHK4TY9sN9xp46x/Vc9UBWmqKHqZMyOHWnDlVdotthPfMwFrT/7jS5v//TEt9si3Xu6Q5A9ms6NKM6OxtHrl824CBzUAiAADz6odDaFdLSQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sampling\" title=\"\" src=\"/static/f62ba441843fe9172b18fc5498bd765d/6af66/sampling.png\" srcset=\"/static/f62ba441843fe9172b18fc5498bd765d/69538/sampling.png 160w,\n/static/f62ba441843fe9172b18fc5498bd765d/72799/sampling.png 320w,\n/static/f62ba441843fe9172b18fc5498bd765d/6af66/sampling.png 640w,\n/static/f62ba441843fe9172b18fc5498bd765d/2c288/sampling.png 684w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>위 그림에 나타난 빨간 점이 컴퓨터가 전압을 측정한 타이밍이다. 컴퓨터는 특정 타이밍에 전기 신호를 측정하고 그 값을 저장한다. 빨간 점의 위치를 보면 저 신호는 <code class=\"language-text\">[10, 20, 30, 27, 19, 8...]</code> 뭐 이런 식으로 측정이 되었을 것이다.\n이때 저 빨간 점을 더 세밀하게, 즉 컴퓨터가 샘플 측정을 하는 간격이 짧을 수록 우리는 원래 신호에 가까운 값을 측정할 수 있다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/735b3ff4a2c2bc5e9bb423aef0d67b88/7497d/high-low-sampling.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAD2EAAA9hAHVrK90AAABSklEQVR42qWSPU8CQRCG30M+D1HxO8BBPO8OLxfgDg7QihgTY0NpaWvhn6CyNf4GS2PlX7CytLU1xmhn1Ngxzi6biFeIkUmezOztzLsztwtE7ZBm0CIddcoCHE9lFqXQJRv+g43g2UKbHFjD1HcCafJAQKBNUOPExpuH8k2eFwlZ4Fwvy28DismUKuUQfBQ4mmfiqlAbQ50qLCQD7fd1NXcSuBRdxKRAj0o/cidaOjRQPN3lqMJsMDazqbyB8vke1k48jrm7ZJV9i2kydbmPhQoypeK4YhnJgsOBybhMh+mKvqXw7M4WCmd9ntTnta/EWDTRlPkrxwfI970/3pQac58W4b+KjjPcWHYEx+bFKrbJilZpvzMYXYr/YsO8UqLQkTtagnsfyGf2LxO3HX6aqN3V4N56aDx56Aznpnur4hf0KI3Wo84+Ht3+AqxFQxyT+4MwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"high low sampling\" title=\"\" src=\"/static/735b3ff4a2c2bc5e9bb423aef0d67b88/6af66/high-low-sampling.png\" srcset=\"/static/735b3ff4a2c2bc5e9bb423aef0d67b88/69538/high-low-sampling.png 160w,\n/static/735b3ff4a2c2bc5e9bb423aef0d67b88/72799/high-low-sampling.png 320w,\n/static/735b3ff4a2c2bc5e9bb423aef0d67b88/6af66/high-low-sampling.png 640w,\n/static/735b3ff4a2c2bc5e9bb423aef0d67b88/d9199/high-low-sampling.png 960w,\n/static/735b3ff4a2c2bc5e9bb423aef0d67b88/21b4d/high-low-sampling.png 1280w,\n/static/735b3ff4a2c2bc5e9bb423aef0d67b88/7497d/high-low-sampling.png 3500w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>신호 내부의 사각형이 컴퓨터가 이해한 신호의 모양이다.</small>\n</center>\n<p>이때 이 신호를 측정하는 간격을 샘플 레이트(Sample Rate)라고 하고 신호를 측정하는 과정 자체를 샘플링(Sampling)이라고 한다. 당연히 샘플 레이트가 높을 수록 소리의 해상도, 즉 음질이 더 좋을 수 밖에 없다. 특히 높은 주파수를 가진 소리, 즉 고음의 해상도가 확연하게 좋아진다.</p>\n<p>보통 CD의 음질이 <code class=\"language-text\">44.1kHz</code>, TV나 라디오 방송이 <code class=\"language-text\">48kHz</code>의 샘플 레이트를 가지는데, 이는 약 1초에 44,100번, 48,000번 샘플을 측정한다는 것이다. 저 샘플 레이트는 어떤 기준으로 정하는 걸까?</p>\n<h3 id=\"샘플-레이트sample-rate를-좀-더-자세히-알아보자\" style=\"position:relative;\">샘플 레이트(Sample Rate)를 좀 더 자세히 알아보자<a href=\"#%EC%83%98%ED%94%8C-%EB%A0%88%EC%9D%B4%ED%8A%B8sample-rate%EB%A5%BC-%EC%A2%80-%EB%8D%94-%EC%9E%90%EC%84%B8%ED%9E%88-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90\" aria-label=\"샘플 레이트sample rate를 좀 더 자세히 알아보자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>방금 설명했듯이 CD의 경우 샘플 레이트가 <code class=\"language-text\">44.1kHz</code>이다. 그 말인 즉슨 CD에 들어가는 오디오는 컴퓨터가 아날로그 신호를 1초에 44,100번 측정한 결과물인 것이라는 것이다.</p>\n<p>하지만 인간이 들을 수 있는 영역인 가청주파수는 <code class=\"language-text\">20hz ~ 20kHz</code> 밖에 되지 않는다. 근데 왜 샘플 레이트는 <code class=\"language-text\">44.1kHz</code>, <code class=\"language-text\">48kHz</code>처럼 훨씬 크게 잡는 것일까?</p>\n<blockquote>\n<p>어차피 인간은 1초에 20,000번 진동하는 소리(20kHz)까지밖에 들을 수 없어서 44,100번 진동하는 소리(44.1kHz)를 녹음해도 어차피 들을 수 없는데?</p>\n</blockquote>\n<p>이 질문에 대한 답은 소리의 진동 사이클이 어떻게 생겼는지를 보면 이해가 된다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/54209060f49749e76b0ab4da633070e6/d9199/sine-wave.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 65.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+0lEQVR42o2SWXLEIAxEuf91p0BqbaSFk8nkx46KKkuYp31kZlXtI+ZbNWD5c/Eg460BCbVyd1HFv/BxhfUondjhFb4NhmAKz7CZEVetVMLRPNoLlkf+I23iEOPnA46EyfKntLvaauAE3P4Nbzed+nqtJUuOrLXmnK2IUGG9Q4G5xFTfByIGQAWqUzzYAJzDXl6KGS/NsmumS7qgpUe62WRV3flqh7IilGFzqEzyJMhLaI66HQp/injZ6Qjh9sLWuEjQGuiK73hujkvP74KpuLr53yW5kY6DhkmmGc0rXKddT+uUXIRlrDTYxI/5j8/dvpFgs7gO4AL8Pv4CWb0B4j12ASIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sine wave\" title=\"\" src=\"/static/54209060f49749e76b0ab4da633070e6/6af66/sine-wave.png\" srcset=\"/static/54209060f49749e76b0ab4da633070e6/69538/sine-wave.png 160w,\n/static/54209060f49749e76b0ab4da633070e6/72799/sine-wave.png 320w,\n/static/54209060f49749e76b0ab4da633070e6/6af66/sine-wave.png 640w,\n/static/54209060f49749e76b0ab4da633070e6/d9199/sine-wave.png 960w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>기본적으로 오디오 주파수는 이렇게 하나의 사이클 단위로 나누어 지는데, 이때 위로 올라가는 <code class=\"language-text\">+</code> 부분이 공기가 압축되는 부분이고 아래로 내려가는 <code class=\"language-text\">-</code> 부분이 다시 공기가 팽창하는 부분이다.</p>\n<p>위에서 계속 설명했던 대로 소리란 곧 진동이고, 우리가 느끼는 것은 그 진동으로 인한 공기의 떨림이므로 압축 > 팽창 > 압축까지 모두 들어야 “떨렸다!”라고 느낄 수 있다. 즉, 우리가 들을 수 있는 20,000번의 진동은 이 사이클이 1초에 20,000번 반복되는 소리라는 것이다.</p>\n<p>압축이나 팽창 중에 하나만 주구장창 느낀다고 해서 “이게 진동이구나”라고 느낄 수는 없을 것이다.</p>\n<p>그래서 오디오 신호의 한 사이클을 제대로 측정하려면 + 방향의 맨 위의 꼭지점 하나와 - 방향의 맨 밑의 꼭지점 하나를 모두 측정해야하기 때문에 최소 2번은 측정을 해야한다. 그래서 인간이 들을 수 있는 가장 높은 소리인 초당 20,000번의 떨림인 <code class=\"language-text\">20kHz</code>을 제대로 측정하려면 컴퓨터는 최소한 1초에 <code class=\"language-text\">20,000 * 2 = 40,000번</code> 측정을 해야 하는 것이다.</p>\n<p>이게 바로 CD가 왜 <code class=\"language-text\">44.1kHz</code>의 샘플 레이트를 가지고 있는지에 대한 이유다. 이걸 나이퀴스트 이론(Nyquist Theorem)이라고 한다. 즉, 나이퀴스트 이론을 한마디로 정리하자면</p>\n<blockquote>\n<p>측정하고 싶은 오디오 주파수있지? 오디오 신호 제대로 다 살리고 싶으면 최소한 그 주파수보다 두배는 더 빠르게 측정해야된다.</p>\n<p>그러니까 최소한 측정하고 싶은 오디오 주파수의 두 배 사이즈의 샘플 레이트를 준비하렴.</p>\n</blockquote>\n<p>인 것이다. 근데 여기서 또 의문이 생긴다. 저 이론에 따르면 인간의 가청주파수는 <code class=\"language-text\">20,000hz</code>니까 딱 40,000번만 측정하면 인간이 들을 수 있는 소리는 다 녹음할 수 있는데 왜 44,100번이나 48,000번까지 측정하는 걸까?</p>\n<p>자연에는 인간만 있는 것이 아니라 이런 친구들도 있기 때문이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f9e7d3854217d95b93299ec30c34597c/eea4a/dolphin.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDAv/EABYBAQEBAAAAAAAAAAAAAAAAAAIBA//aAAwDAQACEAMQAAABspui5kWX/8QAGBAAAgMAAAAAAAAAAAAAAAAAAhAAESL/2gAIAQEAAQUCIqmma//EABYRAAMAAAAAAAAAAAAAAAAAABARIf/aAAgBAwEBPwFQf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABwQAAICAgMAAAAAAAAAAAAAAAABETFBUWFxkf/aAAgBAQABPyHA9JSNdF8F2M1DRg//2gAMAwEAAgADAAAAEGvP/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAwEBPxABwW3/xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QV2f/xAAdEAEAAgICAwAAAAAAAAAAAAABABEhMUFRYYHR/9oACAEBAAE/EKacN9PUGWE4OS+CJgtqtXqUMck+xVFIwyF6n//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"dolphin\" title=\"\" src=\"/static/f9e7d3854217d95b93299ec30c34597c/c08c5/dolphin.jpg\" srcset=\"/static/f9e7d3854217d95b93299ec30c34597c/0913d/dolphin.jpg 160w,\n/static/f9e7d3854217d95b93299ec30c34597c/cb69c/dolphin.jpg 320w,\n/static/f9e7d3854217d95b93299ec30c34597c/c08c5/dolphin.jpg 640w,\n/static/f9e7d3854217d95b93299ec30c34597c/6a068/dolphin.jpg 960w,\n/static/f9e7d3854217d95b93299ec30c34597c/eea4a/dolphin.jpg 1280w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>안녕하세요. 저는 최대 150kHz까지도 소리를 발사할 수 있슴다.</small>\n</center>\n<p>사실 자연에는 우리가 듣지 못하는 훨씬 높은 소리들도 존재한다. 단지 우리가 <code class=\"language-text\">20kHz</code>까지밖에 못 들을 뿐이다. 뭐 박쥐나 돌고래 같은 친구들은 훨씬 고음역대의 소리를 내지 않는가?</p>\n<p>근데 이 소리가 <code class=\"language-text\">40kHz</code>의 샘플 레이트를 준비한 그릇에 들어오면 어떻게 될까? 컴퓨터는 1초에 20,000번의 사이클을 도는 소리를 제대로 측정하기 위해 1초에 40,000번 전압을 측정하려고 했는데 만약 1초에 30,000번의 사이클을 도는 훨씬 더 높은 주파수의 소리가 들어와버린다면?</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 572px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1c9dd2b354904b4b414af5ba807e5204/a805e/nyquist-error.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABo0lEQVR42mVTW46jMBDk/odb7QHmY5REIcEYx28bMDXdDWwy2pZsisL9qjbd5XKBMQbjOEIphWlU0FoR1hgGXsRpDa3275oxrROrYRBfjnG73dBN0wS2jbdlQQsRNTeUClRa8wI03lIk0PDL+ECM2A7eWvsO2DYKWQImVXG/lj0JccynKWGJ5FyyJGaeg2wcrBS0nN8Buezdu2ENiRI2qUacJFNDi8QnevfhXd2ySnXgc2HnX68XOu5d4s0zks6Q4uNHe8SDqmD/MoVTHOGkZWZIJjbnHLp+6rFghvEWLjgUVORikatDPnAiPNOX71vA0yTBKdOZeT+TkkHdEganqOVHLznDGKjrdddorqTNoVcknuRgPKcCb4rg9sG3nIB1gbFUob5epfo17Hrg0I3S7jh+8isWG8H+MvXTVtajon/QUP7+eSJ5Jo4ApzMLzZmOCf4zCpR9RXHlI96G7y+SbaKhDPcBnHKjO/jL+J2r4+z/3b2AWprk4mPczFZWWJKve9AWvZMJ8fLey33ip6drYA9O+BMT78jHGE9/zO6XqPJn3+MHKHJYsi4mGRwAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"nyquist error\" title=\"\" src=\"/static/1c9dd2b354904b4b414af5ba807e5204/a805e/nyquist-error.png\" srcset=\"/static/1c9dd2b354904b4b414af5ba807e5204/69538/nyquist-error.png 160w,\n/static/1c9dd2b354904b4b414af5ba807e5204/72799/nyquist-error.png 320w,\n/static/1c9dd2b354904b4b414af5ba807e5204/a805e/nyquist-error.png 572w\" sizes=\"(max-width: 572px) 100vw, 572px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<blockquote>\n<p>정답. 점을 이상한데다가 찍기 시작한다.</p>\n</blockquote>\n<p>그림을 보면 컴퓨터가 점을 찍는 간격, 즉 전압을 측정하는 간격보다 들어온 신호의 사이클이 더 짧다. 그래서 컴퓨터가 찍은 점을 보면 신호의 꼭지점이 아닌 어중간한 어딘가에 찍힌 것을 볼 수 있다. 이것이 바로 나이퀴스트 이론이 가지고 있는 함정이다. 그리고 저 어중간한데 찍힌 점들을 이어본 파란색 선을 보면 결국 낮은 주파수가 된 것을 알 수 있다. 그러면 어떻게 될까?</p>\n<p>우리 귀에 아주 잘 들린다. 참 소름돋는 순간이다! 녹음할 때는 분명히 아무것도 안들렸는데 녹음한 걸 들어보니 이상한 소리가 녹음되어있으니 말이다. 그래서 이 현상을 “유령 주파수(Ghost Frequency)“라고 부른다.</p>\n<blockquote>\n<p>아니 그러면 샘플 레이트를 팍팍 올리면 되잖아! 높은 소리도 제대로 녹음되면 문제 해결 아닌가?</p>\n</blockquote>\n<p>하지만 이 디지털 오디오 기술이 처음 사용되기 시작한게 1970년대이기 때문에 무작정 샘플 레이트를 올리기에는 하드웨어 용량이 못 따라갔었다.</p>\n<p>그래서 이 문제를 해결하기 위해 사용한 방법이 바로 LPF(Low Pass Filter)이다. 이 필터는 전기 쪽 공부하신 분들은 매우 익숙할텐데, 말 그대로 낮은(Low) 주파수만 통과(Pass)시키는 필터이다. 오디오 녹음을 할때 LPF를 사용해서 인간의 가청 주파수보다 높은 소리는 다 잘라버리고 인간의 가청 주파수 영역의 소리만 통과시키면 방금 얘기한 고스트 주파수가 생길 일도 없기 때문이다.</p>\n<p>근데 또 아날로그 신호라는 게 그렇게 무 자르듯이 싹뚝! 잘리는 게 아니다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/bcb489965646eb5446167bbddb504813/c1b63/cut-off.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQklEQVR42o1STY8hYRDuHQYzPnr1rm0d7aNFxmDGmPVtkT0gEb9BIiGcCIk4uDiKiIOjxMWJiASJCAdxc/ILHOeP2CrRSU/PJLNv8qSrq+p53qp6i1itVublcskJsdvtzKPR6CGZTHoIgrAyDPOIQDuVSr1gDHPEPNQi9vu9QojT6SQfDAb3JpPJazab9SAirVQqdD6fp8C+5TiOxli321VirphPiM6365cF0LxzvV5rDofDnSDvF8Ao4nx6+KANoOSdcLNKdLvymsNzEBKAjKjX6/pqtcoI4XA4gtls1oQxaJXudDr2drttxdYxXigUWLfbHSyVSoZms8nAXHEcPwAeotVqyXhAFVKv10tC8uv5fJaWy2U5+KXT6ZTq9/satNEHsRuXy/USjUa1yIG45FrlzYeeaZpWhsPhV+EIRDO8kCKRiMdut6uJr45Op1NBsk9IXiwW6l6v904wHo/7A4GA5r8Eg8GgV1ghtESKKwyFQr9tNpvmyxcmSfK7z+eLwCxv4ZcBuKE1n16v94ONo9Dhbvr9/jAI6j5bHeGzE1qt1ggCf0HYIpfLLeB6hhNiWRYFnxUKhQm+JtiEOMybu2pIBDrvK5TJZA+1Ws0gDIj28JLXaDRYiqIcHyqEKvAWK6zKUyaTSeRyuQi8qhPmxs1mM/N8PjdOJpMn+Lejjb7xeGzZbDaPsKN/0ul0ErmocdFyOp0qRCKRIKEy6ng83sOjWIbDoXq73Srf3t7u4CJDsVj8iTb6MBaLxTjMRQ5yeZ1/c43gleg9ctcAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"cut off\" title=\"\" src=\"/static/bcb489965646eb5446167bbddb504813/6af66/cut-off.png\" srcset=\"/static/bcb489965646eb5446167bbddb504813/69538/cut-off.png 160w,\n/static/bcb489965646eb5446167bbddb504813/72799/cut-off.png 320w,\n/static/bcb489965646eb5446167bbddb504813/6af66/cut-off.png 640w,\n/static/bcb489965646eb5446167bbddb504813/d9199/cut-off.png 960w,\n/static/bcb489965646eb5446167bbddb504813/c1b63/cut-off.png 1200w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>LPF를 써도 결국 잘린 부분이 저렇게 비스듬하게 꺾이면서 약간 아쉬운 부분이 남게된다. 이때 그림에 표시된 허용 범위인 <code class=\"language-text\">-3db</code> 밑으로 떨어지기 시작하는 곳을 Cut Off라고 부른다. 저기에서부터 신호가 잘렸다고 치겠다는 것이다.</p>\n<p>그럼 Cut Off되는 부분을 <code class=\"language-text\">20kHz</code>보다 조금 더 밑으로 내리면 <code class=\"language-text\">20kHz</code> 언저리에서 신호가 사라지게 만들 수 있지 않을까? 라는 생각도 들지만 그 문제 때문에  <code class=\"language-text\">20kHz</code>의 주파수 영역을 전부 활용하지 못하는 건 너무 아깝다고 판단이 들었나보다.</p>\n<p>그래서 Cut Off를 딱 <code class=\"language-text\">20kHz</code>에 맞추고 남는 부분은 그냥 감수하자고 합의가 된 것이다. 당시 기술로 저 남는 부분을 줄이고 줄여서 맞춘게 딱 <code class=\"language-text\">2,050hz</code>였다.</p>\n<p>그럼 이제 남는 부분과 가청주파수를 합쳐보면 <code class=\"language-text\">22,050hz</code>가 된다. 나이퀴스트 이론에 따르면 우리는 최소한 2배의 샘플 레이트를 준비해야 이 신호를 제대로 측정할 수 있으므로 결국 CD의 표준 샘플 레이트가 <code class=\"language-text\">44,100hz = 44.1kHz</code>가 된 것이다.\n뭐 그 외에도 당시 기술의 한계 외에도 기업들끼리 싸우기도 하고 어른의 사정도 있는 등 국제 표준을 정할 때 늘 발생하는 여러가지 이슈가 있었지만 대표적인 기술적인 이슈는 이 이유였다.</p>\n<p>그 후 <code class=\"language-text\">48kHz</code>, <code class=\"language-text\">96kHz</code>, <code class=\"language-text\">192kHz</code> 등의 높은 샘플 레이트는 그냥 디바이스가 발전하면서 기술적인 제한이 없어졌으니까 “샘플 레이트는 클수록 좋지! 뿜뿜”하면서 늘린 것이다.</p>\n<h3 id=\"비트-레이트bit-rate\" style=\"position:relative;\">비트 레이트(Bit Rate)<a href=\"#%EB%B9%84%ED%8A%B8-%EB%A0%88%EC%9D%B4%ED%8A%B8bit-rate\" aria-label=\"비트 레이트bit rate permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>비트 레이트는 샘플링에 비하면 초 간단하다. 특히 우리 같은 개발랭이들에게 익숙한 이름인 “Bit”가 붙어있지 않은가? 샘플 레이트가 소리의 가로 해상도 역할을 한다면 비트 레이트는 세로 해상도 역할을 한다.</p>\n<p>샘플 레이트와 마찬가지로 비트 레이트도 CD를 기준으로 설명하는 게 보편적이기 때문에 다시 CD를 기준으로 설명하겠다.</p>\n<p>CD의 비트 레이트는 <code class=\"language-text\">16bit</code>인데 이건 말 그대로 세로로 <code class=\"language-text\">16bit</code> 만큼의 해당하는 값을 표현할 수 있다는 얘기이다. 아까 위에서 설명한 샘플링을 진행할 때 전압을 측정했었다. 이때 컴퓨터가 측정한 이 전압의 값을 얼마나 섬세하게 표현할 수 있느냐를 비트 레이트가 결정하는 것이다. <code class=\"language-text\">16bit</code>면 16자리의 이진법을 사용할 수 있다는 것이고 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup><mo>=</mo><mn>65536</mn></mrow><annotation encoding=\"application/x-tex\">2^{16} = 65536</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">16</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">65536</span></span></span></span></span>이니까 0부터 65,536까지 총 65,537개의 값을 사용할 수 있는 것이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/b1bb1c1aa17f6cf158141942536a758f/f2239/bitrate.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 46.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAD2EAAA9hAHVrK90AAABdUlEQVR42o2S20oCURSGf8dDaTNqGo4zlqZJgXfVRVcWSRCkIlSSZUJhWCoeShANKQIpCrrqEXqHeoAezP45BBFFLvhYh2HW3v9aGwAmiVv3sY8wlLscvPtFhO53sPQ+z7qdzBAvDLPgH/PohF8TmD6sQrBdMD9nnxJ8+RbibwvMgySA25GA5VEc4oZ2gPRXQxHhoQL/WZ3xMSkDQpU+T9+A2i/AW4swl4GRBbPPTiDhYG4jArF+Q8v5QX3MwKZeMd4lp0ZT6x59BfZQBcpTDoj8lGz5Xb5NScK50mLU5gEV+gbpG7IFrV6DlGrDk+4wLrB2YiqpmxT13B6oYCKyaUg2FuM0cRny9PpXTYK/XIVjrseYCF16bSwDxk36DqT0EGIqgTHNBU82CvXmgJKa5pxLpoIjTK1eIviwbl5iHPNpzyqE6Msi3NlrYxza0jgOR6wFmYuDom3eP+4NtYZx/Qe5s6Y/L3GrB3G7C3WQgSup6AcC8id2pjciNdJZ2gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"bitrate\" title=\"\" src=\"/static/b1bb1c1aa17f6cf158141942536a758f/6af66/bitrate.png\" srcset=\"/static/b1bb1c1aa17f6cf158141942536a758f/69538/bitrate.png 160w,\n/static/b1bb1c1aa17f6cf158141942536a758f/72799/bitrate.png 320w,\n/static/b1bb1c1aa17f6cf158141942536a758f/6af66/bitrate.png 640w,\n/static/b1bb1c1aa17f6cf158141942536a758f/d9199/bitrate.png 960w,\n/static/b1bb1c1aa17f6cf158141942536a758f/21b4d/bitrate.png 1280w,\n/static/b1bb1c1aa17f6cf158141942536a758f/f2239/bitrate.png 3116w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>\n    비트 레이트가 높을 수록 아날로그 신호 내부의 막대가 더 꼼꼼하게 채워지는 것을 볼 수 있다.<br>\n    +와 -를 합쳐서 비트를 세는 signed이기 때문에 그림에는 50% 씩만 표현되어있는 것이다.\n  </small>\n</center>\n<p>물론 아날로그인 소리 신호가 변환된 전압 값이 <code class=\"language-text\">123</code> 같이 딱 떨어지는 정수일리가 없으므로 우리가 사용할 수 있는 <code class=\"language-text\">0-65536</code> 중 근사치를 찾아서 바꿔주는데 이 과정을 양자화(Quantizing)라고 부른다. <small>(양자역학에서 나오는 그 양자랑 같은 의미 맞다.)</small></p>\n<p>이후 <code class=\"language-text\">0-65536</code>의 값으로 변경된 전압을 컴퓨터가 이해할 수 있는 이진수(Binary)로 변경하는 과정을 부호화(Coding)라고 한다.</p>\n<p>이런 것들은 우리같은 개발랭이들은 워낙 익숙한 문제이기 때문에 이 정도만 설명하고 넘어가겠다.</p>\n<h2 id=\"web-audio-api로-파형-그려보기\" style=\"position:relative;\">Web Audio API로 파형 그려보기<a href=\"#web-audio-api%EB%A1%9C-%ED%8C%8C%ED%98%95-%EA%B7%B8%EB%A0%A4%EB%B3%B4%EA%B8%B0\" aria-label=\"web audio api로 파형 그려보기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>자, 드디어 길고 길었던 소리 이론이 끝났다. 필자는 디지털로 변환된 오디오를 가지고 파형을 그려보는 것이 목적이기 때문에 아날로그에서 디지털로 변환하는 과정만 다뤘고, 반대로 디지털에서 아날로그로 변환하는 과정은 이 포스팅에서 다루지 않을 예정이다. 근데 이것도 나름 재밌으므로 따로 찾아보길 강추한다. 필자는 오디오 파일을 업로드해서 해당 오디오 파일을 <code class=\"language-text\">Web Audio</code> API로 분석하여 필요한 데이터를 뽑아내고 <code class=\"language-text\">svg</code> 엘리먼트를 사용하여 파형을 그릴 것이다.</p>\n<p>참고로 프로젝트는 <code class=\"language-text\">webpack4</code>와 <code class=\"language-text\">babel7</code>을 사용하여 초간단하게 구성했다. 자세한 코드는 <a href=\"https://github.com/evan-moon/simple-waveform-visualizer\" target=\"_blank\" rel=\"nofollow\">깃허브 레파지토리</a>에서 확인 해볼 수 있다.</p>\n<h3 id=\"기본-틀-잡기\" style=\"position:relative;\">기본 틀 잡기<a href=\"#%EA%B8%B0%EB%B3%B8-%ED%8B%80-%EC%9E%A1%EA%B8%B0\" aria-label=\"기본 틀 잡기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>그럼 먼저 HTML을 간단하게 작성하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audio-uploader<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>waveform<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">preserveAspectRatio</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>none<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>waveform-path-group<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>HTML은 이게 끝이다. 오디오 파일을 업로드할 <code class=\"language-text\">input</code> 엘리먼트 하나와 파형을 그릴 <code class=\"language-text\">svg</code> 엘리먼트 하나만 있으면 된다. 어차피 테스트 용도라서 UI가 중요한게 아니기 때문에 기능 구현에 충실했다.<small>(라고 포장을 해봅니다)</small></p>\n<p>이제 파일이 업로드되면 실행될 이벤트 핸들러를 작성하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// index.js</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> inputDOM <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio-uploader'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  inputDOM<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onchange</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>currentTarget<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      reader<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      reader<span class=\"token punctuation\">.</span><span class=\"token function\">readAsArrayBuffer</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">FileReader.prototype.readAsArrayBuffer</code> 메소드는 바이너리 형태인 파일을 한번에 반환하는 것이 아니라 일정 단위의 청크(Chunk)로 반환하는 메소드이다. 보통 뭐 서버로 파일 업로드 한다거나 할 때 많이 사용한다.</p>\n<p>원래는 이 <code class=\"language-text\">ArrayBuffer</code>를 처리해주기 위한 별도의 로직을 작성해야하지만 이번에 사용할 <code class=\"language-text\">Web Audio</code> API가 내부적으로 <code class=\"language-text\">ArrayBuffer</code>를 알아서 처리해주기 때문에 걱정하지 않아도 된다.</p>\n<h3 id=\"audioanalyzer-클래스-작성\" style=\"position:relative;\">AudioAnalyzer 클래스 작성<a href=\"#audioanalyzer-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%9E%91%EC%84%B1\" aria-label=\"audioanalyzer 클래스 작성 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이제 본격적으로 <code class=\"language-text\">Web Audio</code> API를 사용해볼 차례이다. 필자는 별도로 <code class=\"language-text\">AudioAnalyzer</code>라는 싱글톤 클래스를 만들었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// lib/AudioAnalyzer.js</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AudioAnalyzer</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>window<span class=\"token punctuation\">.</span>AudioContext<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> errorMsg <span class=\"token operator\">=</span> <span class=\"token string\">'Web Audio API 지원 안돼유 ㅜㅜ'</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>errorMsg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>errorMsg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token punctuation\">(</span>AudioContext <span class=\"token operator\">||</span> webkitAudioContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>peaks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>waveFormBox <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'waveform'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>waveFormPathGroup <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'waveform-path-group'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">reset</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token punctuation\">(</span>AudioContext <span class=\"token operator\">||</span> webkitAudioContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>peaks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AudioAnalyzer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"svg-뷰박스를-설정하자\" style=\"position:relative;\">SVG 뷰박스를 설정하자<a href=\"#svg-%EB%B7%B0%EB%B0%95%EC%8A%A4%EB%A5%BC-%EC%84%A4%EC%A0%95%ED%95%98%EC%9E%90\" aria-label=\"svg 뷰박스를 설정하자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이렇게 대충 기본 틀을 잡아주고 나서 오디오 파형을 그릴 <code class=\"language-text\">svg</code> 엘리먼트의 뷰박스를 설정할 수 있는 메소드를 하나 선언할 것이다. 소리 신호는 샘플 레이트에 따라서 들어온 데이터의 길이가 천차만별이기 때문에 뷰박스의 <code class=\"language-text\">width</code>를 오디오 데이터의 크기에 맞게 동적으로 변경해줘야지 모든 신호를 뷰박스에 딱 맞게 그릴 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">updateViewboxSize</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>waveFormBox<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'viewBox'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">0 -1 </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> 2</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">svg</code> 엘리먼트의 <code class=\"language-text\">viewBox</code> 속성은 앞에서부터 <code class=\"language-text\">min-x</code>, <code class=\"language-text\">min-y</code>, <code class=\"language-text\">width</code>, <code class=\"language-text\">height</code>를 의미한다. 비트 레이트를 설명할 때 얘기 했듯이 오디오 신호는 부호를 가지는 signed이기 때문에 <code class=\"language-text\">0, 0</code>이 아닌 <code class=\"language-text\">0, -1</code>에서 뷰박스를 설정해야한다. 그리고 <code class=\"language-text\">width</code>는 오디오의 샘플 레이트로 잡아줘서 오디오 신호가 뷰박스의 처음부터 끝까지 꽉 차도록 설정하고 <code class=\"language-text\">height</code>는 <code class=\"language-text\">-1 ~ 1</code>까지 잡아줘야하니까 <code class=\"language-text\">2</code>로 설정했다.</p>\n<p>이렇게 선언한 <code class=\"language-text\">updateViewboxSize</code>메소드는 어플리케이션이 초기화될때 뷰박스 사이즈도 함께 초기화되도록 <code class=\"language-text\">constructor</code>와 <code class=\"language-text\">reset</code> 메소드에 적당히 추가해주었다.</p>\n<h3 id=\"업로드된-audiobuffer-확인하기\" style=\"position:relative;\">업로드된 AudioBuffer 확인하기<a href=\"#%EC%97%85%EB%A1%9C%EB%93%9C%EB%90%9C-audiobuffer-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\" aria-label=\"업로드된 audiobuffer 확인하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이제 <code class=\"language-text\">input</code> 엘리먼트를 통해 업로드된 오디오 파일을 디코딩하는 귀여운 setter를 하나 선언하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">setAudio</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">audioFile</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">decodeAudioData</span><span class=\"token punctuation\">(</span>audioFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">buffer</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">AudioContext.prototype.decodeAudioData</code> 메소드는 <code class=\"language-text\">ArrayBuffer</code>를 받아서 <code class=\"language-text\">AudioBuffer</code>로 변환하는 메소드이다. 아까 위에서 설명했던 대로 <code class=\"language-text\">readAsArrayBuffer</code> 메소드가 반환한 <code class=\"language-text\">ArrayBuffer</code>는 한번에 모든 바이너리 데이터를 불러오는 것이 아니라 청크 단위로 불러오기 때문에 <code class=\"language-text\">decodeAudioData</code>도 변환을 동기적으로 해주지는 않는다. 그래서 이 메소드를 사용할 때는 콜백함수를 사용하거나 <code class=\"language-text\">Promise</code>를 사용해야 한다.</p>\n<p>이제 실제로 오디오 파일이 어떻게 변환되는지 보기 위해 파일을 업로드하면 <code class=\"language-text\">AudioAnalyzer</code>에게 오디오 파일을 넘기도록 변경해주자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// index.js</span>\n<span class=\"token keyword\">import</span> AudioAnalyzer <span class=\"token keyword\">from</span> <span class=\"token string\">'./lib/AudioAnalyzer'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> inputDOM <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio-uploader'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  inputDOM<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onchange</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>currentTarget<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// AudioAnalyzer 초기화</span>\n      AudioAnalyzer<span class=\"token punctuation\">.</span><span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// AudioAnalyzer에게 파일 토스</span>\n      reader<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> AudioAnalyzer<span class=\"token punctuation\">.</span><span class=\"token function\">setAudio</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      reader<span class=\"token punctuation\">.</span><span class=\"token function\">readAsArrayBuffer</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이 쯤 했으면 이제 메인 함수에는 더 이상 뭘 작성할 필요가 없을 것 같다. 이제 <code class=\"language-text\">AudioAnalyzer</code>만 가지고 놀면 된다. 데이터가 어떻게 나오는지 확인하기 위해 필자가 좋아하는 가수인 거미의 “그대 돌아오면”이라는 곡의 mp3 파일을 업로드 해보았다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">AudioBuffer <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">length</span><span class=\"token operator\">:</span> <span class=\"token number\">12225071</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">duration</span><span class=\"token operator\">:</span> <span class=\"token number\">277.2124943310658</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">sampleRate</span><span class=\"token operator\">:</span> <span class=\"token number\">44100</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">numberOfChannels</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>그러면 <code class=\"language-text\">AudioAnalyzer</code>의 <code class=\"language-text\">setAudio</code> 메소드 내부에서 실행된 <code class=\"language-text\">decodeAudioData</code>가 <code class=\"language-text\">ArrayBuffer</code>를 받아서 <code class=\"language-text\">AudioBuffer</code>로 변환한 뒤 반환해준다. 이걸 뜯어보면 유용한 정보들이 들어있다.</p>\n<hr>\n<ul>\n<li><code class=\"language-text\">sampleRate</code>: 당연히 샘플 레이트를 의미하고 이 곡의 샘플 레이트는 <code class=\"language-text\">44,100hz</code>이다.</li>\n<li><code class=\"language-text\">numberOfChannels</code>: 이 오디오가 몇개의 채널을 가지고 있는지를 나타내는데 이 파일은 두 개의 채널이 있는 스테레오 채널 오디오 파일이다.</li>\n<li><code class=\"language-text\">length</code>: 피크(Peak)들의 개수를 의미한다. 피크는 컴퓨터가 샘플링을 진행할 때 전압을 측정한 값을 의미한다.</li>\n<li><code class=\"language-text\">duration</code>: 이 오디오 파일의 재생 길이를 초 단위로 표시해준다. “그대 돌아오면”이라는 곡은 약 277초의 길이를 가지고 있다.</li>\n</ul>\n<hr>\n<p>음 여기서 한 가지 결정해야할 것이 생겼다. 채널이 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>개인 오디오 데이터가 들어왔을 때 그 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>개의 채널의 오디오 파형을 모두 표현해주거나 채널을 하나로 합쳐서 파형을 표현해주어야한다. 필자는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>개의 채널을 가진 오디오 데이터가 들어오더라도 그 채널을 모두 한개의 채널로 머지해서 파형을 그릴 예정이다.</p>\n<p>하지만 이 포스팅에서 채널을 머지하는 것까지 모두 이야기하면 너무 복잡해지기 때문에 그냥 하나의 채널만 사용하여 진행하도록 하겠다.</p>\n<h3 id=\"오디오-데이터-분석하고-정제하기\" style=\"position:relative;\">오디오 데이터 분석하고 정제하기<a href=\"#%EC%98%A4%EB%94%94%EC%98%A4-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D%ED%95%98%EA%B3%A0-%EC%A0%95%EC%A0%9C%ED%95%98%EA%B8%B0\" aria-label=\"오디오 데이터 분석하고 정제하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이제 필자는 기본적인 오디오 데이터인 <code class=\"language-text\">AudioBuffer</code>를 얻었다. 이제 이 데이터만 있어도 오디오 파형을 그릴 수 있다.\n이제 <code class=\"language-text\">AudioBuffer</code>에서 필요한 데이터만 뽑아서 클래스의 멤버변수들에 할당해주자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">setAudio</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">audioFile</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">decodeAudioData</span><span class=\"token punctuation\">(</span>audioFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">buffer</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// AudioBuffer 객체를 멤버변수에 할당</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// 업로드된 오디오의 샘플 레이트를 멤버변수에 할당</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">.</span>sampleRate<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// 샘플 레이트에 맞춰서 svg 엘리먼트 크기 조정</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">updateViewboxSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>후, 여기까지 왔으면 파형을 그릴 준비가 모두 끝났다. 우선 <code class=\"language-text\">AudioBuffer</code>에서 오디오 신호를 하나하나 뽑아보자.</p>\n<p>먼저 오디오 신호가 들어있는 배열부터 한번 살펴보자. 아까 필자가 <code class=\"language-text\">AudioBuffer</code>의 데이터를 간략하게 봤을 때 <code class=\"language-text\">numberOfChannels</code>라는 프로퍼티가 있었고 이 값이 <code class=\"language-text\">2</code>인 <code class=\"language-text\">스테레오</code> 채널이었다. 이 채널 데이터는 <code class=\"language-text\">AudioBuffer.getChannelData</code> 메소드를 통해서 가져올 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer<span class=\"token punctuation\">.</span>numberOfChannels<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">getChannelData</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Float32Array(12225071) [0, 0, 0, …]</span>\n<span class=\"token comment\">// Float32Array(12225071) [0, 0, 0, …]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>아닛 어마무시한 길이의 <code class=\"language-text\">Float32Array</code>가 나왔다. 지금 필자에게 보이는 값은 전부 <code class=\"language-text\">0</code>이지만 보통 음악이 시작하자마자 쿠과과광! 하진 않기 때문에 그런거지 뒤쪽 인덱스의 엘리먼트에는 값이 제대로 들어가 있다. 그렇다고 이 값들을 그대로 사용하긴 조금 힘들고 조금 손질을 해줘야 한다.</p>\n<p>우선 저 배열에 들어있는 원소의 정체가 뭔지부터 생각해보자. 배열의 길이인 <code class=\"language-text\">12225071</code>를 사용하면 이 친구의 정체를 파악할 수 있다. 아까 우리가 <code class=\"language-text\">AudioBuffer</code>를 통해 이 곡의 재생 길이(Duration)를 봤을 때 약 277초였다. 이 곡의 샘플 레이트와 재생 길이를 곱해보면 <code class=\"language-text\">12225071</code>이 나온다. 즉, 저 원소들은 컴퓨터가 샘플 레이트에 따라 측정한 전압인 피크이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f62ba441843fe9172b18fc5498bd765d/2c288/sampling.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 48.12500000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABcRAAAXEQHKJvM/AAAB2ElEQVR42mNgYGAQAGI+BghgZMAJ/sPkGP8zMIgBMSeQzQPVyw/ELHClbc6xwruN0/gZ8IDF0bl8S7yy5P8DDa53jRHzjWgVBwoLATGIFgZiJrDCK6te8qxwz3Bf5ZzmkV+/XwCbS0NX/eecG1prv8csyLEreaoeSMy+fj8L1BBmKA3Rszx1qtVNMTmlm3K6Sv1x3XZgz0El6xnqwbZOi+8x3msdpg8UF17oV+GyMKBCGFkdCrjokmIBlBAF4U0uaTa96dOlIYohYVafu5ivP67fDigvAcTiR0xC1SfGT7RAUsPEoOLBnjbzDCvYQGcpTUNtBgZ9QwYGPQdxVXN/26hwJyDbnJXVGKhL19/MP8BP3thRhYFBy4SV1dAASIcb+4W6K+ramgPVGTMwGPmLK/rqazu6AY1TgDmUJRQSFgxzfEost5kH6wFdI/KQn19palijI0P9fyak8GLIrlgnvMopwfUz0MUgl88MbbTP968XgHu7HqgYFh6LYrq55wZVu4C8t84p2awrbaYyzHv/IUkGHK4TY9sN9xp46x/Vc9UBWmqKHqZMyOHWnDlVdotthPfMwFrT/7jS5v//TEt9si3Xu6Q5A9ms6NKM6OxtHrl824CBzUAiAADz6odDaFdLSQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sampling\" title=\"\" src=\"/static/f62ba441843fe9172b18fc5498bd765d/6af66/sampling.png\" srcset=\"/static/f62ba441843fe9172b18fc5498bd765d/69538/sampling.png 160w,\n/static/f62ba441843fe9172b18fc5498bd765d/72799/sampling.png 320w,\n/static/f62ba441843fe9172b18fc5498bd765d/6af66/sampling.png 640w,\n/static/f62ba441843fe9172b18fc5498bd765d/2c288/sampling.png 684w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>저 하나하나의 피크들이 전부 Float32Array의 원소로 들어가있다.</small>\n</center>\n<p>일단 저 원소의 정체가 피크라는 것을 알았으니 이 친구들을 조금 정제해보자. 왜 이걸 정제하느냐?</p>\n<blockquote>\n<p>12,225,071개의 피크를 전부 렌더한다는 게 과연 효율적인 시각화인가…?</p>\n</blockquote>\n<p>라는 합리적 의심 때문이다. 솔직히 피크가 천만개가 찍히던 오백만개가 찍히던 어차피 우리는 조그만 모니터로 볼 것이기 때문에 굳이 이걸 하나하나 다 표현해준다는 것 자체가 큰 의미는 없다.</p>\n<p>그래서 필자는 피크들을 적당히 압축할 것이다. 모든 피크를 수집하는 것이 아니라 적당한 길이의 샘플을 만들고 해당 샘플 안의 최대값과 최소값만 수집할 것이다.</p>\n<p>위에서 설명했듯이 나이퀴스트 이론에 따르면 어차피 하나의 사이클을 표현할때 최대값 한개와 최소값 한개만 알면 아무 문제가 없다.</p>\n<p>만약 필자의 어플리케이션에 파형을 확대하는 기능이 존재한다면 확대/축소 이벤트가 발생했을 때 렌더링에 필요한 피크 개수만큼 동적으로 피크를 선정하는 과정이 필요하겠지만, 이 어플리케이션은 그 정도로 고도화되지는 않았으므로 정해진 개수의 피크만 정제하는 로직만으로 충분하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> sampleSize <span class=\"token operator\">=</span> peaks<span class=\"token punctuation\">.</span>length <span class=\"token operator\">/</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> sampleStep <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>sampleSize <span class=\"token operator\">/</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 예시로 0번 채널만 가져옴</span>\n<span class=\"token keyword\">const</span> peaks <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">getChannelData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> resultsPeaks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 딱 샘플 레이트 길이인 44100개의 피크만 수집할 것이다.</span>\n<span class=\"token function\">Array</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sampleRate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v<span class=\"token punctuation\">,</span> newPeakIndex</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> start <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>newPeakIndex <span class=\"token operator\">*</span> sampleSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> end <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>newPeakIndex <span class=\"token operator\">+</span> sampleSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> min <span class=\"token operator\">=</span> peaks<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> max <span class=\"token operator\">=</span> peaks<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> sampleIndex <span class=\"token operator\">=</span> start<span class=\"token punctuation\">;</span> sampleIndex <span class=\"token operator\">&lt;</span> end<span class=\"token punctuation\">;</span> sampleIndex <span class=\"token operator\">+=</span> sampleStep<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> v <span class=\"token operator\">=</span> peaks<span class=\"token punctuation\">[</span>sampleIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>v <span class=\"token operator\">></span> max<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      max <span class=\"token operator\">=</span> v<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>v <span class=\"token operator\">&lt;</span> min<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      min <span class=\"token operator\">=</span> v<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  resultPeaks<span class=\"token punctuation\">[</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> newPeakIndex<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> max<span class=\"token punctuation\">;</span>\n  resultPeaks<span class=\"token punctuation\">[</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> newPeakIndex <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> min<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>좀 복잡해보이지만 이 코드를 한마디로 표현하면 다음과 같다.</p>\n<blockquote>\n<ol>\n<li>샘플 레이트만큼 이터레이션을 돈다.</li>\n<li>특정 길이의 2차 샘플 구간을 정하고 그 구간 내에서 최대값과 최소값을 찾는다.</li>\n<li>resultPeaks 배열의 짝수 인덱스에 최대값을, 홀수 인덱스에는 최소값을 삽입한다.</li>\n</ol>\n</blockquote>\n<p><code class=\"language-text\">resultsPeaks</code>배열에 값을 저장할 때 <code class=\"language-text\">2 * newPeakIndex</code>와 같이 배열의 크기를 2배로 해주는 이유는 피크를 한번 이터레이션 돌 때 <code class=\"language-text\">max</code>와 <code class=\"language-text\">min</code> 최대 2개의 값을 저장해야하기 때문이다.</p>\n<p>이렇게 해서 필자는 적당히 압축된 <code class=\"language-text\">88200</code> 길이의 피크 배열 하나를 얻게 되었다.</p>\n<h3 id=\"이제-진짜-그려보자\" style=\"position:relative;\">이제 진짜 그려보자!<a href=\"#%EC%9D%B4%EC%A0%9C-%EC%A7%84%EC%A7%9C-%EA%B7%B8%EB%A0%A4%EB%B3%B4%EC%9E%90\" aria-label=\"이제 진짜 그려보자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>그리는 방법은 생각보다 단순하다. 위에서 뽑아온 피크 배열을 순회돌면서 그려주기만 하면 된다.</p>\n<p>SVG의 <code class=\"language-text\">path</code> 엘리먼트는 <code class=\"language-text\">d</code> 속성에 담긴 문자열을 분석하여 선을 그려준다. 이때 <code class=\"language-text\">M</code>은 Move, 그림을 그릴 포인터를 옮기는 명령어이고 <code class=\"language-text\">L</code>은 Line, 지정한 곳까지 선을 긋는 명령어이다.</p>\n<p>즉, 우리는 포인터를 옮기고 선을 긋는 행위를 반복하면 되는 것이다. 아까 필자가 짝수 인덱스에는 최대 값을 담고 홀수 인덱스에는 최소값을 담아준 이유가 바로 여기에 있다. 이터레이션을 돌면서 짝수 인덱스 일때는 <code class=\"language-text\">M</code> 명령어를 사용하여 포인터를 옮기고 홀수 인덱스 일때는 <code class=\"language-text\">L</code> 명령어를 사용하여 선을 그리려고 한 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">draw</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioBuffer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> peaks <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>peaks<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> totalPeaks <span class=\"token operator\">=</span> peaks<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> d <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> peakIndex <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> peakIndex <span class=\"token operator\">&lt;</span> totalPeaks<span class=\"token punctuation\">;</span> peakIndex<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>peakNumber <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        d <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> M</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>peakNumber <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>peaks<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        d <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> L</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>peakNumber <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>peaks<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElementNS</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://www.w3.org/2000/svg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    path<span class=\"token punctuation\">.</span><span class=\"token function\">setAttributeNS</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'d'</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>waveFormPathGroup<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">Math.floor(peakNumber / 2)</code>는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>축, <code class=\"language-text\">peaks.shift()</code>는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>축을 의미한다. 이 코드는 대략 이런 식으로 작동할 것이다. 앞에 붙은 숫자는 피크의 인덱스라고 생각하자.</p>\n<blockquote>\n<ol>\n<li>(0, 100)으로 포인터 이동</li>\n<li>(0, -25)으로 선을 긋는다.</li>\n<li>(1, 300)으로 포인터 이동</li>\n<li>(1, -450)으로 선을 긋는다.</li>\n<li>쭉쭉 반복</li>\n</ol>\n</blockquote>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1118d0dac6e09f7762f18b1e9a75eae3/2bef9/svg-graph.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIklEQVR42q1Ui3KDMAzj/792KwTIy56kBFq6lrG7cpdzcCxZdgyDf/gZrgTZ4cWuEdZatQwA7WHNus3Za0oifo7b7HtC7kFgJGAwFcXotq7tDPZ/hFS0zG4RBPRhL8LYCadRpH8TkgiqPAEMkNGCrIap+aQQ4GnywnNimASY+tDXndBKFUhqALoTBvecepKkBGUOra84Uxz2O2FCUAgAIqgweFk83769rLB4z+OI/Qrfl2eejTdP8GUkS4yjryt+UljaRVBN2BQuLxQycVNWw72Slz1UH0ncwSpZ5SVdxqHk2AlZOjDnt4xylZm+uStEqSLEYmva2fz+Ug5zSLuNBMmhgOMjNfDtt6wW5XNCf5ivbf36iuKFOTz/mO2yf/j03+YHjbqjJKikfkgAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"svg graph\" title=\"\" src=\"/static/1118d0dac6e09f7762f18b1e9a75eae3/6af66/svg-graph.png\" srcset=\"/static/1118d0dac6e09f7762f18b1e9a75eae3/69538/svg-graph.png 160w,\n/static/1118d0dac6e09f7762f18b1e9a75eae3/72799/svg-graph.png 320w,\n/static/1118d0dac6e09f7762f18b1e9a75eae3/6af66/svg-graph.png 640w,\n/static/1118d0dac6e09f7762f18b1e9a75eae3/d9199/svg-graph.png 960w,\n/static/1118d0dac6e09f7762f18b1e9a75eae3/2bef9/svg-graph.png 1024w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>저 과정을 반복하면 대략 이런 모양의 작대기들이 그려진다</small>\n</center>\n<p>우리가 그리려는 오디오 파형은 디지털 신호를 표현한 것이기 때문에 위에서 우리가 봤던 오디오 신호의 예시처럼 연속적인 아날로그로는 표현이 불가능 하다. 그래서 이렇게 작대기를 쭉쭉 그어가면서 표현해야하는 것이다. 이렇게 보면 상당히 허접한 그림이 나올 것 같지만, 저 선이 88,200개가 겹쳐있으면 꽤 그럴싸해보인다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/4fc99e0799e666c130dfd81d1d0d3bae/3c1e5/two-dimension.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA3klEQVR42k2Pu0pDYRCEzxv6CPoAFmITFEQtUhhELSyCoHiBFFGCl0RiMELUKMGgNtqoiI9g4eWQnf38f3LkZGDYYXdY+BKC3MnluePelWeFLBt6kEL6BZaO9IKS955zvy9eL53nM+ehJvoV0d0UrSXRXhG9PdFZF6eLxsmccTRjVCeNnXGjVRJ3od9eFR99J3npiNtt8dR0HmvD482WuFgTx7NGY8G4KovzZXFYMA6mg6eM3QmjPGbU543rDdEsirdueOgZzigmGUJ0xPxH8og7yJB/4PszzN+8G5H/AOW3I13BHvjUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"two dimension\" title=\"\" src=\"/static/4fc99e0799e666c130dfd81d1d0d3bae/6af66/two-dimension.png\" srcset=\"/static/4fc99e0799e666c130dfd81d1d0d3bae/69538/two-dimension.png 160w,\n/static/4fc99e0799e666c130dfd81d1d0d3bae/72799/two-dimension.png 320w,\n/static/4fc99e0799e666c130dfd81d1d0d3bae/6af66/two-dimension.png 640w,\n/static/4fc99e0799e666c130dfd81d1d0d3bae/d9199/two-dimension.png 960w,\n/static/4fc99e0799e666c130dfd81d1d0d3bae/21b4d/two-dimension.png 1280w,\n/static/4fc99e0799e666c130dfd81d1d0d3bae/3c1e5/two-dimension.png 2854w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>작대기도 잘 그으면 예술이 된다</small>\n</center>\n<p>자, 이렇게 오디오 파형을 심플하게 그려보았다. 여기까지 해놓고 하는 말인데… 사실 <a href=\"https://github.com/katspaugh/wavesurfer.js\" target=\"_blank\" rel=\"nofollow\">WaveSurfer</a>라고 이거 해주는 라이브러리가 있다. 기능도 더 많다.</p>\n<p>그냥 내 손으로 한번 직접 그려보고 싶었다.</p>\n<h2 id=\"음악-주세요-dj\" style=\"position:relative;\">음악 주세요 DJ<a href=\"#%EC%9D%8C%EC%95%85-%EC%A3%BC%EC%84%B8%EC%9A%94-dj\" aria-label=\"음악 주세요 dj permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>파형만 그리기는 좀 아쉬우니 막간을 이용해서 메소드 하나만 더 만들어보자. 바로 이 음악을 재생하는 기능이다.\n원래 이 메소드를 만들 때 필자의 의도는 “음악이라도 좀 들으면서 만들자”였는데 이거 만들면서 같은 곡을 너무 많이 들어서 조금 질려버렸다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">play</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">buffer</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> sourceBuffer <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createBufferSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  sourceBuffer<span class=\"token punctuation\">.</span>buffer <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">;</span>\n  sourceBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>audioContext<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  sourceBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">AudioContext.prototype.createBufferSource</code> 메소드는 <code class=\"language-text\">AudioNode</code> 중 하나인 <code class=\"language-text\">AudioBufferSourceNode</code>라는 친구를 생성하는 메소드인데, 이 <code class=\"language-text\">AudioNode</code>에게 우리가 지금까지 가지고 놀았던 <code class=\"language-text\">AudioBuffer</code>를 넘겨주면 진짜 오디오적인 컨트롤을 할 수가 있게 도와주는 음…껍데기 같은 느낌이다.</p>\n<p><code class=\"language-text\">Web Audio</code> API는 이런 <code class=\"language-text\">AudioNode</code>들을 서로 연결해서 소리를 변조할 수 있는 기능을 제공하기 때문에 이걸 사용해서 컴프레서나 리버브 같은 오디오 이펙터도 만들 수 있다. 다음에는 한번 오디오 이펙터를 만들어보는 것을 목표로 해야겠다.</p>\n<p>완성된 샘플의 소스는 필자의 <a href=\"https://github.com/evan-moon/simple-waveform-visualizer\" target=\"_blank\" rel=\"nofollow\">깃허브 레파지토리</a>에서, 라이브 데모는 <a href=\"https://simple-audio-waveform.herokuapp.com/\" target=\"_blank\" rel=\"nofollow\">여기서</a> 확인할 수 있다.</p>\n<p>이상으로 컴퓨터는 어떻게 소리를 들을까? 포스팅을 마친다.</p>","fields":{"slug":"20190710-javascript-audio-waveform","path":"/2019/07/10/javascript-audio-waveform/","lang":"ko"},"frontmatter":{"title":"컴퓨터는 어떻게 소리를 들을까?","subTitle":"샘플링, 비트 레이트, Web Audio API로 보는 소리의 디지털 변환","date":"Jul 10, 2019","categories":["프로그래밍","오디오"],"tags":["Sound Engineering","사운드 엔지니어","나이퀴스트","Logic Pro X","로직프로","Cubase","큐베이스","Analog to Digital","AD Covert","Digital to Analog","DA Covert","샘플링","Sampling","Sample Rate","AudioContext","Bit Rate","자바스크립트","JavaScript Audio API"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/6cd3149c200b28430bab8288d044aa4c/3a812/thumbnail.jpg","srcSet":"/static/6cd3149c200b28430bab8288d044aa4c/3a812/thumbnail.jpg 320w,\n/static/6cd3149c200b28430bab8288d044aa4c/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/6cd3149c200b28430bab8288d044aa4c/fc5c5/thumbnail.webp 320w,\n/static/6cd3149c200b28430bab8288d044aa4c/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/6cd3149c200b28430bab8288d044aa4c/2d839/thumbnail.jpg","srcSet":"/static/6cd3149c200b28430bab8288d044aa4c/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/6cd3149c200b28430bab8288d044aa4c/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"be7c0ae7-da2d-5b2b-bb0a-9661bfe81244","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%9B%90%EB%9E%98-%ED%95%84%EC%9E%90%EC%9D%98-%EA%B3%84%ED%9A%8D\">원래 필자의 계획</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%A0%9C-1-%EA%B4%80%EB%AC%B8-manifestjson\">제 1 관문, Manifest.json</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%A0%9C-2-%EA%B4%80%EB%AC%B8-service-worker\">제 2 관문, Service Worker</a></p>\n<ul>\n<li><a href=\"#%EA%B0%9C%EB%B0%9C%ED%99%98%EA%B2%BD-%EC%84%B8%ED%8C%85\">개발환경 세팅</a></li>\n<li><a href=\"#service-worker-%EC%9E%91%EC%84%B1\">Service Worker 작성</a></li>\n<li><a href=\"#service-worker-%EC%84%A4%EC%B9%98\">Service Worker 설치</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%9C-3-%EA%B4%80%EB%AC%B8-pushmanager\">제 3 관문, PushManager</a></p>\n<ul>\n<li><a href=\"#%EC%9E%AC%EC%95%99%EC%9D%98-%EC%8B%9C%EC%9E%91\">재앙의 시작</a></li>\n<li><a href=\"#%EB%B9%A0%EB%A5%B8-%EC%86%90%EC%A0%88\">빠른 손절</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%9C-4-%EA%B4%80%EB%AC%B8-notification-api\">제 4 관문, Notification API</a></p>\n<ul>\n<li><a href=\"#%EA%B8%B0%EC%A1%B4-%EA%B8%B0%EB%8A%A5%EC%97%90-notification-%EB%81%BC%EC%9B%8C%EB%84%A3%EA%B8%B0\">기존 기능에 Notification 끼워넣기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 필자가 회사에서 2019년 7월 5일 금요일 하루 동안 기존 어플리케이션에 PWA(Progressive Web Application) 기능을 붙힌 삽질기를 기록하려고 한다. PWA는 지원하지 않는 브라우저에 대한 예외처리만 꼼꼼하게 해주면 UX, 성능, SEO 등에서 무조건 플러스 요인이기 때문에 예전부터 계속 해보고 싶었다.","html":"<p>이번 포스팅에서는 필자가 회사에서 2019년 7월 5일 금요일 하루 동안 기존 어플리케이션에 PWA(Progressive Web Application) 기능을 붙힌 삽질기를 기록하려고 한다. PWA는 지원하지 않는 브라우저에 대한 예외처리만 꼼꼼하게 해주면 UX, 성능, SEO 등에서 무조건 플러스 요인이기 때문에 예전부터 계속 해보고 싶었다.</p>\n<!-- more -->\n<p>하지만 시간이 없어서 계속 미루고 있었는데 마침 어제 간만에 필자에게 여유 시간이 주어졌다.</p>\n<p>필자가 지금 작업하고 있는 프로젝트가 회사의 비즈니스 모델과 밀접한 관련이 있는 프로젝트이고, 또 워낙 이 기능에 관련된 사내 이해관계자들이 많아서 PO가 테스트를 좀 더 꼼꼼히 하고 싶다고 했기 때문이다.</p>\n<p>그래서 금요일 하루, 정확히 말하면 오전에는 버그 터진거 하나 핫픽스하고 점심먹고나서 자료 조사도 한 시간 정도 해본 다음에 15시 30분 쯤부터 시작해서 22시 55분까지 달렸다. 원래 필자는 근무시간에 열심히 하고 다른 시간은 나에게 투자하자는 주의라 야근은 왠만하면 안하는데, 필자에게 주어진 시간이 하루 밖에 없어서 그 안에 무조건 끝내야 했던 것도 있지만 사실 제일 큰 이유는…</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/4b791df3dd464ea532b95b6c21f7e0e7/acb04/tyson.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwT/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAeacpxrNRZehUA//xAAbEAEAAgIDAAAAAAAAAAAAAAABABECAxIiMf/aAAgBAQABBQKsV601MVI7Fj7yYNRbn//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABoQAAICAwAAAAAAAAAAAAAAAAAhARECICL/2gAIAQEABj8CmrOsZEi4Qtf/xAAaEAEAAwADAAAAAAAAAAAAAAABABEhMUFR/9oACAEBAAE/IaQV5DR5XUbeiKGKFUpjhHcvPIisiK1n/9oADAMBAAIAAwAAABBb4H7/xAAYEQACAwAAAAAAAAAAAAAAAAABEBEhQf/aAAgBAwEBPxDFJpf/xAAWEQEBAQAAAAAAAAAAAAAAAAARABD/2gAIAQIBAT8QI3//xAAcEAEBAAMBAAMAAAAAAAAAAAABEQAhMUFRgaH/2gAIAQEAAT8QF9Ka/HtyzwkXSGU40cW/eVRrsWn7hltvCVzeGPY5pUJ44TWsoGOJ7lz/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"tyson\" title=\"\" src=\"/static/4b791df3dd464ea532b95b6c21f7e0e7/c08c5/tyson.jpg\" srcset=\"/static/4b791df3dd464ea532b95b6c21f7e0e7/0913d/tyson.jpg 160w,\n/static/4b791df3dd464ea532b95b6c21f7e0e7/cb69c/tyson.jpg 320w,\n/static/4b791df3dd464ea532b95b6c21f7e0e7/c08c5/tyson.jpg 640w,\n/static/4b791df3dd464ea532b95b6c21f7e0e7/acb04/tyson.jpg 750w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<blockquote>\n<p>네, 쉽게 보고 덤볐다가 쳐맞았습니다.</p>\n</blockquote>\n<p>필자는 사실 PWA를 구현해본 경험이 없다. 구글에서 제공해주는 데모는 몇번 돌려본 적이 있지만 나머지는 그냥 다른 굇수분들의 블로그를 보고 “오…나도 해보고 싶군” 정도로만 생각했었다.</p>\n<p>근데 다른 사람들이 구현한 걸 보면 뭐 코드가 복잡한 것도 아니고 서비스 워커(Service Worker)도 작동 원리가 그렇게 생소한 느낌은 아니기에 사실 얕보고 있었다.</p>\n<h2 id=\"원래-필자의-계획\" style=\"position:relative;\">원래 필자의 계획<a href=\"#%EC%9B%90%EB%9E%98-%ED%95%84%EC%9E%90%EC%9D%98-%EA%B3%84%ED%9A%8D\" aria-label=\"원래 필자의 계획 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>원래 필자도 PWA에게 쳐맞기 전까진 그럴싸한 계획이 있었다. 물론 필자는 자세히 공부를 하고 덤비는 타입이 아니라 그냥 대충 알아본 다음에 나머지는 직접 맞아가면서 배우는 타입이라 더 그랬던 것도 있다.</p>\n<p>어쨌든 어제 점심을 먹고 와서 필자가 사무실에 앉아서 가만히 생각을 해본 결과, “PWA나 해볼까…? Manifest 넣고 서비스 워커 붙히면 뭐 나머지는 문서보고 해도 대충 될 거 같은데…?”로 결론이 나왔다.</p>\n<p>그래도 PWA의 모든 기능을 다 구현하는 것은 퇴근 시간인 19시까지는 힘들 것 같아서 작업에 대한 스코프를 잡았다.</p>\n<blockquote>\n<ol>\n<li>기능을 전부 구현하는 건 힘들 것 같으니 일단 기반을 잡아놓는다고 생각하자.</li>\n<li>서비스 워커 설치.</li>\n<li>Manifest.json 추가. 이건 남들 다하는 거니까 우리도 기본적으로 해야함.</li>\n<li>Pusher SDK와 PushManager를 사용해서 브라우저가 꺼져있더라도 사용자에게 푸시 메세지를 보여주자.</li>\n<li>시간 되면 모바일에서 홈스크린에 어플리케이션을 추가하는 것까진 해보고 싶다.(우선순위 낮음)</li>\n<li>오프라인 캐싱은 다음 시간에… (나름 스코프 조절)</li>\n</ol>\n</blockquote>\n<p>자 이제 계획이 잡혔으니 PO와 테스터에게 “프로젝트 테스트 하시는 동안 저는 저만의 놀이터에서 놀다 오겠습니다”라고 협의를 한 뒤 마스터에서 브랜치를 하나 땄다.</p>\n<p>브랜치 이름도 필자의 의지가 돋보이는 <code class=\"language-text\">feature/service-worker-web-push</code>로 딱 지어놓고 15시 30분 쯤 부터 작업을 시작했다. 그래도 이정도면 한 4-5시간 안에 충분히 가능하겠다 싶었는데…</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/d1377bc7e60fb06312324f3859994069/f93b5/babo.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 86.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAMEBQEC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdSrPFJYcHjMCMH/xAAeEAACAQMFAAAAAAAAAAAAAAAAASECAwQREiIxMv/aAAgBAQABBQKuFumC9xTZrbqMnyPv/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAGRAAAgMBAAAAAAAAAAAAAAAAAAEQMYFR/9oACAEBAAY/Aio0fC0bP//EABwQAAMAAgMBAAAAAAAAAAAAAAABESExQYGxcf/aAAgBAQABPyGcD5GlRp8KuEtEIi3kLVRdxZln4aBx2eR//9oADAMBAAIAAwAAABDPF/8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHRABAAICAwEBAAAAAAAAAAAAAQARITFBcfBhsf/aAAgBAQABPxC5UcBbjFtEpF1DLKYWS+hztSkeXeyy4egbTgYni+R383NXT8n/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"babo\" title=\"\" src=\"/static/d1377bc7e60fb06312324f3859994069/f93b5/babo.jpg\" srcset=\"/static/d1377bc7e60fb06312324f3859994069/0913d/babo.jpg 160w,\n/static/d1377bc7e60fb06312324f3859994069/f93b5/babo.jpg 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>코딩하는 내내 필자의 정신상태</small>\n</center>\n<p>결과적으로 저 중에서 달성한 제대로 달성한 목표는 1, 2, 3번 뿐이다. 4번 목표인 푸시 메시지의 경우, Background 메세징은 삽질만 하다가 시간이 너무 많이 가서 실패하고 Notification API를 사용하여 Foreground에서만 노출되도록 구현했다.</p>\n<p>처음에는 숨고 모바일 앱에서 이미 사용하고 있는 FCM(Firebase Cloud Messaging)을 사용하려고 했는데 그러면 웹 클라리언트의 푸시 채널이 이원화되기 때문에 일단 테스트도 해볼 겸 FCM없이 서비스 워커의 <code class=\"language-text\">PushManager</code>만 사용해서 구현하려고 했다.</p>\n<p>이제 필자가 이것들을 작업하면서 어떤 문제에 봉착했고, 어떻게 해결했는지 한번 설명해보겠다.</p>\n<h2 id=\"제-1-관문-manifestjson\" style=\"position:relative;\">제 1 관문, Manifest.json<a href=\"#%EC%A0%9C-1-%EA%B4%80%EB%AC%B8-manifestjson\" aria-label=\"제 1 관문 manifestjson permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>제일 처음 한 일은 <code class=\"language-text\">manifest.json</code>을 생성하는 것이다. 이건 그냥 말 그대로 생성하면 된다. 또한 <code class=\"language-text\">manifest.json</code>은 어차피 정적인 파일이기도 하고 업데이트도 잦지 않은 파일이기 때문에 굳이 Express에서 응답하지 않아도 된다. 그래서 프로젝트 내부의 <code class=\"language-text\">static</code> 디렉토리에 <code class=\"language-text\">manifest.json</code>을 생성하고 nginx가 바로 응답해주는 방식으로 작성했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token comment\">// static/manifest.json</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"숨고\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"short_name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"숨고\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"icons\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"src\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://d1hhkexwnh74v.cloudfront.net/app_icons/1x.png\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"image/png\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sizes\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"48x48\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"src\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://d1hhkexwnh74v.cloudfront.net/app_icons/2x.png\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"image/png\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sizes\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"64x64\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"src\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://d1hhkexwnh74v.cloudfront.net/app_icons/3x.png\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"image/png\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sizes\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"128x128\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"src\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://d1hhkexwnh74v.cloudfront.net/app_icons/3x.png\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"image/png\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sizes\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"144x144\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"start_url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/?pwa=true\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"display\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"fullscreen\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"background_color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#FFFFFF\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"theme_color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#00C7AE\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">manifest.json</code>에 대한 자세한 내용은 Google Web Developer 문서의 <a href=\"https://developers.google.com/web/fundamentals/web-app-manifest/\" target=\"_blank\" rel=\"nofollow\">The Web App Manifest</a>를 참고해서 작성했다.</p>\n<p>그리고 저 아이콘은 지금 숨고 앱에서 사용하고 있는 아이콘들이다. 굳이 모바일 앱과 다른 아이콘을 사용할 이유도 없고, 디자이너 분들도 바빠서 멘탈나간 상황이기 때문에 필자의 기술적인 욕심 때문에 아이콘을 만들어 달라고 하기엔 너무 미안했다.</p>\n<p>또한 앱과 웹이 같은 아이콘을 사용해야 브랜딩 측면에서도 좋을 거라 생각해서 모바일 앱 레파지토리를 클론받아서 몰래 훔쳐왔다. 그리고 저 이미지들은 굳이 프로젝트 내에 저장할 필요가 없으므로 회사에서 사용하는 S3 버킷에 업로드하고 CloudFront로 딜리버리했다.</p>\n<p>위에서 설명했듯이 필자는 <code class=\"language-text\">manifest.json</code>에 대한 요청을 Express가 처리하는 것이 아니라 서버 엔진인 nginx가 처리하는 방식을 선택했는데, 이렇게 nginx가 서버 어플리케이션까지 요청을 토스해주지 않고 그냥 알아서 서빙하도록 하고 싶다면 간단한 설정을 추가하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-nginx line-numbers\"><code class=\"language-nginx\"><span class=\"token directive\"><span class=\"token keyword\">server</span></span> <span class=\"token punctuation\">{</span>\n  ...\n  <span class=\"token directive\"><span class=\"token keyword\">location</span> ~ ^/static</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token directive\"><span class=\"token keyword\">root</span> /your/project/location</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  ...\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이런 식으로 설정하면 바로 프로젝트 내의 <code class=\"language-text\">static</code> 디렉토리에 접근할 수 있다. 위 설정은 “static이라는 경로로 시작하는 요청이 들어오면 <code class=\"language-text\">/your/project/location</code>에서 니가 알아서 찾아줘”라는 의미이다. 하지만 로컬에서 개발 서버를 사용할 때에는 nginx를 사용하지 않고 NodeJS를 사용하여 바로 개발용 서버를 띄우므로 로컬 환경에서는 Express가 직접 파일을 서빙할 수 있도록 해줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">===</span> <span class=\"token string\">'local'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/static'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">serve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./static'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>이제 브라우저에게 “나의 Manifest 파일이 여기 있으니 가져가시오”라고 알려줄 수 있는 <code class=\"language-text\">link</code> 태그를 하나 넣어주면 끝이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// constants/meta.constant.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token literal-property property\">link</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">rel</span><span class=\"token operator\">:</span> <span class=\"token string\">'manifest'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">href</span><span class=\"token operator\">:</span> <span class=\"token string\">'/static/manifest.json'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>manifest<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/static/manifest.json<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">data-vue-meta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>필자는 vue-meta 라이브러리를 사용하고 있기 때문에 이렇게 <code class=\"language-text\">Object</code> 타입 객체를 리턴하는 방식을 사용하면 렌더링 때 <code class=\"language-text\">&lt;head></code> 내부에 알아서 넣어준다. 그 후 브라우저가 <code class=\"language-text\">manifest.json</code>을 제대로 가져가는지는 크롬 개발자 도구의 Application > Manifest 탭에서 확인할 수 있다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 505px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/6752d69a5efe962003e820272d2ac7f7/c0cb9/has-manifest.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 95%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3ElEQVR42p2UT0vjUBTFCw64czHjwmqnNv9e0uSlTaJNUiwt1sERFUZwKMN8Nr+B4pQR3MxiFi6EWc3eD3O852kLgqDJ4vLeS+B37zn3vtfwfR9ZlmEwGMDzPLiuuwyeq0aDwCRJDJQfut0uwjBEFOlaUAN0HMeEUgpaa/R6PfQlSW0gN0EQmErjWJs1TTO4kqQWkJUxCF3s1XOiWsA8zzGZTDAej42H/LEAe56qDqRX9DCKIuOflqaUkqQoCtOgKl4ugVx1HCMWqEr62JFqh+XQfKsMpDRKZYd1GCFME+yORjKbOUJJUAlIGGWlaWqABBcy5NPpAfJiaM61JPMQizx6yCSdzjZsy6o8i8s5XMgmlBVzsGOB1xob27ZNl7nvs8sCLfdG2C1KeErVu8v0zzwK/MEb0mrBlVBODclsSPw8HoFU5MjYbJyfwfr5HXYinla4gi8kK7l6O+Lf5uEhBv/ucfLwH+tfpwg6Fjx6TflvWPCiKWxEJnPXnuxjen2D/u9faA5LhBtN+O1t+J/bZn0X0DyuEr6Ek6T4OJvh048Ztr6dYuvkCM3TI9kfo3X85ala9x1AvjCpjI4lklfml1i5uULj9hKrf66x9neOxt0cH+YXcHr6qXGvyH8E5xc3GuSQDZIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"has manifest\" title=\"\" src=\"/static/6752d69a5efe962003e820272d2ac7f7/c0cb9/has-manifest.png\" srcset=\"/static/6752d69a5efe962003e820272d2ac7f7/69538/has-manifest.png 160w,\n/static/6752d69a5efe962003e820272d2ac7f7/72799/has-manifest.png 320w,\n/static/6752d69a5efe962003e820272d2ac7f7/c0cb9/has-manifest.png 505w\" sizes=\"(max-width: 505px) 100vw, 505px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>자, 여기까지 하는데 거의 10분 정도 걸렸던 것 같다. 아직까지는 필자의 계획대로 순탄히 흘러가고 있었다. 하지만 문제는 이제부터 생기기 시작한다…</p>\n<h2 id=\"제-2-관문-service-worker\" style=\"position:relative;\">제 2 관문, Service Worker<a href=\"#%EC%A0%9C-2-%EA%B4%80%EB%AC%B8-service-worker\" aria-label=\"제 2 관문 service worker permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>기분 좋게 커피 한잔 때리고 와서 이제 서비스 워커를 적용하는 작업을 시작했다. 서비스 워커는 브라우저에 설치하고 나면 백그라운드에서 실행되는 프로세스로, 웹 어플리케이션의 메인 로직과는 전혀 별개로 작동한다.</p>\n<p>서비스 워커와 웹앱의 메인 로직은 서로 메세지를 주고 받는 방식으로 작동한다. <code class=\"language-text\">postMessage</code>로 보내면 <code class=\"language-text\">onMessage</code>로 받는 방식인데, WebView나 Chrome Extension과 같은 방식이기 때문에 이미 우리에겐 익숙한 방식이다.</p>\n<p>단, 아직까지 모든 브라우저에서 지원되는 것이 아니기 때문에 반드시 <code class=\"language-text\">navigator</code> 전역 객체 내부에 <code class=\"language-text\">serviceWorker</code> 객체가 존재하는 지 확인한 후 초기화를 진행해야한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'serviceWorker'</span> <span class=\"token keyword\">in</span> navigator<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* ... */</span> <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>뭐 이 정도 쯤이야 필자같은 프론트엔드 개발자들에게는 굉장히 익숙한 상황이기 때문에 그냥 웃고 넘길 수 있지만 이것보다 더 귀찮은 게 있었다. 바로 서비스 워커의 개발환경 세팅이다.</p>\n<h3 id=\"개발환경-세팅\" style=\"position:relative;\">개발환경 세팅<a href=\"#%EA%B0%9C%EB%B0%9C%ED%99%98%EA%B2%BD-%EC%84%B8%ED%8C%85\" aria-label=\"개발환경 세팅 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>서비스 워커는 일반적인 웹 어플리케이션보다 많은 기능에 접근할 수 있기 때문에 보안이 굉장히 중요하다. 그래서 서비스 워커는 제한적인 환경에서만 작동할 수 있도록 만들어졌는데 그 조건은 딱 두가지이다.</p>\n<hr>\n<ol>\n<li>웹 어플리케이션의 호스트가 localhost이거나</li>\n<li>HTTPS 프로토콜을 사용하고 있을 것</li>\n</ol>\n<hr>\n<p>불행히도 필자는 이 두가지 모두 다 해당이 안된다. 필자의 회사는 로컬에서 <code class=\"language-text\">http://local.soomgo.com</code>이라는 오리진을 사용하고 있기 때문에 서비스 워커 객체가 활성화 되지 않는다.</p>\n<p>그럼 해결 방법은 2가지로 줄어든다. 내가 localhost로 접속하거나 로컬에 HTTPS를 붙히거나.</p>\n<p>사실 필자는 이걸 놓쳐서 “아 서비스 워커 어디갔어? 왜 안돼? 죽을래?”로 컴퓨터랑 실랑이하느라 한 30분 날려먹었다. 공식 문서에 버젓이 한국어로 적혀있는 내용이므로 항상 공식 문서를 꼼꼼히 읽자…</p>\n<h4 id=\"개발-서버를-https로-띄우자\" style=\"position:relative;\">개발 서버를 HTTPS로 띄우자!<a href=\"#%EA%B0%9C%EB%B0%9C-%EC%84%9C%EB%B2%84%EB%A5%BC-https%EB%A1%9C-%EB%9D%84%EC%9A%B0%EC%9E%90\" aria-label=\"개발 서버를 https로 띄우자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>필자가 localhost 개발 환경에 접속하면 백엔드 쪽에서 CORS를 허용할 때 내려주는 Access-Control-Allow-Origin 헤더까지 변경해야하는 상황이라, 그냥 개발 환경에 HTTPS를 붙히기로 했다.</p>\n<p>Express는 내장 객체로 HTTPS 객체를 지원해주고 있기 때문에 간단하게 셋업할 수 있다. 먼저 HTTPS를 사용하기 위해서는 SSH 키쌍이 필요하므로 <code class=\"language-text\">openssl</code>을 사용하여 키를 만들어 주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ openssl genrsa <span class=\"token number\">1024</span> <span class=\"token operator\">></span> private.pem <span class=\"token comment\"># 비공개키 생성</span>\n<span class=\"token punctuation\">..</span>.\n$ openssl req <span class=\"token parameter variable\">-x509</span> <span class=\"token parameter variable\">-new</span> <span class=\"token parameter variable\">-key</span> private.pem <span class=\"token operator\">></span> public.pem <span class=\"token comment\"># 공개키 생성</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>그 다음 이 키를 프로젝트의 적당한 곳에 저장한 다음 그냥 사용하면 되는데 여기서 주의 사항이 있다.</p>\n<blockquote>\n<p>> 생성한 ssh키는 로컬 개발환경에서만 사용되어야합니다.<br />\n> 이 디렉토리 내의 *.pem 파일은 gitignore에 추가되어있습니다.</p>\n<p><strong>/keys/README.md</strong></p>\n</blockquote>\n<p><strong>절대 리모트 저장소에 SSH 키를 업로드하지 말자.</strong> 보안 터진다. 물론 이 키로 뭔가 실질적인 인증을 하는 것이 아니라 로컬 개발 서버에서만 사용하기 때문에 뭔가 중요한 걸 털릴 염려는 없지만 그래도 습관이 중요하다. SSH 키는 폭탄 다루듯이 다루자.</p>\n<p>대신 필자는 다른 개발자들이 쉽게 HTTPS 환경을 세팅할 수 있도록 프로젝트 내에 키를 저장하는 디렉토리 내부에 <code class=\"language-text\">README.md</code>를 작성해놓고 이 키가 어떤 용도로 사용될 것인지 주의 사항은 무엇인지 상세하게 적어놓았다.</p>\n<p>그리고 개발할 때는 HTTPS가 아니라 HTTP로 서버를 띄울 일도 생길 수 있으므로 개발 서버를 띄울 때 옵션을 사용하여 프로토콜을 선택할 수 있도록 해주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token comment\">// package.json</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cross-env NODE_ENV=local node server\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"serve:https\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cross-env NODE_ENV=local node server --https\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// server.js</span>\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> https <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// node의 옵션들은 배열 형태로 process.argv에 담겨있다.</span>\n<span class=\"token keyword\">const</span> useHttps <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">.</span><span class=\"token function\">some</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">val</span> <span class=\"token operator\">=></span> val <span class=\"token operator\">===</span> <span class=\"token string\">'--https'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isLocal<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> localApp <span class=\"token operator\">=</span> app<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>useHttps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    localApp <span class=\"token operator\">=</span> https<span class=\"token punctuation\">.</span><span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 아까 생성한 키는 여기서 사용한다!</span>\n      <span class=\"token literal-property property\">key</span><span class=\"token operator\">:</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./keys/private.pem'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">cert</span><span class=\"token operator\">:</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./keys/public.pem'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> app<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  localApp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">,</span> host<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>isHttps <span class=\"token operator\">?</span> <span class=\"token string\">'https://'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'http://'</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>host<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>port<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">로 가즈아!!!!</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// ...</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이런 식으로 작성해놓으면 개발 서버를 올릴 때 원하는 프로토콜을 자유자재로 변경할 수 있기 때문에, 혹시 내가 개발 서버를 HTTPS로 바꿔놔서 다른 개발자 컴퓨터에서 개발 서버가 안 올라가도 일단 시간을 벌어놓고 버그를 수정할 수 있다.</p>\n<p>원래 진짜 고수는 맞기 전에 맞을 곳을 예상해서 미리 힘을 주고 있는 법이다. <small>(많이 맞아본 1인)</small></p>\n<p>개발 서버를 HTTPS로 띄우면 이제 <code class=\"language-text\">navigator</code> 객체 내부에 이쁘게 들어가있는 <code class=\"language-text\">serviceWorker</code> 객체를 확인할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token operator\">></span> navigator<span class=\"token punctuation\">.</span>serviceWorker\n<span class=\"token operator\">&lt;</span> ServiceWorkerContainer <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">ready</span><span class=\"token operator\">:</span> Promise<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">controller</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">oncontrollerchange</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">onmessage</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h4 id=\"https를-쓰지-않고-문제-회피하기\" style=\"position:relative;\">HTTPS를 쓰지 않고 문제 회피하기<a href=\"#https%EB%A5%BC-%EC%93%B0%EC%A7%80-%EC%95%8A%EA%B3%A0-%EB%AC%B8%EC%A0%9C-%ED%9A%8C%ED%94%BC%ED%95%98%EA%B8%B0\" aria-label=\"https를 쓰지 않고 문제 회피하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>사실 필자도 처음에는 로컬에 HTTPS 붙히기가 귀찮아서 리서치하다가 찾은 얌생이인데, 로컬 서버에서도 HTTPS를 사용하지 않고도 서비스 워커를 사용할 수 있는 방법이 있다.</p>\n<p>Chrome Flag의 <a href=\"chrome://flags/#unsafely-treat-insecure-origin-as-secure\" target=\"_blank\" rel=\"nofollow\">unsafely-treat-insecure-origin-as-secure</a> 설정을 활성화하고 텍스트 필드에 원하는 호스트를 입력해놓으면 해당 호스트는 안전하다고 판단하여 서비스 워커를 사용할 수 있게 해준다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/b815361813e64140e4a33b94ccc0a44f/0f586/secure-hack.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 26.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABFUlEQVR42m2Qy07CQBhGeQti0AjhYlLamRZmesESWgoFpCXGxKVLEx7AvQs3hqWJLHwDVz7icVoSNro4Od+/+W+N8n7G8bjm4yM3rPk8rjgcFiitcMQI4Y4RclxbugrX06YeYTvuH6yhoKG0piwW7MoluyKn2GYUxZJ0viBJKzLm2ZI4nuEHEdEkRusAx5EMbXFqJjyT5amhGIUE+QNyukHEq9rS2AuzGumn5yx0gjRU+cZWPO7feX795unli/3bD1FS0uiKiIttTvMupbk2FBnN5JbWdY9Wu0+r0699WdEZnGh3ueoJvMkGf5KhwhR/usKRioYlfFw9R6pqelpv4BoLw8AJ6dvBvwzMIpZt/mbZ5lTn7F9yj6eT/mq1sAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"secure hack\" title=\"\" src=\"/static/b815361813e64140e4a33b94ccc0a44f/6af66/secure-hack.png\" srcset=\"/static/b815361813e64140e4a33b94ccc0a44f/69538/secure-hack.png 160w,\n/static/b815361813e64140e4a33b94ccc0a44f/72799/secure-hack.png 320w,\n/static/b815361813e64140e4a33b94ccc0a44f/6af66/secure-hack.png 640w,\n/static/b815361813e64140e4a33b94ccc0a44f/d9199/secure-hack.png 960w,\n/static/b815361813e64140e4a33b94ccc0a44f/21b4d/secure-hack.png 1280w,\n/static/b815361813e64140e4a33b94ccc0a44f/0f586/secure-hack.png 1498w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>이렇게 등록한 뒤 하단의 <code class=\"language-text\">Relaunch Now</code> 버튼을 클릭하면 크롬이 재시작되면서 설정이 변경된다. 하지만 이 방법은 스스로 보안 취약점을 만들어 내는 것이기 찜찜해서 결국 사용하지는 않았다.</p>\n<h3 id=\"service-worker-작성\" style=\"position:relative;\">Service Worker 작성<a href=\"#service-worker-%EC%9E%91%EC%84%B1\" aria-label=\"service worker 작성 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이제 개발환경 세팅이 다 끝났다면 이제부터는 딱히 귀찮은 건 없다. 그냥 문서보면서 쭉쭉 작성하면 된다. 일단 서비스 워커의 기능을 구현하기 전에 잘 작동하는 지 부터 확인해야 하므로 아무 내용이 없는 서비스 워커부터 만들었다.</p>\n<p>근데 이것도 <code class=\"language-text\">manifest.json</code>처럼 그냥 웹 어플리케이션과 완전 분리된 <code class=\"language-text\">static/service-worker.js</code>로 따로 작성하면 만들 때는 편하긴 한데, 나중에 서비스 워커에서 웹 어플리케이션에서 사용하고 있는 모듈이나 데이터에 접근하고 싶을 때 굉장히 애매해질 것 같아서 그냥 Webpack을 사용해서 같이 빌드하기로 결정했다.</p>\n<h4 id=\"일단-service-workerjs-파일을-만들자\" style=\"position:relative;\">일단 service-worker.js 파일을 만들자!<a href=\"#%EC%9D%BC%EB%8B%A8-service-workerjs-%ED%8C%8C%EC%9D%BC%EC%9D%84-%EB%A7%8C%EB%93%A4%EC%9E%90\" aria-label=\"일단 service workerjs 파일을 만들자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>Webpack으로 빌드한다고 해도 이 친구가 무에서 유를 창조하는 친구는 아니기 때문에 당연히 소스 파일은 있어야 한다. 일단 서비스 워커가 작동하는 것을 보는 것이 목적이므로 심플하게 작성해주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// src/service-worker.js</span>\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">event</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'저 쪽 테이블에서 보내신 겁니다 -> '</span><span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"service-worker-webpack-plugin-사용하기\" style=\"position:relative;\">Service Worker Webpack Plugin 사용하기<a href=\"#service-worker-webpack-plugin-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"service worker webpack plugin 사용하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p><code class=\"language-text\">ServiceWorkerWebpackPlugin</code>은 구글에 “Service Worker Webpack”을 검색하면 가장 상단에 나오는 플러그인이다. <a href=\"https://github.com/oliviertassinari/serviceworker-webpack-plugin\" target=\"_blank\" rel=\"nofollow\">깃허브 레파지토리</a>에 가서 다들 구경 한번 해보자.</p>\n<p>README를 읽어보니 사용법이 초간단 그 자체다. 그냥 Webpack 설정에 넣어주면 끝이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// build/webpack.client.config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>baseConfig<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">ServiceWorkerWebpackPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">entry</span><span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'../src/service-worker.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>서비스 워커 파일 경로를 찍어주고 <code class=\"language-text\">ServiceWorkerWebpackPlugin</code> 객체를 생성할 때 초기 인자로 넘겨주면 Webpack 설정의 <code class=\"language-text\">output</code>에 정의된 경로에 <code class=\"language-text\">sw.js</code> 파일을 생성해준다. 물론 이 파일 이름은 변경할 수 있으니 모두 각자의 취향대로 애정을 듬뿍 담은 이쁜 이름을 지어주자. 필자는 귀찮으니까 그냥 <code class=\"language-text\">sw.js</code>로 가기로 했다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 309px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/d8c4a05ba385d071d692080e75d2241d/532e8/sw.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 28.750000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7ElEQVR42oWQy07DMBBF/TlUie24NIkfsWOlkESlXYNYI7Ys+AQ+/DKeVuqilbo4mpE1PnNtoZXH0nkYE1C3CbKNkNsBsktca+kfU3vIJjDCkPC769H5Ec37EebjCL3OMJ8nrmX4obByUD5DDRmi3Xn8fkVYP6CydOhG1Dpch1UhXPu7CR3kc2SE6wP+fiJcpie+LWgOM6oytLFnniyqwsZxLWnuJZR94jBiazySD2gt/VveQ1NsnSeoifo9sbyioUVqnLgvf3sjvQilvQhfEgldhKKLejpLWLiS7LAwepnRnFa+dCMsT95FXvYP50rEEU2GbqEAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sw\" title=\"\" src=\"/static/d8c4a05ba385d071d692080e75d2241d/532e8/sw.png\" srcset=\"/static/d8c4a05ba385d071d692080e75d2241d/69538/sw.png 160w,\n/static/d8c4a05ba385d071d692080e75d2241d/532e8/sw.png 309w\" sizes=\"(max-width: 309px) 100vw, 309px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>이쁘게 태어난 sw.js</small>\n</center>\n<p>근데 이 방법의 단점이 있는데, 일반적인 서비스 워커보다 파일의 크기가 커진다는 것이다. 아무래도 Webpack으로 빌드하다보니 서비스 워커의 외부에 있는 모듈이나 라이브러리를 끌어오기 때문이다.</p>\n<p>뭐 이건 애초에 필자가 조금 편하게 쓰려고 선택한 상황이니 어쩔 수 없긴하다. 어쨌든 이런 단점이 있으니, 서비스 워커의 크기를 줄이고자 하시는 독자분들은 직접 작성하시는 게 더 좋을 수도 있다.</p>\n<p>이제 서비스 워커의 본체를 만들었으니 이걸 웹 어플리케이션이 초기화될 때 브라우저에 “나 서비스 워커 가지고 있어!”라고 알려주는 일만 남았다.</p>\n<h3 id=\"service-worker-설치\" style=\"position:relative;\">Service Worker 설치<a href=\"#service-worker-%EC%84%A4%EC%B9%98\" aria-label=\"service worker 설치 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>서비스 워커를 설치하는 방법은 간단하다. 이 브라우저에 <code class=\"language-text\">serviceWorker</code> 객체가 지원되는 지 확인한 후 설치하면 된다.</p>\n<p>일반적인 서비스 워커의 설치 방법은 구글의 <a href=\"https://developers.google.com/web/fundamentals/primers/service-workers/?hl=ko\" target=\"_blank\" rel=\"nofollow\">서비스 워커:소개</a> 문서를 보고 따라하면 된다.  필자는 <code class=\"language-text\">ServiceWorkerWebpackPlugin</code>을 사용했기 때문에 해당 플러그인의 문서를 참조하여 작성했다.</p>\n<p>어차피 어떤 방법을 사용하든 설치 자체는 그렇게 어렵지 않다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token comment\">// settings/service-worker.setting.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> isSupported <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>browser <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string\">'serviceWorker'</span> <span class=\"token keyword\">in</span> navigator<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isSupported<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'서비스 워커가 지원되는 브라우저 입니다.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> runtime <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'serviceworker-webpack-plugin/lib/runtime'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  runtime<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>res <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'서비스 워커 설치 성공 ->'</span><span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span>e <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'서비스 워커 설치 실패 ㅜㅜ -> '</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">isSupported</code> 변수에 <code class=\"language-text\">process.browser</code> 값을 검사하는 이유는, 숨고의 어플리케이션은 Next.js나 Nuxt.js처럼 유니버셜 SSR 환경에서 실행되기 때문이다.</p>\n<p>유니버셜 SSR이 뭔지 궁금하신 분은 이전에 작성한 포스팅인 <a href=\"/2018/09/25/universal-ssr\">Universal Server Side Rendering이란?</a>을 한번 읽어보자.</p>\n<p>해당 모듈은 물론 클라이언트 사이드에서만 호출되지만 그래도 혹시 모르니 왠만하면 현재 실행 컨텍스트가 클라이언트인지 서버인지는 체크해주는 것이 좋다. 서버 사이드 렌더링 사이클 때 브라우저 API인 <code class=\"language-text\">navigator</code>에 접근하려고 하면 당연히 에러가 발생한다.</p>\n<p>서비스 워커의 설치가 성공했다면 <a href=\"chrome://inspect/#service-workers\" target=\"_blank\" rel=\"nofollow\">chrome://inspect/#service-workers</a> 또는 <a href=\"chrome://serviceworker-internals\" target=\"_blank\" rel=\"nofollow\">chrome://serviceworker-internals</a>에 여러분의 서비스 워커가 노출될 것이다. 서비스 워커를 적용하는 방법은 사실 굉장히 심플한 편이다.</p>\n<p>근데 사실 필자가 가장 시간을 많이 잡아먹은 부분이 바로 이 서비스 워커였는데, 그 이유는 서비스 워커 공식 문서에 적혀있다.</p>\n<blockquote>\n<p><strong>설치 실패 알림 기능 부족</strong></p>\n<p>서비스 워커가 등록되더라도 <a href=\"chrome://inspect/#service-workers\" target=\"_blank\" rel=\"nofollow\">chrome://inspect/#service-workers</a> 또는 <a href=\"chrome://serviceworker-internals\" target=\"_blank\" rel=\"nofollow\">chrome://serviceworker-internals</a>에 표시되지 않는 경우 오류가 발생했거나 <code class=\"language-text\">event.waitUntil()</code>에 거부된 프로미스를 전달했기 때문에 설치하지 못했을 수 있습니다.</p>\n<p>이 문제를 해결하려면 <a href=\"chrome://serviceworker-internals\" target=\"_blank\" rel=\"nofollow\">chrome://serviceworker-internals</a>로 이동하여 ‘Open DevTools window and pause JavaScript execution on service worker startup for debugging’을 선택하고 설치 이벤트의 시작 위치에 디버거 문을 추가합니다. 이 옵션을 <a href=\"https://developers.google.com/web/tools/chrome-devtools/javascript/breakpoints?hl=ko\" target=\"_blank\" rel=\"nofollow\">확인할 수 없는 예외 시 일시 중지</a>와 함께 사용하면 문제를 찾을 수 있습니다.</p>\n<p><strong>Matt Gaunt</strong> <em>contributor to WebFundamentals</em></p>\n</blockquote>\n<p>아니 이게 디버깅이 진짜 힘들다. 서비스 워커의 설치가 실패했으면 어디서 에러가 났는지, 왜 났는지 보여줘야 하는데 <code class=\"language-text\">Uncaught DomException</code> 하나만 딸랑 보여주고 끝낸다.</p>\n<p>그래서 뭐가 잘못되었는지 하나하나 코드 라인에 <code class=\"language-text\">debugger</code> 찍고 추리해가면서 수정해야하는데 이게 진짜 힘들다. 근데 이걸 또 공식 문서에 디버깅 힘들다고 버젓이 적어놔서 괜히 더 힘든 거 같다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 436px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/e57b6ba2e83f7ede90d76af1007b9b33/8574c/conan.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100.62500000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFVklEQVR42i2UW1CU5x3Gv/f9vt1lgbAgsMuyCLscdlGWwy4LLEcBcSEuEBUVMBBMPFAVNRqPoxFzUoxTT9EiMbUaiHaSeiCotUkm6UzbybTptE7bTA9pvelMbtppe5Gr3vz6r+3Ff77v5v19z/v9n+cxdIoX7fSj00MoVzUqqw6V3YJyJ7Dy+8jy9+AtSZAflPfyMczQIYzyE6jwKYyqc6jIJXT0Mrr2Cjr+PQyVHkRnVGJkxbDlxnHkdWJ4n8HKS7C4IERlwMdSn5uKAjc1xT4qK9vIr9lOfmSCRTWHBDSNis9ha54jreM9DJ0ZxcxuwhBF9uwYmTklmL4B7I5FpJiavOwsij0eCnNyCRcVUOP3koj6idUlcda/ha3xHVLbv09Gxw18KwWoctvRnh60dzXKuwbLFcSe6sZm2jC1nXSnU4Bu/Lm5lHk9REsD9NRXsyxcREnTLtJX3MHTPcfyHfe5vPAXUejtRxcMoorG0IGtmIWj2Jx52LSJ3XSgDBNPVibVpX5yMzJorQoysaaNxoYERUt7iW+8zdR7X/KTP/yLS/N/FIUCUAJSpbvRwX2YFW9gebqwGQapKWmERVG0rIhnWmNkP5VOQ7yFgzvGCcWG+daxOT5+9DU3f/w1yRfvkdl6UYClO1Ghg+glk+jwFKrmMvaKVzAMG7HyAKP9XSxPJDl3fB9b+xp5d2o/81ffYvb+Fzz41d8ZmfyUvK4rOOrOYK+dEqCAVOUUuvoCKjqDWX8do+4Wfat3cn5nko+mD/PJjQv89tZpHt86zu9n9zJ7bY4907+juP86joYLOKKnhSEiQvsFWHUWHZlBx66hGm6iW97HWLZA7fpZLh8e5+G53Xx+5SUe357kr/OTzJ1/k/KBm6TEp7HFzmCLnEBXHJVbvogu3iJLqb0qPrqBav4Ae8ddXD33yEl+SO7K2zQOTtPcMczmoVXMHnmO60e24V1+Eav+O9ijp9CiSoUOoEu3o/xjqIK1orDpfWztd3iqe4Hs5D3cyXkat37C0ZlfEl6+k4H+AX50fhcTyxoYro+TVbUNIyyqlh5Gl8kiA5vRhUNoSZVyd2GkJxbI6b2Pu/dDqkYfcmDmEZ8//jeTlx7Q3T3AByfHuXpwkJMTQ7x0+BjNnYN4JSVGYBxdNIL2rUHliY9z2tCLYhKQ3nuUDz9k+9lf89Fv/inzDzaeekR85SH5d3v56gev8OqmJHfeeJ6FM7t5cHEfvX2b5eBaLG8vpgTDXBRHZ1ZjZpRjjLz+c+Z/8Td++qdvOPj2lwTX3cWIXmVs08t8MTPO3RMv8O2JNewfW8uKFeuINA8JqA9DvKolsjorIqAKKZdidNpijJ999Q2nbv6ZqpEf4mx9F3vTFVTsEq66E4wPb2Dr6qdJJAYINW9kSeMwodo+nPntqMxatCssoDIBFUpj5aMdbozW7Z+RJuE2G6/J9qSGImfE4K9hBA9hL53AVbgMf00/JZF+AhUd1LQN4w52Y6SWYaaJKqdPQB5Mew6mlYFhNc9KY3wXM3pBbHASteRl2d4e2d4WHIH1LGnaQHXnJlE3QmXTEA1dz1MQ7sVI8WE6PVj2bCybC9NMRUv2DVV7EV11WmxwDCVZ1sXbnhSEkbeKjMDTRNpHCTaNUBp/lpbujRw4cpZgTY8cdGGzu7Asp8AcMvYnY+iK19HSwrpkxxNz6oL14qmkFG4rJdVJ+ga3sGrDXjpX76Gl5znePDdLXb34zdACTJVrCsyyY2mpO2XJh/5rTv8m9OIhlIB0bqcUbhwlLZ7pi9Kzch3HXz3PkaOn2fXCKE0Nbdgc6f9TJDBLnpaAzP/PfwDrN8WrTqXoQAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"conan\" title=\"\" src=\"/static/e57b6ba2e83f7ede90d76af1007b9b33/8574c/conan.png\" srcset=\"/static/e57b6ba2e83f7ede90d76af1007b9b33/69538/conan.png 160w,\n/static/e57b6ba2e83f7ede90d76af1007b9b33/72799/conan.png 320w,\n/static/e57b6ba2e83f7ede90d76af1007b9b33/8574c/conan.png 436w\" sizes=\"(max-width: 436px) 100vw, 436px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>도와줘요 명탐정... 범인말고 내 버그도 찾아줘...</small>\n</center>\n<h2 id=\"제-3-관문-pushmanager\" style=\"position:relative;\">제 3 관문, PushManager<a href=\"#%EC%A0%9C-3-%EA%B4%80%EB%AC%B8-pushmanager\" aria-label=\"제 3 관문 pushmanager permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>이제 서비스 워커도 설치했으니 서비스 워커의 <code class=\"language-text\">PushManager</code>만 연동해주면 모든 것이 끝난다! 라고 생각했지만 이 놈도 복병이었다.</p>\n<p><code class=\"language-text\">PushManager</code> 또한 아직 표준이 아니라서 모든 브라우저에서 지원되는 기능이 아니기 때문에 서비스 워커 설치 시 <code class=\"language-text\">PushManager</code>의 존재 여부도 함께 검사해주어야한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// settings/service-worker.setting.js</span>\n<span class=\"token keyword\">const</span> isSupported <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>browser <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string\">'serviceWorker'</span> <span class=\"token keyword\">in</span> navigator <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string\">'PushManager'</span> <span class=\"token keyword\">in</span> window<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>조건의 가독성이 조금 떨어진 것이 마음에 안들지만 일단은 구동 테스트를 하는 것이므로 그냥 넘어갔다. 딱 여기까지 하고나서 다음 스텝을 봤더니…</p>\n<h3 id=\"재앙의-시작\" style=\"position:relative;\">재앙의 시작<a href=\"#%EC%9E%AC%EC%95%99%EC%9D%98-%EC%8B%9C%EC%9E%91\" aria-label=\"재앙의 시작 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<blockquote>\n<p><strong>애플리케이션 서버 키 가져오기</strong></p>\n<p>이 코드랩으로 작업하려면 애플리케이션 서버 키를 몇 개 생성할 필요가 있는데, 도우미 사이트인 <a href=\"https://web-push-codelab.glitch.me/%EC%97%90%EC%84%9C\" target=\"_blank\" rel=\"nofollow\">https://web-push-codelab.glitch.me/에서</a> 생성할 수 있습니다.</p>\n<p>여기서 공개 키 쌍과 비공개 키 쌍을 생성할 수 있습니다.</p>\n<p>다음과 같이 <code class=\"language-text\">scripts/main.js</code>로 공개 키를 복사하여 <code class=\"language-text\">&lt;Your Public Key></code> 값을 바꾸세요.</p>\n<p><code class=\"language-text\">const applicationServerPublicKey = '&lt;Your Public Key>';</code></p>\n<p>참고: 절대로 비공개 키를 웹 앱에 두면 안 됩니다!</p>\n<p><strong>Matt Gaunt</strong> <em><a href=\"https://developers.google.com/web/fundamentals/codelabs/push-notifications/?hl=ko\" target=\"_blank\" rel=\"nofollow\">웹 앱에 푸시 알림 추가</a></em></p>\n</blockquote>\n<p>응…? SSH 키가 필요하다고…? 예상 못하긴 했지만 HTTPS 환경에서 서버와 클라이언트 통신 채널이 하나 더 생기는 것이므로 SSH 키가 필요한 건 맞는 것 같아서 빠르게 인정했다.</p>\n<p>Google의 공식 문서에서 PushManager로 푸시 채널을 구독하는 예제를 살펴봤더니 확실히 SSH 키가 필요하긴 했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">subscribeUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> applicationServerKey <span class=\"token operator\">=</span> <span class=\"token function\">urlB64ToUint8Array</span><span class=\"token punctuation\">(</span>applicationServerPublicKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  swRegistration<span class=\"token punctuation\">.</span>pushManager<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">userVisibleOnly</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">applicationServerKey</span><span class=\"token operator\">:</span> applicationServerKey\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>음 예상은 못했지만 이 정도는 괜찮다. 어차피 <a href=\"https://pusher.com/\" target=\"_blank\" rel=\"nofollow\">Pusher</a>라는 푸시 솔루션을 이미 사용하고 있고 이것도 결국 같은 원리로 작동하기 때문에 내부적으로는 SSH 키쌍을 사용한 인증을 사용했을 것이다.</p>\n<h3 id=\"빠른-손절\" style=\"position:relative;\">빠른 손절<a href=\"#%EB%B9%A0%EB%A5%B8-%EC%86%90%EC%A0%88\" aria-label=\"빠른 손절 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>그렇게 Pusher에서 사용되는 SSH 키가 어디 있는지 찾기를 어언 20분… 결국 못 찾았다.</p>\n<p>Pusher 내부적으로 서버에서 사용하는 <code class=\"language-text\">secret</code> 값과 클라이언트에서 사용하는 <code class=\"language-text\">key</code>를 사용하여 인증을 하는데, 이건 SSH 키쌍이 아니라 그냥 임의의 문자열이었다.</p>\n<p>어차피 SSH 키를 만든다고 해도 웹 푸시에 대한 컨트롤은 백엔드가 가지고 있으므로 필자 혼자 이것저것 건드리면서 테스트 해보기에는 조금 무리가 있다. 게다가 퇴근 시간은 이미 한참 지났기 때문에 백엔드 분들은 퇴근하셨다. <small>(사실 금요일 저녁에 이런 거 하고 있는 사람이 이상한거다.)</small></p>\n<p>이때 이미 필자의 멘탈은 조금 나가있었기 때문에 월요일에 출근해서 모바일 앱에서는 어떻게 Pusher와 FCM을 연동해서 사용하고 있는 지 물어본 후 진행해야겠다고 결론을 내리고 방향을 바꿨다.</p>\n<p>커밋 로그를 보니 이때 시간이 대략 21시 40분 쯤… 아니 그래도 퇴근은 해야하니까… 집에는 가야지…</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 439px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/4bb0a72bb04f73e4997f67a28c30bbba/e3b18/giveup.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 63.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACCElEQVR42nVTSWtyQRB8f9pbQMSLePAm3gRRL+4xl0RBBXEX92hc4hLEPUo0hmjUCtUwId+HGWjmvZmemq6qHu3r6wvX4nQ6oV6vY7Vayf/Hx4esHY/Hn3h8fESj0UAqlUK320W73YZ2uVzwOzgI8Pn5KQnn81nWOBNE5ai15+dnlEol5HI59Hq9fwHV4c1mg2KxiJeXF/mfzWaIRCLw+/2Ix+N4enrC6+ur7HFmdZVKBdFo9Drg+/s7Wq0WRqMRttstbm9vYbFYoNfrcXNzA51OB6/XK7nT6RTNZhN3d3dwu93QCPJ/EJyUh8OhUDGbzQgEAjAajQiHw6hWq0JfVZjP52G1WmGz2aApPX5ryHE4HITKYrFAMBiEw+GQAy6XS6qnQRzz+RzpdFoksdvt0CaTiVCjTvzu9/sYDAbY7/fodDpygEGD6OhyuRTHyYSXZrNZ2bu/v0csFoNG8QuFgriVTCZF9Ewm8wOoAHw+n2jFfO7tdjuhTbq1Wu2nhTRlBmfVg8qc8Xgsjr69vYl2iURCQGkSGamOoLvUmsw0BfZXP7JqAj48PMDpdIp+7Lv1ei3G0WVeRtPYVto1MIYSna+FIBx8NTRJMeBFrI5UDQYDTCbT34AqWCUroJ7lclncJE1qTt34Olgxe5R5V/uQoSpkRXSQutE8GkAt2ch0nxeGQiF4PB5Z/wYETq25vc6tLQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"giveup\" title=\"\" src=\"/static/4bb0a72bb04f73e4997f67a28c30bbba/e3b18/giveup.png\" srcset=\"/static/4bb0a72bb04f73e4997f67a28c30bbba/69538/giveup.png 160w,\n/static/4bb0a72bb04f73e4997f67a28c30bbba/72799/giveup.png 320w,\n/static/4bb0a72bb04f73e4997f67a28c30bbba/e3b18/giveup.png 439w\" sizes=\"(max-width: 439px) 100vw, 439px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>역시 아니다 싶으면 빠른 손절이 답이다...</small>\n</center>\n<h2 id=\"제-4-관문-notification-api\" style=\"position:relative;\">제 4 관문, Notification API<a href=\"#%EC%A0%9C-4-%EA%B4%80%EB%AC%B8-notification-api\" aria-label=\"제 4 관문 notification api permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>그래서 바꾼 방향은 “Background 푸시 메세지는 포기하고 Foreground 푸시 메세지라도 제대로 받게 하자”였다.</p>\n<p>이렇게 되면 필자가 처음 생각했던 “브라우저가 꺼져있더라도 푸시 메세지를 보여주고 싶다”는 달성하지 못하지만 브라우저가 켜져있고 soomgo.com에 접속되어 있다면 창을 내려놓든 다른 일을 하고 있든 사용자에게 푸시 메세지는 보여줄 수 있으므로 어느 정도 목적 달성은 된다.</p>\n<p>방향을 바꾸고 나니까 기존의 웹 어플리케이션에 구현되어있던 푸시 로직에 노티피케이션을 보여주는 코드만 추가하면 끝나는 간단한 일이 되었다. 어차피 Pusher를 사용하여 인증, 이벤트 구독 등의 로직은 예전에 채팅 기능 개발할 때 다 만들어 놨기 때문이다.</p>\n<h3 id=\"기존-기능에-notification-끼워넣기\" style=\"position:relative;\">기존 기능에 Notification 끼워넣기<a href=\"#%EA%B8%B0%EC%A1%B4-%EA%B8%B0%EB%8A%A5%EC%97%90-notification-%EB%81%BC%EC%9B%8C%EB%84%A3%EA%B8%B0\" aria-label=\"기존 기능에 notification 끼워넣기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>예전에 채팅 기능을 개발할 때 Pusher SDK를 한번 래핑한 헬퍼 클래스도 만들어 놨었기 때문에 나름 구조도 탄탄하다. 이제 여기에 메소드만 몇개 추가하고 웹 푸시 이벤트가 발생했을 때 알림만 보여주면 된다.</p>\n<p>우선 이 브라우저가 <code class=\"language-text\">Notification</code> API를 지원하는 지 확인하는 메소드가 필요하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// src/helpers/Pusher.js</span>\n<span class=\"token function\">isSupportNotification</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> process<span class=\"token punctuation\">.</span>browser <span class=\"token operator\">&amp;&amp;</span> window <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string\">'Notification'</span> <span class=\"token keyword\">in</span> window<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>그 다음 사용자에게 알림에 대한 허가를 받는 메소드를 작성한다. <code class=\"language-text\">Notification</code>은 내부에 <code class=\"language-text\">permission</code> 속성을 가지고 있고 이 속성은 <code class=\"language-text\">granted</code>, <code class=\"language-text\">denied</code>, <code class=\"language-text\">default</code>로 나누어 진다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// src/helpers/Pusher.js</span>\n<span class=\"token function\">getNotificationPermission</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isSupportNotification</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>isAllowNotification <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'not_supported'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Notification<span class=\"token punctuation\">.</span>permission <span class=\"token operator\">===</span> <span class=\"token string\">'granted'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>isAllowNotification <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Notification<span class=\"token punctuation\">.</span>permission <span class=\"token operator\">!==</span> <span class=\"token string\">'denied'</span> <span class=\"token operator\">||</span> Notification<span class=\"token punctuation\">.</span>permission <span class=\"token operator\">===</span> <span class=\"token string\">'default'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> Notification<span class=\"token punctuation\">.</span><span class=\"token function\">requestPermission</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result <span class=\"token operator\">===</span> <span class=\"token string\">'granted'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>isAllowNotification <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">granted</code>는 사용자가 이미 알림을 허용한 상태, <code class=\"language-text\">denied</code>는 거부한 상태, <code class=\"language-text\">default</code>는 아직 알림에 대한 퍼미션을 줄지말지 사용자가 결정을 하지 않은 상태이다.</p>\n<p>따라서 우리는 퍼미션이 <code class=\"language-text\">default</code> 상태일 때 <code class=\"language-text\">Notification.requestPermission</code> 메소드를 사용하여 사용자에게 알림 노출에 대한 허가를 받아야 한다.</p>\n<p>이제 실제로 알림창을 띄워줄 메소드를 작성해보자. <code class=\"language-text\">Notification</code> API 자체가 워낙 심플하다보니 그닥 어렵지 않다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token function\">createForegroundNotification</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">title<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> body<span class=\"token punctuation\">,</span> icon<span class=\"token punctuation\">,</span> link <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> notification <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Notification</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    body<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">icon</span><span class=\"token operator\">:</span> icon <span class=\"token operator\">||</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>AssetsCloudFrontHost<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/app_icons/1x.png</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  notification<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onshow</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> notification<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  notification<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  notification<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclick</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">event</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>link<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        window<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>link<span class=\"token punctuation\">,</span> <span class=\"token string\">'_blank'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">new</code> 키워드를 사용하여 <code class=\"language-text\">Notification</code> 객체를 생성하면 그 즉시 OSX는 화면 우측 상단에, Windows는 우측 하단에 알림 메세지가 노출된다. 그 다음 생성한 <code class=\"language-text\">Notification</code> 객체의 <code class=\"language-text\">onshow</code>, <code class=\"language-text\">onclick</code> 등의 이벤트 리스너에 핸들러를 등록해주면 된다.</p>\n<p>메소드 명은 Background 메세징을 실현하지 못한 필자의 슬픔을 담아 <code class=\"language-text\">createForegroundNotification</code>으로 결정했다. 굳이 Foreground를 강조한 이유는 언젠가 <code class=\"language-text\">createBackgroundNotification</code> 메소드를 만들겠다는 필자의 야망을 담았다.</p>\n<p>이제 필요한 모든 것을 만들었으니 Pusher SDK에서 Web Socket을 통해 푸시를 보낼 때마다 알림이 작동하도록 연결만 해주면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">async</span> <span class=\"token function\">subscribeNotification</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isSupportNotification</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNotificationPermission</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>isAllowNotification<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> channel <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getPrivateUserChannel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">channel</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">response</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myUserId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">const</span> targetChatRoute <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>response<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">.</span>provider <span class=\"token operator\">?</span> <span class=\"token string\">'chats'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'pro/chats'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">createForegroundNotification</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">님이 메세지를 보냈어요.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> response<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">icon</span><span class=\"token operator\">:</span> response<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">.</span>profile_image<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">link</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>location<span class=\"token punctuation\">.</span>origin<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>targetChatRoute<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>chat<span class=\"token punctuation\">.</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Pusher SDK는 푸시 채널에 이벤트 핸들러를 바인딩할 수 있는 기능을 제공해준다. <code class=\"language-text\">message</code> 이벤트는 사용자가 채팅 메세지를 받았을 때 호출되는 이벤트이다. 단 자기 자신이 보낸 메세지에도 여과없이 이벤트가 호출되므로 <code class=\"language-text\">response.sender.id === this.myUserId</code> 조건을 통해 자신이 보낸 메세지에는 알림을 보여주지 않도록 처리하였다.</p>\n<p>그 다음은 이제 사용자가 작은 알림 메세지만 보고도 어떤 상황이 벌어지는 것인지 쉽게 알 수 있도록 “OOO님이 메세지를 보냈어요”라는 형식의 제목과 메세지의 내용, 상대방의 프로필 사진을 사용하여 <code class=\"language-text\">Notification</code> 객체를 생성하면 끝이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 499px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/32c54805c2f49dd0192728224f674405/119c7/push.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 68.12499999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACVUlEQVR42o1R3WuSURh//6cgGOh01YVm+qrDm2mWi6gb16K6qGW4BVpBFwVtXQZhSdNXC+bqIvDGa8UPChkEsiFuil/z8/34dc5598Y0lj3w45zznOfj93sezmAwQINer4dOp4OR3C8sLKj++XmG+VMwGo0TUPPVP46320Fhdzjg8VyFz+eDjbfBcPESLDzP/DZyOhxO8DbyJrEWiwVms5nBZDLh8hUrzFYrXC4XuHPn50AxpzMgFH6G1E4Kd+77EVy9jrXAAzwKbuDh4wCC6xsIhcIIh8Ok6Q243W5CwIMlQuJ9LIrk1y94+eo1uDebm6DY2nqLSCQCYTuGa6u3cfPeEu6u3EJg/SnWngTg969g2bcMr9cLnrfDubgIp5OwJgrefYpC+LaD0Ivn4IrFIigKhQKy2SxyuRx2d1OIfPiIWDyBRDJJzjhiyc+IJgTEY3EkiS9OfIlEAoIgQCDndjyGdDoNDrNMUdgh12rA/gFq7Sb2qwfMNx6PIcvyH1Dj6EUhSadBfZIkqRBFSCSwWSoB5TL2jmoo/dqDSP7q9To6nQ7a7Ta63S5GoxG46UJaJ+WEmXaXacyUf1KIWoM77vVYIGWjBQ+HQ9ax3++j1Wqxt6pbnhjDtDImuU8LkgedhxZUJtLy+TxbUCaTQaVS+Yv1Wca1JBFNcYy+IrPO/5P0z4LfW4co9No4Gg9PVMlMJh00RbPZnNmEjktTyA3IFkeKhAFhShPpJ5WqgUoXScxZi6BGG1erVbXgMRl8/ucPHDYabAmUIQ1okLe28VlG2Q0GA1bwN33ZqDFqNl5aAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"push\" title=\"\" src=\"/static/32c54805c2f49dd0192728224f674405/119c7/push.png\" srcset=\"/static/32c54805c2f49dd0192728224f674405/69538/push.png 160w,\n/static/32c54805c2f49dd0192728224f674405/72799/push.png 320w,\n/static/32c54805c2f49dd0192728224f674405/119c7/push.png 499w\" sizes=\"(max-width: 499px) 100vw, 499px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>필자의 멘탈 상태를 여과없이 보여주는 메세지...잉잉...</small>\n</center>\n<p>어쨌든 이렇게 해서 브라우저에 soomgo.com이 열려있다면 사용자들은 다른 일을 하다가 계속 페이지를 확인하거나 핸드폰을 확인할 필요없이 데스크탑 내에서 새로운 채팅 메세지를 바로 확인할 수 있게 되었다.</p>\n<p>아직도 Background 상태에서 푸시 메세지를 바로 보여주지 못했다는 게 아쉽긴 하다. 하지만 이 정도만 해도 사용자들 입장에서는 꽤나 편할 것이라고 생각한다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>사실 처음 목표했던 걸 다 이루진 못해서 찝찝했지만 너무 피곤했기 때문에 다음을 기약하기로 했다. 이제 월요일에 출근해서 PO한테 이걸 보여주고 혹시 뭐 추가하고 싶은 거 없는지 물어보고 몇가지 테스트를 좀 해본 후 배포할 예정이다.</p>\n<p>서비스 워커에 <code class=\"language-text\">fetch</code> 이벤트 핸들러를 추가하면 Add to Homescreen 기능도 사용할 수 있지만 사실 숨고의 프론트엔드 챕터 공식 입장은 사용자들이 모바일 웹보다는 모바일 앱을 많이 사용했으면 하는 것이기 때문에 이건 할까말까 고민 중이다. <small><del>(인앱 브라우저 크로스브라우징 하기 싫…)</del></small></p>\n<p>일단 처음 스코프를 너무 크게 잡은 것 같기도 하다. 하나하나 좀 자세히 알아보고 작업을 했으면 좋았을 것 같은데 월요일부터는 바로 또 하던 프로젝트 작업을 다시 해야해서 마음이 급했던 것도 있다. 그리고 회사에 프론트엔드 개발자가 부족하기 때문에 이런 기술적인 기능을 붙히는 건 우선 순위가 낮은 편이라서 “지금 아니면 앞으로 언제 할 수 있을 지 모른다”라는 마음도 컸던 것 같다.</p>\n<p>막간을 이용해, 필자와 함께 일해주실 <a href=\"https://www.wanted.co.kr/wd/14044\" target=\"_blank\" rel=\"nofollow\">프론트엔드 개발자 분을 모신다는 JD</a>를 뿌리면서 포스팅을 마무리 하겠다.</p>\n<p>PWA 외에도 다른 하고 싶은 건 많은데 프론트엔드 개발자가 모자라서 못하고 있기 때문에 경력 여하와 상관없이 그냥 재밌는 거 좋아하시는 분이면 된다.<small>(하고 싶은 개발 다 하실 수 있도록 이 한몸 불살라 보필하겠습니다.)</small></p>\n<p>이상으로 PWA 하루 만에 도입하기 포스팅을 마친다.</p>","fields":{"slug":"20190706-pwa-with-notification","path":"/2019/07/06/pwa-with-notification/","lang":"ko"},"frontmatter":{"title":"PWA 하루만에 도입하기","subTitle":"서비스 워커, 웹 푸시, 캐싱까지 직접 구현한 PWA 도입기","date":"Jul 06, 2019","categories":["프로그래밍","웹","튜토리얼"],"tags":["JavaScript","자바스크립트","Web Push","Web Socket","socket.io","Notification API","Vue","PWA","Progressive Web Application"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/ca7838e0f08103b712d883b16d280e71/d803c/thumbnail.png","srcSet":"/static/ca7838e0f08103b712d883b16d280e71/d803c/thumbnail.png 320w,\n/static/ca7838e0f08103b712d883b16d280e71/2a1fd/thumbnail.png 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/ca7838e0f08103b712d883b16d280e71/fc5c5/thumbnail.webp 320w,\n/static/ca7838e0f08103b712d883b16d280e71/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/ca7838e0f08103b712d883b16d280e71/01fb2/thumbnail.png","srcSet":"/static/ca7838e0f08103b712d883b16d280e71/01fb2/thumbnail.png 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/ca7838e0f08103b712d883b16d280e71/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"aa09b406-6c53-5320-939e-0bb424b3f601","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%EB%B3%B8%EC%A7%88%EC%9D%B4-%EB%AD%90%EA%B8%B8%EB%9E%98\">데이터의 본질이 뭐길래?</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%88%98%EC%A7%91%ED%95%A0%EA%B9%8C\">데이터는 어떻게 수집할까?</a></p>\n<ul>\n<li><a href=\"#%EB%82%98%EB%8F%84-%EB%AA%A8%EB%A5%B4%EA%B2%8C-%EC%8A%A4%ED%86%A0%ED%82%B9-%EB%8B%B9%ED%95%98%EA%B3%A0-%EC%9E%88%EB%8B%A4\">나도 모르게 스토킹 당하고 있다</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B4%EC%A0%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EA%B8%B0%EB%B0%98-%EC%9D%98%EC%82%AC%EA%B2%B0%EC%A0%95%EC%9D%B4%EB%8B%A4\">이제 데이터 기반 의사결정이다!</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EA%B8%B0%EB%B0%98-%EC%9D%98%EC%82%AC%EA%B2%B0%EC%A0%95%EC%9D%98-%EC%9E%A5%EC%A0%90\">데이터 기반 의사결정의 장점</a></p>\n<ul>\n<li><a href=\"#%EB%B6%88%ED%99%95%EC%8B%A4%EC%84%B1%EC%9D%84-%EC%B5%9C%EC%86%8C%ED%99%94-%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8B%A4\">불확실성을 최소화 할 수 있다</a></li>\n<li><a href=\"#%ED%83%80%EC%9D%B8%EC%9D%84-%EC%84%A4%EB%93%9D%ED%95%98%EA%B8%B0-%EC%89%BD%EB%8B%A4\">타인을 설득하기 쉽다</a></li>\n<li><a href=\"#%EA%B8%B0%EB%8C%80%EC%99%80-%EC%84%B1%EA%B3%BC%EA%B0%80-%EB%AA%85%ED%99%95%ED%95%98%EB%8B%A4\">기대와 성과가 명확하다</a></li>\n<li><a href=\"#%EB%B3%B5%EC%9E%A1%ED%95%9C-%EB%AC%B8%EC%A0%9C%EB%A5%BC-%EB%8B%A8%EC%88%9C%ED%99%94-%EC%8B%9C%ED%82%AC-%EC%88%98-%EC%9E%88%EB%8B%A4\">복잡한 문제를 단순화 시킬 수 있다.</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EA%B8%B0%EB%B0%98-%EC%9D%98%EC%82%AC%EA%B2%B0%EC%A0%95%EC%9D%98-%EB%8B%A8%EC%A0%90\">데이터 기반 의사결정의 단점</a></p>\n<ul>\n<li><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%8A%94-%EA%B7%B8%EB%83%A5-%EA%B0%92%EC%9D%B4%EB%8B%A4\">데이터는 그냥 값이다.</a></li>\n<li><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%EB%A7%B9%EC%8B%A0%ED%95%98%EB%A9%B4-%EC%9E%98%EB%AA%BB%EB%90%9C-%EA%B2%B0%EC%A0%95%EC%9D%84-%EB%82%B4%EB%A6%B4-%EC%88%98-%EC%9E%88%EB%8B%A4\">데이터를 맹신하면 잘못된 결정을 내릴 수 있다.</a></li>\n<li><a href=\"#%EC%A0%95%EC%84%B1%EC%A0%81%EC%9D%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%EB%AC%B4%EC%8B%9C%ED%95%98%EC%A7%80-%EB%A7%90%EC%9E%90\">정성적인 데이터를 무시하지 말자</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 데이터 기반 의사결정에 대해서 이야기해볼까한다. 데이터 기반 의사결정은 2013년 쯤 빅데이터 열풍이 불면서 뜨기 시작했다. 이미 많은 기업들이 사용하고 있는 의사결정 방법이며 또한 여러가지 선례도 많기 때문에 나름 신뢰성을 가지는 의사결정 방법이다.","html":"<p>이번 포스팅에서는 데이터 기반 의사결정에 대해서 이야기해볼까한다. 데이터 기반 의사결정은 2013년 쯤 빅데이터 열풍이 불면서 뜨기 시작했다. 이미 많은 기업들이 사용하고 있는 의사결정 방법이며 또한 여러가지 선례도 많기 때문에 나름 신뢰성을 가지는 의사결정 방법이다.</p>\n<!-- more -->\n<blockquote>\n<p>단, 데이터의 본질을 제대로 이해하고 사용했을 때만 말이다</p>\n</blockquote>\n<p>데이터 기반 의사결정은 세상이 떠드는 것 만큼 신뢰를 가질 수 있는 의사결정 방법일까? 아니, 그 전에 데이터의 본질이라는 게 뭘까?</p>\n<h2 id=\"데이터의-본질이-뭐길래\" style=\"position:relative;\">데이터의 본질이 뭐길래?<a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%EB%B3%B8%EC%A7%88%EC%9D%B4-%EB%AD%90%EA%B8%B8%EB%9E%98\" aria-label=\"데이터의 본질이 뭐길래 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>우리는 일반적으로 데이터(Data)와 정보(Information)를 동일시 한다. 그러나 사실 데이터 그 자체는 정보가 될 수 없다.</p>\n<p>데이터란, 단순히 현실 세계를 관측해서 얻은 값이다. 그냥 값 그 이상 그 이하도 아니라는 것이다.</p>\n<p>반면에 정보란, 이 데이터들을 어떤 방식으로든 처리해서 의미를 가지는 단위로 만든 것이다. 이때 데이터를 처리해서 정보로 만드는 과정을 데이터 마이닝(Data mining)이라고 하는 것이다.</p>\n<p>이렇게 얘기하면 뭔가 전공책에나 나올 것 같은 느낌이니까 쉽게 풀어보자. 예를 들어서 내일 평균 기온이 섭씨 28도라고 한다. 이때 내일 평균 기온이 섭씨 28도라는 사실은 데이터라고 볼 수 있다. 이 값은 기상청 슈퍼컴퓨터를 써서 측정했든 알파고를 썼든 뭘 썼든 간에 아직까지는 그냥 관측한 값일 뿐이다.</p>\n<p>이제 이 데이터를 내일 집에만 있을 예정인 사람한테 건네주면 의미가 있을까?\n뭐 집에 에어컨이 없다면 큰 의미가 있겠지만, 2019년 대한민국에서는 에어컨은 몰라도 선풍기 정도는 집에 하나씩 다 있기 때문에 별 의미는 없다고 본다. 이러면 이 데이터는 별 의미없는 값이 되어버리는 것이다.</p>\n<p>내일 나가지도 않을건데 밖이 얼마나 덥든 별 상관 없지 않은가? 집에서 에어컨 틀어놓고 수박이나 먹으면 된다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f75a7021ffd0e5cf8696268973f004e3/07f3a/outside-of-blanket.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBf/EABcBAAMBAAAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAdKlp50xjP/EABoQAQEAAgMAAAAAAAAAAAAAAAEAAgMQETL/2gAIAQEAAQUC82tWTHgur//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/AYf/xAAaEAACAgMAAAAAAAAAAAAAAAAAAhAhAREi/9oACAEBAAY/AuUsYvUZj//EABsQAQADAQADAAAAAAAAAAAAAAEAESFBMVFh/9oACAEBAAE/Ia8wPZzIgFUHFKinFvsCaeN5KT//2gAMAwEAAgADAAAAEBwf/8QAFREBAQAAAAAAAAAAAAAAAAAAEQD/2gAIAQMBAT8QWb//xAAXEQEAAwAAAAAAAAAAAAAAAAAAAREh/9oACAECAQE/EMSp/8QAGxABAQEAAgMAAAAAAAAAAAAAAREAIUFRYaH/2gAIAQEAAT8QlNtLAHZNBk/kXfzWKvQXBBSslzhPA5Lo3//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"outside of blanket\" title=\"\" src=\"/static/f75a7021ffd0e5cf8696268973f004e3/c08c5/outside-of-blanket.jpg\" srcset=\"/static/f75a7021ffd0e5cf8696268973f004e3/0913d/outside-of-blanket.jpg 160w,\n/static/f75a7021ffd0e5cf8696268973f004e3/cb69c/outside-of-blanket.jpg 320w,\n/static/f75a7021ffd0e5cf8696268973f004e3/c08c5/outside-of-blanket.jpg 640w,\n/static/f75a7021ffd0e5cf8696268973f004e3/07f3a/outside-of-blanket.jpg 740w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>밖이 섭씨 28도든 말든 이불 밖으로 안나가면 그만이다.</small>\n</center>\n<p>하지만 이 데이터를 내일 종로에서 판교까지 출근해야 하는 사람한테 주면 어떻게 될까? 이제 내일 평균 기온이 섭씨 28도라는 데이터는 이 사람의 생사를 가를 수도 있는 굉장히 의미있는 정보가 된다. <small>(필자는 더위에 약하기 때문에 조금 오버했다)</small></p>\n<p>여기다가 “내일 긴팔 입고 나가면 객사할 수도 있으니 조심하세요!^^“라고 자연어로 표현된 귀여운 정보도 함께 보여주면 좋겠다. 즉, 데이터는 그 자체로는 별로 의미가 없지만 어떤 상황에서 사용되느냐, 어떤 이유로 사용되느냐에 따라 그 정보성의 가치는 천차만별이 되는 것이다. 이게 바로 데이터의 본질이다.</p>\n<h2 id=\"데이터는-어떻게-수집할까\" style=\"position:relative;\">데이터는 어떻게 수집할까?<a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%88%98%EC%A7%91%ED%95%A0%EA%B9%8C\" aria-label=\"데이터는 어떻게 수집할까 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>그렇다면 데이터 기반 의사결정은 어떤 식으로 하는 걸까?</p>\n<p>별 거 없다. 그냥 데이터를 주구장창 모은다. 방대하게 비축된 데이터는 그것만으로도 회사의 자산이라고 할만큼 가치있다. 데이터가 있으면 어떻게 가공하든 그건 자유지만 데이터가 없으면 가공도 못하기 때문이다.</p>\n<h3 id=\"나도-모르게-스토킹-당하고-있다\" style=\"position:relative;\">나도 모르게 스토킹 당하고 있다<a href=\"#%EB%82%98%EB%8F%84-%EB%AA%A8%EB%A5%B4%EA%B2%8C-%EC%8A%A4%ED%86%A0%ED%82%B9-%EB%8B%B9%ED%95%98%EA%B3%A0-%EC%9E%88%EB%8B%A4\" aria-label=\"나도 모르게 스토킹 당하고 있다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>우리와 거의 물아일체인 스마트폰을 지배하는 애플과 구글 역시 알게모르게 데이터를 다 모은다. 아이폰 유저라면 연락처 앱 내에서 가장 상단에 위치한 자기 프로필을 눌러보자. 쭉 내려보면 <code class=\"language-text\">주소(Siri가 특별한 위치에서 찾음)</code>이라는 제목으로 보통 여러분의 집이나 직장이 저장되어 있을 것이다.</p>\n<center>\n  <div style=\"max-width: 300px\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/7a7f89f9e6e92bf96c8753b133e696a6/1d69c/siri.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 178.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAACXBIWXMAAAsTAAALEwEAmpwYAAAExUlEQVR42q1WS2/kRBD2f+TIEQluHBASIHHlwIEDCAktT5FFK3FY4MIB2I02yyYi2tmNJskkmcx4Hsk87bFn/Hbb7v6oatuTWZQQ0G5rarrdbX9dj6+q2zg+OsFh8xius8Tl5QRJUiDPgSxTJGV/1hngtG3SWq7XWOI4w2Aw0jIez7H9cBtteseY2jHmToaZK7EKiheAhFDg9sfPP+LPB79D0SPP8Tr3DJqmBYJIYmwlCKMcRm8OtCcKxxcSU1eh0NpVGtIYUuKnz+/gl6+2aKhe0J7HsgAWvkJzqOBHgMGLvKBkCZSK8gOeC8MMKy/G7u4xdp8cwqNxnMhqQ35XaSndoPR3Rr3IwqAlMGlKO0dhiGGvS34aotPpom+ayLN8rSX4p66+ZzFq1dMU2HqU44fH+drkL37LceeBZKsh6HlrR+r1vLLk64c57u7UG1SAQpRazch/798T+IDEJZ94ocJrn6R4/bOUnK5oTuKd7wXevSvIbAXHU3jzS4G3vxN6vfa9sY4mgT45LbDfkXrMm+yfSzwzpTYtSVW5TnOsHc/ttQs0uuW6EBUgq8v+4j6ijxKh1lHkMc/x7lFMUayk1ihZv19HXrHJGUXPRxTFBFpoJ7PIqt8cc9vsrxMjCHyYZgeDfo/UFnjZZvgJ0LNJLKA7V1paI4mziaQ5heFCYWArrGL13wDzgnxCZA2Sso+FREi+WUWyei79mBWlTZI4pKhXJQ0peFK7hOdZjJDI2zOJtETgi+FAm77/1x7MbofI3MZJ65jWTBwcPMd8PtdapLEP17MQR0vkyQyxd0KgSm+kg2JZln55uVwSJQQ836fKkmiJokj3QRCUPqaPgtiD83QbzodvIem1KClmNF9UJhNfXNfVYD4B3dbYxCBcIewdwf72Y3iXh5BZWNpPfwbbvVgstIasKWtzPZKqOvKrd4k0GEMkA5xMnqFjN2ijgvhclICO46zNvhFwAzgk/w2tI1xYh7BtE/ujA/KhLE3OiOYMxFpygHgXVTn4n1K3LEthRyMEqUvmUq4nLmRNGwZgx6dcbl5BMxiItWOxbVub3u/31y4Yj8d6nnu2gJukRJYy03EoioxSNrsCjOOYCuhAg/BHDNJqtfR4NBrptel0ivPzc80GbnE4RdA7gHf/G4SjU9pouQ6aps1qtdKUYdNvp01B2RPCP9iD894bCNpPESWrK8BN2rBp7IJ/Cwr33pKSwJnCnw4Q+pQx/kwfYDr1OChMGwarAW+jjbuYwJpdIPAXCFYE6E00P3Xq1RrWQWCf3gYokoDy2UNCGROTJNEKVaqUPGRns3iep/tNzv1v2rDJnPTcs3CQ6lJ0sxTXSFW+2G/NZlODvRJi8199lrwiQFU6VEdJrvvbzb5eDEHH4TIsyz2Xfo/OjjCVOpo1/6Qu/epGfm6KwecsH0xzqq19mw8mKmfhS5gs6PLDaef5AV3fcgpOTgS3iJtO+ZwLqnsC5lRQURB0x8l0dWfuMuWYIZyydcUyUrqGNZ43cXpuIuZrCT0/2nmMRqNRHjxFik9/TfDRfSq8MiWQXN/Gzs7ONGAcJ+h2u3SgdXQ1MoIowWhqwXY8Oi5zuoWmmM3mWnhH1sCcpujPUv1cJ0KtIWcWZxkLH2R/A6lS2Z636FQrAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"siri\" title=\"\" src=\"/static/7a7f89f9e6e92bf96c8753b133e696a6/6af66/siri.png\" srcset=\"/static/7a7f89f9e6e92bf96c8753b133e696a6/69538/siri.png 160w,\n/static/7a7f89f9e6e92bf96c8753b133e696a6/72799/siri.png 320w,\n/static/7a7f89f9e6e92bf96c8753b133e696a6/6af66/siri.png 640w,\n/static/7a7f89f9e6e92bf96c8753b133e696a6/1d69c/siri.png 750w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  </div>\n  <small>필자 역시 시리한테 스토킹당하고 있는 운명이다.</small>\n</center>\n<p>필자도 결국 애플의 노예 중 한명이기 때문에, 시리에게 추적당하고 있다. 필자의 집은 실제로 서울시 강서구 양천로 어딘가이고 밑에 나온 주소는 필자의 직장 사무실 소재지이다.</p>\n<p>어쨌든 이 정보를 실제 애플 서버에 저장하는 지 어떤지는 잘 모르겠지만 어쨌든 이런 식으로 기업들은 여러분의 데이터를 지금 이 순간도 실시간으로 모으고 있다. 물론 애플이나 구글같은 대기업이 아니라 스타트업 규모의 회사라도 사용자의 행동 정보를 모두 추적하고 있다. 기업들은 <a href=\"https://developers.google.com/analytics?hl=ko\" target=\"_blank\" rel=\"nofollow\">Google Analytics</a>, <a href=\"https://amplitude.com/\" target=\"_blank\" rel=\"nofollow\">Amplitude</a>, <a href=\"https://mixpanel.com/\" target=\"_blank\" rel=\"nofollow\">Mixpanel</a>, <a href=\"https://www.hotjar.com/\" target=\"_blank\" rel=\"nofollow\">Hotjar</a> 등의 솔루션을 사용하여 여러분의 행동 정보를 쌓고 최대한 의사결정에 이용한다.</p>\n<p>이쯤 되면 이런 생각이 들 것이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/03beee14a6b82dfdc65a02cc5df3b69a/41099/watching-you.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABQAE/8QAFgEBAQEAAAAAAAAAAAAAAAAAAwEC/9oADAMBAAIQAxAAAAHImGkLbY2zf//EABoQAAIDAQEAAAAAAAAAAAAAAAECAwQSEQD/2gAIAQEAAQUCZgxrczIseiMvWb0zdl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8BsY//xAAYEAEAAwEAAAAAAAAAAAAAAAAAAhEhQf/aAAgBAQAGPwLHGqWk/8QAGxAAAwEAAwEAAAAAAAAAAAAAAAERITFBYXH/2gAIAQEAAT8hVW/mlGwPdDhVukbC+HBJMxn/2gAMAwEAAgADAAAAEGQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAERITH/2gAIAQMBAT8QU1IUnT//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QkE//xAAbEAEBAAMBAQEAAAAAAAAAAAABEQAhMUGB0f/aAAgBAQABPxBHkAU7H35in7mwJfFyh2xQX9zkp2yYrrGxWE53CNHDP//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"watching you\" title=\"\" src=\"/static/03beee14a6b82dfdc65a02cc5df3b69a/41099/watching-you.jpg\" srcset=\"/static/03beee14a6b82dfdc65a02cc5df3b69a/0913d/watching-you.jpg 160w,\n/static/03beee14a6b82dfdc65a02cc5df3b69a/cb69c/watching-you.jpg 320w,\n/static/03beee14a6b82dfdc65a02cc5df3b69a/41099/watching-you.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>난 언제나 널 지켜보고 있어...</small>\n</center>\n<p>그렇다. 여러분은 여러분도 모르게 기업들한테 질 좋은 데이터들을 뿜뿜 제공해주고 있다. <a href=\"https://m.yes24.com/Goods/Detail/372300\" target=\"_blank\" rel=\"nofollow\">조지 오웰의 1984</a>에 등장하는 빅브라더가 생각난다.</p>\n<p>물론 대한민국 정부가 이걸 그냥 가만 보고 있을 양반들은 아니라서 어찌어찌 힘쓰고 있긴 하다. 2016년에 행정자치부 및 관계부처가 합동 발표한 개인정보 비식별 조치 가이드라인에 따르면 행동 데이터를 포함한 개인정보 데이터는 개인을 식별할 수 없는 형태로 비식별조치하고 필요한 데이터만 남겨놓는 형태로 사용해야 한다고 권고하고 있긴 하다.</p>\n<blockquote>\n<ol>\n<li><strong>(사전 검토)</strong> 개인정보에 해당하는지 여부를 검토 후, 개인정보가 아닌 것이 명백한 경우 법적 규제 없이 자유롭게 활용</li>\n<li><strong>(비식별 조치)</strong> 정보집합물(데이터 셋)에서 개인을 식별할 수 있는 요소를 전부 또는 일부 삭제하거나 대체하는 등의 방법을 활용, 개인을 알아볼 수 없도록 하는 조치</li>\n<li><strong>(적정성 평가)</strong> 다른 정보와 쉽게 결합하여 개인을 식별할 수 있는지를 「비식별 조치 적정성 평가단」을 통해 평가</li>\n<li><strong>(사후관리)</strong> 비식별 정보 안전조치, 재식별 가능성 모니터링 등 비식별 정보 활용 과정에서 재식별 방지를 위해 필요한 조치 수행</li>\n</ol>\n<p><strong>- 개인정보 비식별 조치 가이드라인, 행정자치부</strong></p>\n</blockquote>\n<p>근데 또 이 권고 사항이 겁나 까다롭기도 하고 말 그대로 권고라서 아마 대부분의 기업에서는 그냥 무시하고 하던대로 하고 있을 거라고 생각한다. 그래도 정상적인 회사라면 회원가입할때 띄워주는 개인정보 처리방침 같은 문서에 여러분의 개인정보를 어떤 이유로, 어떤 방식으로 사용할 것인지 적어놨기 때문에 귀찮더라도 한번 읽어보길 추천한다.</p>\n<h2 id=\"이제-데이터-기반-의사결정이다\" style=\"position:relative;\">이제 데이터 기반 의사결정이다!<a href=\"#%EC%9D%B4%EC%A0%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EA%B8%B0%EB%B0%98-%EC%9D%98%EC%82%AC%EA%B2%B0%EC%A0%95%EC%9D%B4%EB%8B%A4\" aria-label=\"이제 데이터 기반 의사결정이다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>데이터 기반 의사결정이란 결국 이렇게 수집한 데이터를 분석해서 뭔가 그럴싸한 결론을 도출해내는 것이다.</p>\n<p>아무래도 그냥 밑도 끝도 없이 결정하는 것보다는 뭔가 관측한 값을 기반으로 의사결정을 하기 때문에 상대적으로 리스크가 적은 결정을 할 확률이 높다. 특히 이런 데이터 드리븐 방식은 마케팅에서 굉장히 잘 써먹는데, 바로 여러분이 관심을 가질만한 상품을 추천하는 맞춤 광고 시스템이다.</p>\n<p>맞춤 광고 시스템은 여러분이 웹 상에서 이것저것 하고 다닐 동안 그런 행동 데이터를 수집해서 여러분이 어떤 것에 관심이 있는 지 분석한 후 거기에 맞는 광고를 보여주는 것이다. 이런 맞춤 광고 시스템도 일종의 데이터 기반 의사결정이라고 할 수 있다. 확실히 관심을 가질 확률이 높은 상품을 찔러보는 것이기 때문에 그냥 아무 상품이나 찔러보는 것보다 전환률이 확실히 높다.</p>\n<p>그럼 먼저 데이터 기반 의사결정에는 어떤 장점이 있는지 한번 살펴보자.</p>\n<h2 id=\"데이터-기반-의사결정의-장점\" style=\"position:relative;\">데이터 기반 의사결정의 장점<a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EA%B8%B0%EB%B0%98-%EC%9D%98%EC%82%AC%EA%B2%B0%EC%A0%95%EC%9D%98-%EC%9E%A5%EC%A0%90\" aria-label=\"데이터 기반 의사결정의 장점 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>당연히 데이터 기반 의사결정의 장점은 많다. 하지만 하나하나 다 나열하면 끝이 없으므로 필자가 생각하는 대표적인 장점 몇 가지만 적어보겠다.</p>\n<h3 id=\"불확실성을-최소화-할-수-있다\" style=\"position:relative;\">불확실성을 최소화 할 수 있다<a href=\"#%EB%B6%88%ED%99%95%EC%8B%A4%EC%84%B1%EC%9D%84-%EC%B5%9C%EC%86%8C%ED%99%94-%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8B%A4\" aria-label=\"불확실성을 최소화 할 수 있다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>먼저 제일 단순하고 대표적인 장점으로 의사결정의 후폭풍으로 몰려오는 리스크가 적다는 것이다. 위에서 말했듯이 그래도 관측을 통한 데이터를 가지고 분석해서 의사결정 하는 것이기 때문에 그냥 밑도 끝도 없이 직관만 믿고 결정하는 것 보다는 당연히 리스크가 적다.</p>\n<h3 id=\"타인을-설득하기-쉽다\" style=\"position:relative;\">타인을 설득하기 쉽다<a href=\"#%ED%83%80%EC%9D%B8%EC%9D%84-%EC%84%A4%EB%93%9D%ED%95%98%EA%B8%B0-%EC%89%BD%EB%8B%A4\" aria-label=\"타인을 설득하기 쉽다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>두번째로는 타인을 설득하기 쉽다는 것이 있다. 필자 생각에는 이건 조금 심리적인 이유도 있는 것 같다. 아무래도 그냥 말로만 얘기하는 것보다 그럴싸한 그래프와 표를 그려놓고 숫자를 기반으로 얘기하는 것이 더 신뢰가 가지 않겠는가? 이건 아무래도 논리와 숫자에 익숙한 개발자같은 직군보다는 직관을 잘 활용해야 하는 디자이너같은 직군들에게 더 해당이 되는 이유인 것 같다.</p>\n<blockquote>\n<p>a. UX상 이 버튼은 여기에 위치하는 것이 더 유저들이 발견하기 쉬울 거에요!</p>\n<p>b. 유저 테스트를 해본 결과 78%의 유저들이 페이지 상단 20% 내 공간에서만 행동하다가 이탈했습니다. 그러므로…</p>\n</blockquote>\n<p>이 두 개의 차이인 것 같다. 같은 디자이너끼리야 척하면 척이겠지만 다른 직군, 특히 PO나 CEO, 개발자처럼 디자이너가 아닌 사람들을 상대할 때는 확실히 후자가 더 설득하기 쉽다. 물론 저 숫자를 무조건 신뢰하는 것은 위험하다. 그러나 데이터 수집 방법이나 실험 환경이 신뢰가 갈만한 환경이었다면 충분히 들이대볼만한 방법이다.</p>\n<h3 id=\"기대와-성과가-명확하다\" style=\"position:relative;\">기대와 성과가 명확하다<a href=\"#%EA%B8%B0%EB%8C%80%EC%99%80-%EC%84%B1%EA%B3%BC%EA%B0%80-%EB%AA%85%ED%99%95%ED%95%98%EB%8B%A4\" aria-label=\"기대와 성과가 명확하다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>데이터를 기반으로 기능을 기획하면 “우리가 이 기능을 만들면 유저의 이 행동이 증가할거야”라는 식의 기대를 가지고 기획을 하게 된다. 배포한 후에 실제로 해당 행동이 몇 퍼센트나 증가했는지 데이터를 분석해보면 바로 나오기 때문에 성과도 명확하게 가져갈 수 있다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 472px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/da19ee09dcc30f318ee0339dd07b576b/3c5de/abtest.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 58.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0ElEQVR42oWTW2+bQBCF+f//qQ+V2qpSVSlK3Di2sBN2WcxtWS67gPHldAaXmKBIffi0MDM7Ys4cvFW+hSprvKUN6v6C5nj9gHEnVN0ZIrfwI4Mgq1G4AXZRZwdA2yO8tRaIawdVOBTdBWZBTg01EVJ+l1R4yxpkdHtZV/ZXJHUP75t6wA9Z4OveQpYdRHn8lJUyeKS6Q3P+NC+rAbvMwXvREYS5NUuagTiNZ0pnam/we2g6yKK9xWa5icydoajG+53+QdxmSJwGSQOSESQZ2hPgZrAkIq9B08EuckxLd0w7wHvKFGSuIQ4pnlWFzaGETwuSpkdUD/84YhvX2MQVjXyaxe9wPNAtvO/RBjJWOIQh6VTjSWpqSlvXNCJrM9JjHVVEiZC0usfvcHzPGj7nPva1xdo4BLTFXVyO4xmaYbIE20mRfopq2B5La32wzUsuEFQOr7QUviS1RUTPmoQy7WWkIMEjEpwpu+t7fA7Hk4ps80U8kql9BGqNX68FVmExrp+tEJCOjKBGk23kLD6H6/3UwvNNjsSQ2Ck3shDakdGH0QYTbAu2jaAJcvqaeW6C4zyZ9zN7QJEkKPYHbEnDkH4xQ55hG7zbYphs0/zXNn8BgPuRDnRA4W0AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"abtest\" title=\"\" src=\"/static/da19ee09dcc30f318ee0339dd07b576b/3c5de/abtest.png\" srcset=\"/static/da19ee09dcc30f318ee0339dd07b576b/69538/abtest.png 160w,\n/static/da19ee09dcc30f318ee0339dd07b576b/72799/abtest.png 320w,\n/static/da19ee09dcc30f318ee0339dd07b576b/3c5de/abtest.png 472w\" sizes=\"(max-width: 472px) 100vw, 472px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>A/B 테스트를 통해서 배포한 기능으로 인해 실제로 원하는 결과를 얻었는지 테스트하기도 한다</small>\n</center>\n<h3 id=\"복잡한-문제를-단순화-시킬-수-있다\" style=\"position:relative;\">복잡한 문제를 단순화 시킬 수 있다.<a href=\"#%EB%B3%B5%EC%9E%A1%ED%95%9C-%EB%AC%B8%EC%A0%9C%EB%A5%BC-%EB%8B%A8%EC%88%9C%ED%99%94-%EC%8B%9C%ED%82%AC-%EC%88%98-%EC%9E%88%EB%8B%A4\" aria-label=\"복잡한 문제를 단순화 시킬 수 있다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>위에서 설명한 맞춤 광고 같은 경우는 사실 굉장히 복잡한 문제이다. 애초에 사람의 관심사라는 추상적인 개념을 수치해석적으로 표현한다는 것은 쉬운 일은 아니다. 그러나 쉬운 일이 아니라는 게 못한다는 말은 아니다.</p>\n<p>예를 들어 필자는 요즘 CSV 전자담배에 관심을 가지고 실제로 구매를 해서 잘 사용하고 있다. 그 과정에서 필자는 블로그와 유튜브를 돌아다니면서 전자담배에 대한 리뷰를 살펴봤고 전자담배에 끼울 수 있는 액상통과 액상을 웹 상에서 구매할 수 있는지 알고 싶어서 전자담배용품 판매 사이트도 들락날락거렸다.</p>\n<p>분명히 필자의 웹 히스토리에는 <code class=\"language-text\">전자담배</code>라는 키워드가 다수 검출될 것이다. 이 키워드를 수집한 후 필자에게 전자담배 키워드를 가진 광고를 노출시켜주는 것은 그렇게 어려운 기술은 아니다.</p>\n<p>이렇게 “이 사람의 관심사를 알고 싶다”라는 복잡한 문제를 단순한 키워드 매칭으로 해결할 수 있는 것도 데이터 기반 의사결정의 장점 중 하나이다.</p>\n<h2 id=\"데이터-기반-의사결정의-단점\" style=\"position:relative;\">데이터 기반 의사결정의 단점<a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EA%B8%B0%EB%B0%98-%EC%9D%98%EC%82%AC%EA%B2%B0%EC%A0%95%EC%9D%98-%EB%8B%A8%EC%A0%90\" aria-label=\"데이터 기반 의사결정의 단점 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>자, 여기까지만 보면 데이터 기반 의사결정은 리스크도 적고 성과도 명확히 측정할 수 있고 복잡한 문제도 쉽게 풀 수 있는 빈틈없는 의사결정 방법인 것 같다!</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/b0c8b95e3bbd877f6ccc773a5dab64b5/066f9/nope.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 101.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHu5XGiABQH/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAECESEiMUH/2gAIAQEAAQUCvM94DPE7EPh//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAGRAAAQUAAAAAAAAAAAAAAAAAAQACITAx/9oACAEBAAY/AtRDDNH/xAAaEAEBAQADAQAAAAAAAAAAAAABEQAQITHB/9oACAEBAAE/IUkIPuCQw9PBLeqdjrLwCm8b00q7/9oADAMBAAIAAwAAABAjzwD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAcEAEAAgMBAQEAAAAAAAAAAAABABEhQVExccH/2gAIAQEAAT8QKNXwUv4gYR9II5uAgC29ilRZxruYNA2hlO/ssBiejtWYpzMpoU6n/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"nope\" title=\"\" src=\"/static/b0c8b95e3bbd877f6ccc773a5dab64b5/066f9/nope.jpg\" srcset=\"/static/b0c8b95e3bbd877f6ccc773a5dab64b5/0913d/nope.jpg 160w,\n/static/b0c8b95e3bbd877f6ccc773a5dab64b5/cb69c/nope.jpg 320w,\n/static/b0c8b95e3bbd877f6ccc773a5dab64b5/066f9/nope.jpg 400w\" sizes=\"(max-width: 400px) 100vw, 400px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>응. 아니야</small>\n</center>\n<p>물론 데이터 기반 의사결정은 장점이 많은 의사결정 방법이지만 위에서 이야기한 데이터의 본질을 제대로 알고 사용하지 않는다면 현실과 전혀 동떨어진 이상한 의사결정을 하게 될 수도 있다. 필자가 생각하기에 주로 놓치게 되는 포인트들은 이렇다.</p>\n<h3 id=\"데이터는-그냥-값이다\" style=\"position:relative;\">데이터는 그냥 값이다.<a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%8A%94-%EA%B7%B8%EB%83%A5-%EA%B0%92%EC%9D%B4%EB%8B%A4\" aria-label=\"데이터는 그냥 값이다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>위에서도 한번 얘기했듯이 데이터는 그냥 단순한 값에 불과하다. 즉, 데이터를 분석해서 정보성을 가지도록 만들어야 하는데 이 과정에서 사람의 주관이 들어갈 수 밖에 없다는 것이다.</p>\n<p>보통 조직에서 데이터를 분석하는 역할을 맡은 데이터 분석가(Data Analyst)의 직관이 크게 작용한다. 사실 이 직관이 얼마나 정확하냐가 이 사람들의 능력이기도 하다.</p>\n<p>중요한 것은 데이터를 기반으로 나온 결과는 결국 사람의 주관적인 평가가 들어간 정보라는 것이다. 데이터 기반 의사결정을 너무 신뢰하다보면 이렇게 생각하기 쉽다.</p>\n<blockquote>\n<p>우리가 직접 관측한 값을 기반으로 나온 결과니까 결과도 정확할거야!</p>\n</blockquote>\n<p>데이터가 정확하다고 해서 결과도 정확하리라는 법은 없다. 항상 비판적인 시각으로 결과를 바라봐야 한다. 이 비판적인 시각이란 바로 “왜” 이 결과가 이렇게 나왔는지 따지는 습관을 의미한다.</p>\n<h3 id=\"데이터를-맹신하면-잘못된-결정을-내릴-수-있다\" style=\"position:relative;\">데이터를 맹신하면 잘못된 결정을 내릴 수 있다.<a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%EB%A7%B9%EC%8B%A0%ED%95%98%EB%A9%B4-%EC%9E%98%EB%AA%BB%EB%90%9C-%EA%B2%B0%EC%A0%95%EC%9D%84-%EB%82%B4%EB%A6%B4-%EC%88%98-%EC%9E%88%EB%8B%A4\" aria-label=\"데이터를 맹신하면 잘못된 결정을 내릴 수 있다 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>데이터는 단지 일어난 현상 그 자체를 설명할 뿐, 절대 여러분에게 이 현상이 발생한 이유에 대해서는 설명해주지 않는다. 그래서 “왜 이런 데이터가 나왔을까”라는 질문은 보통 전문가의 직관에게 맡기거나 좀 더 공을 들여서 정성적 데이터를 수집하는 방식으로 알아내기도 한다.</p>\n<p>그렇다면 이유를 생각하지 않고 현상만 보고 의사결정을 하는 것이 왜 위험할까?</p>\n<h4 id=\"인과관계와-상관관계\" style=\"position:relative;\">인과관계와 상관관계<a href=\"#%EC%9D%B8%EA%B3%BC%EA%B4%80%EA%B3%84%EC%99%80-%EC%83%81%EA%B4%80%EA%B4%80%EA%B3%84\" aria-label=\"인과관계와 상관관계 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>인과관계와 상관관계는 통계학에서 기초 중의 기초이다. 이것도 파고들면 한도 끝도 없으므로 간단한 정의 정도만 설명하고 넘어가겠다.</p>\n<p>먼저 상관관계는 어떤 통계적인 변인이 증가할 때 다른 변인도 증가하거나 감소하는 것을 의미한다. 변인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>가 감소할 때 변인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>도 함께 감소하거나 증가한다는 것이다. 이 두개의 변인이 완전 제멋대로 움직이면서 따로 놀고 있다면 이 두개의 변인은 상관관계가 없는 것이다.</p>\n<p>이때 두 변인이 얼마나 상관이 있냐를 나타내는 수를 상관계수라고 한다. 상관계수가 <code class=\"language-text\">0</code>에 가까울 수록 두 변인은 별로 상관관계가 없는 것이고, <code class=\"language-text\">-1</code>에 가까울 수록 음(-)의 상관관계, <code class=\"language-text\">1</code>에 가까울 수록 양(+)의 상관관계가 크다고 할 수 있다.</p>\n<p>그리고 인과관계는 먼저 선행된 한 변인이 후행되는 다른 변인의 원인이라고 판명되는 관계이다.</p>\n<p>한번 “비가 많이 올 수록 한강의 수위가 올라간다”라는 명제를 보자. 사실 이러한 현상에는 다른 숨은 변수들이 더 있을 수는 있지만 대체적으로 “비가 많이 올 수록 한강의 수위가 올라간다”라는 관계에서 “비가 많이 온다”라는 변인은 “한강의 수위가 올라간다”라는 변인에 다른 변수보다 큰 영향을 끼치는 것이 거의 확실하므로 이런 경우 그냥 인과관계라고 친다.</p>\n<p>사실 인과관계와 상관관계의 구분은 생각보다 명확하게 딱 떨어지는 그런 건 아니다.</p>\n<p>“비가 많이 올 수록 한강의 수위가 올라간다”는 인과관계 이지만 “여름이 가까워질수록 한강의 수위가 올라간다”는 상관관계이다. 여름에 한강의 수위가 올라간 이유는 대한민국의 전체 강수량 중 70% 정도가 여름에 집중되어있기 때문이지 단순히 여름이라서 그런건 아니기 때문이다.</p>\n<p>비즈니스에서 대부분의 변인 관계는 대부분 상관관계이기 때문에 항상 숨겨진 다른 변수가 없는 지 생각해야하고 이 결과가 진짜 믿을 만한 결과인지 끊임없이 의심하는 태도를 가져야한다.</p>\n<h4 id=\"잘못된-결정의-예시\" style=\"position:relative;\">잘못된 결정의 예시<a href=\"#%EC%9E%98%EB%AA%BB%EB%90%9C-%EA%B2%B0%EC%A0%95%EC%9D%98-%EC%98%88%EC%8B%9C\" aria-label=\"잘못된 결정의 예시 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>데이터를 맹신하면 어떻게 되는지에 대한 이해를 돕기 위해 데이터의 위험성을 설명할 때의 대표적인 예시인 두 가지 사례를 이야기해보겠다.</p>\n<blockquote>\n<p>한 연구자가 아이스크림 판매량의 연중 증감 추이를 확인하고 있었다. 그리고 연중 익사 사망자의 증감 추이를 함께 놓고 두 데이터 간의 상관분석을 해 보았다.</p>\n<p>결과는 놀라웠다.</p>\n<p>무서울 정도로 명백한 상관관계가 나타나고 있었다. 아이스크림 판매량이 증가하는 동안, 익사 사망자 수도 함께 증가하고 있었으며, 아이스크림 판매량이 감소하는 동안 익사 사망자 수도 감소하고 있었던 것이었다.</p>\n<p>연구자는 몸서리를 치면서 다음과 같은 결론을 내렸다.</p>\n<p><strong>“익사 사망자의 증감은 아이스크림이 그 원인이다.”</strong></p>\n</blockquote>\n<p>이 예시에서 연구자는 “아이스크림이 많이 팔릴 수록 물에 빠져죽는 사람도 많다”라고 얘기하고 있다. 터무니없는 소리 같지만 실제로 아이스크림 판매량 증감과 익사자 수 증감은 어느 정도 일치한다.</p>\n<p>여기서 숨겨진 변수는 바로 기온이다. 여름이 되서 더워지면 아이스크림 판매량이 증가하고, 피서철이라서 바닷가나 계곡에 놀러가는 사람들이 많이지기 때문에 사고로 인한 익사자 수도 증가하는 것이다.</p>\n<p>만약 여기서 숨겨진 변수인 기온을 파악하지 못했다면 이런 의사결정을 내릴 수도 있겠다.</p>\n<blockquote>\n<p>익사자 수를 줄이기 위해서 아이스크림 판매를 금지한다.</p>\n</blockquote>\n<p>자, 이제 두번째 예시를 한번 보자. 이 예시는 TED 2017에서 발표한 수학자이자 데이터 과학자인 Cathy O’Neil님께서 <a href=\"https://www.ted.com/talks/cathy_o_neil_the_era_of_blind_faith_in_big_data_must_end?language=ko\" target=\"_blank\" rel=\"nofollow\">발표한 내용</a>에서 가져온 것이다. 필자는 개인적으로 이 강연, 엄청 재밌게 들었다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1ea81507ac3c4c37b9404183bbc6bf60/9ecec/oNeil.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAHCtIkioAr/xAAZEAEAAgMAAAAAAAAAAAAAAAABAAIDEDL/2gAIAQEAAQUCmSoUleVTX//EABYRAQEBAAAAAAAAAAAAAAAAAAEQIf/aAAgBAwEBPwFdn//EABYRAQEBAAAAAAAAAAAAAAAAAAEQIf/aAAgBAgEBPwEMn//EABgQAAIDAAAAAAAAAAAAAAAAABARAAIh/9oACAEBAAY/ApVJnB//xAAaEAACAwEBAAAAAAAAAAAAAAABEQAQIUFx/9oACAEBAAE/IQHgnEYyqLXsO6r/2gAMAwEAAgADAAAAEOQf/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8QQBP/xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QB1P/xAAbEAEAAwEAAwAAAAAAAAAAAAABABEhYTFRkf/aAAgBAQABPxB2Baw4FmkKce8lRCjGu1v2IFBqvcfM/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"oNeil\" title=\"\" src=\"/static/1ea81507ac3c4c37b9404183bbc6bf60/c08c5/oNeil.jpg\" srcset=\"/static/1ea81507ac3c4c37b9404183bbc6bf60/0913d/oNeil.jpg 160w,\n/static/1ea81507ac3c4c37b9404183bbc6bf60/cb69c/oNeil.jpg 320w,\n/static/1ea81507ac3c4c37b9404183bbc6bf60/c08c5/oNeil.jpg 640w,\n/static/1ea81507ac3c4c37b9404183bbc6bf60/6a068/oNeil.jpg 960w,\n/static/1ea81507ac3c4c37b9404183bbc6bf60/9ecec/oNeil.jpg 1050w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>TED에서 발표 중인 스웩넘치는 캐시 누나</small>\n</center>\n<blockquote>\n<p>1996년에 설립된 폭스 뉴스사는 고용 절차를 효율적으로 진행하기 위해 머신러닝 알고리즘을 도입하기로 했습니다.</p>\n<p>학습에 필요한 데이터셋은 지난 21년간 폭스 뉴스에 지원한 지원자들의 데이터를 사용하면 되겠네요.<br />\n그리고 회사에서 성공적인 역할을 할 수 있는 사람을 가려내기 위해서 <strong>성공</strong>에 대한 정의도 해야겠군요. <br />\n음, 폭스 뉴스에서 4년 정도 근무하면서 적어도 한 번쯤 승진한 사람 정도면 성공했다고 할 수 있겠네요.</p>\n<p>자, 이제 이 알고리즘을 현재의 지원자들에게 적용하면 어떻게 될까요?</p>\n<p><strong>여성 지원자는 절대 합격하지 못할 겁니다.</strong></p>\n</blockquote>\n<p>필자는 개인적으로 이 예시를 듣고 굉장히 충격받았다. 처음 저 이야기를 시작할 때 지난 21년간 폭스 뉴스에 지원한 지원자들의 데이터와 폭스 뉴스에서 4년 정도 근무하면서 적어도 한 번쯤 승진한 사람이라는 정의를 들었을 땐 꽤 공평하고 객관적인 지표라고 생각했기 때문이다.</p>\n<p>하지만 우리 사회에서 성별에 전혀 관계없이 능력만 보고 직원을 고용하게 된 것은 생각보다 그렇게 오래 되지 않았기 때문에 위에서 정의한 규칙대로라면 폭스 뉴스에서 성공한 사람의 절대적인 양 또한 남성이 더 많을 수 밖에 없는 것이다. 게다가 폭스 뉴스는 보수적인 언론사이기 때문에 더더욱 그런 편향이 나타날 것이다.</p>\n<p>이 예시에서는 숨겨진 변수로 사회적 분위기가 있던 것이다.</p>\n<p>이렇게 아무리 객관적이라고 생각했던 지표라고 할지라도 “왜 이런 결과가 나왔지?”를 고민하지 않고 의사결정한다면 현실과 전혀 동떨어진 의사결정을 할 수도 있게 된다.</p>\n<h3 id=\"정성적인-데이터를-무시하지-말자\" style=\"position:relative;\">정성적인 데이터를 무시하지 말자<a href=\"#%EC%A0%95%EC%84%B1%EC%A0%81%EC%9D%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%EB%AC%B4%EC%8B%9C%ED%95%98%EC%A7%80-%EB%A7%90%EC%9E%90\" aria-label=\"정성적인 데이터를 무시하지 말자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>대부분의 조직에서 데이터 기반 의사결정을 할 때, 정성적인 데이터보다는 정량적인 데이터에 집중한다.</p>\n<p>그 이유는 정량적인 데이터가 수집, 비교, 가공 등 정보를 뽑아내는 데이터 마이닝 작업하기가 더 쉽기 때문이다. 반면에 정성적인 데이터를 제대로 수집하려면 유저 테스트, 설문 조사 등 조금 더 공을 들이는 방법을 사용해야 한다.</p>\n<p>또한 수집한 데이터도 숫자가 아닌 자연어인 경우가 많기 때문에 이를 분석하는 것 역시 쉬운 작업이 아니다.</p>\n<p>이런 이유로 정성적인 데이터가 자주 우선순위에서 밀리는 모습을 많이 봐왔는데, 딱히 좋은 태도는 아니다. 왜냐면 정량적인 데이터는 현상을 설명해주지만 정성적인 데이터는 이유를 설명해주기 때문이다.</p>\n<p>예를 들면 둘의 차이는 이런 것이다.</p>\n<blockquote>\n<p>사용자들이 우리의 검색 시스템을 사용한 후 결제를 하는 전환률이 30% 상승했다. (정량적인 데이터)</p>\n<p>설문 조사 결과 사람들은 검색을 해서 자신들에게 더 맞는 상품을 스스로 찾았기 때문이라고 대답했다. (정성적인 데이터)</p>\n</blockquote>\n<p>물론 위의 정성적인 데이터로 든 예시도 정량적인 수치로 변경할 수는 있다. 설문지에 자유롭게 대답할 수 있는 빈 칸이 아니라, 오지선다형으로 답변을 고르도록 하면 정량화할 수 있다.</p>\n<p>그러나 그렇게 하면 결국 답변에 없는 이유는 수집할 수 없기 때문에 결국 “기타(아무거나 적으세요)“라는 칸을 하나씩은 만든다. 그렇다면 기타에 적힌 내용들은 정성적인 데이터가 되는 것이다.</p>\n<p>그냥 단순히 생각해도 기타 란에는 사람들이 직접 하나하나 적은 자연어가 들어갈 것이기 때문에 이걸 또 분류하고 분석하는 작업은 아마 인공지능, 인간지능 둘 중에 하나를 갈아넣어야 할 수 있을 것이다.</p>\n<p>그렇기 때문에 보통 기업들은 좀 더 취급하기 쉬운 정량적인 데이터에 좀 더 집중하고 정성적인 데이터는 보조적인 용도로 많이 활용한다.</p>\n<p>하지만 고객들이 진짜 무엇을 원하는지, 그들의 목소리를 들어보고자 하는 기업이라면 리소스가 많이 투입되더라도 지속적으로 고객들에게 설문조사나 유저 테스트를 통해 정성적인 데이터를 많이 수집하려고 노력한다.</p>\n<p>필자의 직장은 리소스가 부족해서 자주 하지는 못하지만 그래도 큰 기능을 배포할 때는 UI/UX 디자이너들이 선별한 페르소나에 맞는 사용자들을 회사로 초청해서 유저 테스트를 진행하고 있다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>필자는 데이터 기반 의사결정은 양날의 검이라고 생각한다. 잘 사용하면 위에서 설명한 장점대로 적은 리스크에 성과 측정도 명확하고 복잡한 문제도 추상화할 수 있는 좋은 도구이지만 잘못 사용하면 뭐가 잘못되고 있는지도 모른채 계속 숫자만 믿고 잘못된 결정을 하게 될 위험도 크기 때문이다.</p>\n<p>또한 기대와 성과가 명확하다는 장점은 반대로 단점이 될 수도 있다. 위에서 계속 말했듯이 결국 데이터 자체는 그냥 값이기 때문에 뽑아낸 결과에는 최종적으로 사람의 주관이 들어갈 수 밖에 없다. 그 말인 즉슨, 뽑고 싶은 결과를 미리 정해놓고 거기에 데이터를 어떻게든 끼워맞춰도 그럴싸한 결과를 만들어 낼 수 있다는 말이다.</p>\n<p>이런 점들은 진짜 고객을 위한 서비스를 만드는 방향이 아닌 회사에서 중요하다고 생각하는 지표만 높히는 방향으로 의사결정을 하거나, 실제로 고객들은 불편함을 느껴서 전환률이 떨어지더라도 자신이 원하는 결과가 나올때까지 변인을 조작하여 결국은 원하는 결과를 뽑아내는 등의 윗 사람들에게 인정받기 위한 정치적인 목적으로 사용되기 쉽다.</p>\n<blockquote>\n<p>이런 행위들은 데이터 기반 의사결정이 아닌, 데이터 기반 의사결정의 탈을 쓴 숫자놀이에 불과하다.</p>\n</blockquote>\n<p>그렇기 때문에 항상 데이터를 기반으로 의사결정을 할때는 자신이 객관적이고 공정한 결론을 내렸는지, 혹은 이 데이터가 정말 오염되지 않았고 유의미한 결과를 가져다 줄 수 있는 데이터인지, 원하는 대로 결과가 나왔다면 왜 이런 결과가 나오게 되었는지 자기 자신에게 끊임없이 되물으며 비판적인 사고를 유지해야한다.</p>\n<p>이상으로 데이터 기반 의사결정, 과연 완벽한 걸까? 포스팅을 마친다.</p>","fields":{"slug":"20190704-danger-of-data-driven","path":"/2019/07/04/danger-of-data-driven/","lang":"ko"},"frontmatter":{"title":"데이터 기반 의사결정, 과연 완벽한 걸까?","subTitle":"숫자 뒤에 숨겨진 함정, 데이터에 속지 않는 법","date":"Jul 04, 2019","categories":["소프트스킬","에세이"],"tags":["Data Driven","Data Driven Decision","데이터 기반 의사결정","비판적 사고","Data Analysis","데이터 분석","TED 데이터드리븐"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/62d8b411322961c62d1d801e6d053f62/3a812/thumbnail.jpg","srcSet":"/static/62d8b411322961c62d1d801e6d053f62/3a812/thumbnail.jpg 320w,\n/static/62d8b411322961c62d1d801e6d053f62/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/62d8b411322961c62d1d801e6d053f62/fc5c5/thumbnail.webp 320w,\n/static/62d8b411322961c62d1d801e6d053f62/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/62d8b411322961c62d1d801e6d053f62/2d839/thumbnail.jpg","srcSet":"/static/62d8b411322961c62d1d801e6d053f62/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/62d8b411322961c62d1d801e6d053f62/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}}],"pageInfo":{"currentPage":6,"pageCount":8}}},"pageContext":{"limit":15,"skip":75,"lang":"ko","totalCount":111}},"staticQueryHashes":["3523904809","650499039"],"slicesMap":{}}