{"componentChunkName":"component---src-templates-posts-page-template-index-tsx","path":"/page/8/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"id":"386bf9f9-3691-5002-818f-bc32442320c6","tableOfContents":"<ul>\n<li>\n<p><a href=\"#express-checkout%EC%9D%B4%EB%9E%80\">Express Checkout이란?</a></p>\n<ul>\n<li><a href=\"#paypal-standard\">Paypal Standard</a></li>\n<li><a href=\"#express-checkout\">Express Checkout</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#express-checkout%EC%9D%98-%ED%9D%90%EB%A6%84\">Express Checkout의 흐름</a></p>\n</li>\n<li>\n<p><a href=\"#client%EB%A7%8C%EC%9C%BC%EB%A1%9C-%EC%A7%84%ED%96%89%ED%95%98%EA%B8%B0\">Client만으로 진행하기</a></p>\n</li>\n<li>\n<p><a href=\"#client%EC%99%80-server%EC%9D%98-%ED%86%B5%EC%8B%A0%EC%9C%BC%EB%A1%9C-%EC%A7%84%ED%96%89%ED%95%98%EA%B8%B0\">Client와 Server의 통신으로 진행하기</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%8B%A4%ED%96%89%EA%B2%B0%EA%B3%BC\">실행결과</a></p>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 Paypal의 RESTful API인 Express Checkout을 사용하는 방법에 대해서 포스팅 하려고 한다. 진행하기에 앞서 먼저, 페이팔 샌드박스 홈페이지에 접속해서 sandbox용 계정을 만들어야 한다. 이 계정으로 테스트를 진행하고 실제 운영 계정은 페이팔 홈페이지에서 회원가입하면 된다. Express Checkout이란? Paypal에서 제공해주는 결제 플로우 방식 중 하나이며, 유저가 “페이팔로 구매하기” 버튼을 클릭했을 때 페이팔 로그인 Modal window가 렌더되고, 이를 통해 결제를 진행하…","html":"<p>이번 포스팅에서는 Paypal의 RESTful API인 Express Checkout을 사용하는 방법에 대해서 포스팅 하려고 한다. 진행하기에 앞서 먼저, <a href=\"https://www.sandbox.paypal.com/\" target=\"_blank\" rel=\"nofollow\">페이팔 샌드박스 홈페이지</a>에 접속해서 sandbox용 계정을 만들어야 한다.</p>\n<p>이 계정으로 테스트를 진행하고 실제 운영 계정은 <a href=\"https://www.paypal.com/kr/home\" target=\"_blank\" rel=\"nofollow\">페이팔 홈페이지</a>에서 회원가입하면 된다.</p>\n<h2 id=\"express-checkout이란\" style=\"position:relative;\">Express Checkout이란?<a href=\"#express-checkout%EC%9D%B4%EB%9E%80\" aria-label=\"express checkout이란 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Paypal에서 제공해주는 결제 플로우 방식 중 하나이며, 유저가 “페이팔로 구매하기” 버튼을 클릭했을 때 페이팔 로그인 Modal window가 렌더되고, 이를 통해 결제를 진행하는 플로우이다.\n모든 국가를 지원하며, 브라우저 지원은 다음과 같다.</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Internet Explorer</th>\n<th align=\"center\">Chrome</th>\n<th align=\"center\">Mozila Firefox</th>\n<th align=\"center\">Safari</th>\n<th align=\"center\">Opera</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">v9~</td>\n<td align=\"center\">v27~</td>\n<td align=\"center\">v30~</td>\n<td align=\"center\">v5.1~</td>\n<td align=\"center\">v23~</td>\n</tr>\n</tbody>\n</table>\n<p>Paypal에서는 총 3가지의 결제플로우를 제공하고 있으며, 한국에서는 이 중 All countries로 제공되는 다음 2가지 방식 중 선택이 가능하다.</p>\n<h3 id=\"paypal-standard\" style=\"position:relative;\">Paypal Standard<a href=\"#paypal-standard\" aria-label=\"paypal standard permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Paypal에서 제공해주는 HTML코드를 기반으로 생성된 버튼을 웹 클라이언트 소스에 직접 삽입하는 방식이다.\nPaypal사이트에서 직접 상품 이름, 상품 ID, 가격 등을 입력하면 그에 맞는 버튼의 코드를 자동으로 생성해준다. 이후 그 코드를 클라이언트 소스에 삽입하면 된다.</p>\n<h3 id=\"express-checkout\" style=\"position:relative;\">Express Checkout<a href=\"#express-checkout\" aria-label=\"express checkout permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Paypal의 JavaScript SDK인 checkout.js를 사용하여 버튼을 동적으로 렌더하는 방식이다.\n상품 데이터를 본인 서비스의 서버로 전달한 후 Server to Server방식으로 Paypal서버에서 인증을 받는 방식으로 진행된다. 필자는 이 방법을 선택하였다.</p>\n<h2 id=\"express-checkout의-흐름\" style=\"position:relative;\">Express Checkout의 흐름<a href=\"#express-checkout%EC%9D%98-%ED%9D%90%EB%A6%84\" aria-label=\"express checkout의 흐름 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<blockquote>\n<p>이 섹션은 Paypal Developer 페이지의 <a href=\"https://developer.paypal.com/docs/orders-integration-guide/?mark=express%20checkout#\" target=\"_blank\" rel=\"nofollow\">Express Checkout</a>항목을 참고하여 작성하였다.</p>\n</blockquote>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/89c08c41f83f1354f7b221c51a4d2dcc/01dae/flow.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 19.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5UlEQVR42lWNTU+DQBiE+f8/xysn9aAXJWlso5QIhV0KpYHly93l6xEajfFJ5jAzed9xwuDIKfCRUqCqipcg4f49wU/OtKpkH0kejim7T0FTK4QQhGFIkiSUZcklz0mzC7FI177GefZj7nYR8pzdgii/8nZKycuaRlXIa8XrR0iUFXRdx+FwwHVdPM+jUuo2sk9bRKEwusdp9UDRGewwskwjstY8yYZGW1j91j3GFWmjWeYJbQxFUdC2LdM0Ya2l73uM0YzjhDPPM+OwHv+wLAtfWv/5VduTLf9lGIZ/3lrDvI5tfAP9sC7SOWTQKwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"express-checkout-flow\" title=\"\" src=\"/static/89c08c41f83f1354f7b221c51a4d2dcc/6af66/flow.png\" srcset=\"/static/89c08c41f83f1354f7b221c51a4d2dcc/69538/flow.png 160w,\n/static/89c08c41f83f1354f7b221c51a4d2dcc/72799/flow.png 320w,\n/static/89c08c41f83f1354f7b221c51a4d2dcc/6af66/flow.png 640w,\n/static/89c08c41f83f1354f7b221c51a4d2dcc/01dae/flow.png 721w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Express Checkout의 전체 플로우</small>\n</center>\n<p>쉽게 생각하면 Facebook이나 Instagram계정으로 로그인하는 플로우와 UX가 비슷하다고 보면 된다.</p>\n<p>유저가 구매버튼을 클릭하면 데스크탑에서는 팝업, 모바일에서는 새 탭의 형태로 페이팔 로그인 창이 열리고, 유저는 그 창에서 인증과 결제를 순차적으로 진행하게 된다.</p>\n<p>이후 모든 플로우가 끝나면 유저는 결제 진행 결과에 따라 페이팔에 <code class=\"language-text\">redirect_url</code>파라미터로 보내졌던 URL로 이동을 하게되며 최종적으로 성공, 실패, 취소에 따른 페이지와 결제 정보 결과를 보게 된다.\nPaypal서버와 통신하는 방법으로는 <code class=\"language-text\">RESTful API</code>와 <code class=\"language-text\">NVP/SOAP API</code>로 2가지 방법이 있으나 본 문서에서는 <code class=\"language-text\">RESTful API</code>만 기술하겠다.</p>\n<p>Paypal Express Checkout의 플로우는 다음과 같다.</p>\n<hr>\n<ol>\n<li>유저가 구매버튼을 클릭</li>\n</ol>\n<ul>\n<li>Express Checkout의 client SDK인 <code class=\"language-text\">checkout.js</code>를 통해 로그인 모달창이 열리거나 API서버가 Paypal API를 호출하여 <code class=\"language-text\">payment</code>이벤트를 초기화한다.</li>\n<li><code class=\"language-text\">payment</code> 이벤트 초기화 후, Express Checkout 플로우가 모달창 내부에서 시작된다.</li>\n</ul>\n<ol start=\"2\">\n<li>유저가 페이팔 로그인을 진행</li>\n<li>유저가 결제 정보를 확인 후 <code class=\"language-text\">Contunue</code> 버튼을 클릭</li>\n<li>유저가 <code class=\"language-text\">Continue</code> 버튼을 클릭하면 다시 서비스의 리다이렉트페이지로 이동하며 최종 결제 정보가 표시된다.</li>\n</ol>\n<p>결제 정보를 생성할 때 보냈던 상품 정보 파라미터는 이 단계에서 노출시키는 것이 좋다.\n5. 최종적으로 <code class=\"language-text\">execute</code> API가 호출되고 결제가 마무리된다. 그리고 사용자는 서비스 상의 결제완료 페이지로 리다이렉트된다.</p>\n<hr>\n<h2 id=\"client만으로-진행하기\" style=\"position:relative;\">Client만으로 진행하기<a href=\"#client%EB%A7%8C%EC%9C%BC%EB%A1%9C-%EC%A7%84%ED%96%89%ED%95%98%EA%B8%B0\" aria-label=\"client만으로 진행하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<blockquote>\n<p>Paypal 공식문서에서는 Express Checkout과의 버전 호환성을 최대한 보장하기 위해 CDN을 이용한 동적로딩을 추천하고 있다. 직접 <code class=\"language-text\">checkout.js</code>파일을 다운받아 클라이언트 소스에 넣는 것은 추천하지 않는다.</p>\n</blockquote>\n<blockquote>\n<p>이 문서에서의 <code class=\"language-text\">checkout.js</code>의 버전은 <code class=\"language-text\">4.0</code>으로 진행한다.</p>\n</blockquote>\n<p>지금 작성하는 플로우는 필자 서비스의 API서버를 통하지 않고 <code class=\"language-text\">checkout.js</code>를 이용하여 바로 페이팔 서버로부터 인증과 결제까지 한번에 마치는 방법이다.</p>\n<p>클라이언트에서는 데이터를 정의하고 <code class=\"language-text\">checkout.js</code>를 사용하여 Paypal결제 버튼을 렌더한다. 이 버튼을 클릭하면 <code class=\"language-text\">checkout.js</code>의 내장 메소드를 호출하여 자동으로 인증과 결제토큰생성, 결제 완료까지 한큐에 진행하게 된다.</p>\n<p>먼저, <code class=\"language-text\">checkout.js</code> SDK의 동적로딩을 위해 <code class=\"language-text\">index.html</code>파일에 <code class=\"language-text\">script</code>태그를 열고 다음 스크립트를 작성하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> _DOM <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'script'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  _DOM<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span> <span class=\"token string\">'https://www.paypalobjects.com/api/checkout.js'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> element <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'script'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  element<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span><span class=\"token function\">insertBefore</span><span class=\"token punctuation\">(</span>_DOM<span class=\"token punctuation\">,</span> element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이후 Paypal버튼을 DOM을 작성해주고 <code class=\"language-text\">checkout.js</code>를 사용해 버튼을 렌더한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pay-test-btn<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Test to payment<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">paypal<span class=\"token punctuation\">.</span>Button<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">env</span><span class=\"token operator\">:</span> <span class=\"token string\">'sandbox'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 테스트용은 'sandbox'를, 운영은 'production'을 입력</span>\n  <span class=\"token literal-property property\">client</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">sandbox</span><span class=\"token operator\">:</span> <span class=\"token string\">'paypal-sandbox-key'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// paypal에서 발급 받은 client_key를 입력</span>\n    <span class=\"token literal-property property\">production</span><span class=\"token operator\">:</span> <span class=\"token string\">'paypal-production-key'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">payment</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> env <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> paypal<span class=\"token punctuation\">.</span>rest<span class=\"token punctuation\">.</span>payment<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>env<span class=\"token punctuation\">,</span> client<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">transactions</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">total</span><span class=\"token operator\">:</span> <span class=\"token string\">'10.00'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">currency</span><span class=\"token operator\">:</span> <span class=\"token string\">'USD'</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">commit</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// false일 시 모달의 마지막 버튼의 문구가 Continue로 변하고 바로 결제가 진행되는 것이 아니라 리다이렉트 페이지로 이동한다.</span>\n  <span class=\"token comment\">// true일 시 Pay Now로 변하고 바로 결제가 진행된다</span>\n  <span class=\"token function-variable function\">onAuthorize</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data<span class=\"token punctuation\">,</span> actions</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> actions<span class=\"token punctuation\">.</span>payment<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 결제 성공 시 콜백파라미터인 res에 데이터가 담겨온다</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#pay-test-btn'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>그러면 아래와 같이  아까 작성한 <code class=\"language-text\">#pay-test-btn</code> DOM엘리먼트에 자동으로 Paypal버튼이 렌더된다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 234px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/5f4924c16a7d079417dcd1d09fe3ad50/a63a1/paypal-button.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 71.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHaVppYBf/EABoQAQEAAgMAAAAAAAAAAAAAAAECAAMQERL/2gAIAQEAAQUCXoKHhPROuZc//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAEQETH/2gAIAQEABj8COzGalP/EABkQAQACAwAAAAAAAAAAAAAAAAEAEBEhMf/aAAgBAQABPyEMjyL4NqNeDNMTX//aAAwDAQACAAMAAAAQ1A//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEBAAMBAAAAAAAAAAAAAAABEQAQMSH/2gAIAQEAAT8QZPB1w6ZXAdFHfJLMBsES3X//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"paypal-button\" title=\"\" src=\"/static/5f4924c16a7d079417dcd1d09fe3ad50/a63a1/paypal-button.jpg\" srcset=\"/static/5f4924c16a7d079417dcd1d09fe3ad50/0913d/paypal-button.jpg 160w,\n/static/5f4924c16a7d079417dcd1d09fe3ad50/a63a1/paypal-button.jpg 234w\" sizes=\"(max-width: 234px) 100vw, 234px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>버튼 모양이 조금 이상해졌지만 신경쓰지 말자...</small>\n</center>\n<p>정상적으로 버튼이 렌더되었다면 이제 테스트 결제를 진행해보자. 저 버튼을 클릭하면 아래와 같은 창이 하나 뜰 것이다. 이 창은 사용자의 이용환경이 데스크탑이냐, 모바일이냐에 따라 팝업창, iframe또는 새 탭으로 열릴 수 있다.</p>\n<p>이 창을 Paypal에서는 Light window라고 부르지만 이 포스팅에서는 편의상 그냥 “로그인 모달”이라고 하겠다. 이 후 사용자는 로그인 모달의 안내에 따라 결제를 진행하게 되고, 최종 결제가 완료되면 <code class=\"language-text\">onAuthorize</code>메소드에 있는 Promise Callback함수의 <code class=\"language-text\">res</code> 파라미터로 결과값을 전달받게 된다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 252px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/6ec0fda48bf17da3be915e442d513bee/112e4/light-window.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAFNcDkmMF//xAAaEAACAgMAAAAAAAAAAAAAAAACAxAUAAES/9oACAEBAAEFAlL73WGAMgyw2P/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABwQAAAGAwAAAAAAAAAAAAAAAAABAhARMiIxkv/aAAgBAQAGPwLcC6uWxOBc2//EABkQAQEBAAMAAAAAAAAAAAAAAAERABAh8f/aAAgBAQABPyEmFQXou9jkjlKieAXf/9oADAMBAAIAAwAAABDPz//EABURAQEAAAAAAAAAAAAAAAAAABAh/9oACAEDAQE/EKf/xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QEX//xAAcEAEAAgIDAQAAAAAAAAAAAAABABEhUTFB0fH/2gAIAQEAAT8QH9ZDvnRLUDIwNTTUVnSlKyT5R5FVXuf/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"light-window\" title=\"\" src=\"/static/6ec0fda48bf17da3be915e442d513bee/112e4/light-window.jpg\" srcset=\"/static/6ec0fda48bf17da3be915e442d513bee/0913d/light-window.jpg 160w,\n/static/6ec0fda48bf17da3be915e442d513bee/112e4/light-window.jpg 252w\" sizes=\"(max-width: 252px) 100vw, 252px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<h2 id=\"client와-server의-통신으로-진행하기\" style=\"position:relative;\">Client와 Server의 통신으로 진행하기<a href=\"#client%EC%99%80-server%EC%9D%98-%ED%86%B5%EC%8B%A0%EC%9C%BC%EB%A1%9C-%EC%A7%84%ED%96%89%ED%95%98%EA%B8%B0\" aria-label=\"client와 server의 통신으로 진행하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>이 플로우는 Paypal에서 발급해주는 <code class=\"language-text\">client_key</code>와 <code class=\"language-text\">secret</code>을 이용하여 페이팔 인증부터 차례대로 진행하는 방법이다.</p>\n<p>이 방법의 장점으로는 본인의 서비스의 UX플로우를 최대한 지키며 결제를 진행시킬 수 있고, 첫번째 방법보다 플로우가 유연하며 버튼 디자인또한 css로 커스터마이징이 자유롭다.</p>\n<p>그런 이유로 Paypal에서도 이 방법을 권장하고 있다. 결제플로우는 크게 3가지 단계로 나눠진다.</p>\n<hr>\n<ol>\n<li><code class=\"language-text\">client_key</code>와 <code class=\"language-text\">secret</code>을 사용하여 페이팔 서버로부터 액세스토큰을 받는 인증 과정</li>\n<li>결제를 <code class=\"language-text\">create</code>하는 과정</li>\n<li>결제를 <code class=\"language-text\">execute</code>하는 과정</li>\n</ol>\n<hr>\n<p>먼저 클라이언트는 버튼을 렌더하고 본 서비스의 API를 통해 <code class=\"language-text\">create</code>요청을 보내야한다. 이때 전 플로우와의 차이점은 딱히 <code class=\"language-text\">checkout.js</code>를 사용하지않아도 딱히 상관이 없다는 점이다. 먼저 버튼을 렌더한다. 참고로 필자는 <code class=\"language-text\">AngularJS</code>와 <code class=\"language-text\">md-material</code>을 사용하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">layout</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>row<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">layout-align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>center center<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">layout</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>column<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>md-button</span> <span class=\"token attr-name\">md-color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{background: 'blue-grey'}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">ng-click</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>vm.postData()<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      TEST\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>md-button</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이후 Paypal 결제를 다른 페이지에서 사용하게 될때 중복로직을 작성해야하므로 따로 팩토리를 정의했다. 따로 팩토리를 정의하지 않고 컨트롤러 내부에 구현해도 상관은 없다. 이 팩토리에서는 필자의 API서버와 통신을 한 후 <code class=\"language-text\">Promise</code>를 사용하여 다시 컨트롤러로 값을 전달한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'use strict'</span><span class=\"token punctuation\">;</span>\n\n  angular\n    <span class=\"token punctuation\">.</span><span class=\"token function\">module</span><span class=\"token punctuation\">(</span><span class=\"token string\">'services'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">factory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'PaypalService'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">'$rootScope'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Restangular'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SNS_KEYS'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'$q'</span><span class=\"token punctuation\">,</span>\n      PaypalService\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">PaypalService</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">$rootScope<span class=\"token punctuation\">,</span> Restangular<span class=\"token punctuation\">,</span> <span class=\"token constant\">SNS_KEYS</span><span class=\"token punctuation\">,</span> $q</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">//페이팔에서 발급해준 키를 전역으로 사용하기 위해 app.constants에 미리 담아놓았다.</span>\n      <span class=\"token keyword\">var</span> clientKey <span class=\"token operator\">=</span> <span class=\"token constant\">SNS_KEYS</span><span class=\"token punctuation\">.</span>paypal<span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">/**\n        * @public\n        * @name create\n        * @description create paypal payment request\n        * @param { Object } data\n        * @return { Promise }\n        */</span>\n      <span class=\"token keyword\">function</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> defer <span class=\"token operator\">=</span> $q<span class=\"token punctuation\">.</span><span class=\"token function\">defer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        data<span class=\"token punctuation\">.</span>clientKey <span class=\"token operator\">=</span> clientKey<span class=\"token punctuation\">;</span>\n        data<span class=\"token punctuation\">.</span>redirect_urls <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">return_url</span><span class=\"token operator\">:</span> location<span class=\"token punctuation\">.</span>origin <span class=\"token operator\">+</span> <span class=\"token string\">'/paypal/result'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 결제가 완료되었을 때 리다이렉트될 페이지</span>\n          <span class=\"token literal-property property\">cancel_url</span><span class=\"token operator\">:</span> location<span class=\"token punctuation\">.</span>origin <span class=\"token operator\">+</span> <span class=\"token string\">'/paypal/result'</span> <span class=\"token comment\">// 결제가 취소되었을 때 리다이렉트 될 페이지, return_url과 같아도 상관없다</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// API서버의 API endpoint</span>\n        Restangular<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token string\">'paypal/payments/create'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">customPOST</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/json'</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          defer<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          defer<span class=\"token punctuation\">.</span><span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> defer<span class=\"token punctuation\">.</span>promise<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">/**\n        * @name execute\n        * @description execute paypal payment\n        * @param { Object } data\n        * @return { Promise}\n        */</span>\n      <span class=\"token keyword\">function</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> defer <span class=\"token operator\">=</span> $q<span class=\"token punctuation\">.</span><span class=\"token function\">defer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// API서버의 API endpoint</span>\n        Restangular<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/paypal/payments/execute'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">customPOST</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/json'</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          defer<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          defer<span class=\"token punctuation\">.</span><span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> defer<span class=\"token punctuation\">.</span>promise<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">/**\n        * @name getPaymentInfo\n        * @description getting created paypal payment information\n        * @param { Object } data\n        * @return { Promise }\n        */</span>\n      <span class=\"token keyword\">function</span> <span class=\"token function\">getPaymentInfo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> defer <span class=\"token operator\">=</span> $q<span class=\"token punctuation\">.</span><span class=\"token function\">defer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// API서버의 API endpoint</span>\n        Restangular<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/paypal/payments/detail'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">customGET</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          defer<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          defer<span class=\"token punctuation\">.</span><span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">create</span><span class=\"token operator\">:</span> create<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">execute</span><span class=\"token operator\">:</span> execute<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">getPaymentInfo</span><span class=\"token operator\">:</span> getPaymentInfo\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이후 버튼을 렌더한 html파일에 물려있는 Controller에서 위에서 정의한 Paypal 서비스를 호출한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'use strict'</span><span class=\"token punctuation\">;</span>\n\n  angular\n    <span class=\"token punctuation\">.</span><span class=\"token function\">module</span><span class=\"token punctuation\">(</span><span class=\"token string\">'app'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">controller</span><span class=\"token punctuation\">(</span><span class=\"token string\">'PaypalCreateController'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">'$rootScope'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'$scope'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PaypalService'</span><span class=\"token punctuation\">,</span>\n      PaypalCreateController\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">PaypalCreateController</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> vm <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">//테스트를 위한 더미데이터를 정의한다. 실서비스에는 이 데이터들이 폼에 바인딩 될 것이다.</span>\n      vm<span class=\"token punctuation\">.</span>paymentData <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">transactions</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">total</span><span class=\"token operator\">:</span> <span class=\"token string\">'1.00'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">currency</span><span class=\"token operator\">:</span> <span class=\"token string\">'USD'</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> <span class=\"token string\">'This is the description'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">item_list</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">items</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n              <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> <span class=\"token string\">'This is test product'</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">quantity</span><span class=\"token operator\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">price</span><span class=\"token operator\">:</span> <span class=\"token string\">'1.00'</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">sku</span><span class=\"token operator\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">currency</span><span class=\"token operator\">:</span> <span class=\"token string\">'USD'</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n      vm<span class=\"token punctuation\">.</span>postData <span class=\"token operator\">=</span> postData<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">function</span> <span class=\"token function\">postData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> angular<span class=\"token punctuation\">.</span><span class=\"token function\">copy</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">.</span>paymentData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// Deep Copy를 하는 이유는 데이터를 전송하기전에 변조해야할 경우가 생길 수 있기 때문이며</span>\n        <span class=\"token comment\">// Object타입은 기본적으로 Call by reference이기때문에 여기서 변조를 해버리면 원본 데이터도 함께 변조되기 때문이다.</span>\n        PaypalService<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// Paypal에서는 총 3개의 url을 리턴해주는데</span>\n          <span class=\"token comment\">// links[0] = 방금 생성된 결제정보의 자세한 값을 받을 수 있는 GET메소드 요청 URL</span>\n          <span class=\"token comment\">// links[1] = 생성된 결제페이지의 리다이렉트 URL</span>\n          <span class=\"token comment\">// links[2] = 결제 실행 URL</span>\n          <span class=\"token comment\">// 순으로 나열된다.</span>\n          window<span class=\"token punctuation\">.</span>location <span class=\"token operator\">=</span> res<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span>links<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이때 API서버는 클라이언트에서 보내준 값들을 가지고 Paypal서버와 통신하여 인증을 진행하는 로직을 가지고 있어야한다. 필자의 API서버는 <code class=\"language-text\">Laravel 5.x</code>로 되어있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Controllers</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">Log</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Request</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Requests</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Controllers<span class=\"token punctuation\">\\</span>Controller</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">GuzzleHttp<span class=\"token punctuation\">\\</span>Client</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">PaypalPaymentController</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Controller</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$client</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$paymentUrl</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$accessToken</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">client</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Client</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 페이팔에서 발급받은 access token값을 env에서 가져온다</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">accessToken</span> <span class=\"token operator\">=</span> <span class=\"token function\">env</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'PAYPAL_ACCESS_TOKEN_SANDBOX'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 지금은 테스트 중이라 sandbox url로 요청을 날리고있다. 본 서비스는 sandbox를 제거하고 api.paypal.com으로 날리면 된다.</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">paymentUrl</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"https://api.sandbox.paypal.com/v1/payments/payment\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">detail</span><span class=\"token punctuation\">(</span><span class=\"token class-name type-declaration\">Request</span> <span class=\"token variable\">$request</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$request</span><span class=\"token operator\">-></span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">client</span><span class=\"token operator\">-></span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">paymentUrl</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'/'</span><span class=\"token operator\">.</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'paymentId'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string single-quoted-string\">'headers'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span>\n                <span class=\"token string double-quoted-string\">\"Content-Type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"application/json\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string double-quoted-string\">\"Authorization\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">accessToken</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$decodeResult</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$response</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token function\">response</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$decodeResult</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">payment</span><span class=\"token punctuation\">(</span><span class=\"token class-name type-declaration\">Request</span> <span class=\"token variable\">$request</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">client</span><span class=\"token operator\">-></span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'POST'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">paymentUrl</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string single-quoted-string\">'headers'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span>\n                <span class=\"token string double-quoted-string\">\"Content-Type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"application.json\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string double-quoted-string\">\"Authorization\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">accessToken</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'json'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span> <span class=\"token comment\">// Paypal서버에 날릴 요청의 Body, 페이팔 공식사이트에 적혀있는 파라미터와 동일해야한다.</span>\n                <span class=\"token string double-quoted-string\">\"intent\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"sale\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string double-quoted-string\">\"redirect_urls\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$request</span><span class=\"token operator\">-></span><span class=\"token property\">redirect_urls</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string double-quoted-string\">\"payer\"</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token string double-quoted-string\">\"payment_method\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"paypal\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 한국은 paypal메소드밖에 지원이 안된다</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string double-quoted-string\">\"transactions\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$request</span><span class=\"token operator\">-></span><span class=\"token property\">transactions</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// client에서 보내준 결제 정보</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$decodeResult</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$response</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token function\">response</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$decodeResult</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token class-name type-declaration\">Request</span> <span class=\"token variable\">$request</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">client</span><span class=\"token operator\">-></span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'POST'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">paymentUrl</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'/'</span><span class=\"token operator\">.</span><span class=\"token variable\">$request</span><span class=\"token operator\">-></span><span class=\"token property\">paymentId</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'/execute'</span> <span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string single-quoted-string\">'headers'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span>\n                <span class=\"token string double-quoted-string\">\"Content-Type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"application/json\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string double-quoted-string\">\"Authorization\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">accessToken</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'json'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span>\n                <span class=\"token string double-quoted-string\">\"payer_id\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$request</span><span class=\"token operator\">-></span><span class=\"token property\">PayerID</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getBody</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$decodeResult</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$response</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token function\">response</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$decodeResult</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이제 클라이언트에서 테스트 버튼을 클릭하면 미리 필자가 정의한 API인 <code class=\"language-text\">/paypal/payment/create</code>를 통해 필자의 API 서버로 결제 데이터가 전송되고, API서버는 다시 그 데이터를 가지고 Paypal 서버와 통신 후 클라이언트로 결과를 반환해 줄 것이다. 그 후 클라이언트는 리턴된 데이터의 <code class=\"language-text\">link[1]</code>에 담긴 리다이렉트페이지를 그냥 열기만 하면 결제가 시작된다!</p>\n<p>왜 <code class=\"language-text\">link[1]</code>인지는 아래에서 다시 설명하겠다.</p>\n<p>이후 사용자는 Paypal 로그인 상태에 따라 로그인페이지 또는 결제 확인 페이지로 이동하게되며, Paypal의 결제 확인 창에서 Continue 버튼을 누르면 아까 우리가 <code class=\"language-text\">create</code> API를 통해 보내놓았던 <code class=\"language-text\">redirect_url</code>페이지로 랜딩된다.</p>\n<p>이때 Paypal은 사용자가 최종 결제 확인을 했고, 이제 결제를 시작해도 된다는 데이터를 <code class=\"language-text\">redirect_url</code>뒤에 쿼리스트링의 형태로 붙혀서 보내준다.</p>\n<p>이제 클라이언트와 서버의 기본적인 로직이 모두 준비되었다! 전체적인 플로우를 다시 설명하면 다음과 같다.</p>\n<hr>\n<ol>\n<li>클라이언트에서 API서버로 결제 생성 요청을 보낸다.</li>\n<li>API서버는 받은 데이터를 가지고 다시 Paypal서버로 결제 생성 요청을 보내고 이후 클라이언트로 값을 반환해준다.</li>\n<li>클라이언트는 반환받은 데이터에 있는 <code class=\"language-text\">redirect_url</code>로 사용자를 리다이렉트 시킨다.</li>\n<li>이후 사용자는 이동한 Paypal페이지에서 로그인 및 간략한 결제정보 확인을 마치고 <code class=\"language-text\">Continue</code> 버튼을 클릭한다.</li>\n<li><code class=\"language-text\">Continue</code> 버튼이 클릭되면 Paypal은 결제 생성 요청에 담겨있던 <code class=\"language-text\">redirect_url</code>로 사용자를 리다이렉트 시킨다.</li>\n<li>이후 사용자는 리다이렉트된 페이지에서 최종 결제전 상세 결제 정보를 확인한다.</li>\n<li>사용자가 “최종결제”버튼을 클릭하면 클라이언트는 결제 실행 요청을 API서버로 보낸다.</li>\n<li>API서버는 다시 Paypal서버로 이 요청을 전달하고, 클라이언트로 값을 반환해준다.</li>\n<li>결제의 실행결과에 따라 사용자는 해당 페이지로 다시 리다이렉트된다.</li>\n</ol>\n<hr>\n<p>뭔가 굉장히 복잡해 보이지만 잘 보면 API 서버는 거의 그냥 통신 셔틀이라고 보면 된다.</p>\n<p>그러면 그냥 “Paypal서버와 다이렉트로 통신하면 안될까?” 라고 생각할 수 있지만 이는 보안과 직결되는 문제이다. Paypal 서버와 통신을 하기 위해서는 <code class=\"language-text\">client_key</code>와 <code class=\"language-text\">secret</code>이 필요한데, API 서버를 중개하지 않고 Paypal 서버와 바로 통신을 하려면 클라이언트가 이 2개의 값을 다 가지고 있어야 한다는 뜻이 된다.</p>\n<p>하지만 알다시피 웹 상에서 클라이언트 소스는 공개되기가 쉽고 난독화를 한다고 해도 Object의 <code class=\"language-text\">key</code>같은 <code class=\"language-text\">String</code>변수는 난독화되지 않기 때문에 악의를 가진 사용자가 손쉽게 <code class=\"language-text\">client_key</code>와 <code class=\"language-text\">secret</code>을 탈취할 수 있다. 그래서 상대적으로 안전한 서버에 <code class=\"language-text\">secret</code>을 저장하고 클라이언트에는 <code class=\"language-text\">client_key</code>만 저장하는 식으로 2개의 값을 한번에 볼 수 없도록 나눠 놓는다.</p>\n<h2 id=\"실행결과\" style=\"position:relative;\">실행결과<a href=\"#%EC%8B%A4%ED%96%89%EA%B2%B0%EA%B3%BC\" aria-label=\"실행결과 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>먼저, API서버를 통해 create 요청을 진행한 결과, 필자는 다음과 같은 response를 받을 수 있었다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/ee391623f4d89ab9517f34c1a64c178c/5bb8b/result1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 28.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGUlEQVR42lWQ6U7DMBCE8zKotEmatInvM0ebFIQqJBAS7/8ew9oRVPz4tJ61tZ7ZgtsF7Unj3Dt0zIEJn+mYRc8fOpG0NBGKECpAyIDmZFDWCnWjUVYShVg+8HJfEccAJi2U9YQDV3Q2Dpq0tluVpOMU4YcI6wNsCCiPEk87ht2eY3/gKHh4zQ/OTNMvEsd2o/6tzaNWjUB1FKSJ09Zn0tBHlhIY7EuBQq2f2eHX94rxMoCTS6lddsuVyzq5TQjqC+op43OSnm994zy9SwPJobq8Y327YrlNdBFgfMxI7bN2YaB4cashYl5mzNeZoo+0ppF6yYTH80EQKfJ0zwPjtO2jPSu0nf6LnknxKHKZ4/5fSSKtIQ1LA38AHnLHaTWOUI4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"result1\" title=\"\" src=\"/static/ee391623f4d89ab9517f34c1a64c178c/6af66/result1.png\" srcset=\"/static/ee391623f4d89ab9517f34c1a64c178c/69538/result1.png 160w,\n/static/ee391623f4d89ab9517f34c1a64c178c/72799/result1.png 320w,\n/static/ee391623f4d89ab9517f34c1a64c178c/6af66/result1.png 640w,\n/static/ee391623f4d89ab9517f34c1a64c178c/5bb8b/result1.png 749w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>links라는 배열을 하나 받았는데, 각 인덱스의 의미는 이렇다.</p>\n<hr>\n<p><code class=\"language-text\">0</code> - 결제의 상세 정보를 GET메소드로 확인해볼 수 있는 API의 URI</p>\n<p><code class=\"language-text\">1</code> - Paypal의 결제페이지로 리다이렉트 시키는 URL</p>\n<p><code class=\"language-text\">2</code> - 결제를 실행시킬 수 있는 URL</p>\n<hr>\n<p>아까 위에서 설명한 <code class=\"language-text\">links[1]</code>의 의미를 이제 알 수 있을 것이다. 그리고 보내진 url의 host를 보면 전부 <code class=\"language-text\">sandbox.*</code>로 시작하는데 이는 현재 sandbox 계정을 사용하여 테스트를 진행하고 있다는 뜻이다. 실제 운영 API에는 저 sandbox 부분이 빠져있다.</p>\n<p>그리고 이제 <code class=\"language-text\">links[1]</code>의 url로 리다이렉트를 시키면 당연히(…) 저 값들은 먼지가 되어 사라지게 된다. 쿠키에 담든 어떻게 사용은 할 수 있겠지만 어차피 또 보내주니까 미련없이 버리자.</p>\n<p>필자도 리다이렉트를 안시키고 팝업으로 저 페이지를 열어보았는데 <code class=\"language-text\">401 Unauthrized</code>를 뱉으며 결제정보가 장렬히 산화하는 모습을 볼 수 있었다…</p>\n<p>하지만 어차피 Paypal에 <code class=\"language-text\">create</code> 요청을 날린 시점에서 Paypal 서버에는 필자가 처음 보낸 <code class=\"language-text\">redirect_url</code>값이 저장되어있기 때문에 사용자가 Paypal 페이지에서 결제확인을 완료하게 되면 다시 주도권은 필자 서비스로 돌아오게 된다.</p>\n<p>자 이제 리다이렉트를 시켜보자.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 455px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f5ec8d06a213e8a6b2fe1fb84ff6d13d/7cd9c/redirect1.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHvTNpoX//EABoQAAICAwAAAAAAAAAAAAAAAAARAQIQEiH/2gAIAQEAAQUCLNGvYhY//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGhAAAgIDAAAAAAAAAAAAAAAAABABESExMv/aAAgBAQAGPwIwupN2v//EABsQAAIDAAMAAAAAAAAAAAAAAAABESFBMWFx/9oACAEBAAE/IVpopPsXFjZtXOUQIbeiT//aAAwDAQACAAMAAAAQL8//xAAVEQEBAAAAAAAAAAAAAAAAAAAQMf/aAAgBAwEBPxCn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAQEAAgMBAAAAAAAAAAAAAREAIVExQaFh/9oACAEBAAE/ECDHfOgzuAWZqGL+ZcDKwwfM3nHbN+G4et//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"redirect1\" title=\"\" src=\"/static/f5ec8d06a213e8a6b2fe1fb84ff6d13d/7cd9c/redirect1.jpg\" srcset=\"/static/f5ec8d06a213e8a6b2fe1fb84ff6d13d/0913d/redirect1.jpg 160w,\n/static/f5ec8d06a213e8a6b2fe1fb84ff6d13d/cb69c/redirect1.jpg 320w,\n/static/f5ec8d06a213e8a6b2fe1fb84ff6d13d/7cd9c/redirect1.jpg 455w\" sizes=\"(max-width: 455px) 100vw, 455px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>그러면 이런 화면이 하나 뜬다. 만약 Paypal에 로그인이 안되어있다면 먼저 로그인페이지로 이동 후 로그인이 완료되면 이 페이지로 이동하게 될 것이다.</p>\n<p>이 페이지에서 유저는 자신이 결제할 금액을 확인할 수 있으며 오른쪽 상단에 있는 카트모양 아이콘을 누르면 조금 더 상세한 정보가 나오긴 한다. 근데 알아보기 힘들 정도로 간략하게 적혀있어서 딱히 의미는 없을 것 같았다.</p>\n<p>그리고 필자가 요청을 날린 통화 단위는  유로화로 등록이 되어있던 상품이었지만 Paypal에서는 자동으로 사용자의 국가의 환율로 자동 환산을 해준다. 이제 사용자가 모든 항목을 확인하고 <code class=\"language-text\">Continue</code> 버튼을 누르면 필자가 처음 <code class=\"language-text\">create</code>시 보냈던 <code class=\"language-text\">redirect_url</code>로 이동이 시작된다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 448px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/b34365fda4b25226be0676994e510290/33b38/redirect2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 55.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqklEQVR42q2SywrCMBBF+///pOKuUv0AKdq6KNjaPBsSbRbXJOBCUBOjiwMhMxxyJ1PM84wYk1JQjnd1a22oc85RUMaQAkvsSxbSfwkJpRgJCfjzT0IvkFLCaB2QUoDkCr1MCIH9ocF6U2FVVqiPbbj79NK40EmW5Q6Lcou6OeULH9LJRb4ajZsxIX5sjkWs4etP4S4Ccwv5iqy16boO575HPwxPXMYxS3gHfvlCUe7xvscAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"redirect2\" title=\"\" src=\"/static/b34365fda4b25226be0676994e510290/33b38/redirect2.png\" srcset=\"/static/b34365fda4b25226be0676994e510290/69538/redirect2.png 160w,\n/static/b34365fda4b25226be0676994e510290/72799/redirect2.png 320w,\n/static/b34365fda4b25226be0676994e510290/33b38/redirect2.png 448w\" sizes=\"(max-width: 448px) 100vw, 448px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>이 페이지는 필자가 테스트를 위해 임시로 만들어 놓은 페이지이고 실제 운영서버였다면 이 페이지는 최종결제 전 마지막으로 정보를 확인할 수 있는 페이지가 될 것이다.\n이때 주목해야할 것은 이 페이지의 URL이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/b7ad2e818105d647d8e8498a1af1e86b/9f82e/url.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 2.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAABYlAAAWJQFJUiTwAAAASklEQVR42mN4/vz5fxB++fIlGIPY796+/X/95q3/Nd1T/tf1Tf1f1wvCUyB0HwQ39E37X9bW93/fkeP/v3/98n/d9t3/O6bN/Q8AULA+Y3mH7csAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"url\" title=\"\" src=\"/static/b7ad2e818105d647d8e8498a1af1e86b/6af66/url.png\" srcset=\"/static/b7ad2e818105d647d8e8498a1af1e86b/69538/url.png 160w,\n/static/b7ad2e818105d647d8e8498a1af1e86b/72799/url.png 320w,\n/static/b7ad2e818105d647d8e8498a1af1e86b/6af66/url.png 640w,\n/static/b7ad2e818105d647d8e8498a1af1e86b/9f82e/url.png 820w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>쿼리스트링으로 페이팔이 보내준 <code class=\"language-text\">paymentId</code>와 <code class=\"language-text\">token</code>, <code class=\"language-text\">PayerID</code>가 들어있다. 그럼 이제 저 값들을 사용해서 다음 플로우를 진행하면 된다.</p>\n<p>이 페이지의 Controller는 저 값들을 사용하여 디테일한 결제정보를 받아오는 로직과 결제를 실행하는 로직을 가진 메소드로 이루어져있다. 혹시 아까 위에서 정의한 Paypal서비스의 로직이 기억나지 않는다면 위에서 다시 보고 오자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'use strict'</span><span class=\"token punctuation\">;</span>\n\n  angular\n  <span class=\"token punctuation\">.</span><span class=\"token function\">module</span><span class=\"token punctuation\">(</span><span class=\"token string\">'app.pages.product'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">controller</span><span class=\"token punctuation\">(</span><span class=\"token string\">'PaypalRedirectController'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'$rootScope'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Restangular'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PaypalService'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'$location'</span><span class=\"token punctuation\">,</span>\n    PaypalRedirectController\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/** @ngInject */</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">PaypalRedirectController</span><span class=\"token punctuation\">(</span>\n      <span class=\"token parameter\">$rootScope<span class=\"token punctuation\">,</span> Restangular<span class=\"token punctuation\">,</span> PaypalService<span class=\"token punctuation\">,</span> $location</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> vm <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> queryString <span class=\"token operator\">=</span> $location<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 페이팔에서 보내준 쿼리스트링을 가져온다</span>\n\n    vm<span class=\"token punctuation\">.</span>init <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>init<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">getPaymentInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * @public\n     * @method executePaypal\n     */</span>\n    vm<span class=\"token punctuation\">.</span>executePaypal <span class=\"token operator\">=</span> executePaypal<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">executePaypal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 실제 결제 실행 메소드</span>\n      PaypalService<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>queryString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'EXECUTE RESULT -> '</span><span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * @private\n     * @method getPaymentInfo\n     */</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">getPaymentInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 결제 정보 받아오는 메소드</span>\n      PaypalService<span class=\"token punctuation\">.</span><span class=\"token function\">getPaymentInfo</span><span class=\"token punctuation\">(</span>queryString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'GET PAYMENT INFO -> '</span><span class=\"token punctuation\">,</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>필자는 해당 페이지에 있는 버튼에 <code class=\"language-text\">excutePaypal</code>메소드를 클릭 이벤트로 걸어놓았다.\n이제 유저가 저 버튼을 클릭하면 최종 결제가 실행되고 결과를 <code class=\"language-text\">response</code>로 받아볼 수 있다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 381px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/0a41c8ee9d6bbef09c3fee2378861cec/ac471/result.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 198.12500000000003%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAoABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIBAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB8+dyyAdIoQ0Vocwf/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAECEDH/2gAIAQEAAQUCXHkldFzJHklLP//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BX//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BX//EABcQAAMBAAAAAAAAAAAAAAAAAAAwMVH/2gAIAQEABj8C0jv/xAAfEAACAgEEAwAAAAAAAAAAAAAAAREhQRAxcZFRYYH/2gAIAQEAAT8halBpwT5PptGay70eKIfJXkk6Eh4J9C7syOOyD//aAAwDAQACAAMAAAAQczmzgD//xAAVEQEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAwEBPxAr/8QAFxEAAwEAAAAAAAAAAAAAAAAAARAxIP/aAAgBAgEBPxA3Bq//xAAfEAEAAgICAgMAAAAAAAAAAAABABEhMUGRUWFxgaH/2gAIAQEAAT8QqYKrqVk9waSnkdx5FaYg1PIqYtt5+4W0eY7cj4NSoVEYN3FWih5S5bw6iUBfERKg6xb8lvfU/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"result\" title=\"\" src=\"/static/0a41c8ee9d6bbef09c3fee2378861cec/ac471/result.jpg\" srcset=\"/static/0a41c8ee9d6bbef09c3fee2378861cec/0913d/result.jpg 160w,\n/static/0a41c8ee9d6bbef09c3fee2378861cec/cb69c/result.jpg 320w,\n/static/0a41c8ee9d6bbef09c3fee2378861cec/ac471/result.jpg 381w\" sizes=\"(max-width: 381px) 100vw, 381px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <br>\n</center>\n<p>정상적으로 결제가 진행되고 Paypal 서버가 보내준 결과이다. <code class=\"language-text\">payer.status</code>가 <code class=\"language-text\">approved</code>라면 정상적으로 결제가 승인된 것이다. 이제 실제로 결제가 승인되었고 돈이 제대로 들어왔는지 확인해볼 차례이다.</p>\n<p>페이팔의 <a href=\"https://www.sandbox.paypal.com/\" target=\"_blank\" rel=\"nofollow\">샌드박스 페이지</a>에 접속해서 구매자 계정으로 확인해보면 구매내역에 정상적으로 12유로가 출금 되었다고 나와있는 것을 볼 수 있다. 판매자 계정에도 정상적으로 12유로가 들어왔다고 적혀있다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 607px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/96ceab0902c02bc5b934f2ff0b0154d5/ef9e5/customer.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3klEQVR42o3OTW8SURSH8flCzlBe09agqWnVFu2LKahtYtRSbSkWxW7cunHp3sSVG6VAtUCBDgMYFyaamLhuU4jWBBppOiAzBeHxQt0YXXiSX87Jvbn/e6TBRzk8L95x9omGM6jiCqmiZ3EEstiX0lj9KawLKQZuCTeTKPOvkWcjKHNvsFyLo/jiyN44A7MxTs1EkS480/B/rOJNfGI4lOT8mspIKMPIahrHYlIECgtJEbYpJLD4IlgnniOLMNf1KDbfOoo3insuijITQXI/fo/n5WfOPf2Aa6XIcLDAUEBj8K6KdTGHfbmA7U4em18TW+Zwiu5eymO9sc1pf54hcWafz3LmtobtahrJ4llFvhhAHl/BcknME0HsUw9wXVnDOR3uc00/xDkVxnH5Ps5JcTcZxjp+D3lsGXn0hDIawDIWQEpsbZHKZvp682YqRWY7Sy6voQr5YpH1jQ1exWIU3hbFWQ61oJHJqSTSaZKZ37InpHa7zdGRTrNp0KtuF1qd/ohpmvTu/6e64mGPpOt1yuUy1YMDmobRD+h0OtSNFjtfvlEq7bFXKvF1f7/ve632h9rhIZVqlZ3dXfR6A8k0W1Qq1b82MVs/0X8Y6LpOvdHAENv2Pmwa5j/1wgzzmF+1GNs2Kr/V5AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"customer\" title=\"\" src=\"/static/96ceab0902c02bc5b934f2ff0b0154d5/ef9e5/customer.png\" srcset=\"/static/96ceab0902c02bc5b934f2ff0b0154d5/69538/customer.png 160w,\n/static/96ceab0902c02bc5b934f2ff0b0154d5/72799/customer.png 320w,\n/static/96ceab0902c02bc5b934f2ff0b0154d5/ef9e5/customer.png 607w\" sizes=\"(max-width: 607px) 100vw, 607px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>샌드박스의 구매 테스트 계정. 12유로가 출금 되었다.</small>\n</center>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/24e9af9f9c7012c52f8780e1280f8c5c/0a47e/provider.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 59.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACTElEQVR42l1Ta2/TQBD0//9FCEEpjSiUqmkFaQlOHZ/fbyf22Y6fGeZO6YdiabR7q9vx7OOMRtZwLROR5+BhY+Fm/Rc3D1tc37/g25OJz3fPWPG8Wm9xdf+M9cseTdejbk4asn0PI4wTmLsdItov3x9xdfuIj6s1ru9+4+rHL9oNPqwe8On2CV9/bnBzv4EpAuwIZbd7/x2MXpY4RhZk5qHNHPSFg2U8QX3LMuNMKDvPM8bpzZ/Q9yOGYcL/n3E69QiCEGEUIY5TeJ4Px3V5jiGbFrVstD3WDbJSskwVa5EfJMqqxTQv72CM04S8PKI4VDopzUvEac7kA8YFGtOZoJ3Pl/PFn5YzTuN8wYKeFRh1XcN2PbhU5gYJexPDtCM4QYo/OxfbV58/O6K5NL3p3tBTYYO9m0D4GfMiROmBhCxpszWZLGDuPXhRCjeMaRP49IMk18iZXNQtClrtEyXPyk8PNZKyRiU7GF0/4FV4iApJtDg0vYYcFo286pggkR1bJikrNUletZrECnKIpMJrUCLMjjAG9rDgpYB9S1Ufm06r86JMK1DqLMfXaoXP4WUlLC+FaQm2KsCRqiq2QuUkWQFjImHXtnCEQMxJj8OAKAzhOAJFkSOKQqRpQhTYCx8lyxMkrCr2VUrMzJd8HMK2kaUpDBWoakkCB3GScLcGhGqNSNp2HRLGfN9HEFKhG6IoWR4Hp/ZyUrs5jlCDFRSUZRkJGaw4GBWI+VrUBUUmhK0vqksu99IPE+5noBVaTsLdDbSqvme/qdS2FWGKf8URhCdIghH3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"provider\" title=\"\" src=\"/static/24e9af9f9c7012c52f8780e1280f8c5c/0a47e/provider.png\" srcset=\"/static/24e9af9f9c7012c52f8780e1280f8c5c/69538/provider.png 160w,\n/static/24e9af9f9c7012c52f8780e1280f8c5c/72799/provider.png 320w,\n/static/24e9af9f9c7012c52f8780e1280f8c5c/0a47e/provider.png 600w\" sizes=\"(max-width: 600px) 100vw, 600px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>샌드박스의 판매 테스트 계정. 최상단에 필자 이름과 함께 12유로가 들어와있다.</small>\n</center>\n<p>하지만 아직 완전한 처리가 이루어지지 않은 상태라 Payment status는 <code class=\"language-text\">Unclaimed</code>로 되어있다. 아직은 저게 현금화 된게 아니라 그냥 Paypal서버에 들어가있는 데이터 쪼가리일 뿐이다.\n이제 Accept버튼을 눌러 판매자의 계좌로 입금을 진행하면 상태가 <code class=\"language-text\">Completed</code>로 전환되며 계좌에 <code class=\"language-text\">12EUR</code>가 <code class=\"language-text\">USD</code>로 환전되며 입금된다.</p>\n<p>이상으로 Express Checkout에 대한 포스팅을 마친다.</p>","fields":{"slug":"20170514-paypal-express-checkout","path":"/2017/05/14/paypal-express-checkout/","lang":"ko"},"frontmatter":{"title":"페이팔의 Express Checkout Restful API 사용하기","subTitle":"페이팔 결제 연동, 어떻게 구현할 수 있을까?","date":"May 14, 2017","categories":["프로그래밍","튜토리얼"],"tags":["JavaScript","자바스크립트","Paypal","페이팔","앵귤러","Angular","AngularJS","Laravel","라라벨","PHP","튜토리얼","결제연동"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/617e08b28c22d787f8450e2ec114cc93/3a812/thumbnail.jpg","srcSet":"/static/617e08b28c22d787f8450e2ec114cc93/3a812/thumbnail.jpg 320w,\n/static/617e08b28c22d787f8450e2ec114cc93/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/617e08b28c22d787f8450e2ec114cc93/fc5c5/thumbnail.webp 320w,\n/static/617e08b28c22d787f8450e2ec114cc93/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/617e08b28c22d787f8450e2ec114cc93/2d839/thumbnail.jpg","srcSet":"/static/617e08b28c22d787f8450e2ec114cc93/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/617e08b28c22d787f8450e2ec114cc93/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"29f9f758-8c2e-589a-8f50-a67ccbd16866","tableOfContents":"<ul>\n<li><a href=\"#%ED%95%84%EC%9A%94%ED%95%9C-%EC%83%81%EC%88%98-%EA%B0%92%EB%93%A4-%EC%84%A0%EC%96%B8\">필요한 상수 값들 선언</a></li>\n<li><a href=\"#mover-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%84%A0%EC%96%B8\">Mover 클래스 선언</a></li>\n<li><a href=\"#mover-%EA%B0%9D%EC%B2%B4%EB%93%A4-%EB%A0%8C%EB%8D%94%ED%95%98%EA%B8%B0\">Mover 객체들 렌더하기</a></li>\n<li><a href=\"#mover-%EA%B0%9D%EC%B2%B4%EB%93%A4-%EC%9A%B4%EB%8F%99-%EC%8B%9C%ED%82%A4%EA%B8%B0\">Mover 객체들 운동 시키기</a></li>\n</ul>","excerpt":"이번 포스팅에서는 저번 포스팅에 이어 중력을 직접 JS로 구현해보려고 한다. 개발환경은 JavaScript ES7, babel, Webpack, Three.js을 사용하였다. 필요한 상수 값들 선언 먼저 프로그램에서 사용할 상수 값들 부터 선언하겠다. 여기서 원래는 의 작은 값을 가지는 중력 상수 를 으로 설정했는데, 그 이유는 필자가 만들 시뮬레이션에 등장하는 물체들의 질량이 너무 작기 때문이다. 실제 중력 상수를 그대로 적용하면서도 중력의 영향이 눈에 보일 정도가 되려면 질량도 행성급으로 커야 하는데, 그러면 계산이 너무 힘들…","html":"<p>이번 포스팅에서는 <a href=\"/2017/05/06/gravity-via-js-1\">저번 포스팅</a>에 이어 중력을 직접 JS로 구현해보려고 한다. 개발환경은 JavaScript ES7, babel, Webpack, Three.js을 사용하였다.</p>\n<h2 id=\"필요한-상수-값들-선언\" style=\"position:relative;\">필요한 상수 값들 선언<a href=\"#%ED%95%84%EC%9A%94%ED%95%9C-%EC%83%81%EC%88%98-%EA%B0%92%EB%93%A4-%EC%84%A0%EC%96%B8\" aria-label=\"필요한 상수 값들 선언 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>먼저 프로그램에서 사용할 상수 값들 부터 선언하겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> initOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">framerate</span><span class=\"token operator\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">G</span><span class=\"token operator\">:</span> <span class=\"token number\">250</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 내 맘대로 중력상수</span>\n  <span class=\"token constant\">START_SPEED</span><span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 초기화 시 물체들의 속도</span>\n  <span class=\"token constant\">OBJECT_COUNT</span><span class=\"token operator\">:</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 초기화 후 렌더 될 물체 개수</span>\n  <span class=\"token constant\">TRACE_LENGTH</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 물체의 이동 궤적 길이</span>\n  <span class=\"token constant\">MIN_MASS</span><span class=\"token operator\">:</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 물체들의 최소 질량</span>\n  <span class=\"token constant\">MAX_MASS</span><span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 물체들의 최대 질량</span>\n  <span class=\"token constant\">DENSITY</span><span class=\"token operator\">:</span> <span class=\"token number\">0.15</span> <span class=\"token comment\">// 물체들이 렌더되는 밀도</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">SPHERE_SIDES</span> <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token operator\">=</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>여기서 원래는 <code class=\"language-text\">6.6742e-11</code>의 작은 값을 가지는 중력 상수 <code class=\"language-text\">G</code>를 <code class=\"language-text\">250</code>으로 설정했는데, 그 이유는 필자가 만들 시뮬레이션에 등장하는 물체들의 질량이 너무 작기 때문이다.</p>\n<p>실제 중력 상수를 그대로 적용하면서도 중력의 영향이 눈에 보일 정도가 되려면 질량도 행성급으로 커야 하는데, 그러면 계산이 너무 힘들어지기 때문에 물체의 질량을 줄이고 중력 상수는 늘려주는 방식으로 조정했다.</p>\n<p><code class=\"language-text\">MASS_FACTOR</code>는 나중에 렌더할 때 물체의 질량에 비례하도록 구의 크기를 설정하려고 하는데 질량 값들이 <code class=\"language-text\">400-3000</code>이다보니까 구의 부피가 너무 커질 것 같아서 그걸 보정하기 위해 선언한 상수이다.</p>\n<p>일종의 압축률 비슷한 느낌으로 나중에 구의 크기를 정의할 때 물체의 질량에 <code class=\"language-text\">MASS_FACTOR</code>를 곱해줘서 일정한 비율로 크기를 줄일 예정이다.</p>\n<p>이 포스팅은 ThreeJS를 설명하기 위한 포스팅이 아니므로 <code class=\"language-text\">Scene</code>과 <code class=\"language-text\">Renderer</code>의 선언 및 초기화 등에 대해서는 생략하고 지나가겠다.</p>\n<h2 id=\"mover-클래스-선언\" style=\"position:relative;\">Mover 클래스 선언<a href=\"#mover-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%84%A0%EC%96%B8\" aria-label=\"mover 클래스 선언 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>자 그럼 이제 실제 움직일 놈들을 구현하자. 이름을 Object로 하고 싶었지만 알다시피 JS에서 Object라는 이름은 Build-in Object가 이미 가지고 있다. 그래서 다른 이름을 고심하다가 그냥 <code class=\"language-text\">Mover</code>라고 했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">SPHERE_SIDES</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'src/constants'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n Vector3<span class=\"token punctuation\">,</span> SphereGeometry<span class=\"token punctuation\">,</span> Line<span class=\"token punctuation\">,</span>\n MeshPhongMaterial<span class=\"token punctuation\">,</span> PointLight<span class=\"token punctuation\">,</span> Mesh<span class=\"token punctuation\">,</span> Geometry\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'three'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Mover</span> <span class=\"token punctuation\">{</span>\n <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mass<span class=\"token punctuation\">,</span> velocity<span class=\"token punctuation\">,</span> location<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">,</span> scene</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>uid <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">mover-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location <span class=\"token operator\">=</span> location<span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity <span class=\"token operator\">=</span> velocity<span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>acceleration <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">=</span> mass<span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>alive <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>geometry <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SphereGeometry</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">SPHERE_SIDES</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">SPHERE_SIDES</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>vertices <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>line <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Line</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>line<span class=\"token punctuation\">.</span>material<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">;</span>\n\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>basicMaterial <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MeshPhongMaterial</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n     <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span>\n     <span class=\"token literal-property property\">specular</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span>\n     <span class=\"token literal-property property\">shininess</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mesh <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Mesh</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>geometry<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>basicMaterial<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mesh<span class=\"token punctuation\">.</span>castShadow <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mesh<span class=\"token punctuation\">.</span>receiveShadow <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>position <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parentScene <span class=\"token operator\">=</span> scene<span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">Mover</code>클래스로 생성된 객체는 <code class=\"language-text\">constructor</code> 실행 시 넘겨받은 랜덤한 질량값과 속도, 위치 값을 가지고 있다. 그리고 가속도를 의미하는 <code class=\"language-text\">acceleration</code> 값을 초기화 해준다. 가속도는 어떠한 방향으로 움직이는 속도이므로 3개의 원소를 가진 벡터로 선언해 주었다.</p>\n<p>그리고 <code class=\"language-text\">Mover</code>끼리 충돌 판정이 나면 <code class=\"language-text\">Mover</code> 두개를 하나로 합쳐서 더 큰 질량을 가진 <code class=\"language-text\">Mover</code>로 만들 예정이기 때문에 <code class=\"language-text\">alive</code> 멤버 변수를 선언해서 해당 Mover가 죽었나 살았나를 판별할 수 있도록 했다.</p>\n<h2 id=\"mover-객체들-렌더하기\" style=\"position:relative;\">Mover 객체들 렌더하기<a href=\"#mover-%EA%B0%9D%EC%B2%B4%EB%93%A4-%EB%A0%8C%EB%8D%94%ED%95%98%EA%B8%B0\" aria-label=\"mover 객체들 렌더하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>이후 <code class=\"language-text\">Scene</code>에는 초기화 시 <code class=\"language-text\">Mover</code>들을 그려주는 로직을 작성했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> movers <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>movers<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>movers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// movers리스트 초기화</span>\n      movers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>mesh<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>selectionLight<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    movers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span><span class=\"token constant\">MOVER_COUNT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> mass <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span><span class=\"token constant\">MIN_MASS</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span><span class=\"token constant\">MAX_MASS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> maxDistance <span class=\"token operator\">=</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span> <span class=\"token operator\">/</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span><span class=\"token constant\">DENSITY</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> maxSpeed <span class=\"token operator\">=</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span><span class=\"token constant\">START_SPEED</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">const</span> velocity <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxSpeed<span class=\"token punctuation\">,</span> maxSpeed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxSpeed<span class=\"token punctuation\">,</span> maxSpeed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxSpeed<span class=\"token punctuation\">,</span> maxSpeed<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> location <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxDistance<span class=\"token punctuation\">,</span> maxDistance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxDistance<span class=\"token punctuation\">,</span> maxDistance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxDistance<span class=\"token punctuation\">,</span> maxDistance<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// 랜덤한 속도, 위치, 질량을 가진 Mover를 생성</span>\n      movers<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Mover</span><span class=\"token punctuation\">(</span>mass<span class=\"token punctuation\">,</span> velocity<span class=\"token punctuation\">,</span> location<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Mover가 초기화될 때 만들어진 Mesh, Line, Light 객체를 Scene에 넣는다</span>\n    movers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v</span> <span class=\"token operator\">=></span> v<span class=\"token punctuation\">.</span><span class=\"token function\">addMover</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>movers <span class=\"token operator\">=</span> movers<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">min<span class=\"token punctuation\">,</span> max</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>max <span class=\"token operator\">-</span> min<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> min<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이제 <code class=\"language-text\">Scene</code>은 여러 개의 <code class=\"language-text\">Mover</code>를 담은 리스트인 <code class=\"language-text\">movers</code>를 가지게 되었다. 이제 렌더되는 동안 계산만 하면 끝! 인데…\n전 포스팅에서 말했듯이 여러 개의 물체에 대한 중력을 구하는 다체문제는 해를 구할 수가 없다.</p>\n<p>그래서 <code class=\"language-text\">movers</code>를 순회하며 한번 순회할 때마다 다른 <code class=\"language-text\">Mover</code>들과의 중력을 이체문제로 모두 계산하는 로직을 만들어야한다.</p>\n<h2 id=\"mover-객체들-운동-시키기\" style=\"position:relative;\">Mover 객체들 운동 시키기<a href=\"#mover-%EA%B0%9D%EC%B2%B4%EB%93%A4-%EC%9A%B4%EB%8F%99-%EC%8B%9C%ED%82%A4%EA%B8%B0\" aria-label=\"mover 객체들 운동 시키기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">let</span> movers <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>movers<span class=\"token punctuation\">;</span>\n\nmovers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o1<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>o1<span class=\"token punctuation\">.</span>alive<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  movers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o2<span class=\"token punctuation\">,</span> j</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>o1<span class=\"token punctuation\">.</span>alive <span class=\"token operator\">&amp;&amp;</span> o2<span class=\"token punctuation\">.</span>alive <span class=\"token operator\">&amp;&amp;</span> i <span class=\"token operator\">!==</span> j<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// o1 -> o2의 거리</span>\n      <span class=\"token keyword\">const</span> distance <span class=\"token operator\">=</span> o1<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span><span class=\"token function\">distanceTo</span><span class=\"token punctuation\">(</span>o2<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// o1, o2의 반지름 r1, r2</span>\n      <span class=\"token keyword\">const</span> r1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>o1<span class=\"token punctuation\">.</span>mass <span class=\"token operator\">/</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token operator\">/</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token operator\">/</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">**</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> r2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>o2<span class=\"token punctuation\">.</span>mass <span class=\"token operator\">/</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token operator\">/</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token operator\">/</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">**</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>distance <span class=\"token operator\">&lt;=</span> r1 <span class=\"token operator\">+</span> r2<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 둘의 거리가 둘의 반지름의 합 이하면 충돌한 것으로 판정, 두 물체를 합친다</span>\n        o2<span class=\"token punctuation\">.</span><span class=\"token function\">eat</span><span class=\"token punctuation\">(</span>o1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 충돌이 아닐 경우 그냥 운동만 시킨다</span>\n        o2<span class=\"token punctuation\">.</span><span class=\"token function\">attract</span><span class=\"token punctuation\">(</span>o1<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>우선 이런 식으로 전체 <code class=\"language-text\">Mover</code>들을 순회하면서 충돌 판정을 내주었다. <code class=\"language-text\">Mover</code> 클래스의 <code class=\"language-text\">eat</code>메소드는 충돌 판정이 난 두 <code class=\"language-text\">Mover</code>들을 하나로 합치는 로직을 가지고 있으며, <code class=\"language-text\">attract</code> 메소드에는 현재 두 물체의 거리에서의 중력을 측정하고 <code class=\"language-text\">Mover</code>의 가속도에 더해주는 역할을 하고 있다.</p>\n<p>이후 모든 계산이 끝나면 <code class=\"language-text\">Mover</code>의 위치와 크기, 속도, 방향 등을 업데이트 해주었다. <code class=\"language-text\">Gravity</code>클래스의 <code class=\"language-text\">calcGravity</code>메소드는 <a href=\"/2017/05/06/gravity-via-js-1\">저번 포스팅</a>에서 적었던 로직 그대로이다.</p>\n<p><code class=\"language-text\">Mover</code>의 운동에 관련된 메소드들은 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Mover</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mass<span class=\"token punctuation\">,</span> velocity<span class=\"token punctuation\">,</span> location<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">,</span> scene</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">eat</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">otherMover</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> newMass <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> newLocation <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>z <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>z <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> newVelocity <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>z <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>z <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location <span class=\"token operator\">=</span> newLocation<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity <span class=\"token operator\">=</span> newVelocity<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">=</span> newMass<span class=\"token punctuation\">;</span>\n\n    otherMover<span class=\"token punctuation\">.</span><span class=\"token function\">kill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">attract</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">otherMover<span class=\"token punctuation\">,</span> options</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> force <span class=\"token operator\">=</span> Gravity<span class=\"token punctuation\">.</span><span class=\"token function\">calcGravity</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> otherMover<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">.</span><span class=\"token constant\">G</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">applyForce</span><span class=\"token punctuation\">(</span>force<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">applyForce</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">force</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">=</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> f <span class=\"token operator\">=</span> force<span class=\"token punctuation\">.</span><span class=\"token function\">divideScalar</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// mover의 가속도에 힘을 적용</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>acceleration<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>acceleration<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 속도에 가속도 더함</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 위치에 속도 더해서 이동시킴</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>acceleration<span class=\"token punctuation\">.</span><span class=\"token function\">multiplyScalar</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 가속도 초기화</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mesh<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">.</span><span class=\"token function\">copy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// mover의 mesh객체에 위치 적용</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>정리하자면 매 프레임마다 <code class=\"language-text\">movers</code>리스트를 순회하면서 각 <code class=\"language-text\">Mover</code>들간의 중력을 계산하고 가속도를 적용한 후 실제로 <code class=\"language-text\">Mover</code>를 이동시키는 것이다. 전체 소스는 <a href=\"https://github.com/evan-moon/3d-gravity-test\" target=\"_blank\" rel=\"nofollow\">중력 테스트 프로젝트 깃허브 레파지토리</a>에서 확인해볼 수 있다.</p>\n<p>이상으로 JavaScript로 중력 구현하기 포스팅을 마친다.</p>","fields":{"slug":"20170506-gravity-via-js-2","path":"/2017/05/06/gravity-via-js-2/","lang":"ko"},"frontmatter":{"title":"[JavaScript로 중력 구현하기] 2. 코딩하기","subTitle":"만유인력 법칙을 적용한 중력 시뮬레이션","date":"May 06, 2017","categories":["프로그래밍","그래픽스"],"tags":["중력 구현하기","중력","Gravity","JavaScript","자바스크립트","WebGL","수학","ThreeJS","튜토리얼"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/6c72a52042fa8bad71e5e927ca2d86d6/3a812/thumbnail.jpg","srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/3a812/thumbnail.jpg 320w,\n/static/6c72a52042fa8bad71e5e927ca2d86d6/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/fc5c5/thumbnail.webp 320w,\n/static/6c72a52042fa8bad71e5e927ca2d86d6/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/6c72a52042fa8bad71e5e927ca2d86d6/2d839/thumbnail.jpg","srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"b1fa5f6e-421e-504e-a6fc-917056d05d0c","tableOfContents":"<ul>\n<li><a href=\"#%EC%A4%91%EB%A0%A5%EC%9D%B4%EB%9E%80\">중력이란?</a></li>\n<li><a href=\"#%EA%B7%B8%EB%9E%98%EC%84%9C-%EA%B5%AC%ED%98%84%EC%9D%80-%EC%96%B4%EB%96%BB%EA%B2%8C\">그래서 구현은 어떻게?</a></li>\n</ul>","excerpt":"이번 포스팅에서는 만유인력의 법칙을 이용하여 중력을 구현해보려고 한다. 지표면 상에서 한 방향으로 작용하는 중력이 아니라 랜덤한 질량을 가진 여러 개의 물체를 랜덤한 좌표에 뿌려놓고 서로의 운동에 어떻게 간섭하는 지를 살펴볼 수 있는 시뮬레이션을 만들어 볼 예정이다. 중력이란? 먼저 이 포스팅은 물리학도가 아닌 필자같이 수학에 익숙하지 않은 사람을 대상으로 한 포스팅이기에 먼저 중력의 개념부터 제대로 짚고 넘어가려고 한다. 뉴턴께서 가라사대, 중력이란 두 개의 질량을 가진 물체가 서로 끌어당기는 힘이라고 했다. 사실 뉴턴은 만유인…","html":"<p>이번 포스팅에서는 만유인력의 법칙을 이용하여 중력을 구현해보려고 한다. 지표면 상에서 한 방향으로 작용하는 중력이 아니라 랜덤한 질량을 가진 여러 개의 물체를 랜덤한 좌표에 뿌려놓고 서로의 운동에 어떻게 간섭하는 지를 살펴볼 수 있는 시뮬레이션을 만들어 볼 예정이다.</p>\n<h2 id=\"중력이란\" style=\"position:relative;\">중력이란?<a href=\"#%EC%A4%91%EB%A0%A5%EC%9D%B4%EB%9E%80\" aria-label=\"중력이란 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>먼저 이 포스팅은 물리학도가 아닌 필자같이 <strong>수학에 익숙하지 않은 사람</strong>을 대상으로 한 포스팅이기에 먼저 중력의 개념부터 제대로 짚고 넘어가려고 한다.</p>\n<p>뉴턴께서 가라사대, 중력이란 두 개의 질량을 가진 물체가 서로 끌어당기는 힘이라고 했다.</p>\n<p>사실 뉴턴은 만유인력의 법칙이라는 공식을 만들면서 어떻게 중력이 작용하는지는 알아냈지만 왜 중력이 생기는 것인지는 몰랐다. 아무래도 “신께서만 아실 일이지…”하고 넘어간 듯 싶다.\n그리고 뉴턴은 질량을 가진 물체가 중력을 가진다고 했었는데 이는 빛은 질량이 없기 때문에 중력에 영향을 전혀 받지않는다는 얘기가 된다.</p>\n<p>하지만 현대에 와서 밝혀진 사실에 의하면 빛도 중력에 영향을 받는다. 영화 인터스텔라에서도 보지 않았던가? <small>(100% 확실한 시각화 묘사라고는 할 수 없지만 이론물리학자인 킵 손이 일반상대성이론을 계산해서 3D로 시각화했다고 한다.)</small></p>\n<p>블랙홀 같이 중력이 어마어마한 곳에서는 이 현상이 눈에 띄게 관찰되는데, 이를 중력렌즈효과라고 부른다.</p>\n<center>\n  <img src=\"/59d205c9bdb4c3be36f94bb8b25cddf1/gravity-lens.gif\" alt=\"gravity lens\" width=\"100%\">\n  <br>\n  <small>블랙홀 뒤를 지나는 빛의 휘어짐</small>\n  <br>\n  <br>\n</center>\n<p>중력은 1915년 아인슈타인의 일반상대성이론에서 에너지에 의한 시공간의 휨으로 정의되게 된다. 그래서 시공간 상의 물체의 질량이 급격하게 증가하거나 감소할 때 시공간에 파동이 생기게 되는데 이것이 바로 작년 초에 발견된 중력파이다.</p>\n<p>이렇게 발생된 중력파는 빛과 같은 속도로 움직인다고 한다. 그래서 갑자기 태양계에서 태양이 뿅!하고 사라지게 되면 태양 주위를 공전하던 행성들이 바로 궤도를 이탈해서 날아가는 게 아니다.</p>\n<p>예를 들어서 지구같은 경우에는 태양에서 나온 빛이 지구까지 약 8분 20초 정도 걸리니까 태양이 갑자기 사라져도 8분 정도는 없어진 태양이 있던 위치를 그대로 공전하는 것이다.\n그러다가 8분 후 마지막에 태양에서 나온 빛이 지구에 도달하는 순간 지구는 궤도를 이탈할 것이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/434fed24de68a2e16a016af2e5c94459/29d31/gravity.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeHeFkA//8QAGBABAAMBAAAAAAAAAAAAAAAAAQACEBH/2gAIAQEAAQUCqTho5//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAAICAwAAAAAAAAAAAAAAAAABEDERQVH/2gAIAQEAAT8hRbHg0O4Z2P/aAAwDAQACAAMAAAAQQw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEBAQEBAQAAAAAAAAAAAAABEQAxEKH/2gAIAQEAAT8QY05wyqSrJPuipy4zWKTz/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"gravity\" title=\"\" src=\"/static/434fed24de68a2e16a016af2e5c94459/c08c5/gravity.jpg\" srcset=\"/static/434fed24de68a2e16a016af2e5c94459/0913d/gravity.jpg 160w,\n/static/434fed24de68a2e16a016af2e5c94459/cb69c/gravity.jpg 320w,\n/static/434fed24de68a2e16a016af2e5c94459/c08c5/gravity.jpg 640w,\n/static/434fed24de68a2e16a016af2e5c94459/29d31/gravity.jpg 700w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>큰 질량을 가진 물체일수록 시공간을 더 많이 휘게 만든다</small>\n</center>\n<p>그렇다고 만유인력의 법칙이 틀렸다는 것이 아니라, 상대성이론은 만유인력의 법칙이 놓친 점을 보완해준 것에 더 가깝다. 사실 중력이 아주 큰 공간<small>(아주 많이 휘어진 공간)</small>이 아니라면 만유인력의 법칙으로도 충분히 설명이 가능하다.</p>\n<p>예를 들어 지구는 전체적으로 보면 커다란 구이지만 지구에 사는 우리가 주변을 돌아보면 이게 구인지 평면인지 알수가 없다. 이와 같이 휘어진 정도가 아주아주 작아 유클리드 공간과 거의 유사한 공간을 유사-유클리드 공간이라고 한다. 그리고 이런 유사-유클리드 공간에서는 만유인력의 법칙만 적용해도 충분하다. 아폴로 우주선을 달에 보낼때도 만유인력의 법칙만으로 충분했다고 한다.</p>\n<p>결론적으로 중력을 구하는 것은 시공간의 곡률을 구하는 것으로 볼 수 있지만, 사실 필자가 만드려고 하는 간단한 시뮬레이션은 굉장히 작은 유사-유클리도 공간 안에서의 상황을 시뮬레이팅하는 것이고, 현실에 적용되는 프로그램이 아니라 말 그대로 시뮬레이션이기 때문에 만유인력의 법칙만으로도 충분히 구현이 가능하다.</p>\n<h2 id=\"그래서-구현은-어떻게\" style=\"position:relative;\">그래서 구현은 어떻게?<a href=\"#%EA%B7%B8%EB%9E%98%EC%84%9C-%EA%B5%AC%ED%98%84%EC%9D%80-%EC%96%B4%EB%96%BB%EA%B2%8C\" aria-label=\"그래서 구현은 어떻게 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>일단 설명을 쉽게 하기 위해 랜덤한 질량을 가진 2개의 물체를 랜덤한 좌표에 랜덤한 방향과 속도를 가지게 설정한 후 그냥 공간 상에 뿌린다고 가정하자.\n이 물체 2개의 중력의 영향을 계산하는 것은 그다지 어렵지 않다. 여기서 만유인력의 법칙이 등장한다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>F</mi><mn>12</mn></msub><mo>=</mo><mo>−</mo><mi>G</mi><mfrac><mrow><msub><mi>m</mi><mn>1</mn></msub><msub><mi>m</mi><mn>2</mn></msub></mrow><mrow><mi mathvariant=\"normal\">∣</mi><msup><mrow><msub><mi>r</mi><mn>12</mn></msub><mi mathvariant=\"normal\">∣</mi></mrow><mn>2</mn></msup></mrow></mfrac><mover accent=\"true\"><msub><mi>r</mi><mn>12</mn></msub><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">F_{12} = -G{\\frac{m_1 m_2}{\\vert{r_{12}\\vert}^2}}\\hat{r_{12}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2016em;vertical-align:-1.094em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">G</span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.156em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.954em;\"><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.094em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></div>\n<p>이 공식은 물체1이 물체2에게 가하는 중력 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span></span>를 구하는 공식이다. 이때 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span></span>는 <a href=\"https://ko.wikipedia.org/wiki/%EC%A4%91%EB%A0%A5_%EC%83%81%EC%88%98\" target=\"_blank\" rel=\"nofollow\">중력 상수</a>를 의미하고, 이 중력 상수는 <code class=\"language-text\">6.67384 * 10^-11</code>로 정해져 있다.</p>\n<p>그리고 분자의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">m_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>과 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">m_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>는 각 물체의 질량이고 분모인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mn>12</mn></msub></mrow><annotation encoding=\"application/x-tex\">r_{12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>은 이 물체들 간의 <a href=\"https://ko.wikipedia.org/wiki/%EC%9C%A0%ED%81%B4%EB%A6%AC%EB%93%9C_%EA%B1%B0%EB%A6%AC\" target=\"_blank\" rel=\"nofollow\">유클리드거리</a>를 의미한다. 그리고 마지막에 곱해주는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span>은 물체1에서 물체2를 바라보고 있는 단위벡터를 의미한다.</p>\n<p>이 식의 포인트는 분모에 물체 간의 거리가 들어가있고 분자에 두 물체의 질량이 들어가있다는 것이다.</p>\n<p>이는 두 물체 간의 거리가 멀어질수록 분모가 커지니까 결과 값이 작게 나오고, 두 물체의 질량이 커질수록 분자가 커지니까 결과 값이 크게 나온다는 것을 의미하며, 간단하게 말해서 중력은 <strong>두 물체 간 거리에 반비례하고 두 물체 간 질량의 곱에 비례한다</strong>고 할 수 있다.</p>\n<p>혹시 선형대수학을 안배우신 분들이 있을 지 모르니 간단하게 설명하면, 벡터라는 놈은 공간 상에서의 방향을 의미한다는 정도만 알아두셔도 좋을 것 같다. 지금 우리가 계산하려고 하는 공간은 3차원 공간이기 때문에 벡터는 <code class=\"language-text\">(x, y, z)</code> 3개의 좌표값을 가지게 된다.</p>\n<p>우리가 어릴 때 배웠던 만유인력의 법칙은</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>F</mi><mo>=</mo><mi>G</mi><mfrac><mrow><msub><mi>m</mi><mn>1</mn></msub><msub><mi>m</mi><mn>2</mn></msub></mrow><msup><mi>r</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding=\"application/x-tex\">F = G\\frac{m_1 m_2}{r^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></div>\n<p>의 꼴을 가지는데 이 공식의 결과는 <code class=\"language-text\">1</code> <code class=\"language-text\">5.2</code> <code class=\"language-text\">1204</code>같은 스칼라 값을 가지게 된다. 스칼라는 어떠한 물리량만을 의미하는 것이기 때문에 중력이 얼마나 센지는 알 수 있어도 중력의 방향까지는 알 수가 없다.</p>\n<p>그래서 힘의 방향을 표현해줘야 우리가 이 공식을 제대로 사용할 수 있고, 그렇기 때문에 마지막에 벡터를 곱해주는 것이다.</p>\n<p>그리고 공식 맨 앞에 <code class=\"language-text\">-1</code>이 붙어있는 이유는 벡터의 방향 때문이다. 마지막에 우리가 곱한 벡터는 물체1에서 물체2로 향하는 방향이다. 하지만 중력은 내 쪽으로 끌어당기는 힘이지 밀어내는 힘이 아니기 때문에 따라서 힘의 방향은 물체2에서 물체1로 향해야 한다. 그래서 위 공식에서 <code class=\"language-text\">-1</code>을 다시 곱해주는 것이다.</p>\n<p>조금 복잡해보이지만 막상 코드로 구현하면 간단하다. 필자는 <a href=\"https://threejs.org/\" target=\"_blank\" rel=\"nofollow\">ThreeJS</a>를 사용하여 벡터 계산을 진행하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Vector3 <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'three'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">calcGravity</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o1<span class=\"token punctuation\">,</span> o2<span class=\"token punctuation\">,</span> <span class=\"token constant\">G</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// o1의 위치벡터와 o2의 위치벡터의 차를 구해 o1 -> o2를 바라보는 벡터를 구한다.</span>\n  <span class=\"token keyword\">let</span> force <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">subVectors</span><span class=\"token punctuation\">(</span>o1<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">,</span> o2<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token comment\">// 위에서 구한 방향벡터의 길이를 구한 후 절대값으로 변환해준다.</span>\n  <span class=\"token keyword\">const</span> distance <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sqrt</span><span class=\"token punctuation\">(</span>force<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">**</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token comment\">// 위에서 구한 방향벡터를 단위벡터로 바꿔준다.</span>\n  force <span class=\"token operator\">=</span> force<span class=\"token punctuation\">.</span><span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token comment\">// 중력 스칼라 구하기</span>\n  <span class=\"token keyword\">const</span> strength <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token constant\">G</span> <span class=\"token operator\">*</span> o1<span class=\"token punctuation\">.</span>mass <span class=\"token operator\">*</span> o2<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>distance <span class=\"token operator\">**</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token comment\">// 방향벡터에 위에서 구한 중력 스칼라를 곱해준다</span>\n  force <span class=\"token operator\">=</span> force<span class=\"token punctuation\">.</span><span class=\"token function\">multiplyScalar</span><span class=\"token punctuation\">(</span>strength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">return</span> force<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이제 여기서 나온 값을 계산 대상이 되는 현재 물체의 위치값에 계속 더해주면 물체는 그 방향으로 운동하게 될 것이다. 근데 문제는 실질적으로 우리는 2개만 뿌릴 것이 아니라는 것이다.</p>\n<p>저 만유인력의 법칙은 2개의 물체 간의 중력 만을 생각하고 계산하고 있다. 그렇다면 여러 개의 물체의 중력이 서로에게 영향을 주고 받는 것도 계산할 수 있을까?</p>\n<p>아쉽게도 이런 <a href=\"https://ko.wikipedia.org/wiki/%EB%8B%A4%EC%B2%B4_%EB%AC%B8%EC%A0%9C\" target=\"_blank\" rel=\"nofollow\">다체문제</a>는 수리물리학분야에서 손꼽히는 난제이며, 1887년에 앙리 푸엥카레가 삼체 이상 문제의 일반해를 구하는 것이 불가능하다고 했다. 그래서 우리는 저 위에 있는 이체문제의 만유인력의 법칙을 사용해서 중력을 근사적으로 구하는 수 밖에 없다.</p>\n<p><a href=\"/2017/05/06/gravity-via-js-2\">다음 포스팅</a>에서는 간단한 중력 모델 샘플을 코드로 구현해볼 예정이다. 이상으로 JavaScript로 중력 구현하기 첫번째 포스팅을 마친다.</p>","fields":{"slug":"20170506-gravity-via-js-1","path":"/2017/05/06/gravity-via-js-1/","lang":"ko"},"frontmatter":{"title":"[JavaScript로 중력 구현하기] 1. 중력이란 무엇일까?","subTitle":"중력은 어떻게 공간을 휘게 만드는가?","date":"May 06, 2017","categories":["프로그래밍","그래픽스"],"tags":["중력 구현하기","중력","Gravity","JavaScript","자바스크립트","WebGL","수학","ThreeJS","튜토리얼"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/6c72a52042fa8bad71e5e927ca2d86d6/3a812/thumbnail.jpg","srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/3a812/thumbnail.jpg 320w,\n/static/6c72a52042fa8bad71e5e927ca2d86d6/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/fc5c5/thumbnail.webp 320w,\n/static/6c72a52042fa8bad71e5e927ca2d86d6/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/6c72a52042fa8bad71e5e927ca2d86d6/2d839/thumbnail.jpg","srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"cdaa1c4a-3da0-5f44-ab08-59709658e623","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%BC%80%ED%94%8C%EB%9F%AC-%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\">케플러 궤도 요소 데이터 확인하기</a></p>\n<ul>\n<li><a href=\"#%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0\">궤도 요소 데이터 살펴보기</a></li>\n<li><a href=\"#j2000-%EA%B8%B0%EC%A0%90%EC%9C%BC%EB%A1%9C-%EC%B8%A1%EC%A0%95%ED%95%9C-%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C\">J2000 기점으로 측정한 궤도 요소</a></li>\n<li><a href=\"#%ED%95%9C-%EC%84%B8%EA%B8%B0-%EB%8F%99%EC%95%88%EC%9D%98-%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C-%EB%B3%80%ED%99%94%EB%9F%89\">한 세기 동안의 궤도 요소 변화량</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%ED%98%84%EC%9E%AC-%EC%8B%9C%EC%A0%90%EC%9D%98-%EC%A7%80%EA%B5%AC-%EA%B6%A4%EB%8F%84%EC%99%80-%EC%9C%84%EC%B9%98%EB%A5%BC-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90\">현재 시점의 지구 궤도와 위치를 알아보자</a></p>\n<ul>\n<li><a href=\"#%ED%98%84%EC%9E%AC-%EC%8B%9C%EC%A0%90%EC%9D%98-%EC%A7%80%EA%B5%AC-%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C-%EA%B3%84%EC%82%B0%ED%95%98%EA%B8%B0\">현재 시점의 지구 궤도 요소 계산하기</a></li>\n<li><a href=\"#%EC%A7%80%EA%B5%AC%EB%8A%94-%EA%B6%A4%EB%8F%84%EC%9D%98-%EC%96%B4%EB%94%94%EC%AF%A4%EC%97%90-%EC%9C%84%EC%B9%98%ED%95%B4%EC%9E%88%EC%9D%84%EA%B9%8C\">지구는 궤도의 어디쯤에 위치해있을까?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 저번 포스팅에 이어 실제 궤도의 모양과 크기, 위치, 방향을 정의하고 코드로 작성을 해보려고 한다. 케플러 궤도 요소 데이터 확인하기 어떤 천체든 케플러 궤도 요소를 사용하여 궤도를 구하는 방법은 동일하니, 이 포스팅에서는 우리에게 가장 익숙한 지구의 궤도를 한번 구해보도록 하자. NASA의 제트 추진 연구소 사이트(JPL)에서는 태양계 내 행성들의 케플러 궤도 요소 데이터를 제공하는데, 필자도 이 데이터를 그대로 사용하여 지구의 궤도를 구해볼 예정이다. JPL이 제공하는 궤도 데이터는 크게 세 가지인데, 이 데…","html":"<p>이번 포스팅에서는 <a href=\"/2017/05/03/calculate-orbit-1\">저번 포스팅</a>에 이어 실제 궤도의 모양과 크기, 위치, 방향을 정의하고 코드로 작성을 해보려고 한다.</p>\n<h2 id=\"케플러-궤도-요소-데이터-확인하기\" style=\"position:relative;\">케플러 궤도 요소 데이터 확인하기<a href=\"#%EC%BC%80%ED%94%8C%EB%9F%AC-%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\" aria-label=\"케플러 궤도 요소 데이터 확인하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>어떤 천체든 케플러 궤도 요소를 사용하여 궤도를 구하는 방법은 동일하니, 이 포스팅에서는 우리에게 가장 익숙한 지구의 궤도를 한번 구해보도록 하자.</p>\n<p>NASA의 <a href=\"https://ssd.jpl.nasa.gov/planets/approx_pos.html\" target=\"_blank\" rel=\"nofollow\">제트 추진 연구소 사이트(JPL)</a>에서는 태양계 내 행성들의 케플러 궤도 요소 데이터를 제공하는데, 필자도 이 데이터를 그대로 사용하여 지구의 궤도를 구해볼 예정이다.</p>\n<p>JPL이 제공하는 궤도 데이터는 크게 세 가지인데, 이 데이터들은 계산의 목적이나 정밀도에 따라 용도가 다르다.</p>\n<hr>\n<ul>\n<li>Table 1: 평균 황도와 춘분점을 기준으로 한 케플러 궤도 요소와 변화율. 서기 1800년 - 2050년 사이의 예측에 유효하며, 장기적인 궤도 요소 변화는 무시하지만 계산이 단순하고 빠름.</li>\n<li>Table 2a: Table 1과 동일한 기준으로 측정했지만, 기원전 3000년 - 서기 3000년 사이의 예측에 유효하다. 다만 더 넓은 시간 범위를 다루기 때문에 목성에서 해왕성까지의 궤도 계산에는 반드시 Table 2b의 추가 항을 적용해야한다.</li>\n<li>Table 2b: Table 2a에서 다루는 목성, 토성, 천왕성, 해왕성의 궤도 계산에 필요한 평균 근점 이각 계산을 보정하는 항이다. 이 항들은 중력 교란이나 천체 간 상호작용, 일반 상대성 효과 등을 반영했다.</li>\n</ul>\n<hr>\n<p>이 중 Table 2a와 Table 2b의 데이터는 궤도에 대한 우주 탐사 등에 필요한 고정밀 계산에 사용하는 데이터인데, 특히 목성처럼 질량이 어마무시한 행성은 다른 천체에 미치는 중력 효과가 크기 때문에 별도의 보정 값을 통해 정밀도를 높여줘야 한다.</p>\n<p>어차피 필자가 하려고 하는 계산은 단순한 시뮬레이션이라 고정밀 계산이 필요한 영역은 아니기 때문에 Table 1에서 주어진 요소만으로도 충분히 계산이 가능하다.</p>\n<h3 id=\"궤도-요소-데이터-살펴보기\" style=\"position:relative;\">궤도 요소 데이터 살펴보기<a href=\"#%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"궤도 요소 데이터 살펴보기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Table 1은 역기점인 J2000, 즉 2000년 1월 1일 정오에 측정한 궤플러 궤도 요소 값, 그리고 한 세기 동안 궤도 요소가 변화한 변화량을 의미한다. 이 테이블에서 주어진 궤도 요소 데이터는 아래와 같다.</p>\n<hr>\n<ol>\n<li>semi-major axis(<code class=\"language-text\">a</code>): 장반경. 단위는 AU이다.</li>\n<li>eccentricity(<code class=\"language-text\">e</code>): 이심률. 단위는 Radian이다.</li>\n<li>inclination(<code class=\"language-text\">I</code>): 기울기. 단위는 Degree이다.</li>\n<li>mean longitude(<code class=\"language-text\">L</code>): 평균 경도. 단위는 Degree이다.</li>\n<li>longitude of perihelion(<code class=\"language-text\">long.peri.</code>): 근일점 경도. 단위는 Degree이다.</li>\n<li>longitude of the ascending node(<code class=\"language-text\">long.node</code>): 승교점 경도. 단위는 Degree이다.</li>\n</ol>\n<hr>\n<p>JPL은 태양계 행성에 대한 모든 데이터를 제공하지만, 이 포스팅은 궤도 계산 과정을 간단하게 설명하기 위한 포스팅이니, 지구의 궤도 요소인 EM Bary라고 적혀있는 로우만 확인하면 된다. <small>(EM Bary는 지구와 달 간의 질량 중심을 의미한다. Earth/Moon Barycenter의 줄임말이다.)</small></p>\n<p>그럼 Table 1의 지구 궤도 요소를 한번 살펴보도록 하자. 이 데이터는 크게 J2000 기점으로 측정한 데이터와 한 세기 동안 궤도 요소의 변화량으로 나누어진다.</p>\n<h3 id=\"j2000-기점으로-측정한-궤도-요소\" style=\"position:relative;\">J2000 기점으로 측정한 궤도 요소<a href=\"#j2000-%EA%B8%B0%EC%A0%90%EC%9C%BC%EB%A1%9C-%EC%B8%A1%EC%A0%95%ED%95%9C-%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C\" aria-label=\"j2000 기점으로 측정한 궤도 요소 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>J2000은 율리우스력으로 2000년 1월 1일 정오를 의미한다. 이렇게 행성 궤도 요소의 기준이 되는 관측이 실시된 시기를 역기점(曆起點)이라고 한다.</p>\n<table>\n<thead>\n<tr>\n<th>a</th>\n<th>e</th>\n<th>I</th>\n<th>L</th>\n<th>long.peri.</th>\n<th>long.node</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1.00000261</td>\n<td>0.01671123</td>\n<td>-0.00001531</td>\n<td>100.46457166</td>\n<td>102.93768193</td>\n<td>0.0</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"한-세기-동안의-궤도-요소-변화량\" style=\"position:relative;\">한 세기 동안의 궤도 요소 변화량<a href=\"#%ED%95%9C-%EC%84%B8%EA%B8%B0-%EB%8F%99%EC%95%88%EC%9D%98-%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C-%EB%B3%80%ED%99%94%EB%9F%89\" aria-label=\"한 세기 동안의 궤도 요소 변화량 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>이 값들은 한 세기 동안 궤도 요소가 변화한 값을 의미한다. 이 값들을 이용하면 현재 이 포스팅을 작성하고 있는 2017년 5월 3일 22시 27분의 지구 궤도 요소가 어떤 상태인지 구해볼 수 있다.</p>\n<table>\n<thead>\n<tr>\n<th>a</th>\n<th>e</th>\n<th>I</th>\n<th>L</th>\n<th>long.peri.</th>\n<th>long.node</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0.00000562</td>\n<td>-0.00004392</td>\n<td>-0.01294668</td>\n<td>35999.37244981</td>\n<td>0.32327364</td>\n<td>0.0</td>\n</tr>\n</tbody>\n</table>\n<p>이제 이 값들을 토대로 해서 현재 지구가 궤도 상 어디쯤에 위치해있는지를 계산해보자.</p>\n<h2 id=\"현재-시점의-지구-궤도와-위치를-알아보자\" style=\"position:relative;\">현재 시점의 지구 궤도와 위치를 알아보자<a href=\"#%ED%98%84%EC%9E%AC-%EC%8B%9C%EC%A0%90%EC%9D%98-%EC%A7%80%EA%B5%AC-%EA%B6%A4%EB%8F%84%EC%99%80-%EC%9C%84%EC%B9%98%EB%A5%BC-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90\" aria-label=\"현재 시점의 지구 궤도와 위치를 알아보자 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>위 데이터를 살펴보면 이전 포스팅에서 설명했던 케플러 궤도 요소 중 근일점 편각과 근일점 통과 시각이 없는 것을 볼 수 있지만, 큰 문제는 없다.</p>\n<p>우선 근일점 편각의 경우 결국 근일점이 승교점으로부터 얼마나 떨어져있는지를 의미하는 것이니 이미 주어진 근일점 경도와 승교점 경도만으로도 충분히 계산이 가능하다. 하지만 이 포스팅에서는 2차원의 궤도 평면 상에서의 행성 위치만 구할 것이기 때문에 궤도의 포지션을 결정할 때 필요한 근일점 편각은 계산할 필요가 없다.</p>\n<p>또한 근일점 통과 시각은 결국 특정 시간을 기점으로 행성이 어디에 위치해있는지를 알아내기 위한 시간 개념인데, JPL 데이터는 J2000에 측정된 값과 한 세기 동안의 변화량을 함께 알려주고 있으므로 시간의 흐름에 따른 궤도 요소의 변화 또한 충분히 표현되고 있다.</p>\n<p>태양을 중심으로 공전하는 행성의 위치를 계산하는 방법의 포인트는 결국 궤도 요소를 기반으로 <a href=\"https://ko.wikipedia.org/wiki/%ED%8F%89%EA%B7%A0_%EA%B7%BC%EC%A0%90_%EC%9D%B4%EA%B0%81\" target=\"_blank\" rel=\"nofollow\">평균 근점 이각(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span>)</a>과 <a href=\"https://ko.wikipedia.org/wiki/%ED%8E%B8%EC%8B%AC%EC%9D%B4%EA%B0%81\" target=\"_blank\" rel=\"nofollow\">편심이각(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span>)</a>를 계산한 뒤, 궤도 평면 상에서의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span> 좌표를 구하는 것이다.</p>\n<p>이때 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span></span> 좌표를 고려하지 않는 이유는 어차피 궤도 평면 상에서의 행성 위치를 구한 뒤 궤도의 기울기(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">I</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span></span>)와 승교점 경도(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Ω</mi></mrow><annotation encoding=\"application/x-tex\">\\Omega</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Ω</span></span></span></span></span>), 근일점 편각(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ω</mi></mrow><annotation encoding=\"application/x-tex\">\\omega</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span></span></span></span></span>)을 고려하여 3차원 공간에 궤도를 배치해주면 자연스럽게 3차원 공간에서의 행성 위치도 따라오기 때문이다.</p>\n<p>결국 위에서 주어진 데이터를 토대로 평균 근점 이각과 편심이각을 구할 수 있냐는 것이 중요한데, 앞서 언급했듯이 이미 주어진 값들로도 충분히 계산이 가능하기 때문에 큰 문제는 없다.</p>\n<p>그럼 본격적으로 한번 궤도 요소를 구해보도록 하자.</p>\n<h3 id=\"현재-시점의-지구-궤도-요소-계산하기\" style=\"position:relative;\">현재 시점의 지구 궤도 요소 계산하기<a href=\"#%ED%98%84%EC%9E%AC-%EC%8B%9C%EC%A0%90%EC%9D%98-%EC%A7%80%EA%B5%AC-%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C-%EA%B3%84%EC%82%B0%ED%95%98%EA%B8%B0\" aria-label=\"현재 시점의 지구 궤도 요소 계산하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>앞서 언급했듯이 JPL에서 가져온 데이터는 J2000 기준으로 측정한 궤도 요소 값과 한 세기 동안의 궤도 요소 변화량이다.</p>\n<p>그렇기 때문에 현재의 궤도 요소 값을 알아내려면 J2000으로부터 현재까지 몇 세기가 지났는지를 알아낸 후, 한 세기 동안의 변화량에 해당 값을 곱해서 최종 궤도 요소 값을 보정해줘야 한다.</p>\n<p>계산을 쉽게 하기 위해 각 시간 단위들을 원하는대로 변경할 수 있는 함수들을 먼저 선언해주도록 하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token constant\">DAY</span> <span class=\"token operator\">=</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">24</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">YEAR</span> <span class=\"token operator\">=</span> <span class=\"token number\">365.25</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 율리우스력은 1년을 365.25일로 정의한다</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">convertMillisecondsToSeconds</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>milliseconds<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> milliseconds <span class=\"token operator\">/</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">convertSecondsToDays</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>seconds<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> seconds <span class=\"token operator\">/</span> <span class=\"token constant\">DAY</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">convertDaysToYears</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>days<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> days <span class=\"token operator\">/</span> <span class=\"token constant\">YEAR</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">convertYearsToCenturies</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>years<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> years <span class=\"token operator\">/</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이제 역기점인 J2000으로부터 현재까지 몇 세기가 지났는지를 확인해보면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token constant\">J2000</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2000-01-01T12:00:00-00:00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> now <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2017-05-03T22:27:00-00:00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> epochTime <span class=\"token operator\">=</span> <span class=\"token function\">convertMillisecondsToSeconds</span><span class=\"token punctuation\">(</span>\n    today<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token constant\">J2000</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Date객체끼리 연산하면 값이 ms로 나오기 때문에 1000으로 나눠서 초 단위로 나오게끔 환산해준다</span>\n<span class=\"token comment\">// 결과: 547,122,420초</span>\n\n<span class=\"token keyword\">const</span> centuries <span class=\"token operator\">=</span> \n  <span class=\"token function\">convertYearsToCenturies</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">convertDaysToYears</span><span class=\"token punctuation\">(</span>\n      <span class=\"token function\">convertSecondsToDays</span><span class=\"token punctuation\">(</span>epochTime<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 결과: 0.17337263289984028세기</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>결과적으로 J2000부터 현재까지는 약 <code class=\"language-text\">6,332.43</code>일이 지났으며, 이를 세기로 환산해보면 약 <code class=\"language-text\">0.1734</code>세기가 지났다는 사실을 알 수 있다. 이제 역기점으로부터 몇 세기가 지났는지 알았으니 JPL에서 가져온 궤도 요소를 선언하고 현재 시점의 지구 궤도 요소를 계산해보도록 하자.</p>\n<p>필자는 앞으로의 계산을 용이하게 하기 위해 해당 데이터의 AU 단위를 모두 km로 환산하려고 한다. 1AU는 태양과 지구 간의 평균 거리를 의미하며 약 149,597,870km 이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">KeplerOrbitElement</span> <span class=\"token punctuation\">{</span>\n  장반경<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  이심률<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  기울기<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  승교점경도<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  평균경도<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  근일점경도<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">JPLOrbitElementData</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">J2000</span><span class=\"token operator\">:</span> KeplerOrbitElement<span class=\"token punctuation\">;</span>\n  한세기변화량<span class=\"token operator\">:</span> KeplerOrbitElement<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token constant\">AU</span> <span class=\"token operator\">=</span> <span class=\"token number\">149597870</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">convertAUtoKM</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>au<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> au <span class=\"token operator\">*</span> <span class=\"token number\">149_597_870</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> 지구_궤도요소<span class=\"token operator\">:</span> JPLOrbitElementData <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">J2000</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    장반경<span class=\"token operator\">:</span> <span class=\"token function\">convertAUtoKM</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.00000261</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 149598260.45044068km</span>\n    이심률<span class=\"token operator\">:</span> <span class=\"token number\">0.01671123</span><span class=\"token punctuation\">,</span>\n    기울기<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">0.00001531</span><span class=\"token punctuation\">,</span>\n    승교점경도<span class=\"token operator\">:</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span>\n    평균경도<span class=\"token operator\">:</span> <span class=\"token number\">100.46457166</span><span class=\"token punctuation\">,</span>\n    근일점경도<span class=\"token operator\">:</span> <span class=\"token number\">102.93768193</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  한세기변화량<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    장반경<span class=\"token operator\">:</span> <span class=\"token function\">convertAUtoKM</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.00000562</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 840.7400294km</span>\n    이심률<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">0.00004392</span><span class=\"token punctuation\">,</span>\n    기울기<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">0.01294668</span><span class=\"token punctuation\">,</span>\n    승교점경도<span class=\"token operator\">:</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span>\n    평균경도<span class=\"token operator\">:</span> <span class=\"token number\">35999.37244981</span><span class=\"token punctuation\">,</span>\n    근일점경도<span class=\"token operator\">:</span> <span class=\"token number\">0.32327364</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>궤도 요소의 선언이 끝났다면 이제 계산을 해볼 차례이다. 객체 프로퍼티에 대한 매핑 연산을 쉽게하기 위해 추상화된 <a href=\"https://es-toolkit.slash.page/reference/object/mapValues.html\" target=\"_blank\" rel=\"nofollow\">mapValues</a> 함수를 사용하면 간단하게 표현할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> 현재궤도요소 <span class=\"token operator\">=</span> <span class=\"token function\">mapValues</span><span class=\"token punctuation\">(</span>지구_궤도요소<span class=\"token punctuation\">.</span><span class=\"token constant\">J2000</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> element <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>지구_궤도요소<span class=\"token punctuation\">.</span>한세기변화량<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> centuries<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/**\n  {\n    장반경: 149598406.21175316,\n    이심률: 0.01670361547396304,\n    기울기: -0.0022599099989117043,\n    승교점경도: 0,\n    평균경도: 6341.770556025533,\n    근일점경도: 102.99372873211391\n  } \n */</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이렇게 간단한 과정을 통해 2017년 5월 3일 22시 27분의 지구 궤도 요소의 상태를 구해볼 수 있었다. 이제 이 값들을 사용하여 본격적으로 지구가 궤도 상 어디에 위치해있는지를 구해보도록 하자.</p>\n<h3 id=\"지구는-궤도의-어디쯤에-위치해있을까\" style=\"position:relative;\">지구는 궤도의 어디쯤에 위치해있을까?<a href=\"#%EC%A7%80%EA%B5%AC%EB%8A%94-%EA%B6%A4%EB%8F%84%EC%9D%98-%EC%96%B4%EB%94%94%EC%AF%A4%EC%97%90-%EC%9C%84%EC%B9%98%ED%95%B4%EC%9E%88%EC%9D%84%EA%B9%8C\" aria-label=\"지구는 궤도의 어디쯤에 위치해있을까 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>앞서 언급했듯이 케플러 궤도 요소를 사용한 궤도 계산의 포인트는 평균 근점 이각과 편심 이각을 구하고, 이를 토대로 궤도 평면 상에서 행성의 위치를 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>와 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span> 좌표로 나타내는 것이다. 이제 이 값들을 구해보면서 왜 궤도 계산에 이러한 값들이 필요한 것인지도 한번 살펴보도록 하겠다.</p>\n<h4 id=\"평균-근점-이각-구하기\" style=\"position:relative;\">평균 근점 이각 구하기<a href=\"#%ED%8F%89%EA%B7%A0-%EA%B7%BC%EC%A0%90-%EC%9D%B4%EA%B0%81-%EA%B5%AC%ED%95%98%EA%B8%B0\" aria-label=\"평균 근점 이각 구하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p><a href=\"https://ko.wikipedia.org/wiki/%ED%8F%89%EA%B7%A0_%EA%B7%BC%EC%A0%90_%EC%9D%B4%EA%B0%81\" target=\"_blank\" rel=\"nofollow\">평균 근점 이각</a>은 고전 이체 문제에서 타원 궤도 상의 물체의 위치를 계산하기 사용하는 각도이다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/a7b4621e50eb2b0ac7db1f5d349d81e7/f56c3/mean-anomaly-ko.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 98.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMCAQX/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAfdjaLVnCbyJoH//xAAaEAEAAgMBAAAAAAAAAAAAAAABAAISICEx/9oACAEBAAEFAlmXTyNYVNP/xAAVEQEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAwEBPwEj/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFhAAAwAAAAAAAAAAAAAAAAAAACEw/9oACAEBAAY/AhQ//8QAGRABAAIDAAAAAAAAAAAAAAAAAQARECEx/9oACAEBAAE/IRJouo2l9jdajKKqsAYWsf/aAAwDAQACAAMAAAAQ88g8/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAEQETH/2gAIAQMBAT8QwOp//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAGhAAAwEBAQEAAAAAAAAAAAAAAAERITFREP/aAAgBAQABPxBCn2uYOerv3q+KpPir0wEA8sIpWDSY6Jmi4j//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"mean anomaly ko\" title=\"\" src=\"/static/a7b4621e50eb2b0ac7db1f5d349d81e7/c08c5/mean-anomaly-ko.jpg\" srcset=\"/static/a7b4621e50eb2b0ac7db1f5d349d81e7/0913d/mean-anomaly-ko.jpg 160w,\n/static/a7b4621e50eb2b0ac7db1f5d349d81e7/cb69c/mean-anomaly-ko.jpg 320w,\n/static/a7b4621e50eb2b0ac7db1f5d349d81e7/c08c5/mean-anomaly-ko.jpg 640w,\n/static/a7b4621e50eb2b0ac7db1f5d349d81e7/6a068/mean-anomaly-ko.jpg 960w,\n/static/a7b4621e50eb2b0ac7db1f5d349d81e7/eea4a/mean-anomaly-ko.jpg 1280w,\n/static/a7b4621e50eb2b0ac7db1f5d349d81e7/f56c3/mean-anomaly-ko.jpg 2128w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small></small>\n</center>\n<p>위 그림은 행성이 궤도를 따라 운동할 때 같은 시간동안 쓸고 지나간 면적을 보여주고 있다. 이때 회색 궤도의 면적은 조금씩 다른데 반해 분홍색 궤도의 면적은 동일한 것을 볼 수 있다.</p>\n<p>기본적으로 타원 궤도를 도는 행성은 케플러 제2법칙인 <a href=\"https://ko.wikipedia.org/wiki/%EC%BC%80%ED%94%8C%EB%9F%AC%EC%9D%98_%ED%96%89%EC%84%B1%EC%9A%B4%EB%8F%99%EB%B2%95%EC%B9%99\" target=\"_blank\" rel=\"nofollow\">면적속도 일정</a>에 따라 비선형적인 움직임을 보인다. 즉, 근일점 근처에서는 행성의 운동 속도가 빨라지고 원일점 근처에서는 느려진다는 것이다.</p>\n<p>이때 평균 근점 이각은 어떤 물체가 공전 속도와 공전 주기를 유지한 채 정확한 원 궤도로 옮겨간다고 가정했을 때의 물체와 근일점간의 각거리를 의미한다. 이렇게 궤도를 원에 가까운 형태로 단순화하면 궤도 상 행성의 위치를 표현하는 각도도 시간에 대해 선형적으로 증가하기 때문에 계산이 단순해지는 것이다.</p>\n<p>물론 행성의 궤도 이심률이 0이라 완벽한 원이라면 실제 행성도 이렇게 움직이겠지만, 대부분의 궤도는 타원 형태이기 때문에 평균 근점 이각과 이심률을 사용하여 계산을 다시 보정하고 실제 행성의 움직임을 알아내는 과정을 거칠 것이다.</p>\n<p>이처럼 평균 근점 이각은 궤도 상의 행성 위치를 계산하기 위한 가장 기본적인 재료로 사용된다. 평균 근점 이각을 구하는 방법은 여러가지가 있지만 이미 필자는 평균 경도와 근일점 경도를 알고 있기 때문에 이 값들을 사용하여 평균 근점 이각을 구할 것이다.</p>\n<p>평균 경도(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span>)과 근일점 경도(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ω</mi></mrow><annotation encoding=\"application/x-tex\">\\omega</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span></span></span></span></span>)로 평균 근점 이각을 구하는 공식은 아래와 같다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>M</mi><mo>=</mo><mi>l</mi><mo>−</mo><mi>ω</mi></mrow><annotation encoding=\"application/x-tex\">M = l - \\omega</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span></span></span></span></span></div>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> 평균근점이각 <span class=\"token operator\">=</span> 현재궤도요소<span class=\"token punctuation\">.</span>평균경도 <span class=\"token operator\">-</span> 현재궤도요소<span class=\"token punctuation\">.</span>근일점경도<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 6238.776827293419도</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>이 원리를 이해하려면 평균 경도가 무엇인지에 대한 이해가 조금 더 필요한데, 계산에 사용된 평균 경도는 춘분점을 기준으로 행성이 궤도 상에서 얼마나 진행했는지를 평균적으로 나타내는 값이다. 평균 경도(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span>)는 아래와 같은 수식으로 표현할 수 있다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>l</mi><mo>=</mo><mfrac><mrow><mn>2</mn><mi>π</mi></mrow><mi>P</mi></mfrac><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><msub><mi>T</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi>ϖ</mi></mrow><annotation encoding=\"application/x-tex\">l = \\frac{2\\pi}{P}(t - T_0) + \\varpi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">ϖ</span></span></span></span></span></div>\n<hr>\n<ul>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mn>2</mn><mi>π</mi></mrow><mi>P</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{2\\pi}{P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>: 평균 운동(행성이 공전 궤도를 한 바퀴 도는데 걸리는 시간 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span>). 이는 행성이 궤도 상에서 운동하는 총 각도인 360도, 즉 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">2\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span> 라디안을 행성의 공전 주기로 나눠준 것이다.</li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><msub><mi>T</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(t - T_0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>: 기준 시점 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">T_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>로부터 경과한 시간. 이때 기준 시점 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">T_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>는 역기점 J2000이다.</li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ω</mi></mrow><annotation encoding=\"application/x-tex\">\\omega</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span></span></span></span></span>: 근일점 경도.</li>\n</ul>\n<hr>\n<p>이때 이 수식의 모양을 보면 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>−</mo><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">t - T_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6984em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>가 0인 경우 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mo>=</mo><mi>ω</mi></mrow><annotation encoding=\"application/x-tex\">l = \\omega</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span></span></span></span></span>, 평균 경도와 근일점 경도가 같다는 결론이 도출되는데, 이를 통해 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mn>2</mn><mi>π</mi></mrow><mi>P</mi></mfrac><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><msub><mi>T</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\frac{2\\pi}{P}(t - T_0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>라는 수식이 근일점을 기준으로 행성이 평균적으로 이동한 각도를 나타낸다는 것을 알 수 있다.</p>\n<p>그래서 마지막으로 근일점 경도(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ω</mi></mrow><annotation encoding=\"application/x-tex\">\\omega</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span></span></span></span></span>)를 더해줌으로써 평균 경도의 기준점을 춘분점으로부터의 각도로 변경해주는 것이다.</p>\n<p>하지만 우리에게 필요한 평균 근점 이각은 이름에서 알 수 있듯이, 춘분점이 아닌 근일점을 기준으로 잡는 값이다. 그래서 평균 경도에서 다시 근일점 경도를 다시 빼줌으로써 각도의 기준을 다시 근일점으로 만들어주는 것이다.</p>\n<h4 id=\"편심-이각-구하기\" style=\"position:relative;\">편심 이각 구하기<a href=\"#%ED%8E%B8%EC%8B%AC-%EC%9D%B4%EA%B0%81-%EA%B5%AC%ED%95%98%EA%B8%B0\" aria-label=\"편심 이각 구하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>이렇게 평균 근점 이각을 통해 행성이 궤도 상의 근일점을 기준으로 얼마나 이동했는지를 구했다면 이제는 <a href=\"https://ko.wikipedia.org/wiki/%ED%8E%B8%EC%8B%AC%EC%9D%B4%EA%B0%81\" target=\"_blank\" rel=\"nofollow\">편심 이각(Eccentric anomaly)</a>을 구할 차례이다.</p>\n<p>앞서 구했던 평균 근점 이각은 마치 시간을 일정한 속도로 돌리는 시계와 같다. 이제 시간이 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span></span>만큼 흘렀으니 행성도 각도 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span>만큼 이동했을 것이라고 단순하게 계산하는 것이다.</p>\n<p>하지만 실제로 타원 궤도를 도는 행성의 속도는 중심체와의 거리에 따라 비선형적으로 달라진다. 그래서 우리는 평균 근점 이각과 이심률을 사용하여 편심 이각이라는 값을 구함으로써 빨라졌다가 느려졌다가 하는 행성의 비선형적인 운동을 반영하여 정확한 위치를 알아내어야 한다.</p>\n<p>편심 이각은 실제 타원 궤도의 행성 위치를 단순화하기 위해 정의된 각도이며, 실제 타원 궤도의 장반경을 반지름으로 가지는 가상의 원 궤도에 행성의 위치를 투영했을 때의 중심각을 의미한다. 그림으로 보면 더 직관적으로 이해하기가 쉽다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c365db79e876e64320f24144048329b1/d9ed5/eccentric-anomaly-2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 83.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACY0lEQVR42qWTT2gTURDGf8k2aVK3+bebbappKzW1SWoCqRUrojmkSPHWQg8VagVBhOJBL41SyKEeBD3owZMnD4IUxIsnBRHx4Fn8Az2KggdPEUtPrvN2N3ETS1Uc+Hhvdt/7Zt7MN4AdoMOUb4d86PpPt7+T2UFBRJDwEO9CUrBHoP0Fqa0LDEG/l5G2Q7CQRyjBrg2CNfAnwnZEW6I3aCgSZ21A0G5npM6tluD2sBvkv01ledGCYlj2Kdfvsg3QJANdsPeDyeGnOaa/hZgQf3xbbj7fz9E3GabehQtjN3iUrYGUJ9er7uo0TSGNdsaE/JcE5bsVysunyWyMEv8MffI9LIi8Mui/soi5lF889sIaLX2HlWcw45bBDujYaVl72oT1MyR5TGKXZwYcBRjSNJvQpRzFJhSE8JAgK//CrgpadgtTv0q6WqVnl6YNLHjdj86SXZ9gSO2lJGOqNCnsmEvsFlGjIWQNTC4TZZlIp9Z+xFxSz1LElmoc/Joj5pUsu8lURXZ9ncpXpNcZ5Ca+zqnaON0M+MSsF0+Run+c4dapbfTCPdYKfsJfpPJ8LuBpzCl4qz5Bb40zS+/6PCOSXVwQUs17yUzVHYLfdaTxQBo1/VHk8CQDm+mu6ZFRpKe2grGVZOiTyEgRNhnJvydvqANJH1LOhVEszPwk7JMuzsmoHTE8IlW3jHN2gcy4RUmiHTgv99YIVc5CufUUP9TzlVgT3tpCzAva7/hzWH0mg2mlb7G3pIp1Yrnd5izQUV+c7quGhSU7jTqGbzi015w80SHwf7I79LLqlMCxLSLDDzk3qZyfRsqbeSrY0uAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"eccentric anomaly 2\" title=\"\" src=\"/static/c365db79e876e64320f24144048329b1/6af66/eccentric-anomaly-2.png\" srcset=\"/static/c365db79e876e64320f24144048329b1/69538/eccentric-anomaly-2.png 160w,\n/static/c365db79e876e64320f24144048329b1/72799/eccentric-anomaly-2.png 320w,\n/static/c365db79e876e64320f24144048329b1/6af66/eccentric-anomaly-2.png 640w,\n/static/c365db79e876e64320f24144048329b1/d9199/eccentric-anomaly-2.png 960w,\n/static/c365db79e876e64320f24144048329b1/21b4d/eccentric-anomaly-2.png 1280w,\n/static/c365db79e876e64320f24144048329b1/d9ed5/eccentric-anomaly-2.png 2880w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>위 그림에서 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span>는 궤도 상 행성의 위치를 나타내며, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>P</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">P'</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span>는 실제 궤도의 장반경인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span></span>를 반지름으로 가지는 가상의 원 궤도에 투영된 행성의 위치를 나타낸다.</p>\n<p>이때 실제 궤도인 타원의 중심은 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span>, 타원의 초점은 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span></span>로 나타내고 있다. 이때 타원의 초점은 궤도의 중력 중심을 의미하며, 태양계로 치면 태양이 될 것이다. 그리고 편심 이각 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span>는 타원의 중심인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span>부터 가상의 원 궤도에 투영된 행성의 위치인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>P</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">P'</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span>까지의 각도를 의미한다.</p>\n<p>편심 이각도 평균 근점 이각과 마찬가지로 가상의 원 궤도에 반영된 행성 위치를 표현한 각도이지만, 편심 이각 계산에는 이심률이 사용되므로 평균 근점 이각과는 다르게 타원 궤도의 기하학적인 특성이 반영되어 비선형적인 증가율을 보이게 된다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/54cc99e748edcd1fc096e8849a6441d0/11f9c/m_vs_e.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 64.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAB7CAAAewgFu0HU+AAABcElEQVR42qVTi3KDIBDk//+yVVujAV+IqMj2ltQ0yaSxM70ZBzyX9Y7bVZDYwoq4BazrirquUVUVjDE4n89omgZd10FrjbZtU4575vkYo7EsC2kQY4SaZy8gDaNb5HkmT46iKDDP8xX0GCl3k49xlZ9ZKSgRztCmgXU+/bHve4zjiBACjiNiXkYUVYemveCV9z618pdIhX3vtyCdyVW8lQ7t8FOtItkwDIdEe2zbgla6yE8WVbNJm/dYVZZlavOQKEQMvUNVW5gu3BHd4hSn9ljhDuA6+SiTnNA3E5xbpcLnRFdCSoSyeCTqbcRHPaHWPaiEu6m+uB7lnEuEO9464P3k8Xnu4L09OP6EkGLep1ybIFMT2ThWHH5t6yXhJpcy2kGqFJcYEi34TyiqvpMpG92IhSYZkAW1yclba7FfCQ3Ald+4Ms/vxE3TlLokRl20RT0tyVLOjemdB3iYjqF3qYYsyxKGTqJ/SUAcMVQKvfwFtwj7PCL7F18AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"m vs e\" title=\"\" src=\"/static/54cc99e748edcd1fc096e8849a6441d0/6af66/m_vs_e.png\" srcset=\"/static/54cc99e748edcd1fc096e8849a6441d0/69538/m_vs_e.png 160w,\n/static/54cc99e748edcd1fc096e8849a6441d0/72799/m_vs_e.png 320w,\n/static/54cc99e748edcd1fc096e8849a6441d0/6af66/m_vs_e.png 640w,\n/static/54cc99e748edcd1fc096e8849a6441d0/d9199/m_vs_e.png 960w,\n/static/54cc99e748edcd1fc096e8849a6441d0/21b4d/m_vs_e.png 1280w,\n/static/54cc99e748edcd1fc096e8849a6441d0/11f9c/m_vs_e.png 1707w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>\n    JPL의 지구 궤도 요소 중 이심률을 0.6으로 변경한 뒤 계산한 평균 근점 이각과 편심 이각의 변화.<br>\n    근일점인 0일에는 차이가 적지만 원일점인 180일에 가까울수록 차이가 커지는 모습을 볼 수 있다.\n  </small>\n</center>\n<p>그리고 편심 이각을 구하면 최종적으로 중력 중심체의 위치인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span></span>부터 실제 행성의 위치인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span>까지의 거리, 그리고 각도 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span></span>인 진근점이각을 알아낼 수 있다.</p>\n<p>평균근점이각과 마찬가지로 편심이각도 여러 개의 정의로 나타내어질 수 있는데, 필자는 이미 평균근점이각을 구했기 때문에 평균근점이각으로부터 유도되는 공식을 사용하겠다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>E</mi><mo>=</mo><mfrac><mrow><mi>M</mi><mo>+</mo><mi>e</mi><mi>sin</mi><mo>⁡</mo><mi>M</mi></mrow><mrow><mn>1</mn><mo>−</mo><mi>e</mi><mi>cos</mi><mo>⁡</mo><mi>M</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">E = \\frac{M+e \\sin M}{1-e \\cos M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1297em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></div>\n<p>위 공식은 평균 근점 이각(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span>)과 타원의 이심률(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span></span>)를 사용해 편심 이각을 계산하고 있다. 이때 행성의 운동이 가지는 비선형적 특성은 이심률이 클수록 강해지는데, 이를 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>sin</mi><mo>⁡</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">e \\sin M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span>과 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>cos</mi><mo>⁡</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">e \\cos M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span> 항을 통해 반영해주는 것이다.</p>\n<p>이때 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>sin</mi><mo>⁡</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">e \\sin M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span>은 타원의 비선형 운동에 맞춰 평균 근점 이각을 보정하고, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>cos</mi><mo>⁡</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">e \\cos M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span>은 행성의 위치가 근일점과 원일점 어느 곳에 가까운지를 나타내는 정규화 인자 역할을 한다.</p>\n<p>만약 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">e = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>이라면 궤도는 완벽한 원이 될테니 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi><mo>=</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">E = M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span>이라는 공식이 성립하겠지만, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mo>></mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">e > 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>라서 궤도가 타원일 경우 근일점 근처에서는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>sin</mi><mo>⁡</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">e \\sin M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span>과 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>cos</mi><mo>⁡</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">e \\cos M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span>이 작아져 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span>와 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span>의 차이도 작아지고, 원일점 근처에서는 두 값이 커져 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span>와 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span> 간의 차이가 커진다.</p>\n<p>하지만 안타깝게도 편심 이각을 구하는 공식은 비선형 방정식이라 정확한 해가 아닌 근사값을 뱉어내기 때문에 <a href=\"https://en.wikipedia.org/wiki/Newton%27s_method\" target=\"_blank\" rel=\"nofollow\">뉴턴-랩슨 메소드</a>를 사용하여 오차를 줄여줘야한다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>E</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>E</mi><mi>n</mi></msub><mo>−</mo><mfrac><mrow><msub><mi>E</mi><mi>n</mi></msub><mo>−</mo><mi>e</mi><mi>sin</mi><mo>⁡</mo><msub><mi>E</mi><mi>n</mi></msub><mo>−</mo><mi>M</mi></mrow><mrow><mn>1</mn><mo>−</mo><mi>e</mi><mi>cos</mi><mo>⁡</mo><msub><mi>E</mi><mi>n</mi></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">E_{n+1} = E_n - \\frac{E_n - e \\sin E_n - M}{1 - e \\cos E_n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1963em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></div>\n<p>자, 그럼 편심 이각을 구하는 방법을 알았으니 본격적인 계산을 진행해보자. JavaScript의 <code class=\"language-text\">Math.sin</code>, <code class=\"language-text\">Math.cos</code>와 같은 삼각함수 메소드들은 인자로 Degree 단위가 아닌 Radian 단위를 받기 때문에 계산에 사용할 평균 근점 이각을 Radian 단위로 변경해주어야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">convertDegreeToRadian</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>degree<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> degree <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span> <span class=\"token operator\">/</span> <span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> 평균근점이각 <span class=\"token operator\">=</span> <span class=\"token function\">convertDegreeToRadian</span><span class=\"token punctuation\">(</span>현재궤도요소<span class=\"token punctuation\">.</span>평균경도 <span class=\"token operator\">-</span> 현재궤도요소<span class=\"token punctuation\">.</span>근일점경도<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>이후 반복 계산을 도와줄 뉴턴-랩슨 메소드 함수와 편심이각을 구하는 함수를 선언하고 6회 반복 계산해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">뉴턴랩슨메소드</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token function-variable function\">callback</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> 초기값<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> 계산횟수<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> 초기값<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> x1 <span class=\"token operator\">=</span> 초기값<span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> 계산횟수<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    x <span class=\"token operator\">=</span> x1<span class=\"token punctuation\">;</span>\n    x1 <span class=\"token operator\">=</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> x1<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token keyword\">get</span><span class=\"token function\">편심이각</span><span class=\"token punctuation\">(</span>이심률<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> 평균근점이각<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>편심이각<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> 편심이각 <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>평균근점이각 <span class=\"token operator\">+</span> 이심률 <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>편심이각<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> 편심이각<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> 이심률 <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>편심이각<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> 편심이각 <span class=\"token operator\">=</span> <span class=\"token function\">뉴턴랩슨메소드</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">get</span><span class=\"token function\">편심이각</span><span class=\"token punctuation\">(</span>현재궤도요소<span class=\"token punctuation\">.</span>이심률<span class=\"token punctuation\">,</span> 평균근점이각<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> 평균근점이각<span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 108.9017193604219라디안</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이때 이심률이 클수록 <code class=\"language-text\">get편심이각</code> 함수가 뱉는 결과값의 오차도 크기 때문에 더 많은 횟수를 반복 계산해주어야 한다. 하지만 이 포스팅에서 예시로 사용하고 있는 지구 궤도의 이심률은 약 <code class=\"language-text\">0.02</code> 정도로 원에 가깝기 때문에 6회 정도만 계산을 진행해준 것이다.</p>\n<p>이렇게 편심 이각을 구했다면 이제 지금까지 모은 재료들을 토대로 궤도 평면 상에 위치한 행성의 진짜 위치를 밝혀낼 차례이다.</p>\n<h4 id=\"궤도-평면-상의-행성-x-y-좌표-구하기\" style=\"position:relative;\">궤도 평면 상의 행성 x, y 좌표 구하기<a href=\"#%EA%B6%A4%EB%8F%84-%ED%8F%89%EB%A9%B4-%EC%83%81%EC%9D%98-%ED%96%89%EC%84%B1-x-y-%EC%A2%8C%ED%91%9C-%EA%B5%AC%ED%95%98%EA%B8%B0\" aria-label=\"궤도 평면 상의 행성 x y 좌표 구하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>이제는 궤도 평면 상에서 행성이 어디에 위치한 것인지를 알아내어 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>와 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span> 좌표로 표현할 차례이다. 지금 구하는 좌표들은 타원의 중심을 기준으로 하는 좌표들이지만, 최종적으로 이 좌표들을 이용하여 지구가 태양을 기준으로 얼마나 멀리 떨어져있는지, 그리고 근일점을 기준으로 몇 도나 돌아간 곳에 위치한 것인지를 알아낼 것이다.</p>\n<p>먼저 타원의 중심을 기준으로 행성의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span> 좌표를 구하는 공식은 아래와 같다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>a</mi><mo>⋅</mo><mo stretchy=\"false\">(</mo><mi>cos</mi><mo>⁡</mo><mi>E</mi><mo>−</mo><mi>e</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x = a \\cdot (\\cos E - e)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mclose\">)</span></span></span></span></span></div>\n<p>편심 이각은 타원의 복잡한 비율을 반영하기 어렵기 때문에 가상의 원 궤도에 투영된 행성의 위치를 나타내는 값이다. 그래서 편심 이각을 사용하여 실제 타원 궤도에 위치한 행성의 위치를 구할 때는 가상의 원 궤도와 실제 타원 궤도 간의 차이를 보정해주게 된다.</p>\n<p><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span> 좌표를 구하는 공식의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>cos</mi><mo>⁡</mo><mi>E</mi><mo>−</mo><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">\\cos E - e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span></span> 항이 이 보정을 수행하는 과정이다. <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>cos</mi><mo>⁡</mo><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">\\cos E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span>는 편심 이각(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span>)를 기준으로 행성이 가상의 원 궤도에서 수평 방향으로 얼마나 떨어져 있는지를 계산한다. 이후 이심률 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span></span>를 빼줌으로써 최종 값은 타원의 중심과 초점 사이의 거리만큼 이동하게 되는 것이다.</p>\n<p>여기까지 계산한 값은 그저 타원의 장반경에 대한 비율인 무차원값이기 때문에 최종적으로 장반경(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span></span>)를 곱해줌으로서 궤도의 스케일을 확정해준다.</p>\n<p><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span> 좌표를 구하는 공식도 원리는 비슷하다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>a</mi><mo>⋅</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mi>e</mi><mn>2</mn></msup></mrow></msqrt><mo>⋅</mo><mi>sin</mi><mo>⁡</mo><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">y = a \\cdot \\sqrt{1 - e^2} \\cdot \\sin E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.24em;vertical-align:-0.1777em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0623em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.0223em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.28em\" viewBox=\"0 0 400000 1296\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span></div>\n<p><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span> 좌표 또한 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">\\sin E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span>를 통해 가상의 원 궤도에서 행성이 수직 방향으로 얼마나 떨어져 있는지를 먼저 계산하고, 이후 가상의 원 궤도와 실제 타원 궤도와의 차이를 보정하는 방법을 사용한다.</p>\n<p>다만 이때는 타원의 수직 방향으로의 보정이 필요하기 때문에 장반경이 아닌 단반경을 사용해야하는데, 위 공식의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>⋅</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msup><mi>e</mi><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">a \\cdot \\sqrt{1 - e^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.1266em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9134em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.8734em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1266em;\"><span></span></span></span></span></span></span></span></span></span>가 바로 장반경과 이심률을 사용하여 단반경을 구하는 공식이다.</p>\n<p>대략의 원리를 알았다면 이제 코드를 작성하고 지구의 좌표를 뽑아보도록 하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> positionX <span class=\"token operator\">=</span> 현재궤도요소<span class=\"token punctuation\">.</span>장반경 <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>\n    Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>편심이각<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> 현재궤도요소<span class=\"token punctuation\">.</span>이심률\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> positionY <span class=\"token operator\">=</span> 현재궤도요소<span class=\"token punctuation\">.</span>장반경 <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>\n    Math<span class=\"token punctuation\">.</span><span class=\"token function\">sqrt</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>현재궤도요소<span class=\"token punctuation\">.</span>이심률 <span class=\"token operator\">**</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>편심이각<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이를 통해 필자는 지구가 타원의 중심으로부터 X축으로 약 -76,411,956km, Y축으로는 약 130,045,428km 떨어진 곳에 위치한다는 사실을 알 수 있었다.</p>\n<h4 id=\"태양으로부터의-거리와-진근점이각-구하기\" style=\"position:relative;\">태양으로부터의 거리와 진근점이각 구하기<a href=\"#%ED%83%9C%EC%96%91%EC%9C%BC%EB%A1%9C%EB%B6%80%ED%84%B0%EC%9D%98-%EA%B1%B0%EB%A6%AC%EC%99%80-%EC%A7%84%EA%B7%BC%EC%A0%90%EC%9D%B4%EA%B0%81-%EA%B5%AC%ED%95%98%EA%B8%B0\" aria-label=\"태양으로부터의 거리와 진근점이각 구하기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>이렇게 궤도 평면 상에서 지구의 좌표를 구해볼 수 있었지만, 이 좌표는 중력 중심체인 태양이 아닌 궤도 자체의 중심에서부터의 거리를 의미한다.</p>\n<p>하지만 필자가 알고 싶은 것은 궤도 중심으로부터의 계산한 지구의 위치가 아닌 태양으로부터의 위치이기 때문에 추가적인 계산을 진행해야한다. 이를 이해하기 위해 다시 위에서 보았던 그림을 가져와보자.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c365db79e876e64320f24144048329b1/d9ed5/eccentric-anomaly-2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 83.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACY0lEQVR42qWTT2gTURDGf8k2aVK3+bebbappKzW1SWoCqRUrojmkSPHWQg8VagVBhOJBL41SyKEeBD3owZMnD4IUxIsnBRHx4Fn8Az2KggdPEUtPrvN2N3ETS1Uc+Hhvdt/7Zt7MN4AdoMOUb4d86PpPt7+T2UFBRJDwEO9CUrBHoP0Fqa0LDEG/l5G2Q7CQRyjBrg2CNfAnwnZEW6I3aCgSZ21A0G5npM6tluD2sBvkv01ledGCYlj2Kdfvsg3QJANdsPeDyeGnOaa/hZgQf3xbbj7fz9E3GabehQtjN3iUrYGUJ9er7uo0TSGNdsaE/JcE5bsVysunyWyMEv8MffI9LIi8Mui/soi5lF889sIaLX2HlWcw45bBDujYaVl72oT1MyR5TGKXZwYcBRjSNJvQpRzFJhSE8JAgK//CrgpadgtTv0q6WqVnl6YNLHjdj86SXZ9gSO2lJGOqNCnsmEvsFlGjIWQNTC4TZZlIp9Z+xFxSz1LElmoc/Joj5pUsu8lURXZ9ncpXpNcZ5Ca+zqnaON0M+MSsF0+Run+c4dapbfTCPdYKfsJfpPJ8LuBpzCl4qz5Bb40zS+/6PCOSXVwQUs17yUzVHYLfdaTxQBo1/VHk8CQDm+mu6ZFRpKe2grGVZOiTyEgRNhnJvydvqANJH1LOhVEszPwk7JMuzsmoHTE8IlW3jHN2gcy4RUmiHTgv99YIVc5CufUUP9TzlVgT3tpCzAva7/hzWH0mg2mlb7G3pIp1Yrnd5izQUV+c7quGhSU7jTqGbzi015w80SHwf7I79LLqlMCxLSLDDzk3qZyfRsqbeSrY0uAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"eccentric anomaly 2\" title=\"\" src=\"/static/c365db79e876e64320f24144048329b1/6af66/eccentric-anomaly-2.png\" srcset=\"/static/c365db79e876e64320f24144048329b1/69538/eccentric-anomaly-2.png 160w,\n/static/c365db79e876e64320f24144048329b1/72799/eccentric-anomaly-2.png 320w,\n/static/c365db79e876e64320f24144048329b1/6af66/eccentric-anomaly-2.png 640w,\n/static/c365db79e876e64320f24144048329b1/d9199/eccentric-anomaly-2.png 960w,\n/static/c365db79e876e64320f24144048329b1/21b4d/eccentric-anomaly-2.png 1280w,\n/static/c365db79e876e64320f24144048329b1/d9ed5/eccentric-anomaly-2.png 2880w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>필자는 앞서 위 그림에서 나타난 편심 이각 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span>를 구했고, 이 값을 토대로 행성의 실제 궤도인 붉은색 궤도를 돌고 있는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span>의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span> 좌표를 알아낼 수 있었다. 하지만 타원 궤도를 도는 행성은 궤도의 중심인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span>를 공전하는 것이 아니라 타원의 초점 중 하나에 위치한 중력 중심체를 공전한다.</p>\n<p>중력 중심체를 공전하는 행성은 중심체와의 거리에 따라 받는 중력의 영향도 달라지고, 이로 인한 궤도 운동의 속도도 달라지기 때문에 사실 궤도 계산에서 중요한 것은 타원의 초점이 아닌 중력 중심체와의 거리와 각도이다.</p>\n<p>즉, 이제 필자는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span>가 아닌 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span></span>에서 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span>까지의 거리, 그리고 각도 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span></span>를 알아내야 하는 것이다. 이때 각도 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span></span>를 진짜 근점 이각이라는 의미로 <a href=\"https://ko.wikipedia.org/wiki/%EC%A7%84%EA%B7%BC%EC%A0%90_%EC%9D%B4%EA%B0%81\" target=\"_blank\" rel=\"nofollow\">진근점이각</a>이라고 부른다.</p>\n<p>먼저 태양의 위치에서 지구까지의 거리를 구해보자. 어차피 지구의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span> 좌표를 알고 있으니 태양부터 지구의 유클리드 거리(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span>)는 피타고라스의 원리로 간단하게 구해볼 수 있다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>r</mi><mo>=</mo><msqrt><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mo stretchy=\"false\">(</mo><mi>a</mi><mo>⋅</mo><mi>e</mi><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">r = \\sqrt{(x - (a \\cdot e))^2 + y^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.24em;vertical-align:-0.2561em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9839em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.9439em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.28em\" viewBox=\"0 0 400000 1296\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2561em;\"><span></span></span></span></span></span></span></span></span></span></div>\n<p>이때 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>⋅</mo><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">a \\cdot e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span></span>은 타원 궤도의 중심에서 태양까지의 거리를 의미하는데, 기존에 계산한 지구의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span> 좌표는 궤도의 중심을 기준으로 계산한 것이기 때문에 궤도 중심과 태양까지의 거리를 빼줌으로서 거리의 기준을 태양의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span> 좌표로 보정해준 것이다. 이 내용을 제외하면 공식 자체는 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><msqrt><mrow><msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">c = \\sqrt{a^2 + b^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.1266em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9134em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.8734em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1266em;\"><span></span></span></span></span></span></span></span></span></span>라는 흔한 피타고라스 정리와 같은 꼴이기 때문에 자세한 설명은 생략하겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">convertKMtoAU</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>km<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> km <span class=\"token operator\">/</span> <span class=\"token number\">149_597_870</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> 거리 <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sqrt</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>positionX <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>현재궤도요소<span class=\"token punctuation\">.</span>장반경 <span class=\"token operator\">*</span> 현재궤도요소<span class=\"token punctuation\">.</span>이심률<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>positionY<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">convertKMtoAU</span><span class=\"token punctuation\">(</span>거리<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 1.0168205539250386 AU</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이 공식을 바탕으로 계산을 해보면 2017년 5월 3일 22시 27분, 지구는 태양으로부터 약 1.02 AU만큼 떨어진 곳에 위치한다는 사실을 알 수 있다.</p>\n<p>이제 태양과 지구의 거리를 구했으니, 이제는 진근점이각을 구해 지구가 궤도의 근일점을 기준으로 몇 도나 돌아간 곳에 위치한 것인지를 알아낼 차례이다.</p>\n<p>일반적으로는 편심 이각을 사용하여 진근점이각을 계산하는 공식을 주로 사용하지만, 필자는 이미 지구의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span> 좌표를 알고 있기 때문에 <a href=\"https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Math/atan2\" target=\"_blank\" rel=\"nofollow\">Math.atan2</a> 함수를 사용하여 간단하게 진근점이각을 알아낼 수 있다.</p>\n<p><code class=\"language-text\">Math.atan2</code> 함수는 인자로 받은 <code class=\"language-text\">y</code>와 <code class=\"language-text\">x</code>의 상대적인 위치를 사용하여 특정 점이 기준점에서 형성하는 각도를 계산하는 함수이다. 이때 결과값은 -180도(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">-\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span>)에서 180도(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span>) 사이의 라디안 값으로 나타난다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/aba07d7dd119d6c7cf99ca046209025f/c3039/atan2_2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAB7CAAAewgFu0HU+AAABYUlEQVR42s1U27KDIAz0///S8cHxUu+CopCytLFQa4+epzKTEZI1LAlLZIwhHlVVURzHlKYpdV1H/vBxRVFQkiSUZRm1bRvgonmet4XWmtZ1pWVZ3JwHfEqpYA3MO84lnKZpx4RBUhoCMT+hEGaHO5VQyomaRu0Y1rVyMT7RYUIkYuv7noZh3NY42qs0xsYGh8FG/n+wSEq5scJX2Q2GpiHjmGnnBztsjDh8iI22aWoc3RwYtq81PGrK5RoiwV8JmdHppvyb4WjrgILDUE8UHMY+9gshgvWjcSEOm0bcDIyyLJ1S8jx3quGY3zQYFAKlAFfXdRALlML14+twdGQfd0kpP9plAE8k/IRzCT8ppUVDnr53pbCvs2qazyjl8aIIGuy14Mb4DFnrTORUDY3R9l4put0UoUxavxIWhbLzxT0Sl5XCBMCQrxfnOOwyjofnCQxg+BGb8JrrhyOC2Tcc8twBC4Eq2UyW6lYAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"atan2 2\" title=\"\" src=\"/static/aba07d7dd119d6c7cf99ca046209025f/6af66/atan2_2.png\" srcset=\"/static/aba07d7dd119d6c7cf99ca046209025f/69538/atan2_2.png 160w,\n/static/aba07d7dd119d6c7cf99ca046209025f/72799/atan2_2.png 320w,\n/static/aba07d7dd119d6c7cf99ca046209025f/6af66/atan2_2.png 640w,\n/static/aba07d7dd119d6c7cf99ca046209025f/d9199/atan2_2.png 960w,\n/static/aba07d7dd119d6c7cf99ca046209025f/21b4d/atan2_2.png 1280w,\n/static/aba07d7dd119d6c7cf99ca046209025f/c3039/atan2_2.png 1979w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>atan2 함수는 원점과 양의 x축을 기준으로 각도를 잰다</small>\n</center>\n<p>참고로 이 함수는 특이하게 <code class=\"language-text\">Math.atan2(y, x)</code>처럼 <code class=\"language-text\">y</code> 좌표를 먼저 받도록 설계되어있는데, 이는 탄젠트를 표현할 때 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>tan</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mi>y</mi><mi>x</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\tan(\\theta) = \\frac{y}{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">tan</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0925em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7475em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>와 같이 <code class=\"language-text\">Math.tan(y / x)</code>의 형태로 표현되기 때문이다.</p>\n<p>이때 <code class=\"language-text\">Math.atan2</code> 함수가 받는 좌표들은 무조건 원점 기준으로 계산한 좌표가 아니라 임의의 원점으로부터 계산된 상대 좌표를 의미한다. 앞서 필자가 구한 지구의 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>는 태양의 위치를 기준으로 구한 좌표이므로 이 좌표들을 <code class=\"language-text\">Math.atan2</code>에 꽂아주기만 하면 태양을 기준으로 지구가 몇 도나 돌아간 곳에 위치한 것인지 알아낼 수 있는 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ts line-numbers\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">convertRadianToDegree</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>radian<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> radian <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">180</span> <span class=\"token operator\">/</span> Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> 진근점이각 <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">atan2</span><span class=\"token punctuation\">(</span>positionY<span class=\"token punctuation\">,</span> positionX <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>현재궤도요소<span class=\"token punctuation\">.</span>장반경 <span class=\"token operator\">*</span> 현재궤도요소<span class=\"token punctuation\">.</span>이심률<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'진근점이각'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">convertRadianToDegree</span><span class=\"token punctuation\">(</span>진근점이각<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 120.4375985828049도</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이렇게 필자는 2017년 5월 3일 22시 27분 기준으로 지구가 궤도 근일점으로부터 약 120도, 1.02AU만큼 떨어진 곳에 위치하고 있다는 사실을 알 수 있었다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>이 포스팅에서는 2차원 궤도 평면 상에서 행성의 위치를 구하는 것까지만 설명했지만, 결국 3차원 공간에 궤도를 배치하면서 궤도의 기울기와 근일점 편각을 반영해주면 행성은 자연스럽게 3차원 운동을 진행하게 될 것이다.</p>\n<p>이 공식들을 사용하여 필자가 만든 시뮬레이터는 <a href=\"https://evan-moon.github.io/solarsystemts/\" target=\"_blank\" rel=\"nofollow\">여기</a>에서 확인해볼 수 있고, 전체 소스는 <a href=\"https://github.com/evan-moon/solarsystemts\" target=\"_blank\" rel=\"nofollow\">Solarsystem 프로젝트 깃허브 레파지토리</a>에서 확인해볼 수 있다.</p>\n<p>이상으로 행성 위치 게산하기 포스팅을 마친다.</p>","fields":{"slug":"20170503-calculate-orbit-2","path":"/2017/05/03/calculate-orbit-2/","lang":"ko"},"frontmatter":{"title":"[JavaScript로 천체 구현하기] 행성의 움직임을 구현해보자","subTitle":"케플러 방정식을 활용한 천체 시뮬레이션 구현","date":"May 03, 2017","categories":["프로그래밍","그래픽스"],"tags":["궤도 구현하기","케플러 궤도 방정식","케플러 궤도 요소","JavaScript","자바스크립트","WebGL","ThreeJS","수학","튜토리얼"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/746a090a9954b09cea8d75079269697d/3a812/thumbnail.jpg","srcSet":"/static/746a090a9954b09cea8d75079269697d/3a812/thumbnail.jpg 320w,\n/static/746a090a9954b09cea8d75079269697d/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/746a090a9954b09cea8d75079269697d/fc5c5/thumbnail.webp 320w,\n/static/746a090a9954b09cea8d75079269697d/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/746a090a9954b09cea8d75079269697d/2d839/thumbnail.jpg","srcSet":"/static/746a090a9954b09cea8d75079269697d/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/746a090a9954b09cea8d75079269697d/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"c68bcc72-db35-5172-bab5-748ff5398f1f","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%A2%8C%ED%91%9C%EC%99%80-%EA%B8%B0%EC%A4%80%EB%A9%B4\">좌표와 기준면</a></p>\n<ul>\n<li><a href=\"#%EC%B2%9C%EA%B5%AC%EC%99%80-%ED%99%A9%EB%8F%84\">천구와 황도</a></li>\n<li><a href=\"#%EC%A0%81%EA%B2%BD%EA%B3%BC-%EC%A0%81%EC%9C%84\">적경과 적위</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EA%B6%A4%EB%8F%84%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9A%A9%EC%96%B4\">궤도에 대한 용어</a></p>\n<ul>\n<li><a href=\"#%EC%8A%B9%EA%B5%90%EC%A0%90--%EA%B0%95%EA%B5%90%EC%A0%90\">승교점 / 강교점</a></li>\n<li><a href=\"#%EC%9B%90%EC%9D%BC%EC%A0%90--%EA%B7%BC%EC%9D%BC%EC%A0%90\">원일점 / 근일점</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%BC%80%ED%94%8C%EB%9F%AC-%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C\">케플러 궤도 요소</a></p>\n<ul>\n<li><a href=\"#%EC%9E%A5%EB%B0%98%EA%B2%BD\">장반경</a></li>\n<li><a href=\"#%EC%9D%B4%EC%8B%AC%EB%A5%A0\">이심률</a></li>\n<li><a href=\"#%EA%B8%B0%EC%9A%B8%EA%B8%B0\">기울기</a></li>\n<li><a href=\"#%EC%8A%B9%EA%B5%90%EC%A0%90-%EA%B2%BD%EB%8F%84\">승교점 경도</a></li>\n<li><a href=\"#%EA%B7%BC%EC%9D%BC%EC%A0%90-%ED%8E%B8%EA%B0%81\">근일점 편각</a></li>\n<li><a href=\"#%EA%B7%BC%EC%9D%BC%EC%A0%90-%ED%86%B5%EA%B3%BC-%EC%8B%9C%EA%B0%81\">근일점 통과 시각</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","excerpt":"이번 포스팅에서는 태양계 시뮬레이션을 개발하면서 제일 애먹었던 천체의 궤도와 위치 계산에 대해서 알아보려고 한다. 필자는 고등학교 시절 수포자였기 대문에 필자와 같이 수포자였던 분들을 위해 최대한 간단하게 설명하는 것을 목표로 하고 있다. 먼저 궤도를 그리는 방법과 행성의 위치를 추정하는 방법에 대해서는 구글에 널리고 널렸지만, 이를 이해하기 위해서는 기본적인 천문학용어들에 대한 지식이 있어야했다.\n고1 지구과학시간에 배우는 용어들이라는데 필자는 고등학교때 잠만 잤기 때문에 하나도 기억이 나지 않아서 다시 찾아봐야했다. 필자는 천…","html":"<p>이번 포스팅에서는 태양계 시뮬레이션을 개발하면서 제일 애먹었던 천체의 궤도와 위치 계산에 대해서 알아보려고 한다. 필자는 고등학교 시절 수포자였기 대문에 필자와 같이 수포자였던 분들을 위해 최대한 간단하게 설명하는 것을 목표로 하고 있다.</p>\n<p>먼저 궤도를 그리는 방법과 행성의 위치를 추정하는 방법에 대해서는 구글에 널리고 널렸지만, 이를 이해하기 위해서는 기본적인 천문학용어들에 대한 지식이 있어야했다.\n고1 지구과학시간에 배우는 용어들이라는데 필자는 고등학교때 잠만 잤기 때문에 하나도 기억이 나지 않아서 다시 찾아봐야했다.</p>\n<p>필자는 천체물리학과를 나온 것도 아닌 일개 개발자이므로 각각의 용어 정리에 대해서는 틀린 점이 있을 수 있다.</p>\n<p>본격적으로 케플러 궤도 요소를 알아보기 전에 이후 나오는 설명들의 이해를 위해 가장 기본적인 용어들부터 알아보자.</p>\n<h2 id=\"좌표와-기준면\" style=\"position:relative;\">좌표와 기준면<a href=\"#%EC%A2%8C%ED%91%9C%EC%99%80-%EA%B8%B0%EC%A4%80%EB%A9%B4\" aria-label=\"좌표와 기준면 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>천체는 3차원으로 무한하게 펼쳐진 공간을 운동하고 있기 때문에, 천체의 움직임을 설명하기 위해서는 반드시 좌표의 기준이 필요하다.</p>\n<p>이때 이 기준이란 좌표의 중심점을 어디로 잡을 것이냐, 그리고 좌표 상에서 각도를 표현할 때 어디를 0도로 놓을 것이냐와 같은 것들이다.</p>\n<h3 id=\"천구와-황도\" style=\"position:relative;\">천구와 황도<a href=\"#%EC%B2%9C%EA%B5%AC%EC%99%80-%ED%99%A9%EB%8F%84\" aria-label=\"천구와 황도 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>천구는 관측자를 중심으로 하여 무한대의 반지름을 가진 가상적인 구를 의미한다.</p>\n<p>이때 관측자란 실제 인간이 아닌 관측자가 위치한 천체를 의미하는데, 인간의 경우 아직까지는 지구 외 행성에서 이런 개념을 사용할 일이 없으니 통상적으로 관측자는 지구로 한정된다. 이때 지구의 적도를 쭉 연장해서 천구에 맞닿는 그 선을 <strong>천구의 적도</strong>라고 부른다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 638px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/7ae3e4bed5b1240285335fdd519f6924/41be6/1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 76.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADBUlEQVR42kWT21LaUBSGN2CLLaJykJNAiJwEAgkhEXIgEQinJAOEgwgosWpVbC/aaa86velMH6DP0Ufq9GG6ou10Jhd71vq/7H/v9W80WH+MV7QMb6S5UYobZfgRLDBGKyuL/vnGuPpANucJVodimhtaXX50LI6jVO/i8SuCHtrL20NlFKBQsIz8pC1Q9uebOdFgh5va4CFdHeCsnmBVe6hiaQKUI0Sjnaw0ukFs/xKYbazmxKqO6MluSmK6l7z+piBNCopZ6pgFaVpTzeb4Lkgo9kN2G+Ne4Tzyl5SzDQIpOqBexmuOQxaq1b5JNs4DhOJO1ffTkidz6joSg8U2Ic+q/bULF1CQfhE9Qd5ia/rwH7aFmYI0o9tLX64JIie4SAotY12UjB2cCxLNSmdJNaYxuhul+8hDtGbPcKC8FT3ZSdY51cQZdS8puhPc7lHNkxaiRH0/Kbhxbv+IdyWUzacrtqN6c8rTzvd/YXuEiZAdUTNDhLKfFjwZ4WWMzdR1VlvBOR2RE2+m/vjZ/PjlJlRogXPkKz3BPQu2RZgCP5CGt7685Iwzuxk5QTXnl5uHbz9duLyNieb96PevH/rqPs1o8Lsn2LJ9ATAKVw6L7dnypjsxk9WBOyWhEBMuT1KNDdHQe4txazrWzx+M+Vu83LFF2L87s5ZtyonxMVoZLK8ZadzoL9TJtazOZc2YrGbqxCiLWorql/iBqK1309LW823PAAbbvlK8ohbloTy8kI3r5njN6/Nqb7y6BZM9W4BxYbw3KxGNOUzREWGcWO0JfrYNo4pVUajiSgji4Lq3eOfPNeCSfDnFl2u9xnl/vlWQzwT9jftIsP+DFYCr6hqFaMgNlCAnnuxppbPitKtcfQphztenWXEMCeO1K+/xKQicGLedgISRbUgY2TxHewV7mLaCDTPwk1thJkJ1S40zTrOY4unskOxuha2Wle0D0gEyV7Y+vEH95ftwqYOxepzR4MMYPVbRgsVOXpooszt18XgsGIFiG4oxWgVTsnErjW7hOd19/v4HfhW6L3NhaLIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"1\" title=\"\" src=\"/static/7ae3e4bed5b1240285335fdd519f6924/41be6/1.png\" srcset=\"/static/7ae3e4bed5b1240285335fdd519f6924/69538/1.png 160w,\n/static/7ae3e4bed5b1240285335fdd519f6924/72799/1.png 320w,\n/static/7ae3e4bed5b1240285335fdd519f6924/41be6/1.png 638w\" sizes=\"(max-width: 638px) 100vw, 638px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>그리고 위 그림에서 <strong>황도</strong>라고 불리는 노란색 선은 지구를 중심으로 하늘을 올려다보았을 때 항성인 태양이 움직이는 선을 의미한다.</p>\n<p>즉, 천구와 황도라는 개념은 천동설에서부터 유래된 것이라고 생각하면 된다. 관측자인 지구가 중심으로 삼아 하늘에 떠있는 천체들의 위치를 정의하는 것이다.</p>\n<p>지구의 자전축은 23.5도 기울어져있기 때문에 천구의 적도와 황도 또한 23.5도의 기울기로 맞닿아 있다. 이러한 기울기로 인해 관측자인 지구가 태양을 바라보면 마치 태양이 지구를 빙글빙글 돌면서 지구의 남쪽으로 이동했다가 북쪽으로 이동하는 모습을 보이는데, 이때 태양이 남쪽에서 북쪽으로 올라가는 지점을 <strong>춘분점</strong>, 그리고 반대로 북쪽에서 남쪽으로 내려가는 지점을 <strong>추분점</strong>이라고 한다.</p>\n<p>하지만 21세기를 사는 우리는 사실 태양이 지구를 도는 것이 아닌 지구가 태양을 돌고 있다는 사실을 알고 있다. 즉, 위 그림에서는 지구가 똑바로 서있고 마치 태양이 삐딱하게 지구를 돌고 있는 것처럼 표현되어있지만 실제로는 황도가 기준면이 되고 천구의 적도가 23.5도 기울어져있는 모습을 떠올릴 수 있다.</p>\n<h3 id=\"적경과-적위\" style=\"position:relative;\">적경과 적위<a href=\"#%EC%A0%81%EA%B2%BD%EA%B3%BC-%EC%A0%81%EC%9C%84\" aria-label=\"적경과 적위 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>천구는 결국 지구를 중심으로 하늘에 떠있는 천체들의 위치를 표현하기 위한 개념이다. 이때 천체의 위치를 표현하기 위해 적경과 적위라는 개념을 사용한다.</p>\n<p>이는 마치 우리가 지구 상의 특정 위치를 표현하기 위해 경도와 위도를 사용한 지리 좌표계를 사용하는 것과 동일한 개념이다. 지리 좌표계의 위도는 적도를 0도라고 보고 북극과 남극을 90도로 삼아 세로 위치를 표시하고, 경도는 그리니치 천문대를 0도로 삼아 동쪽으로 180도, 서쪽으로 180도를 나누어 가로 위치를 표현한다.</p>\n<p>이와 동일한 원리로 지구를 중심으로 하늘을 올려다보았을 때 천구 표면에 존재하는 천체의 위치도 경도와 위도 두 개의 값만 있으면 표현이 가능한 것이다.</p>\n<p>이때 적경과 적위는 천구의 적도를 기준선으로 잡은 적도 좌표계에서의 경도와 위도를 의미한다. 이때 천체의 가로 위치를 정의하는 적경은 춘분점을 기준으로 대상 천체의 위치까지 반시계 방향으로 잰 각도를 의미하며, 천체의 세로 위치를 의미하는 적위는 천구의 적도를 기준으로 대상 천체까지의 위치를 잰 각도를 의미한다. 즉, 적도 좌표계의 기준이 되는 천구의 적도와 춘분점, 그리고 적경과 적위만 알면 천구 상에 떠있는 특정 천체의 위치를 특정할 수 있는 것이다. <small>(물론 적도 좌표계는 대상 천체가 천구의 표면이라는 가상의 2차원 공간에 존재한다고 가정하는 것이라 대상 천체의 거리까지는 정의하지 못 한다)</small></p>\n<p>재미있는 사실은 태양계 천체나 혜성과 같은 몇몇 천체를 제외한 대부분의 천체는 천구 상에서 거의 움직이지 않기 때문에 대부분의 천체는 고유한 적경과 적위를 가지므로 이 값만 알면 손쉽게 천체의 위치를 찾을 수 있다.</p>\n<p>이때 적도 좌표계의 적경은 지리 좌표계의 경도와 다르게 시, 분과 같은 시간 단위로 표현한다. 지구는 24시간 동안 360도를 자전하기 때문에 1시간의 적경은 15도의 각도로 환산할 수 있다. 적위는 천구의 적도를 0도로 삼고 천구의 북극을 <code class=\"language-text\">+90</code>, 남극을 <code class=\"language-text\">-90</code>으로 정의하기 때문에 항상 <code class=\"language-text\">-90</code>부터 <code class=\"language-text\">+90</code> 사이의 값을 가진다.</p>\n<p>참고로 지구의 적도가 아닌 실제 지면에 서있는 지구의 관측자를 중심으로 하고 관측자가 서있는 지면을 기준면으로 잡는 좌표계는 지평좌표계라고 한다.</p>\n<h2 id=\"궤도에-대한-용어\" style=\"position:relative;\">궤도에 대한 용어<a href=\"#%EA%B6%A4%EB%8F%84%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9A%A9%EC%96%B4\" aria-label=\"궤도에 대한 용어 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"승교점--강교점\" style=\"position:relative;\">승교점 / 강교점<a href=\"#%EC%8A%B9%EA%B5%90%EC%A0%90--%EA%B0%95%EA%B5%90%EC%A0%90\" aria-label=\"승교점  강교점 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>천체의 궤도는 일반적으로 기준 평면과 기울어져 있다. 이때 기준 평면은 정의에 따라 달라질 수 있는데, 태양계의 경우 황도면을 이야기한다.</p>\n<p>앞서 살펴본 적도 좌표계에서 태양이 지구를 중심으로 회전하며 남쪽에서 북쪽으로 이동하는 지점을 춘분점, 반대로 북쪽에서 남쪽으로 내려오는 지점을 추분점이라고 한다는 설명을 했다.</p>\n<p>이처럼 특정 중심체를 기반으로 궤도를 도는 천체가 중심체의 남쪽에서 북쪽으로 올라가는 지점을 승교점, 그리고 북쪽에서 남쪽으로 내려오는 지점을 강교점이라고 한다. 적도 좌표계에서 이야기하는 춘분점과 추분점은 지구라는 행성에 사는 우리만 사용할 수 있는 표현이지만, 승교점과 강교점은 중심체를 특정 궤도를 그리며 운동하는 모든 천체에 통용할 수 있는 용어다.</p>\n<p>태양계의 경우 중심체가 태양이기 때문에 황도를 기준으로 잡는다.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/4693485f3e9d15673833669486a0c618/0a47e/pluto_orbit.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 61.24999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMUlEQVR42rVSy2rDQAzUW/uy13Ycm1IKhRZyyKH//3dVHj0k0GN01M5opJkFeHUxkKIm8kJ5SlO3rij/os1tHMfsxYIgLXMxdkEhoON63I/bkhcEeuAgM2hoWMpDzdNh2VJtoIwuoHJ7QlE27T4h4B8NCd1R1Tk1b+5ODG68r8tYizOaEimhXYCD9ZSGy7g7WU01ZXCP9cqleyh1H+e3df85n9dxzpfLQVxHHxQkVCmVOzlz7m21UkmkTSM5l6GoUlwZwqfTV87u6jU1ZgER8oRyVa5ULA4yrW0ADl+U1AIBJrEuIG3b++fHd2szu0cfg4/Xg3O4XzoLI+KDeRjmauJcpDJKACICokeHQ3bu07ZvkU0YSHiLNMXQCJae8niq2LJxm1Jf8lyoZEpOxsgv/3m/zscMNxDZT98AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"pluto orbit\" title=\"\" src=\"/static/4693485f3e9d15673833669486a0c618/0a47e/pluto_orbit.png\" srcset=\"/static/4693485f3e9d15673833669486a0c618/69538/pluto_orbit.png 160w,\n/static/4693485f3e9d15673833669486a0c618/72799/pluto_orbit.png 320w,\n/static/4693485f3e9d15673833669486a0c618/0a47e/pluto_orbit.png 600w\" sizes=\"(max-width: 600px) 100vw, 600px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>명왕성의 궤도를 보면 황도를 기준으로 태양의 북쪽으로 올라가거나 남쪽으로 내려간다는게 무슨 말인지 쉽게 알 수 있다.</small>\n</center>\n<h3 id=\"원일점--근일점\" style=\"position:relative;\">원일점 / 근일점<a href=\"#%EC%9B%90%EC%9D%BC%EC%A0%90--%EA%B7%BC%EC%9D%BC%EC%A0%90\" aria-label=\"원일점  근일점 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>행성의 궤도는 타원이기 때문에 초점이 2개이다. 보통 이 중 하나의 초점에 항성이 위치하게 되며, 각각 원일점과 근일점은 항성에서 가장 멀리 떨어지거나 가장 가까운 한점을 의미한다. 포물선 궤도는 원일점이 무한대이므로 근일점만을 가지게 된다.</p>\n<h2 id=\"케플러-궤도-요소\" style=\"position:relative;\">케플러 궤도 요소<a href=\"#%EC%BC%80%ED%94%8C%EB%9F%AC-%EA%B6%A4%EB%8F%84-%EC%9A%94%EC%86%8C\" aria-label=\"케플러 궤도 요소 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>기본 용어 정리가 되었으면 이제 궤도의 모양과 크기, 방향을 결정하는 케플러 궤도 요소를 알아보자.</p>\n<p>케플러 궤도 요소는 궤도의 형태와 크기를 정의하는 장반경과 이심률, 그리고 궤도면의 형태를 결정하는 기울기와 승교점 경도, 마지막으로 궤도가 놓인 방향을 결정하는 근일점 편각과 특정 시간을 기준으로 천체의 위치를 특정하기 위한 근일점 통과 시각으로 구성되어있다.</p>\n<h3 id=\"장반경\" style=\"position:relative;\">장반경<a href=\"#%EC%9E%A5%EB%B0%98%EA%B2%BD\" aria-label=\"장반경 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>행성의 궤도는 타원이기 때문에 반지름이 아닌 장반경과 단반경으로 정의한다. 이때 장반경은 궤도 상에서 궤도 중심과 가장 거리가 먼 한 지점을 의미하며, 단반경은 궤도 상에서 궤도 중심과 가장 거리가 가까운 한 지점을 의미한다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/18c739abac106732c5daf91effd1103d/00597/semi-major-axis.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB35QB/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFhABAQEAAAAAAAAAAAAAAAAAAIEg/9oACAEBAAE/IUTH/9oADAMBAAIAAwAAABBgz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQADAAMAAAAAAAAAAAAAAAEAESEQMUH/2gAIAQEAAT8QG7xNqWnp2Cp2Iw4//9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"semi major axis\" title=\"\" src=\"/static/18c739abac106732c5daf91effd1103d/c08c5/semi-major-axis.jpg\" srcset=\"/static/18c739abac106732c5daf91effd1103d/0913d/semi-major-axis.jpg 160w,\n/static/18c739abac106732c5daf91effd1103d/cb69c/semi-major-axis.jpg 320w,\n/static/18c739abac106732c5daf91effd1103d/c08c5/semi-major-axis.jpg 640w,\n/static/18c739abac106732c5daf91effd1103d/00597/semi-major-axis.jpg 678w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>원일점, 근일점과의 차이는 측정의 기준이 되는 점이 항성이 아닌 궤도의 중심이라는 것이다. 포물선 궤도나 쌍곡선 궤도는 장반경이 무한대 이므로 단반경만을 가지게 된다.</p>\n<p>다만 케플러 궤도 요소에서는 장반경과 단반경 중 장반경만을 다루고 있는데, 그 이유는 궤도 에너지를 계산할 때는 궤도 자체의 모양보다는 궤도를 형성하는 천체의 평균 거리가 중요하기 때문이다. 장반경은 궤도의 전체 크기를 대표할 수 있지만 단반경은 단지 궤도의 찌그러짐 정도를 나타내는 것 뿐이므로 에너지 계산에 적합한 지표가 아니다.</p>\n<p>그러한 이유로 일반적인 천체역햑에서는 주로 장반경을 사용하며, 케플러 방정식 또한 마찬가지이다.</p>\n<h3 id=\"이심률\" style=\"position:relative;\">이심률<a href=\"#%EC%9D%B4%EC%8B%AC%EB%A5%A0\" aria-label=\"이심률 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 440px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/6f85397f2e1f0b3d470fea6c6afa5c6b/48c0e/eccentricity.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 121.25000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsTAAALEwEAmpwYAAACOklEQVR42qWVvYvTYBzHv2l7aZOnbZo06fW8qCDccJXqKs4OgiLcUHR0cBIcfENu6iQK4iCCi8LtB7eJuIrQyb9CEHETzz1+f3mes8nlUhN84JuXPs2H3/sDAF1qzahNdYxs4C739gZ672zH7JfJ1qyLGOAtAryAwhwNFFYSUi6qLaUvAnoCD7uI+DygWhmgBRyuL6HyXrrcvxezLMJcPCX4GfwlWCCfzwBf/mVpDmgZ6XUfDoGj1OJ0Xe4BXzcJb9WxMA9OUou7jO8IN0DgwuGP4n6jDtCwYCUGPGeM3UcYq1sQmECHtYBJ1vXlamAHG96ehECA39y6FtpUjwqNvHd891kN3QfXQ11O1S30qYhSVHOf4r1zAMS/0I0mL1m3WwtJUDsT9zzwyE3eAwGWxKj1nnuHF5ik2zdP89/esdrMW5hoS6KyWM6R1uWpBbA5vTY9h/DTRhpbTOxVwDCb5Wy2L4G1Sbc/OIi3r2xvITiIdZ/HjnHbOcllf4XLst/+McEYd3YIS/orXT6WFMmsk1HnZxrf3jCWpJz/KDG0S5NSUjYDKReRhtG9fXbOvatRSXHXKmzgue/hjYQjCYDvqlZhI5OM2QxN9VCNglfo6zFWr/XyU0eGA/uYd07sZM0MB+v/xlc6yZMm8HusoavHlyoM2N3CgG2Yqe1UGbAOs9Dgx/3ipD6qsWREqQpnCoFTAqSuHnOAFg6pFBZVhBlvfR5Ocdoytmkd14jPMzb/66E+JtdVZu8kybf9P8qYk5p9WHxjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"eccentricity\" title=\"\" src=\"/static/6f85397f2e1f0b3d470fea6c6afa5c6b/48c0e/eccentricity.png\" srcset=\"/static/6f85397f2e1f0b3d470fea6c6afa5c6b/69538/eccentricity.png 160w,\n/static/6f85397f2e1f0b3d470fea6c6afa5c6b/72799/eccentricity.png 320w,\n/static/6f85397f2e1f0b3d470fea6c6afa5c6b/48c0e/eccentricity.png 440w\" sizes=\"(max-width: 440px) 100vw, 440px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>이심률은 간단히 말하면 타원이 얼마나 찌그러져있는지에 대한 값이다. 기하학적 정의에서 타원의 이심률 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span></span>는</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>e</mi><mo>=</mo><msqrt><mrow><mn>1</mn><mo>−</mo><mfrac><msup><mi>b</mi><mn>2</mn></msup><msup><mi>a</mi><mn>2</mn></msup></mfrac></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">e = \\sqrt{1-\\frac{b^2}{a^2}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.44em;vertical-align:-0.7406em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6994em;\"><span class=\"svg-align\" style=\"top:-4.4em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4171em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.6594em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:2.48em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"2.48em\" viewBox=\"0 0 400000 2592\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M424,2478\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl0 -0c4,-6.7,10,-10,18,-10 H400000\nv40H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M1001 80\nh400000v40h-400000z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7406em;\"><span></span></span></span></span></span></span></span></span></span></div>\n<p>로 정의할 수 있으며, 이때 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span></span>는 장반경, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span>는 단반경이다. 그러나 케플러 궤도에서 사용하는 사용되는 이심률은 약간 공식이 달라진다.</p>\n<p>일반적인 타원의 이심률을 구하는 공식은 중력이나 에너지와 같은 요소는 고려하지 않은 순전히 기하학적 타원의 찌그러짐 정도만을 나타내는 것이라, 타원 궤도를 형성하는 물체의 운동 에너지와 중력 간의 상호작용을 기반으로 하는 케플러 궤도의 이심률을 구하는 데에는 적합하지 않기 때문이다.</p>\n<p>그래서 케플러 궤도의 이심률을 구할 때는 물체의 운동 에너지, 각운동량 등의 물리적 동역학을 고려하여 계산해야한다.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>e</mi><mo>=</mo><msqrt><mrow><mn>1</mn><mo>+</mo><mfrac><mrow><mn>2</mn><mi>E</mi><msup><mi>L</mi><mn>2</mn></msup></mrow><mrow><msub><mi>m</mi><mtext>red</mtext></msub><msup><mi>α</mi><mn>2</mn></msup></mrow></mfrac></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">e = \\sqrt{1+\\frac{2EL^2}{m_\\text{red}\\alpha^2}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.04em;vertical-align:-1.1156em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9244em;\"><span class=\"svg-align\" style=\"top:-5em;\"><span class=\"pstrut\" style=\"height:5em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4171em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">red</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.8844em;\"><span class=\"pstrut\" style=\"height:5em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:3.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"3.08em\" viewBox=\"0 0 400000 3240\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M473,2793\nc339.3,-1799.3,509.3,-2700,510,-2702 l0 -0\nc3.3,-7.3,9.3,-11,18,-11 H400000v40H1017.7\ns-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200\nc0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26\ns76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,\n606zM1001 80h400000v40H1017.7z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1156em;\"><span></span></span></span></span></span></span></span></span></span></div>\n<p>이 공식의 해인 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span></span>를 궤도 이심률이라고 부른다.</p>\n<p>여기서 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span></span>는 물체가 궤도에서 가진 전체 에너지, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span></span>은 각운동량, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mrow><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">m_{red}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>는 환산 질량을 나타내며, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span>는 역제곱 법칙 중심력의 계수이다. 역제곱 법칙이란 어떤 힘의 크기가 거리의 제곱에 반비례하는 것을 가리키는 말이다. 이 경우 어떤 힘이란 바로 중력이 된다.</p>\n<p>하지만 필자는 이심률이 이미 주어진 데이터를 사용할 예정이므로, 사실 굳이 이렇게 까지 계산할 필요가 없다. 그냥 일반적인 이심률 공식과 계산법이 다르다는 정도만 알고 넘어가자.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 212px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/68ee7ca2b63f32445afe5c63a2526b87/8c7fa/skip.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 112.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAXABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAUEAQP/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHtOZTNLxEPSG0H/8QAGhAAAwEBAQEAAAAAAAAAAAAAAQIDBBETMf/aAAgBAQABBQLTUmk+rEfKpzWjPRYEtOwf3WjShjBEP//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EAB4QAAIDAAEFAAAAAAAAAAAAAAECABEhMRBBUWGh/9oACAEBAAY/AmQFgRxUWrOd+hN+4rYBLJu4552Uusfk3zP/xAAcEAEAAgIDAQAAAAAAAAAAAAABABEhMUFRYXH/2gAIAQEAAT8hXQJuz3MFK2VW3L7bl0HJV6h1uFp3M5tL88mNEeoRL0cIAHbaf//aAAwDAQACAAMAAAAQEwc8/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHRABAAICAwEBAAAAAAAAAAAAAQARITFhcYFBsf/aAAgBAQABPxAlDhY4mu8dQ1zxRYM3be4kE0th8ajEBzDwN9ahBU4WqyVwQA+xErb8RpGUFjBxmO1cgLHs56I+BEy64n//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"짤\" title=\"\" src=\"/static/68ee7ca2b63f32445afe5c63a2526b87/8c7fa/skip.jpg\" srcset=\"/static/68ee7ca2b63f32445afe5c63a2526b87/0913d/skip.jpg 160w,\n/static/68ee7ca2b63f32445afe5c63a2526b87/8c7fa/skip.jpg 212w\" sizes=\"(max-width: 212px) 100vw, 212px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>케플러 궤도의 이심률은 다음 4가지의 형태로 나타난다.</p>\n<hr>\n<ul>\n<li>원 궤도: <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">e = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span></li>\n<li>타원 궤도: <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>&#x3C;</mo><mi>e</mi><mo>&#x3C;</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">0 &#x3C; e &#x3C; 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6835em;vertical-align:-0.0391em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&#x3C;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&#x3C;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span></li>\n<li>포물선 궤도: <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">e = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span></li>\n<li>쌍곡선 궤도: <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mo>></mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">e > 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span></li>\n</ul>\n<hr>\n<p>지구의 궤도 이심률은 현재 약 <code class=\"language-text\">0.0167</code>으로 거의 원형에 가깝다. 태양계 행성 중 가장 이심률이 큰 수성은 <code class=\"language-text\">0.2056</code>의 값을 가지고 있고, 이로 인해서 수성은 근일점에서 원일점보다 두 배 정도 태양 복사를 받는다.</p>\n<p>원래는 <code class=\"language-text\">0.248</code>의 값을 가지고 있던 명왕성이 이 분야의 대빵이었지만 지금은 다들 알다시피 퇴출되었다…<small>(아디오스…)</small></p>\n<p>혜성의 경우 이심률이 상당히 다양한 편인데, 보통 주기 혜성들의 경우는 <code class=\"language-text\">0.2</code>에서 <code class=\"language-text\">0.7</code>의 값을 가지며 몇몇 궤도가 매우 찌그러진 혜성들은 거의 <code class=\"language-text\">1</code>에 육박하는 이심률을 가진 것도 있다.</p>\n<p>예를 들어 혜성 중 많이 이름이 알려진 핼리 혜성의 경우 이심률이 <code class=\"language-text\">0.967</code>이며, 궤도가 매우 찌그러져있어서 한번 공전하는데 76년이나 걸린다. 참고로 다음 핼리 혜성의 접근 시기는 2061년이다.</p>\n<h3 id=\"기울기\" style=\"position:relative;\">기울기<a href=\"#%EA%B8%B0%EC%9A%B8%EA%B8%B0\" aria-label=\"기울기 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>항성의 황도면과 궤도 간의 기울기를 의미한다. 기울기가 <code class=\"language-text\">90</code>도를 초과하면 이 물체는 기울기가 0-90인 물체와 반대방향으로 공전하고 있다고 보면 된다.</p>\n<h3 id=\"승교점-경도\" style=\"position:relative;\">승교점 경도<a href=\"#%EC%8A%B9%EA%B5%90%EC%A0%90-%EA%B2%BD%EB%8F%84\" aria-label=\"승교점 경도 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>앞서 언급했듯이 승교점은 천체가 궤도를 돌다가 기준면을 남쪽에서 북쪽으로 통과하는 지점을 의미한다. 이때 승교점은 경도라는 각도로 표현되는데, 이는 춘분점을 기준으로 황도면에 따라 반시계 방향으로 잰 승교점까지의 각도를 나타낸다.</p>\n<p>즉 승교점 경도를 통해 궤도 상 승교점의 위치를 3차원 좌표계에서 정의할 수 있게 된다.</p>\n<h3 id=\"근일점-편각\" style=\"position:relative;\">근일점 편각<a href=\"#%EA%B7%BC%EC%9D%BC%EC%A0%90-%ED%8E%B8%EA%B0%81\" aria-label=\"근일점 편각 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>근일점 편각은 타원의 궤도 평면 상에서 승교점을 기준으로 근일점까지의 각도를 나타낸다. 근일점이라는 용어에서 알 수 있듯이 이 각도는 타원의 중심이 아닌 궤도의 중심, 즉 중력의 초점에서 측정한다.</p>\n<p>이 값은 궤도 타원이 황도면과 같은 기준 평면에 대해서 얼마나 회전되어있는지를 나타내는 각도이다. 만약 근일점 편각이 0도라면 승교점과 근일점이 일치하는 것이므로 천체가 항성에 가장 근접하는 순간 승교점을 통과한다는 의미이며, 만약 근일점 편각이 90도라면 가장 근접하는 순간 기준 면에서 북쪽으로 가장 멀리 떨어진 지점에 위치하게 된다는 것을 의미한다.</p>\n<h3 id=\"근일점-통과-시각\" style=\"position:relative;\">근일점 통과 시각<a href=\"#%EA%B7%BC%EC%9D%BC%EC%A0%90-%ED%86%B5%EA%B3%BC-%EC%8B%9C%EA%B0%81\" aria-label=\"근일점 통과 시각 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>행성이 궤도의 근일점을 통과한 시각을 의미한다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p><a href=\"/2017/05/03/calculate-orbit-2\">다음 포스팅</a>에서는 궤도를 코드로 구현해볼 예정이다. 이상으로 천문학 용어 정리 포스팅을 마친다.</p>","fields":{"slug":"20170503-calculate-orbit-1","path":"/2017/05/03/calculate-orbit-1/","lang":"ko"},"frontmatter":{"title":"[JavaScript로 천체 구현하기] 케플러 궤도 요소 알아보기","subTitle":"천문학과 수학을 몰라도 이해할 수 있는 케플러 궤도 요소 가이드","date":"May 03, 2017","categories":["프로그래밍","그래픽스"],"tags":["궤도 구현하기","케플러 궤도 방정식","케플러 궤도 요소","JavaScript","자바스크립트","WebGL","ThreeJS","튜토리얼"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/746a090a9954b09cea8d75079269697d/3a812/thumbnail.jpg","srcSet":"/static/746a090a9954b09cea8d75079269697d/3a812/thumbnail.jpg 320w,\n/static/746a090a9954b09cea8d75079269697d/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/746a090a9954b09cea8d75079269697d/fc5c5/thumbnail.webp 320w,\n/static/746a090a9954b09cea8d75079269697d/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/746a090a9954b09cea8d75079269697d/2d839/thumbnail.jpg","srcSet":"/static/746a090a9954b09cea8d75079269697d/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/746a090a9954b09cea8d75079269697d/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}}],"pageInfo":{"currentPage":8,"pageCount":8}}},"pageContext":{"limit":15,"skip":105,"lang":"ko","totalCount":110}},"staticQueryHashes":["3523904809","650499039"],"slicesMap":{}}