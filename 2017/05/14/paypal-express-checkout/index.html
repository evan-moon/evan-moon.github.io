<!DOCTYPE html>
<html lang="ko">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
<title>Paypal - Express Checkout Restful API 사용하기 - Evan&#39;s Tech Blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta name="description" content="이번 포스팅에서는 Paypal의 RESTful API인 Express Checkout을 사용하는 방법에 대해서 포스팅 하려고 한다. 진행하기에 앞서 먼저, 페이팔 샌드박스 홈페이지에 접속해서 sandbox용 계정을 만들어야 한다.">
<meta name="keywords" content="JavaScript,Paypal,페이팔">
<meta property="og:type" content="article">
<meta property="og:title" content="Paypal - Express Checkout Restful API 사용하기">
<meta property="og:url" content="https://evan-moon.github.io/2017/05/14/paypal-express-checkout/index.html">
<meta property="og:site_name" content="Evan&#39;s Tech Blog">
<meta property="og:description" content="이번 포스팅에서는 Paypal의 RESTful API인 Express Checkout을 사용하는 방법에 대해서 포스팅 하려고 한다. 진행하기에 앞서 먼저, 페이팔 샌드박스 홈페이지에 접속해서 sandbox용 계정을 만들어야 한다.">
<meta property="og:locale" content="ko">
<meta property="og:image" content="https://evan-moon.github.io/2017/05/14/paypal-express-checkout/thumbnail.jpg">
<meta property="og:updated_time" content="2020-02-28T09:06:22.053Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Paypal - Express Checkout Restful API 사용하기">
<meta name="twitter:description" content="이번 포스팅에서는 Paypal의 RESTful API인 Express Checkout을 사용하는 방법에 대해서 포스팅 하려고 한다. 진행하기에 앞서 먼저, 페이팔 샌드박스 홈페이지에 접속해서 sandbox용 계정을 만들어야 한다.">
<meta name="twitter:image" content="https://evan-moon.github.io/2017/05/14/paypal-express-checkout/thumbnail.jpg">




    <meta name="naver-site-verification" content="48beb5f578053c0c5f127b4198a57270bad360ca">


<link rel="canonical" href="https://evan-moon.github.io/2017/05/14/paypal-express-checkout/">


<link rel="alternative" href="/feed.xml" title="Paypal - Express Checkout Restful API 사용하기" type="application/xml">



<link rel="icon" href="/img/favicon.ico">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    

    
    
    
    

    
    
    


<link rel="stylesheet" href="/css/style.css">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-132075145-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-132075145-1');
</script>



<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: 'ca-pub-4372275195526937',
        enable_page_level_ads: true
    });
</script>

</head>
<body class="is-2-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/" data-link-name="navigatorLogo">
            
                <img src="/img/logo-text.png" alt="Paypal - Express Checkout Restful API 사용하기" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a data-link-name="navigator" class="navbar-item" href="/">Home</a>
                
                <a data-link-name="navigator" class="navbar-item" href="/archives">Archives</a>
                
                <a data-link-name="navigator" class="navbar-item" href="/categories">Categories</a>
                
                <a data-link-name="navigator" class="navbar-item" href="/tags">Tags</a>
                
                <a data-link-name="navigator" class="navbar-item" href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="GitHub" href="https://github.com/evan-moon" rel="external nofollow noopener noreferrer">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="카탈로그" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="검색" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-8-widescreen has-order-2 column-main">
<!-- 아티클 위 광고 -->
<ins class="adsbygoogle" style="display:block;" data-ad-client="ca-pub-4372275195526937" data-ad-slot="6101119789" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script class="card">
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<div class="card">
    
    <div class="card-image">
        <span class="image is-7by1">
            <img class="thumbnail" src="/2017/05/14/paypal-express-checkout/thumbnail.jpg" alt="Paypal - Express Checkout Restful API 사용하기">
        </span>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-14T03:36:23.000Z">2017-05-14</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/programming/">Programming</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-bold">
            
                Paypal - Express Checkout Restful API 사용하기
            
        </h1>
        
        <hr>
        
        <div class="content">
            <html><head><meta name="generator" content="Hexo 3.9.0"></head><body><p>이번 포스팅에서는 Paypal의 RESTful API인 <code>Express Checkout</code>을 사용하는 방법에 대해서 포스팅 하려고 한다. 진행하기에 앞서 먼저, <a href="https://www.sandbox.paypal.com/" target="_blank" rel="external nofollow noopener noreferrer">페이팔 샌드박스 홈페이지</a>에 접속해서 sandbox용 계정을 만들어야 한다.<br><a id="more"></a></p>
<p>이 계정으로 테스트를 진행하고 실제 운영 계정은 <a href="https://www.paypal.com/kr/home" target="_blank" rel="external nofollow noopener noreferrer">페이팔 홈페이지</a>에서 회원가입하면 된다.</p>
<h2 id="Express-Checkout이란"><a href="#Express-Checkout이란" class="headerlink" title="Express Checkout이란?"></a>Express Checkout이란?</h2><p>Paypal에서 제공해주는 결제 플로우 방식 중 하나이며, 유저가 <code>페이팔로 구매하기</code>버튼을 클릭했을 때 페이팔 로그인 Modal window가 렌더되고, 이를 통해 결제를 진행하는 플로우이다.<br>모든 국가를 지원하며, 브라우저 지원은 다음과 같다.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Internet Explorer</th>
<th style="text-align:center">Chrome</th>
<th style="text-align:center">Mozila Firefox</th>
<th style="text-align:center">Safari</th>
<th style="text-align:center">Opera</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">IE 9 이상</td>
<td style="text-align:center">ver 27 이상</td>
<td style="text-align:center">ver 30 이상</td>
<td style="text-align:center">ver 5.1 이상</td>
<td style="text-align:center">ver 23 이상</td>
</tr>
</tbody>
</table>
<p>Paypal에서는 총 3가지의 결제플로우를 제공하고 있으며, 한국에서는 이 중 All countries로 제공되는 다음 2가지 방식 중 선택이 가능하다.</p>
<h3 id="Paypal-Standard"><a href="#Paypal-Standard" class="headerlink" title="Paypal Standard"></a>Paypal Standard</h3><p>Paypal에서 제공해주는 HTML코드를 기반으로 생성된 버튼을 웹 클라이언트 소스에 직접 삽입하는 방식이다.<br>Paypal사이트에서 직접 상품 이름, 상품 ID, 가격 등을 입력하면 그에 맞는 버튼의 코드를 자동으로 생성해준다. 이후 그 코드를 클라이언트 소스에 삽입하면 된다.</p>
<h3 id="Express-Checkout"><a href="#Express-Checkout" class="headerlink" title="Express Checkout"></a>Express Checkout</h3><p>Paypal의 JavaScript SDK인 checkout.js를 사용하여 버튼을 동적으로 렌더하는 방식이다.<br>상품 데이터를 본인 서비스의 서버로 전달한 후 Server to Server방식으로 Paypal서버에서 인증을 받는 방식으로 진행된다. 필자는 이 방법을 선택하였다.</p>
<h2 id="Express-Checkout의-흐름"><a href="#Express-Checkout의-흐름" class="headerlink" title="Express Checkout의 흐름"></a>Express Checkout의 흐름</h2><p>먼저 이 포스팅은 Paypal Developer 페이지의 <a href="https://developer.paypal.com/docs/orders-integration-guide/?mark=express%20checkout#" target="_blank" rel="external nofollow noopener noreferrer">Express Checkout</a>항목을 참고하여 작성하였다.</p>
<center><br>  <img src="/2017/05/14/paypal-express-checkout/flow.png" title="express-checkout-flow"><br>  <sub><a href="https://developer.paypal.com/docs/classic/express-checkout/" target="_blank" rel="external nofollow noopener noreferrer">https://developer.paypal.com/docs/classic/express-checkout/</a></sub><br>  <br><br></center>

<p>쉽게 생각하면 Facebook이나 Instagram계정으로 로그인하는 플로우와 UX가 비슷하다고 보면 된다.<br>유저가 구매버튼을 클릭하면 데스크탑에서는 팝업, 모바일에서는 새 탭의 형태로 페이팔 로그인 창이 열리고, 유저는 그 창에서 인증과 결제를 순차적으로 진행하게 된다.<br>이후 모든 플로우가 끝나면 유저는 결제 진행 결과에 따라 페이팔에 <code>redirect_url</code>파라미터로 보내졌던 URL로 이동을 하게되며 최종적으로 성공, 실패, 취소에 따른 페이지와 결제 정보 결과를 보게 된다.<br>Paypal서버와 통신하는 방법으로는 <code>RESTful API</code>와 <code>NVP/SOAP API</code>로 2가지 방법이 있으나 본 문서에서는 <code>RESTful API</code>만 기술하겠다.</p>
<p><code>Paypal Express Checkout</code>의 플로우는 다음과 같다.</p>
<hr>
<ol>
<li>유저가 구매버튼을 클릭<ul>
<li>Express Checkout의 client SDK인 <code>checkout.js</code>를 통해 로그인 모달창이 열리거나 API서버가 Paypal API를 호출하여 <code>payment</code>이벤트를 초기화한다.</li>
<li><code>payment</code>이벤트 초기화 후, Express Checkout 플로우가 모달창 내부에서 시작된다.</li>
</ul>
</li>
<li>유저가 페이팔 로그인을 진행</li>
<li>유저가 결제 정보를 확인 후 <code>Contunue</code>버튼을 클릭</li>
<li>유저가 <code>Continue</code>버튼을 클릭하면 다시 서비스의 리다이렉트페이지로 이동하며 최종 결제 정보가 표시된다.<br>결제 정보를 생성할 때 보냈던 상품 정보 파라미터는 이 단계에서 노출시키는 것이 좋다.</li>
<li>최종적으로 <code>execute</code> API가 호출되고 결제가 마무리된다. 그리고 사용자는 서비스 상의 결제완료 페이지로 리다이렉트된다.</li>
</ol>
<hr>
<h2 id="Client만으로-진행하기"><a href="#Client만으로-진행하기" class="headerlink" title="Client만으로 진행하기"></a>Client만으로 진행하기</h2><blockquote>
<p>Paypal 공식문서에서는 Express Checkout과의 버전 호환성을 최대한 보장하기 위해 CDN을 이용한 동적로딩을 추천하고 있다. 직접 <code>checkout.js</code>파일을 다운받아 클라이언트 소스에 넣는 것은 추천하지 않는다.<br>이 문서에서의 <code>checkout.js</code>의 버전은 <code>4.0</code>으로 진행한다.</p>
</blockquote>
<p>지금 작성하는 플로우는 필자 서비스의 API서버를 통하지 않고 <code>checkout.js</code>를 이용하여 바로 페이팔 서버로부터 인증과 결제까지 한번에 마치는 방법이다.<br>클라이언트에서는 데이터를 정의하고 <code>checkout.js</code>를 사용하여 Paypal결제 버튼을 렌더한다. 이 버튼을 클릭하면 <code>checkout.js</code>의 내장 메소드를 호출하여 자동으로 인증과 결제토큰생성, 결제 완료까지 한큐에 진행하게 된다.</p>
<p>먼저, <code>checkout.js</code> SDK의 동적로딩을 위해 <code>index.html</code>파일에 <code>script</code>태그를 열고 다음 스크립트를 작성하였다.</p>
<figure class="highlight js hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">  <span class="hljs-keyword">var</span> _DOM = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'script'</span>);</span><br><span class="line">  _DOM.src = <span class="hljs-string">'https://www.paypalobjects.com/api/checkout.js'</span>;</span><br><span class="line">  <span class="hljs-keyword">var</span> element = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'script'</span>)[<span class="hljs-number">0</span>];</span><br><span class="line">  element.parentNode.insertBefore(_DOM, element);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p>이후 Paypal버튼을 DOM을 작성해주고 checkout.js를 사용해 버튼을 렌더한다.</p>
<figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"pay-test-btn"</span>></span>Test to payment<span class="hljs-tag">div</span>></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight js hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">paypal.Button.render({</span><br><span class="line">  env: <span class="hljs-string">'sandbox'</span>, <span class="hljs-comment">// 테스트용은 'sandbox'를, 운영은 'production'을 입력</span></span><br><span class="line">  client: {</span><br><span class="line">    sandbox: <span class="hljs-string">'paypal-sandbox-key'</span>, <span class="hljs-comment">// paypal에서 발급 받은 client_key를 입력</span></span><br><span class="line">    production: <span class="hljs-string">'paypal-production-key'</span></span><br><span class="line">  },</span><br><span class="line">  payment: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">    <span class="hljs-keyword">var</span> env = <span class="hljs-keyword">this</span>.props.env;</span><br><span class="line">    <span class="hljs-keyword">var</span> client = <span class="hljs-keyword">this</span>.props.client;</span><br><span class="line">    <span class="hljs-keyword">return</span> paypal.rest.payment.create(env, client, {</span><br><span class="line">      transactions: [{</span><br><span class="line">        amount: {</span><br><span class="line">          total: <span class="hljs-string">'10.00'</span>,</span><br><span class="line">          currency: <span class="hljs-string">'USD'</span></span><br><span class="line">        }</span><br><span class="line">      }],</span><br><span class="line">    });</span><br><span class="line">  },</span><br><span class="line">  commit: <span class="hljs-literal">true</span>,</span><br><span class="line">  <span class="hljs-comment">// false일 시 모달의 마지막 버튼의 문구가 Continue로 변하고 바로 결제가 진행되는 것이 아니라 리다이렉트 페이지로 이동한다.</span></span><br><span class="line">  <span class="hljs-comment">// true일 시 Pay Now로 변하고 바로 결제가 진행된다</span></span><br><span class="line">  onAuthorize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data, actions</span>) </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> actions.payment.execute().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{</span><br><span class="line">      <span class="hljs-comment">// 결제 성공 시 콜백파라미터인 res에 데이터가 담겨온다</span></span><br><span class="line">      <span class="hljs-built_in">console</span>.log(res);</span><br><span class="line">    });</span><br><span class="line">  }</span><br><span class="line">}, <span class="hljs-string">'#pay-test-btn'</span>);</span><br></pre></td></tr></tbody></table></figure>
<p>그러면 아래와 같이  아까 작성한 <code>#pay-test-btn</code> DOM엘리먼트에 자동으로 Paypal버튼이 렌더된다.</p>
<center><br>  <img src="/2017/05/14/paypal-express-checkout/paypal-button.jpeg" title="paypal-button"><br>  <sub>버튼 모양이 조금 이상해졌지만 신경쓰지 말자…</sub><br>  <br><br></center>

<p>정상적으로 버튼이 렌더되었다면 이제 테스트 결제를 진행해보자.<br>저 버튼을 클릭하면 아래와 같은 창이 하나 뜰 것이다. 이 창은 사용자의 이용환경이 데스크탑이냐, 모바일이냐에 따라 팝업창, iframe또는 새 탭으로 열릴 수 있다.</p>
<p>이 창을 Paypal에서는 <code>light window</code>라고 부르지만 이 포스팅에서는 편의상 그냥 <code>로그인 모달</code>이라고 하겠다.<br>이 후 사용자는 로그인 모달의 안내에 따라 결제를 진행하게 되고, 최종 결제가 완료되면 <code>onAuthorize</code>메소드에 있는 Promise Callback함수의 <code>res</code>파라메터로 결과값을 전달받게 된다.</p>
<center><br>  <img src="/2017/05/14/paypal-express-checkout/light-window.jpeg" title="light-window"><br>  <br><br></center>

<h2 id="Client와-Server의-통신으로-진행하기"><a href="#Client와-Server의-통신으로-진행하기" class="headerlink" title="Client와 Server의 통신으로 진행하기"></a>Client와 Server의 통신으로 진행하기</h2><p>이 플로우는 Paypal에서 발급해주는 client_key와 secret을 이용하여 페이팔 인증부터 차례대로 진행하는 방법이다.<br>이 방법의 장점으로는 본인의 서비스의 UX플로우를 최대한 지키며 결제를 진행시킬 수 있고, 첫번째 방법보다 플로우가 유연하며 버튼 디자인또한 css로 커스터마이징이 자유롭다.<br>그런 이유로 Paypal에서도 이 방법을 권장하고 있다. 결제플로우는 크게 3가지 단계로 나눠진다.</p>
<hr>
<ol>
<li><code>client_key</code>와 <code>secret</code>을 사용하여 페이팔 서버로부터 액세스토큰을 받는 인증 과정</li>
<li>결제를 <code>create</code>하는 과정</li>
<li>결제를 <code>execute</code>하는 과정</li>
</ol>
<hr>
<p>먼저 클라이언트는 버튼을 렌더하고 본 서비스의 API를 통해 <code>create</code>요청을 보내야한다.<br>이때 전 플로우와의 차이점은 딱히 <code>checkout.js</code>를 사용하지않아도 딱히 상관이 없다는 점이다.<br>먼저 버튼을 렌더한다. 참고로 필자는 <code>AngularJS</code>와 <code>md-material</code>을 사용하였다.</p>
<figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">layout</span>=<span class="hljs-string">"row"</span> <span class="hljs-attr">layout-align</span>=<span class="hljs-string">"center center"</span>></span></span><br><span class="line">  <span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">layout</span>=<span class="hljs-string">"column"</span>></span></span><br><span class="line">    <span class="hljs-tag"><<span class="hljs-name">md-button</span> <span class="hljs-attr">md-color</span>=<span class="hljs-string">"{background: 'blue-grey'}"</span> <span class="hljs-attr">ng-click</span>=<span class="hljs-string">"vm.postData()"</span>></span></span><br><span class="line">      TEST</span><br><span class="line">    <span class="hljs-tag">md-button</span>></span><br><span class="line">  <span class="hljs-tag">div</span>></span><br><span class="line"><span class="hljs-tag">div</span>></span><br></pre></td></tr></tbody></table></figure>
<p>이후 Paypal결제를 다른 페이지에서 사용하게 될때 중복로직을 작성해야하므로 따로 팩토리를 정의했다.<br>따로 팩토리를 정의하지 않고 컨트롤러 내부에 구현해도 상관은 없다.<br>이 팩토리에서는 필자의 API서버와 통신을 한 후 <code>Promise</code>를 사용하여 다시 컨트롤러로 값을 전달한다.</p>
<figure class="highlight js hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line"><span class="hljs-meta">  'use strict'</span>;</span><br><span class="line"></span><br><span class="line">  angular</span><br><span class="line">    .module(<span class="hljs-string">'services'</span>)</span><br><span class="line">    .factory(<span class="hljs-string">'PaypalService'</span>, [</span><br><span class="line">      <span class="hljs-string">'$rootScope'</span>, <span class="hljs-string">'Restangular'</span>, <span class="hljs-string">'SNS_KEYS'</span>, <span class="hljs-string">'$q'</span>,</span><br><span class="line">      PaypalService</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PaypalService</span>(<span class="hljs-params">$rootScope, Restangular, SNS_KEYS, $q</span>) </span>{</span><br><span class="line">      <span class="hljs-comment">//페이팔에서 발급해준 키를 전역으로 사용하기 위해 app.constants에 미리 담아놓았다.</span></span><br><span class="line">      <span class="hljs-keyword">var</span> clientKey = SNS_KEYS.paypal;</span><br><span class="line"></span><br><span class="line">      <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@public</span></span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@name <span class="hljs-variable">create</span></span></span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@description </span>create paypal payment request</span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@param <span class="hljs-type">{ Object }</span> <span class="hljs-variable">data</span></span></span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@return <span class="hljs-type">{ Promise }</span></span></span></span><br><span class="line"><span class="hljs-comment">        */</span></span><br><span class="line">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span>(<span class="hljs-params">data</span>) </span>{</span><br><span class="line">        <span class="hljs-keyword">var</span> defer = $q.defer();</span><br><span class="line">        data.clientKey = clientKey;</span><br><span class="line">        data.redirect_urls = {</span><br><span class="line">          return_url: location.origin + <span class="hljs-string">'/paypal/result'</span>, <span class="hljs-comment">// 결제가 완료되었을 때 리다이렉트될 페이지</span></span><br><span class="line">          cancel_url: location.origin + <span class="hljs-string">'/paypal/result'</span> <span class="hljs-comment">// 결제가 취소되었을 때 리다이렉트 될 페이지, return_url과 같아도 상관없다</span></span><br><span class="line">        };</span><br><span class="line">        <span class="hljs-comment">// API서버의 API endpoint</span></span><br><span class="line">        Restangular.all(<span class="hljs-string">'paypal/payments/create'</span>)</span><br><span class="line">        .customPOST(data, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, {</span><br><span class="line">          <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span></span><br><span class="line">        }).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{</span><br><span class="line">          defer.resolve(res);</span><br><span class="line">        }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{</span><br><span class="line">          defer.reject(err);</span><br><span class="line">        });</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> defer.promise;</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@name <span class="hljs-variable">execute</span></span></span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@description </span>execute paypal payment</span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@param <span class="hljs-type">{ Object }</span> <span class="hljs-variable">data</span></span></span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@return <span class="hljs-type">{ Promise}</span></span></span></span><br><span class="line"><span class="hljs-comment">        */</span></span><br><span class="line">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params">data</span>) </span>{</span><br><span class="line">        <span class="hljs-keyword">var</span> defer = $q.defer();</span><br><span class="line">        <span class="hljs-comment">// API서버의 API endpoint</span></span><br><span class="line">        Restangular.all(<span class="hljs-string">'/paypal/payments/execute'</span>).customPOST(data, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, {</span><br><span class="line">          <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span></span><br><span class="line">        }).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{</span><br><span class="line">          defer.resolve(res);</span><br><span class="line">        }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{</span><br><span class="line">          defer.reject(err);</span><br><span class="line">        });</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> defer.promise;</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@name <span class="hljs-variable">getPaymentInfo</span></span></span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@description </span>getting created paypal payment information</span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@param <span class="hljs-type">{ Object }</span> <span class="hljs-variable">data</span></span></span></span><br><span class="line"><span class="hljs-comment">        * <span class="hljs-doctag">@return <span class="hljs-type">{ Promise }</span></span></span></span><br><span class="line"><span class="hljs-comment">        */</span></span><br><span class="line">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPaymentInfo</span>(<span class="hljs-params">data</span>) </span>{</span><br><span class="line">        <span class="hljs-keyword">var</span> defer = $q.defer();</span><br><span class="line">        <span class="hljs-comment">// API서버의 API endpoint</span></span><br><span class="line">        Restangular.all(<span class="hljs-string">'/paypal/payments/detail'</span>).customGET(<span class="hljs-string">''</span>, data).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{</span><br><span class="line">          defer.resolve(res);</span><br><span class="line">        }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{</span><br><span class="line">          defer.reject(err);</span><br><span class="line">        });</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="hljs-keyword">return</span> {</span><br><span class="line">          create: create,</span><br><span class="line">          execute: execute,</span><br><span class="line">          getPaymentInfo: getPaymentInfo</span><br><span class="line">      };</span><br><span class="line">    }</span><br><span class="line">})();</span><br></pre></td></tr></tbody></table></figure>
<p>이후 버튼을 렌더한 html파일에 물려있는 Controller에서 위에서 정의한 Paypal서비스를 호출한다.</p>
<figure class="highlight js hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line"><span class="hljs-meta">  'use strict'</span>;</span><br><span class="line"></span><br><span class="line">  angular</span><br><span class="line">    .module(<span class="hljs-string">'app'</span>)</span><br><span class="line">    .controller(<span class="hljs-string">'PaypalCreateController'</span>, [</span><br><span class="line">      <span class="hljs-string">'$rootScope'</span>, <span class="hljs-string">'$scope'</span>, <span class="hljs-string">'PaypalService'</span>,</span><br><span class="line">      PaypalCreateController</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PaypalCreateController</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">      <span class="hljs-keyword">var</span> vm = <span class="hljs-keyword">this</span>;</span><br><span class="line">      <span class="hljs-comment">//테스트를 위한 더미데이터를 정의한다. 실서비스에는 이 데이터들이 폼에 바인딩 될 것이다.</span></span><br><span class="line">      vm.paymentData = {</span><br><span class="line">        transactions: [{</span><br><span class="line">          amount: {</span><br><span class="line">            total: <span class="hljs-string">'1.00'</span>,</span><br><span class="line">            currency: <span class="hljs-string">'USD'</span></span><br><span class="line">          },</span><br><span class="line">          description: <span class="hljs-string">'This is the description'</span>,</span><br><span class="line">          item_list: {</span><br><span class="line">            items: [{</span><br><span class="line">              name: <span class="hljs-string">'test'</span>,</span><br><span class="line">              description: <span class="hljs-string">'This is test product'</span>,</span><br><span class="line">              quantity: <span class="hljs-string">'1'</span>,</span><br><span class="line">              price: <span class="hljs-string">'1.00'</span>,</span><br><span class="line">              sku: <span class="hljs-string">'1'</span>,</span><br><span class="line">              currency: <span class="hljs-string">'USD'</span></span><br><span class="line">            }]</span><br><span class="line">          }</span><br><span class="line">        }]</span><br><span class="line">      };</span><br><span class="line"></span><br><span class="line">      vm.postData = postData;</span><br><span class="line">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">postData</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">        <span class="hljs-keyword">var</span> data = angular.copy(vm.paymentData);</span><br><span class="line">        <span class="hljs-comment">// Deep Copy를 하는 이유는 데이터를 전송하기전에 변조해야할 경우가 생길 수 있기 때문이며</span></span><br><span class="line">        <span class="hljs-comment">// Object타입은 기본적으로 Call by reference이기때문에 여기서 변조를 해버리면 원본 데이터도 함께 변조되기 때문이다.</span></span><br><span class="line">        PaypalService.create(data).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{</span><br><span class="line">          <span class="hljs-comment">// Paypal에서는 총 3개의 url을 리턴해주는데</span></span><br><span class="line">          <span class="hljs-comment">// links[0] = 방금 생성된 결제정보의 자세한 값을 받을 수 있는 GET메소드 요청 URL</span></span><br><span class="line">          <span class="hljs-comment">// links[1] = 생성된 결제페이지의 리다이렉트 URL</span></span><br><span class="line">          <span class="hljs-comment">// links[2] = 결제 실행 URL</span></span><br><span class="line">          <span class="hljs-comment">// 순으로 나열된다.</span></span><br><span class="line">          <span class="hljs-built_in">window</span>.location = res.result.links[<span class="hljs-number">1</span>].href;</span><br><span class="line">        });</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p>이때 API서버는 클라이언트에서 보내준 값들을 가지고 Paypal서버와 통신하여 인증을 진행하는 로직을 가지고 있어야한다.<br>필자의 API서버는 <code>Laravel 5.x</code>로 되어있다.</p>
<figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">use</span> <span class="hljs-title">Log</span>;</span><br><span class="line"><span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Request</span>;</span><br><span class="line"><span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Requests</span>;</span><br><span class="line"><span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Controllers</span>\<span class="hljs-title">Controller</span>;</span><br><span class="line"><span class="hljs-keyword">use</span> <span class="hljs-title">GuzzleHttp</span>\<span class="hljs-title">Client</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PaypalPaymentController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> $client;</span><br><span class="line">    <span class="hljs-keyword">public</span> $paymentUrl;</span><br><span class="line">    <span class="hljs-keyword">public</span> $accessToken;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>--->client = <span class="hljs-keyword">new</span> Client();</span><br><span class="line">        <span class="hljs-comment">// 페이팔에서 발급받은 access token값을 env에서 가져온다</span></span><br><span class="line">        <span class="hljs-keyword">$this</span>->accessToken = env(<span class="hljs-string">'PAYPAL_ACCESS_TOKEN_SANDBOX'</span>);</span><br><span class="line">        <span class="hljs-comment">// 지금은 테스트 중이라 sandbox url로 요청을 날리고있다. 본 서비스는 sandbox를 제거하고 api.paypal.com으로 날리면 된다.</span></span><br><span class="line">        <span class="hljs-keyword">$this</span>->paymentUrl = <span class="hljs-string">"https://api.sandbox.paypal.com/v1/payments/payment"</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">detail</span><span class="hljs-params">(Request $request)</span></span>{</span><br><span class="line">        $query = $request->query();</span><br><span class="line">        $response = <span class="hljs-keyword">$this</span>->client->request(<span class="hljs-string">'GET'</span>, <span class="hljs-keyword">$this</span>->paymentUrl.<span class="hljs-string">'/'</span>.$query[<span class="hljs-string">'paymentId'</span>] , [</span><br><span class="line">            <span class="hljs-string">'headers'</span> => [</span><br><span class="line">                <span class="hljs-string">"Content-Type"</span> => <span class="hljs-string">"application/json"</span>,</span><br><span class="line">                <span class="hljs-string">"Authorization"</span> => <span class="hljs-keyword">$this</span>->accessToken,</span><br><span class="line">            ],</span><br><span class="line">        ])->getBody()->getContents();</span><br><span class="line">        $decodeResult = json_decode($response);</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> response()->success($decodeResult);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">payment</span><span class="hljs-params">(Request $request)</span> </span>{</span><br><span class="line">        $response = <span class="hljs-keyword">$this</span>->client->request(<span class="hljs-string">'POST'</span>, <span class="hljs-keyword">$this</span>->paymentUrl, [</span><br><span class="line">            <span class="hljs-string">'headers'</span> => [</span><br><span class="line">                <span class="hljs-string">"Content-Type"</span> => <span class="hljs-string">"application.json"</span>,</span><br><span class="line">                <span class="hljs-string">"Authorization"</span> => <span class="hljs-keyword">$this</span>->accessToken,</span><br><span class="line">            ],</span><br><span class="line">            <span class="hljs-string">'json'</span> => [ <span class="hljs-comment">// Paypal서버에 날릴 요청의 Body, 페이팔 공식사이트에 적혀있는 파라미터와 동일해야한다.</span></span><br><span class="line">                <span class="hljs-string">"intent"</span> => <span class="hljs-string">"sale"</span>,</span><br><span class="line">                <span class="hljs-string">"redirect_urls"</span> => $request->redirect_urls,</span><br><span class="line">                <span class="hljs-string">"payer"</span> => [</span><br><span class="line">                    <span class="hljs-string">"payment_method"</span> => <span class="hljs-string">"paypal"</span>, <span class="hljs-comment">// 한국은 paypal메소드밖에 지원이 안된다</span></span><br><span class="line">                ],</span><br><span class="line">                <span class="hljs-string">"transactions"</span> => $request->transactions, <span class="hljs-comment">// client에서 보내준 결제 정보</span></span><br><span class="line">            ]</span><br><span class="line">        ])->getBody()->getContents();</span><br><span class="line">        $decodeResult = json_decode($response);</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> response()->success($decodeResult);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span><span class="hljs-params">(Request $request)</span></span>{</span><br><span class="line">        $response = <span class="hljs-keyword">$this</span>->client->request(<span class="hljs-string">'POST'</span>, <span class="hljs-keyword">$this</span>->paymentUrl.<span class="hljs-string">'/'</span>.$request->paymentId.<span class="hljs-string">'/execute'</span> , [</span><br><span class="line">            <span class="hljs-string">'headers'</span> => [</span><br><span class="line">                <span class="hljs-string">"Content-Type"</span> => <span class="hljs-string">"application/json"</span>,</span><br><span class="line">                <span class="hljs-string">"Authorization"</span> => <span class="hljs-keyword">$this</span>->accessToken,</span><br><span class="line">            ],</span><br><span class="line">            <span class="hljs-string">'json'</span> => [</span><br><span class="line">                <span class="hljs-string">"payer_id"</span> => $request->PayerID,</span><br><span class="line">            ]</span><br><span class="line">        ])->getBody()->getContents();</span><br><span class="line">        $decodeResult = json_decode($response);</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> response()->success($decodeResult);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>이제 클라이언트에서 테스트 버튼을 클릭하면 미리 필자가 정의한 API인 <code>/paypal/payment/create</code>를 통해 필자의 API서버로 결제 데이터가 전송되고, API서버는 다시 그 데이터를 가지고 Paypal서버와 통신 후 클라이언트로 결과를 반환해 줄 것이다.<br>그 후 클라이언트는 리턴된 데이터의 <code>link[1]</code>에 담긴 리다이렉트페이지를 그냥 열기만 하면 결제가 시작된다!<br>왜 <code>link[1]</code>인지는 아래에서 다시 설명하겠다.</p>
<p>이후 사용자는 Paypal로그인 상태에 따라 로그인페이지 또는 결제 확인 페이지로 이동하게되며, Paypal의 결제 확인 창에서 Continue버튼을 누르면 아까 우리가 <code>create</code> API를 통해 보내놓았던 <code>redirect_url</code>페이지로 랜딩된다.<br>이때 Paypal은 사용자가 최종 결제 확인을 했고, 이제 결제를 시작해도 된다는 데이터를 <code>redirect_url</code>뒤에 쿼리스트링의 형태로 붙혀서 보내준다.</p>
<p>이제 클라이언트와 서버의 기본적인 로직이 모두 준비되었다! 전체적인 플로우를 다시 설명하면 다음과 같다.</p>
<hr>
<ol>
<li>클라이언트에서 API서버로 결제 생성 요청을 보낸다.</li>
<li>API서버는 받은 데이터를 가지고 다시 Paypal서버로 결제 생성 요청을 보내고 이후 클라이언트로 값을 반환해준다.</li>
<li>클라이언트는 반환받은 데이터에 있는 <code>redirect_url</code>로 사용자를 리다이렉트 시킨다.</li>
<li>이후 사용자는 이동한 Paypal페이지에서 로그인 및 간략한 결제정보 확인을 마치고 <code>Continue</code>버튼을 클릭한다.</li>
<li><code>Continue</code>버튼이 클릭되면 Paypal은 결제 생성 요청에 담겨있던 <code>redirect_url</code>로 사용자를 리다이렉트 시킨다.</li>
<li>이후 사용자는 리다이렉트된 페이지에서 최종 결제전 상세 결제 정보를 확인한다.</li>
<li>사용자가 “최종결제”버튼을 클릭하면 클라이언트는 결제 실행 요청을 API서버로 보낸다.</li>
<li>API서버는 다시 Paypal서버로 이 요청을 전달하고, 클라이언트로 값을 반환해준다.</li>
<li>결제의 실행결과에 따라 사용자는 해당 페이지로 다시 리다이렉트된다.</li>
</ol>
<hr>
<p>뭔가 굉장히 복잡해 보이지만 잘 보면 API 서버는 거의 그냥 통신 셔틀이라고 보면 된다.<br><code>그러면 그냥 Paypal서버와 다이렉트로 통신하면 안될까?</code> 라고 생각할 수 있지만 이는 보안과 직결되는 문제이다.<br>Paypal 서버와 통신을 하기 위해서는 <code>client_key</code>와 <code>secret</code>이 필요한데, API서 버를 중개하지 않고 Paypal서버와 바로 통신을 하려면 클라이언트가 이 2개의 값을 다 가지고 있어야 한다는 뜻이 된다.<br>하지만 알다시피 웹 상에서 클라이언트 소스는 공개되기가 쉽고 난독화를 한다고 해도 Object의 <code>key</code>같은 <code>String</code>변수는 난독화되지 않기 때문에 악의를 가진 사용자가 손쉽게 <code>client_key</code>와 <code>secret</code>을 탈취할 수 있다.<br>그래서 상대적으로 안전한 서버에 <code>secret</code>을 저장하고 클라이언트에는 <code>client_key</code>만 저장하는 식으로 2개의 값을 한번에 볼 수 없도록 나눠 놓는다.</p>
<h2 id="실행결과"><a href="#실행결과" class="headerlink" title="실행결과"></a>실행결과</h2><p>먼저, API서버를 통해 create요청을 진행한 결과, 필자는 다음과 같은 response를 받을 수 있었다.</p>
<center><br>  <img src="/2017/05/14/paypal-express-checkout/result1.png"><br></center>

<p>links라는 배열을 하나 받았는데, 각 인덱스의 의미는 이렇다.</p>
<p><code>0</code> - 결제의 상세 정보를 GET메소드로 확인해볼 수 있는 API의 URI<br><code>1</code> - Paypal의 결제페이지로 리다이렉트 시키는 URL<br><code>2</code> - 결제를 실행시킬 수 있는 URL</p>
<p>아까 위에서 설명한 <code>links[1]</code>의 의미를 이제 알 수 있을 것이다.<br>그리고 보내진 url의 host를 보면 전부 <code>sandbox.*</code>로 시작하는데 이는 현재 sandbox 계정을 사용하여 테스트를 진행하고 있다는 뜻이다. 실제 운영 API에는 저 sandbox 부분이 빠져있다.<br>그리고 이제 <code>links[1]</code>의 url로 리다이렉트를 시키면 당연히(…) 저 값들은 먼지가 되어 사라지게 된다. 쿠키에 담든 어떻게 사용은 할 수 있겠지만 어차피 또 보내주니까 미련없이 버리자.</p>
<p>필자도 리다이렉트를 안시키고 팝업으로 저 페이지를 열어보았는데 <code>401 Unauthrized</code>를 뱉으며 결제정보가 장렬히 산화하는 모습을 볼 수 있었다….<br>하지만 어차피 Paypal에 <code>create</code>요청을 날린 시점에서 Paypal서버에는 필자가 처음 보낸 <code>redirect_url</code>값이 저장되어있기 때문에 사용자가 Paypal페이지에서 결제확인을 완료하게 되면 다시 주도권은 필자 서비스로 돌아오게 된다.</p>
<p>자 이제 리다이렉트를 시켜보자.</p>
<center><img src="/2017/05/14/paypal-express-checkout/redirect1.jpeg"></center>

<p>그러면 이런 화면이 하나 뜬다. 만약 Paypal에 로그인이 안되어있다면 먼저 로그인페이지로 이동 후 로그인이 완료되면 이 페이지로 이동하게 될 것이다.<br>이 페이지에서 유저는 자신이 결제할 금액을 확인할 수 있으며 오른쪽 상단에 있는 카트모양 아이콘을 누르면 조금 더 상세한 정보가 나오긴 한다. 근데 알아보기 힘들 정도로 간략하게 적혀있어서 딱히 의미는 없을 것 같았다.<br>그리고 필자가 요청을 날린 통화단위는 <code>EUR</code>, 즉 유로화로 등록이 되어있던 상품이었지만 Paypal에서는 자동으로 사용자의 국가의 환율로 자동 환산을 해준다.<br>이제 사용자가 모든 항목을 확인하고 <code>Continue</code>버튼을 누르면 필자가 처음 <code>create</code>시 보냈던 <code>redirect_url</code>로 이동이 시작된다.</p>
<center><img src="/2017/05/14/paypal-express-checkout/redirect2.png"></center>

<p>이 페이지는 필자가 테스트를 위해 임시로 만들어 놓은 페이지이고 실제 운영서버였다면 이 페이지는 최종결제 전 마지막으로 정보를 확인할 수 있는 페이지가 될 것이다.<br>이때 주목해야할 것은 이 페이지의 URL이다.</p>
<center><img src="/2017/05/14/paypal-express-checkout/url.png"></center>

<p>쿼리스트링으로 페이팔이 보내준 <code>paymentId</code>와 <code>token</code>, <code>PayerID</code>가 들어있다. 그럼 이제 저 값들을 사용해서 다음 플로우를 진행하면 된다.<br>이 페이지의 Controller는 저 값들을 사용하여 디테일한 결제정보를 받아오는 로직과 결제를 실행하는 로직을 가진 메소드로 이루어져있다. 혹시 아까 위에서 정의한 Paypal서비스의 로직이 기억나지 않는다면 위에서 다시 보고 오자.</p>
<figure class="highlight js hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line"><span class="hljs-meta">  'use strict'</span>;</span><br><span class="line"></span><br><span class="line">  angular</span><br><span class="line">  .module(<span class="hljs-string">'app.pages.product'</span>)</span><br><span class="line">  .controller(<span class="hljs-string">'PaypalRedirectController'</span>, [</span><br><span class="line">    <span class="hljs-string">'$rootScope'</span>, <span class="hljs-string">'Restangular'</span>, <span class="hljs-string">'PaypalService'</span>, <span class="hljs-string">'$location'</span>,</span><br><span class="line">    PaypalRedirectController</span><br><span class="line">  ]);</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">/** <span class="hljs-doctag">@ngInject </span>*/</span></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PaypalRedirectController</span>(<span class="hljs-params"></span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">      $rootScope, Restangular, PaypalService, $location</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">  </span>) </span>{</span><br><span class="line">    <span class="hljs-keyword">var</span> vm = <span class="hljs-keyword">this</span>;</span><br><span class="line">    <span class="hljs-keyword">var</span> queryString = $location.search(); <span class="hljs-comment">// 페이팔에서 보내준 쿼리스트링을 가져온다</span></span><br><span class="line"></span><br><span class="line">    vm.init = (init)();</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">      getPaymentInfo();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@public</span></span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@method <span class="hljs-variable">executePaypal</span></span></span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    vm.executePaypal = executePaypal;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">executePaypal</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">      <span class="hljs-comment">// 실제 결제 실행 메소드</span></span><br><span class="line">      PaypalService.execute(queryString).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{</span><br><span class="line">        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'EXECUTE RESULT -> '</span>, res);</span><br><span class="line">      });</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@private</span></span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@method <span class="hljs-variable">getPaymentInfo</span></span></span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPaymentInfo</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">      <span class="hljs-comment">// 결제 정보 받아오는 메소드</span></span><br><span class="line">      PaypalService.getPaymentInfo(queryString).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{</span><br><span class="line">        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'GET PAYMENT INFO -> '</span>,res);</span><br><span class="line">      });</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">})();</span><br></pre></td></tr></tbody></table></figure>
<p>필자는 해당 페이지에 있는 버튼에 <code>excutePaypal</code>메소드를 클릭 이벤트로 걸어놓았다.<br>이제 유저가 저 버튼을 클릭하면 최종 결제가 실행되고 결과를 <code>response</code>로 받아볼 수 있다.</p>
<center><img src="/2017/05/14/paypal-express-checkout/result.jpeg"></center>

<p>정상적으로 결제가 진행되고 Paypal서버가 보내준 결과이다. <code>payer.status</code>가 <code>approved</code>라면 정상적으로 결제가 승인된 것이다. 이제 실제로 결제가 승인되었고 돈이 제대로 들어왔는지 확인해볼 차례이다.</p>
<p>페이팔의 <a href="https://www.sandbox.paypal.com/" target="_blank" rel="external nofollow noopener noreferrer">샌드박스 페이지</a>에 접속해서 구매자 계정으로 확인해본 상태이다.<br>구매내역에 정상적으로 <code>12유로</code>가 출금 되었다고 나와있다. 판매자 계정에도 정상적으로 <code>12유로</code>가 들어왔다고 적혀있다.</p>
<center><br>  <img src="/2017/05/14/paypal-express-checkout/customer.png"><br>  <sub>샌드박스의 구매 테스트 계정. 12유로가 출금 되었다.</sub><br><br>  <img src="/2017/05/14/paypal-express-checkout/provider.png"><br>  <sub>샌드박스의 판매 테스트 계정. 최상단에 필자 이름과 함께 12유로가 들어와있다.</sub><br>  <br><br></center>

<p>하지만 아직 완전한 처리가 이루어지지 않은 상태라 Payment status는 <code>Unclaimed</code>로 되어있다. 아직은 저게 현금화 된게 아니라 그냥 Paypal서버에 들어가있는 데이터 쪼가리일 뿐이다.<br>이제 Accept버튼을 눌러 판매자의 계좌로 입금을 진행하면 상태가 <code>Completed</code>로 전환되며 계좌에 <code>12EUR</code>가 <code>USD</code>로 환전되며 입금된다.</p>
<p>이상으로 Express Checkout에 대한 포스팅을 마친다.</p>
</body></html>
        </div>
        
        
        
            <div class="related-posts">
                <h4>관련 포스팅 보러가기</h4>
                <ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/2019/08/19/javascript-audio-effectors-gain/" title="[JavaScript로 오디오 이펙터를 만들어보자] 소리의 흐름을 파악하자" rel="bookmark">[JavaScript로 오디오 이펙터를 만들어보자] 소리의 흐름을 파악하자</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/2017/05/03/calculate-orbit-1/" title="[JavaScript로 천체 구현하기] 케플러 6요소 알아보기" rel="bookmark">[JavaScript로 천체 구현하기] 케플러 6요소 알아보기</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/2017/05/06/gravity-via-js-2/" title="[JavaScript로 중력 구현하기] 2. 코딩하기" rel="bookmark">[JavaScript로 중력 구현하기] 2. 코딩하기</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/2017/05/06/gravity-via-js-1/" title="[JavaScript로 중력 구현하기] 1. 중력이란 무엇일까?" rel="bookmark">[JavaScript로 중력 구현하기] 1. 중력이란 무엇일까?</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/2019/06/15/diving-into-js-array/" title="JavaScript 배열(Array)의 발전과 성능에 대해서 자세히 알아보기" rel="bookmark">JavaScript 배열(Array)의 발전과 성능에 대해서 자세히 알아보기</a></h3></div></li></ul>
            </div>
        

        
        <div class="level is-size-7 is-uppercase post-tags">
            <div class="level-start">
                <div class="tags">
                    <span class="is-size-6 has-text-grey has-mr-7 tag-icon"><i class="fas fa-tag"></i></span>
                    <a class="tag -link" href="/tags/javascript/">JavaScript</a><a class="tag -link" href="/tags/paypal/">Paypal</a><a class="tag -link" href="/tags/페이팔/">페이팔</a>
                </div>
            </div>
        </div>
        

        

        
        
<div class="sharethis-inline-share-buttons"></div>
<script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5d0a1a560345900012ec77c4&amp;product=inline-share-buttons" async="async"></script>

        
    </div>
</div>





<!-- 댓글 위 광고 -->
<ins class="adsbygoogle card" style="display:block" data-ad-client="ca-pub-4372275195526937" data-ad-slot="7343917257" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script class="card">
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>



<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start card">
            <a data-link-name="pagenator" class="level level-item has-link-grey article-nav-prev" href="/2018/07/17/deep-learning-intro/">
                <i class="fas fa-chevron-left"></i> [Deep Learning이란 무엇인가?] 딥러닝이란?
            </a>
        </div>
        
        <!-- <div class="with-prev card to-home">
            <a data-link-name="pagenator" class="level level-item has-link-grey" href="/">
                <i class="fas fa-home"></i> Home
            </a>
        </div> -->
        
        <div class="level-end card">
            <a data-link-name="pagenator" class="level level-item has-link-grey  article-nav-next" href="/2017/05/06/gravity-via-js-2/">
                [JavaScript로 중력 구현하기] 2. 코딩하기 <i class="fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>


</div>
                
                




<div class="column is-4-tablet is-4-desktop is-4-widescreen  has-order-3 column-right is-sticky">
    
        
<div class="card widget" id="toc">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                카탈로그
            </h3>
            <ul class="menu-list"><li>
        <a class="is-flex" href="#Express-Checkout이란" data-link-name="toc">
        <span class="has-mr-6">1</span>
        <span>Express Checkout이란?</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Paypal-Standard" data-link-name="toc">
        <span class="has-mr-6">1.1</span>
        <span>Paypal Standard</span>
        </a></li><li>
        <a class="is-flex" href="#Express-Checkout" data-link-name="toc">
        <span class="has-mr-6">1.2</span>
        <span>Express Checkout</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#Express-Checkout의-흐름" data-link-name="toc">
        <span class="has-mr-6">2</span>
        <span>Express Checkout의 흐름</span>
        </a></li><li>
        <a class="is-flex" href="#Client만으로-진행하기" data-link-name="toc">
        <span class="has-mr-6">3</span>
        <span>Client만으로 진행하기</span>
        </a></li><li>
        <a class="is-flex" href="#Client와-Server의-통신으로-진행하기" data-link-name="toc">
        <span class="has-mr-6">4</span>
        <span>Client와 Server의 통신으로 진행하기</span>
        </a></li><li>
        <a class="is-flex" href="#실행결과" data-link-name="toc">
        <span class="has-mr-6">5</span>
        <span>실행결과</span>
        </a></li></ul>
        </div>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                카테고리
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/essay/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Essay</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">14</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/programming/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Programming</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">47</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/programming/algorithm/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Algorithm</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/programming/audio/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Audio</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/programming/design/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Design</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/programming/git/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Git</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/programming/graphics/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Graphics</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/programming/javascript/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">JavaScript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/programming/machine-learning/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Machine Learning</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/programming/network/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Network</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">9</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/programming/web/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Web</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/soft-skills/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Soft Skills</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/soft-skills/agile/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Agile</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/soft-skills/data/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Data</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/soft-skills/organization/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Organization</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/soft-skills/tools/" data-link-name="category">
            <span class="level-start">
                <span class="level-item">Tools</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li>
            </ul>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/img/logo-text.png" alt="Paypal - Express Checkout Restful API 사용하기" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 Evan Moon&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a> & <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="external nofollow noopener noreferrer">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/" rel="external nofollow noopener noreferrer">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/" rel="external nofollow noopener noreferrer">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="GitHub" href="https://github.com/evan-moon" rel="external nofollow noopener noreferrer">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>

<script>console.log("env -> development");</script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("ko");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/" rel="external nofollow noopener noreferrer" target="_blank">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Kembali ke atas" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    

    
    
    
    

    
    
    


<script src="/js/main.js" defer></script>
<script src="/js/gaevents.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="입력 하세요...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '포스트',
                PAGES: '페이지',
                CATEGORIES: '카테고리',
                TAGS: '태그',
                UNTITLED: '(제목없음)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>