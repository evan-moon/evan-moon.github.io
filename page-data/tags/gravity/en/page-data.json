{"componentChunkName":"component---src-templates-tag-page-template-index-tsx","path":"/tags/gravity/en/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"id":"947de425-1f56-5ddf-92ad-085b106c0fef","tableOfContents":"<ul>\n<li><a href=\"#declaring-necessary-constants\">Declaring Necessary Constants</a></li>\n<li><a href=\"#declaring-the-mover-class\">Declaring the Mover Class</a></li>\n<li><a href=\"#rendering-mover-objects\">Rendering Mover Objects</a></li>\n<li><a href=\"#moving-mover-objects\">Moving Mover Objects</a></li>\n</ul>","excerpt":"In this post, following the previous post, I’m going to directly implement gravity with JS. The development environment uses JavaScript ES7, babel, Webpack, and Three.js.","html":"<p>In this post, following <a href=\"/2017/05/06/gravity-via-js-1\">the previous post</a>, I’m going to directly implement gravity with JS. The development environment uses JavaScript ES7, babel, Webpack, and Three.js.</p>\n<!-- more -->\n<h2 id=\"declaring-necessary-constants\" style=\"position:relative;\">Declaring Necessary Constants<a href=\"#declaring-necessary-constants\" aria-label=\"declaring necessary constants permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>First, I’ll declare the constant values to use in the program.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> initOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">framerate</span><span class=\"token operator\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">G</span><span class=\"token operator\">:</span> <span class=\"token number\">250</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Gravitational constant as I please</span>\n  <span class=\"token constant\">START_SPEED</span><span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Objects' speed during initialization</span>\n  <span class=\"token constant\">OBJECT_COUNT</span><span class=\"token operator\">:</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Number of objects to render after initialization</span>\n  <span class=\"token constant\">TRACE_LENGTH</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Length of objects' movement trajectory</span>\n  <span class=\"token constant\">MIN_MASS</span><span class=\"token operator\">:</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Minimum mass of objects</span>\n  <span class=\"token constant\">MAX_MASS</span><span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Maximum mass of objects</span>\n  <span class=\"token constant\">DENSITY</span><span class=\"token operator\">:</span> <span class=\"token number\">0.15</span> <span class=\"token comment\">// Density at which objects are rendered</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">SPHERE_SIDES</span> <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token operator\">=</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Here, I set the gravitational constant <code class=\"language-text\">G</code>, which originally has a small value of <code class=\"language-text\">6.6742e-11</code>, to <code class=\"language-text\">250</code>, because the masses of objects appearing in the simulation I’m making are too small.</p>\n<p>To apply the actual gravitational constant while still having gravitational influence visible to the eye, the mass would also need to be planet-sized, but that would make calculations too difficult, so I adjusted by reducing object mass and increasing the gravitational constant.</p>\n<p><code class=\"language-text\">MASS_FACTOR</code> is a constant I declared to compensate because when rendering later, I’m trying to set sphere size proportional to object mass, but since mass values are <code class=\"language-text\">400-3000</code>, the sphere volume would become too large.</p>\n<p>It’s a feeling similar to a compression ratio. When defining sphere size later, I’ll multiply the object’s mass by <code class=\"language-text\">MASS_FACTOR</code> to reduce size at a constant ratio.</p>\n<p>Since this post is not for explaining ThreeJS, I’ll skip over <code class=\"language-text\">Scene</code> and <code class=\"language-text\">Renderer</code> declaration and initialization.</p>\n<h2 id=\"declaring-the-mover-class\" style=\"position:relative;\">Declaring the Mover Class<a href=\"#declaring-the-mover-class\" aria-label=\"declaring the mover class permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Now let’s implement the things that will actually move. I wanted to name it Object, but as you know, the name Object is already taken by a Built-in Object in JS. So after agonizing over another name, I just called it <code class=\"language-text\">Mover</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">SPHERE_SIDES</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'src/constants'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n Vector3<span class=\"token punctuation\">,</span> SphereGeometry<span class=\"token punctuation\">,</span> Line<span class=\"token punctuation\">,</span>\n MeshPhongMaterial<span class=\"token punctuation\">,</span> PointLight<span class=\"token punctuation\">,</span> Mesh<span class=\"token punctuation\">,</span> Geometry\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'three'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Mover</span> <span class=\"token punctuation\">{</span>\n <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mass<span class=\"token punctuation\">,</span> velocity<span class=\"token punctuation\">,</span> location<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">,</span> scene</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>uid <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">mover-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location <span class=\"token operator\">=</span> location<span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity <span class=\"token operator\">=</span> velocity<span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>acceleration <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">=</span> mass<span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>alive <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>geometry <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SphereGeometry</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">SPHERE_SIDES</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">SPHERE_SIDES</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>vertices <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>line <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Line</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>line<span class=\"token punctuation\">.</span>material<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">;</span>\n\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>basicMaterial <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MeshPhongMaterial</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n     <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span>\n     <span class=\"token literal-property property\">specular</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span>\n     <span class=\"token literal-property property\">shininess</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mesh <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Mesh</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>geometry<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>basicMaterial<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mesh<span class=\"token punctuation\">.</span>castShadow <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mesh<span class=\"token punctuation\">.</span>receiveShadow <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>position <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parentScene <span class=\"token operator\">=</span> scene<span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Objects created with the <code class=\"language-text\">Mover</code> class have random mass, speed, and position values received when <code class=\"language-text\">constructor</code> executes. And it initializes the <code class=\"language-text\">acceleration</code> value representing acceleration. Since acceleration is a speed moving in some direction, I declared it as a vector with 3 elements.</p>\n<p>And when collision detection occurs between <code class=\"language-text\">Movers</code>, I plan to merge two <code class=\"language-text\">Movers</code> into one to make a <code class=\"language-text\">Mover</code> with larger mass, so I declared an <code class=\"language-text\">alive</code> member variable to determine whether that Mover is dead or alive.</p>\n<h2 id=\"rendering-mover-objects\" style=\"position:relative;\">Rendering Mover Objects<a href=\"#rendering-mover-objects\" aria-label=\"rendering mover objects permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Then I wrote logic in <code class=\"language-text\">Scene</code> to draw <code class=\"language-text\">Movers</code> during initialization.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> movers <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>movers<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>movers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// Initialize movers list</span>\n      movers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>mesh<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>selectionLight<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    movers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span><span class=\"token constant\">MOVER_COUNT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> mass <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span><span class=\"token constant\">MIN_MASS</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span><span class=\"token constant\">MAX_MASS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> maxDistance <span class=\"token operator\">=</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span> <span class=\"token operator\">/</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span><span class=\"token constant\">DENSITY</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> maxSpeed <span class=\"token operator\">=</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span><span class=\"token constant\">START_SPEED</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">const</span> velocity <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxSpeed<span class=\"token punctuation\">,</span> maxSpeed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxSpeed<span class=\"token punctuation\">,</span> maxSpeed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxSpeed<span class=\"token punctuation\">,</span> maxSpeed<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> location <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxDistance<span class=\"token punctuation\">,</span> maxDistance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxDistance<span class=\"token punctuation\">,</span> maxDistance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>maxDistance<span class=\"token punctuation\">,</span> maxDistance<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// Create Mover with random speed, position, mass</span>\n      movers<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Mover</span><span class=\"token punctuation\">(</span>mass<span class=\"token punctuation\">,</span> velocity<span class=\"token punctuation\">,</span> location<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Put Mesh, Line, Light objects created when Mover initialized into Scene</span>\n    movers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v</span> <span class=\"token operator\">=></span> v<span class=\"token punctuation\">.</span><span class=\"token function\">addMover</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>movers <span class=\"token operator\">=</span> movers<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">getRandomize</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">min<span class=\"token punctuation\">,</span> max</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>max <span class=\"token operator\">-</span> min<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> min<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now <code class=\"language-text\">Scene</code> has <code class=\"language-text\">movers</code>, which is a list containing multiple <code class=\"language-text\">Movers</code>. Now we just calculate during rendering and we’re done! But…\nAs I said in the previous post, n-body problems for finding gravity for multiple objects have no solution.</p>\n<p>So we need to make logic that traverses <code class=\"language-text\">movers</code> and calculates gravity with other <code class=\"language-text\">Movers</code> as two-body problems each time we traverse.</p>\n<h2 id=\"moving-mover-objects\" style=\"position:relative;\">Moving Mover Objects<a href=\"#moving-mover-objects\" aria-label=\"moving mover objects permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">let</span> movers <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>movers<span class=\"token punctuation\">;</span>\n\nmovers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o1<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>o1<span class=\"token punctuation\">.</span>alive<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  movers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o2<span class=\"token punctuation\">,</span> j</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>o1<span class=\"token punctuation\">.</span>alive <span class=\"token operator\">&amp;&amp;</span> o2<span class=\"token punctuation\">.</span>alive <span class=\"token operator\">&amp;&amp;</span> i <span class=\"token operator\">!==</span> j<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Distance from o1 -> o2</span>\n      <span class=\"token keyword\">const</span> distance <span class=\"token operator\">=</span> o1<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span><span class=\"token function\">distanceTo</span><span class=\"token punctuation\">(</span>o2<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// o1, o2's radii r1, r2</span>\n      <span class=\"token keyword\">const</span> r1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>o1<span class=\"token punctuation\">.</span>mass <span class=\"token operator\">/</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token operator\">/</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token operator\">/</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">**</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> r2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>o2<span class=\"token punctuation\">.</span>mass <span class=\"token operator\">/</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token operator\">/</span> <span class=\"token constant\">MASS_FACTOR</span> <span class=\"token operator\">/</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">**</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>distance <span class=\"token operator\">&lt;=</span> r1 <span class=\"token operator\">+</span> r2<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// If their distance is less than or equal to the sum of their radii, judge as collision and merge the two objects</span>\n        o2<span class=\"token punctuation\">.</span><span class=\"token function\">eat</span><span class=\"token punctuation\">(</span>o1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// If not collision, just make them move</span>\n        o2<span class=\"token punctuation\">.</span><span class=\"token function\">attract</span><span class=\"token punctuation\">(</span>o1<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>First, I made collision detection while traversing all <code class=\"language-text\">Movers</code> like this. The <code class=\"language-text\">Mover</code> class’s <code class=\"language-text\">eat</code> method has logic to merge two <code class=\"language-text\">Movers</code> that had collision detection into one, and the <code class=\"language-text\">attract</code> method measures gravity at the current distance of the two objects and adds it to the <code class=\"language-text\">Mover</code>’s acceleration.</p>\n<p>After all calculations finish, I updated the <code class=\"language-text\">Mover</code>’s position, size, speed, direction, etc. The <code class=\"language-text\">Gravity</code> class’s <code class=\"language-text\">calcGravity</code> method is exactly the same logic I wrote in <a href=\"/2017/05/06/gravity-via-js-1\">the previous post</a>.</p>\n<p>Methods related to <code class=\"language-text\">Mover</code>’s motion are as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Mover</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mass<span class=\"token punctuation\">,</span> velocity<span class=\"token punctuation\">,</span> location<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">,</span> scene</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">eat</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">otherMover</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> newMass <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> newLocation <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>z <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>z <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> newVelocity <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>z <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> otherMover<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>z <span class=\"token operator\">*</span> otherMover<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> newMass\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location <span class=\"token operator\">=</span> newLocation<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity <span class=\"token operator\">=</span> newVelocity<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">=</span> newMass<span class=\"token punctuation\">;</span>\n\n    otherMover<span class=\"token punctuation\">.</span><span class=\"token function\">kill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">attract</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">otherMover<span class=\"token punctuation\">,</span> options</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> force <span class=\"token operator\">=</span> Gravity<span class=\"token punctuation\">.</span><span class=\"token function\">calcGravity</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> otherMover<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">.</span><span class=\"token constant\">G</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">applyForce</span><span class=\"token punctuation\">(</span>force<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">applyForce</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">force</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">=</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> f <span class=\"token operator\">=</span> force<span class=\"token punctuation\">.</span><span class=\"token function\">divideScalar</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Apply force to mover's acceleration</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>acceleration<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>acceleration<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Add acceleration to velocity</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Add velocity to position to move</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>acceleration<span class=\"token punctuation\">.</span><span class=\"token function\">multiplyScalar</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Reset acceleration</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mesh<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">.</span><span class=\"token function\">copy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Apply position to mover's mesh object</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>To summarize, every frame we traverse the <code class=\"language-text\">movers</code> list, calculate gravity between each <code class=\"language-text\">Movers</code>, apply acceleration, and actually move the <code class=\"language-text\">Mover</code>. The full source can be checked in the <a href=\"https://github.com/evan-moon/3d-gravity-test\" target=\"_blank\" rel=\"nofollow\">gravity test project GitHub repository</a>.</p>\n<p>That’s all for this post on implementing gravity with JavaScript.</p>","fields":{"slug":"20170506-gravity-via-js-2-en","path":"/2017/05/06/gravity-via-js-2/en/","lang":"en"},"frontmatter":{"title":"[Implementing Gravity with JavaScript] 2. Coding","subTitle":"Gravity Simulation Applying the Law of Universal Gravitation","date":"May 06, 2017","categories":["Programming","Graphics"],"tags":["Implementing Gravity","Gravity","JavaScript","WebGL","Math","ThreeJS","Tutorial"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/6c72a52042fa8bad71e5e927ca2d86d6/3a812/thumbnail.jpg","srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/3a812/thumbnail.jpg 320w,\n/static/6c72a52042fa8bad71e5e927ca2d86d6/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/fc5c5/thumbnail.webp 320w,\n/static/6c72a52042fa8bad71e5e927ca2d86d6/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/6c72a52042fa8bad71e5e927ca2d86d6/2d839/thumbnail.jpg","srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}},{"node":{"id":"29465098-3c06-5f9d-8576-0b50982f304c","tableOfContents":"<ul>\n<li><a href=\"#what-is-gravity\">What is Gravity?</a></li>\n<li><a href=\"#so-how-to-implement\">So How to Implement?</a></li>\n</ul>","excerpt":"In this post, I’m going to implement gravity using the law of universal gravitation. Not gravity acting in one direction on the ground surface, but I plan to make a simulation where I scatter multiple objects with random masses at random coordinates and observe how they interfere with each other’s motion.","html":"<p>In this post, I’m going to implement gravity using the law of universal gravitation. Not gravity acting in one direction on the ground surface, but I plan to make a simulation where I scatter multiple objects with random masses at random coordinates and observe how they interfere with each other’s motion.</p>\n<!-- more -->\n<h2 id=\"what-is-gravity\" style=\"position:relative;\">What is Gravity?<a href=\"#what-is-gravity\" aria-label=\"what is gravity permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>First, since this post is aimed at people like me who are <strong>not familiar with mathematics</strong> rather than physics majors, I want to properly establish the concept of gravity before moving on.</p>\n<p>Newton said that gravity is the force by which two objects with mass attract each other.</p>\n<p>In fact, while Newton figured out how gravity works by creating the formula for the law of universal gravitation, he didn’t know why gravity occurs. He probably passed it off as “only God would know…”\nAnd Newton said that objects with mass have gravity, which means that light has no mass and is therefore not affected by gravity at all.</p>\n<p>However, according to facts revealed in modern times, light is also affected by gravity. Didn’t we see this in the movie Interstellar? <small>(While it may not be a 100% accurate visual depiction, theoretical physicist Kip Thorne calculated general relativity and visualized it in 3D.)</small></p>\n<p>In places with tremendous gravity like black holes, this phenomenon is noticeably observed, and this is called gravitational lensing.</p>\n<center>\n  <img src=\"/59d205c9bdb4c3be36f94bb8b25cddf1/gravity-lens.gif\" alt=\"gravity lens\" width=\"100%\">\n  <br>\n  <small>Bending of light passing behind a black hole</small>\n  <br>\n  <br>\n</center>\n<p>Gravity came to be defined in Einstein’s general relativity in 1915 as the bending of spacetime by energy. So when the mass of an object in spacetime rapidly increases or decreases, waves are created in spacetime, and this is gravitational waves, which were discovered early last year.</p>\n<p>Gravitational waves generated like this are said to move at the same speed as light. So if the sun suddenly disappeared from the solar system with a poof!, the planets orbiting around the sun wouldn’t immediately escape their orbits and fly away.</p>\n<p>For example, in Earth’s case, since light from the sun takes about 8 minutes and 20 seconds to reach Earth, even if the sun suddenly disappeared, for about 8 minutes we would continue orbiting the position where the vanished sun was.\nThen 8 minutes later, the moment the last light that left the sun reaches Earth, Earth would break orbit.</p>\n<center>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/434fed24de68a2e16a016af2e5c94459/29d31/gravity.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeHeFkA//8QAGBABAAMBAAAAAAAAAAAAAAAAAQACEBH/2gAIAQEAAQUCqTho5//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAAICAwAAAAAAAAAAAAAAAAABEDERQVH/2gAIAQEAAT8hRbHg0O4Z2P/aAAwDAQACAAMAAAAQQw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEBAQEBAQAAAAAAAAAAAAABEQAxEKH/2gAIAQEAAT8QY05wyqSrJPuipy4zWKTz/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"gravity\" title=\"\" src=\"/static/434fed24de68a2e16a016af2e5c94459/c08c5/gravity.jpg\" srcset=\"/static/434fed24de68a2e16a016af2e5c94459/0913d/gravity.jpg 160w,\n/static/434fed24de68a2e16a016af2e5c94459/cb69c/gravity.jpg 320w,\n/static/434fed24de68a2e16a016af2e5c94459/c08c5/gravity.jpg 640w,\n/static/434fed24de68a2e16a016af2e5c94459/29d31/gravity.jpg 700w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <small>Objects with larger mass bend spacetime more</small>\n</center>\n<p>This doesn’t mean the law of universal gravitation was wrong; rather, the theory of relativity is closer to complementing what the law of universal gravitation missed. In fact, if it’s not a space with very large gravity <small>(a very bent space)</small>, the law of universal gravitation can explain it sufficiently.</p>\n<p>For example, Earth is a large sphere overall, but when we who live on Earth look around, we can’t tell whether it’s a sphere or a plane. Similarly, a space where the degree of bending is so small that it’s almost similar to Euclidean space is called pseudo-Euclidean space. And in such pseudo-Euclidean space, applying only the law of universal gravitation is sufficient. They say that even when sending the Apollo spacecraft to the moon, the law of universal gravitation alone was enough.</p>\n<p>In conclusion, finding gravity can be seen as finding the curvature of spacetime, but the simple simulation I’m trying to make is simulating situations within a very small pseudo-Euclidean space, and since it’s not a program applied to reality but literally a simulation, it can be sufficiently implemented with just the law of universal gravitation.</p>\n<h2 id=\"so-how-to-implement\" style=\"position:relative;\">So How to Implement?<a href=\"#so-how-to-implement\" aria-label=\"so how to implement permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>First, to explain easily, let’s assume we scatter 2 objects with random masses at random coordinates with random directions and speeds into space.\nCalculating the gravitational influence of these 2 objects is not very difficult. This is where the law of universal gravitation appears.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>F</mi><mn>12</mn></msub><mo>=</mo><mo>−</mo><mi>G</mi><mfrac><mrow><msub><mi>m</mi><mn>1</mn></msub><msub><mi>m</mi><mn>2</mn></msub></mrow><mrow><mi mathvariant=\"normal\">∣</mi><msup><mrow><msub><mi>r</mi><mn>12</mn></msub><mi mathvariant=\"normal\">∣</mi></mrow><mn>2</mn></msup></mrow></mfrac><mover accent=\"true\"><msub><mi>r</mi><mn>12</mn></msub><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">F_{12} = -G{\\frac{m_1 m_2}{\\vert{r_{12}\\vert}^2}}\\hat{r_{12}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2016em;vertical-align:-1.094em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">G</span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.156em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.954em;\"><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.094em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></div>\n<p>This formula calculates the gravitational force <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span></span> that object 1 exerts on object 2. Here <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span></span> means the <a href=\"https://ko.wikipedia.org/wiki/%EC%A4%91%EB%A0%A5_%EC%83%81%EC%88%98\" target=\"_blank\" rel=\"nofollow\">gravitational constant</a>, and this gravitational constant is fixed at <code class=\"language-text\">6.67384 * 10^-11</code>.</p>\n<p>And <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">m_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> and <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">m_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> in the numerator are the masses of each object, and <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mn>12</mn></msub></mrow><annotation encoding=\"application/x-tex\">r_{12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> in the denominator means the <a href=\"https://ko.wikipedia.org/wiki/%EC%9C%A0%ED%81%B4%EB%A6%AC%EB%93%9C_%EA%B1%B0%EB%A6%AC\" target=\"_blank\" rel=\"nofollow\">Euclidean distance</a> between these objects. And the <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span> multiplied at the end means the unit vector from object 1 looking toward object 2.</p>\n<p>The point of this formula is that the distance between objects is in the denominator and the masses of the two objects are in the numerator.</p>\n<p>This means that as the distance between two objects increases, the denominator gets larger so the result value becomes smaller, and as the masses of the two objects increase, the numerator gets larger so the result value becomes larger. Simply put, gravity is <strong>inversely proportional to the distance between two objects and directly proportional to the product of the masses of the two objects</strong>.</p>\n<p>For those who haven’t studied linear algebra, simply understanding that a vector means a direction in space should be sufficient. Since the space we’re trying to calculate is 3-dimensional space, vectors have 3 coordinate values: <code class=\"language-text\">(x, y, z)</code>.</p>\n<p>The law of universal gravitation we learned when we were young has the form:</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>F</mi><mo>=</mo><mi>G</mi><mfrac><mrow><msub><mi>m</mi><mn>1</mn></msub><msub><mi>m</mi><mn>2</mn></msub></mrow><msup><mi>r</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding=\"application/x-tex\">F = G\\frac{m_1 m_2}{r^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></div>\n<p>The result of this formula has scalar values like <code class=\"language-text\">1</code>, <code class=\"language-text\">5.2</code>, or <code class=\"language-text\">1204</code>. Since scalars only represent physical quantities, you can know how strong gravity is but can’t know the direction of gravity.</p>\n<p>So we need to express the direction of force to properly use this formula, which is why we multiply by a vector at the end.</p>\n<p>And the reason <code class=\"language-text\">-1</code> is attached at the very front of the formula is because of the vector’s direction. The vector we multiplied at the end is the direction from object 1 toward object 2. But gravity is a force that pulls toward me, not a pushing force, so the direction of force should be from object 2 toward object 1. That’s why we multiply by <code class=\"language-text\">-1</code> again in the above formula.</p>\n<p>It looks a bit complicated, but when actually implemented in code, it’s simple. I proceeded with vector calculations using <a href=\"https://threejs.org/\" target=\"_blank\" rel=\"nofollow\">ThreeJS</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Vector3 <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'three'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">calcGravity</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o1<span class=\"token punctuation\">,</span> o2<span class=\"token punctuation\">,</span> <span class=\"token constant\">G</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Find the difference between o1's position vector and o2's position vector to get the vector looking from o1 -> o2.</span>\n  <span class=\"token keyword\">let</span> force <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector3</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">subVectors</span><span class=\"token punctuation\">(</span>o1<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">,</span> o2<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Find the length of the direction vector obtained above and convert to absolute value.</span>\n  <span class=\"token keyword\">const</span> distance <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sqrt</span><span class=\"token punctuation\">(</span>force<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">**</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Convert the direction vector obtained above to a unit vector.</span>\n  force <span class=\"token operator\">=</span> force<span class=\"token punctuation\">.</span><span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Get gravity scalar</span>\n  <span class=\"token keyword\">const</span> strength <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token constant\">G</span> <span class=\"token operator\">*</span> o1<span class=\"token punctuation\">.</span>mass <span class=\"token operator\">*</span> o2<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>distance <span class=\"token operator\">**</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Multiply the direction vector by the gravity scalar obtained above</span>\n  force <span class=\"token operator\">=</span> force<span class=\"token punctuation\">.</span><span class=\"token function\">multiplyScalar</span><span class=\"token punctuation\">(</span>strength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> force<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now if we keep adding the value from here to the position value of the current object being calculated, the object will move in that direction. But the problem is that in reality we’re not just going to scatter 2 objects.</p>\n<p>That law of universal gravitation is considering and calculating only the gravity between 2 objects. Then can we also calculate multiple objects’ gravity influencing and receiving influence from each other?</p>\n<p>Unfortunately, such <a href=\"https://ko.wikipedia.org/wiki/%EB%8B%A4%EC%B2%B4_%EB%AC%B8%EC%A0%9C\" target=\"_blank\" rel=\"nofollow\">n-body problems</a> are one of the most difficult problems in mathematical physics, and in 1887, Henri Poincaré said it was impossible to find a general solution to three-body or greater problems. So we have no choice but to approximately calculate gravity using the two-body problem’s law of universal gravitation above.</p>\n<p>In <a href=\"/2017/05/06/gravity-via-js-2\">the next post</a>, I plan to implement a simple gravity model sample in code. That’s all for the first post on implementing gravity with JavaScript.</p>","fields":{"slug":"20170506-gravity-via-js-1-en","path":"/2017/05/06/gravity-via-js-1/en/","lang":"en"},"frontmatter":{"title":"[Implementing Gravity with JavaScript] 1. What is Gravity?","subTitle":"How Does Gravity Bend Space?","date":"May 06, 2017","categories":["Programming","Graphics"],"tags":["Implementing Gravity","Gravity","JavaScript","WebGL","Math","ThreeJS","Tutorial"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","images":{"fallback":{"src":"/static/6c72a52042fa8bad71e5e927ca2d86d6/3a812/thumbnail.jpg","srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/3a812/thumbnail.jpg 320w,\n/static/6c72a52042fa8bad71e5e927ca2d86d6/4b287/thumbnail.jpg 750w","sizes":"(min-width: 320px) 320px, 100vw"},"sources":[{"srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/fc5c5/thumbnail.webp 320w,\n/static/6c72a52042fa8bad71e5e927ca2d86d6/e9225/thumbnail.webp 750w","type":"image/webp","sizes":"(min-width: 320px) 320px, 100vw"}]},"width":320,"height":320}}},"jumbotron":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/6c72a52042fa8bad71e5e927ca2d86d6/2d839/thumbnail.jpg","srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/2d839/thumbnail.jpg 750w","sizes":"100vw"},"sources":[{"srcSet":"/static/6c72a52042fa8bad71e5e927ca2d86d6/b384d/thumbnail.webp 750w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5}}}}}}]}},"pageContext":{"tag":"Gravity","lang":"en"}},"staticQueryHashes":["3523904809","650499039"],"slicesMap":{}}